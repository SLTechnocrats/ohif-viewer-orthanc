{"version":3,"file":"173.bundle.fdec3dff1b70b5ababdf.js","mappings":"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Cf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,GAAI,IAAK,KACd,CAAC,IAAK,GAAI,GAAI,KACd,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,GAAI,IAAK,GAAI,KACd,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,GAAI,KACd,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,GAAI,IAAK,KACd,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,GAAI,IAAK,GAAI,KACd,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,GAAI,IAAK,GAAI,KACd,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,GAAI,KACd,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,GAAI,KACd,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,GAAI,IAAK,KACd,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,GAAI,IAAK,GAAI,KACd,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,IAAK,IAAK,IAAK,KAChB,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,GAAI,IAAK,KACf,CAAC,IAAK,IAAK,GAAI,KACf,CAAC,GAAI,IAAK,IAAK,KACf,CAAC,IAAK,IAAK,IAA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","sources":["webpack:///../../../node_modules/@cornerstonejs/calculate-suv/dist/calculate-suv.esm.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/constants/COLOR_LUT.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/cursors/MouseCursor.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/cursors/elementCursor.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/cursors/ImageMouseCursor.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/cursors/SVGCursorDescriptor.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/cursors/SVGMouseCursor.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/cursors/setCursorForElement.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/cursors/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/getSvgDrawingHelper.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/draw.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/setAttributesIfNecessary.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/setNewAttributesIfValid.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawCircle.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawEllipseByCoordinates.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawEllipse.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawHandle.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawHandles.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawLine.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawHeight.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawPolyline.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawPath.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawTextBox.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawLink.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawLinkedTextBox.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawRectByCoordinates.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawRect.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawArrow.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/drawingSvg/drawRedactionRect.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/enums/ChangeTypes.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/enums/Events.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/enums/StrategyCallbacks.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/enums/ToolModes.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/enums/Touch.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/enums/AnnotationStyleStates.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/enums/WorkerTypes.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/annotations/contourSegmentation/contourSegmentationCompleted.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/mouse/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/touch/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/wheel/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/segmentation/labelmap/onLabelmapSegmentationDataModified.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/segmentation/segmentationDataModifiedEventListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/segmentation/segmentationModifiedEventListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/segmentation/imageChangeEventListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/annotations/annotationCompletedListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/annotations/annotationSelectionListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/annotations/annotationModifiedListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/annotations/annotationRemovedListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/annotations/contourSegmentation/contourSegmentationRemoved.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/imageRenderedEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/mouseToolEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/keyboardToolEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/cameraModifiedEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/imageSpacingCalibratedEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/touchToolEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/annotationInterpolationEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventDispatchers/cameraResetEventDispatcher.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/addEnabledElement.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/SynchronizerManager/getSynchronizersForViewport.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/removeEnabledElement.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/cancelActiveManipulations.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/SynchronizerManager/Synchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/SynchronizerManager/createSynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/SynchronizerManager/destroy.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/SynchronizerManager/getSynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/SynchronizerManager/getAllSynchronizers.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/SynchronizerManager/destroySynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/eventListeners/segmentation/segmentationRepresentationModifiedListener.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/init.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/callbacks/cameraSyncCallback.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/synchronizers/createCameraPositionSynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/callbacks/presentationViewSyncCallback.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/synchronizers/createPresentationViewSynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/callbacks/voiSyncCallback.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/synchronizers/createVOISynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/callbacks/zoomPanSyncCallback.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/synchronizers/createZoomPanSynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/callbacks/imageSliceSyncCallback.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/callbacks/areViewportsCoplanar.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/synchronizers/createImageSliceSynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/callbacks/slabThicknessSyncCallback.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/synchronizers/createSlabThicknessSynchronizer.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/synchronizers/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/PanTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/TrackballRotateTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/WindowLevelTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/WindowLevelRegionTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/StackScrollTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/PlanarRotateTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/ZoomTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/MIPJumpToClickTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/CrosshairsTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/MagnifyTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/AdvancedMagnifyTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/ReferenceLinesTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/OverlayGridTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/SegmentationIntersectionTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/ReferenceCursors.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/ScaleOverlayTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/SculptorTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/VolumeRotateTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/LengthTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/HeightTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/ProbeTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/DragProbeTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/EllipticalROITool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/CircleROITool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/ETDRSGridTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/SplineROITool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/SplineContourSegmentationTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/LivewireContourTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/LivewireContourSegmentationTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/ArrowAnnotateTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/AngleTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/CobbAngleTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/UltrasoundDirectionalTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/KeyImageTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/AnnotationEraserTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/RectangleScissorsTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/CircleScissorsTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/SphereScissorsTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/CircleROIStartEndThresholdTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/PaintFillTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/OrientationMarkerTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/SegmentSelectTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/VideoRedactionTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/AnnotationRenderingEngine.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/FrameOfReferenceSpecificAnnotationManager.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/annotationLocking.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/annotationSelection.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/annotationState.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/annotationVisibility.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/config/ToolStyle.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/config/helpers.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/config/getState.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/config/getFont.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/getAnnotation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/helpers/state.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/annotation/AnnotationGroup.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/SegmentationRenderingEngine.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/SegmentationStateManager.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/SegmentationStyle.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/activeSegmentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/setActiveSegmentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/addColorLUT.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/internalAddSegmentationRepresentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/addSegmentationRepresentationsToViewport.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/helpers/normalizeSegmentationInput.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/addSegmentations.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/config/segmentationColor.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/events/triggerSegmentationDataModified.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getActiveSegmentIndex.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getActiveSegmentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getCurrentLabelmapImageIdForViewport.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getSegmentationRepresentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getSegmentationRepresentationVisibility.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getSegmentations.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getViewportIdsWithSegmentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getViewportSegmentations.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/helpers/computeVolumeLabelmapFromStack.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/updateSegmentations.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/config/segmentationVisibility.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/setSegmentationRepresentationVisibility.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/config/styleHelpers.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/helpers/clearSegmentValue.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/removeSegment.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getLabelmapImageIds.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/polySeg/Contour/computeAndAddContourRepresentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/polySeg/Labelmap/computeAndAddLabelmapRepresentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/polySeg/Surface/computeAndAddSurfaceRepresentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/polySeg/Surface/updateSurfaceData.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/polySeg/Surface/createAndCacheSurfacesFromRaw.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/polySeg/Surface/convertContourToSurface.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/polySeg/Surface/convertLabelmapToSurface.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/polySeg/Surface/surfaceComputationStrategies.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/polySeg/canComputeRequestedRepresentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/polySeg/computeAndAddRepresentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/removeSegmentation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/removeSegmentationRepresentations.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/segmentIndex.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/segmentLocking.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/removeColorLUT.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/getStackSegmentationImageIdsForViewport.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/segmentationState.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/stateManagement/segmentation/updateLabelmapSegmentationImageReferences.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/ToolGroupManager/getToolGroupForViewport.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/ToolGroupManager/getToolGroup.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/ToolGroupManager/ToolGroup.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/ToolGroupManager/createToolGroup.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/ToolGroupManager/destroyToolGroup.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/ToolGroupManager/destroy.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/ToolGroupManager/getAllToolGroups.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/ToolGroupManager/getToolGroupsWithToolName.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/addTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/state.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/store/svgNodeCache.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/BidirectionalTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/PlanarFreehandContourSegmentationTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/PlanarFreehandROITool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/annotation/RectangleROITool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/base/AnnotationDisplayTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/base/BaseTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/displayTools/Contour/contourDisplay.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/displayTools/Labelmap/labelmapDisplay.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/displayTools/Surface/surfaceDisplay.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/BrushTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/RectangleROIStartEndThresholdTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/tools/segmentation/RectangleROIThresholdTool.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/types/ContourAnnotation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/getViewportsForAnnotation.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/index.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/math/vec2/findClosestPoint.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/getUniqueSegmentIndices.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/invalidateBrushCursor.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/segmentation/utilities.js","webpack:///../../../node_modules/@cornerstonejs/tools/dist/esm/utilities/triggerAnnotationRenderForViewportIds.js","webpack:///../../../node_modules/@icons/material/CheckIcon.js","webpack:///../../../node_modules/@icons/material/UnfoldMoreHorizontalIcon.js","webpack:///../../../node_modules/dicomweb-client/build/dicomweb-client.es.js","webpack:///../../../node_modules/lodash.get/index.js","webpack:///../../../node_modules/lodash/_DataView.js","webpack:///../../../node_modules/lodash/_Hash.js","webpack:///../../../node_modules/lodash/_ListCache.js","webpack:///../../../node_modules/lodash/_Map.js","webpack:///../../../node_modules/lodash/_MapCache.js","webpack:///../../../node_modules/lodash/_Promise.js","webpack:///../../../node_modules/lodash/_Set.js","webpack:///../../../node_modules/lodash/_SetCache.js","webpack:///../../../node_modules/lodash/_Stack.js","webpack:///../../../node_modules/lodash/_Uint8Array.js","webpack:///../../../node_modules/lodash/_WeakMap.js","webpack:///../../../node_modules/lodash/_arrayEach.js","webpack:///../../../node_modules/lodash/_arrayFilter.js","webpack:///../../../node_modules/lodash/_arrayLikeKeys.js","webpack:///../../../node_modules/lodash/_arrayMap.js","webpack:///../../../node_modules/lodash/_arrayPush.js","webpack:///../../../node_modules/lodash/_arraySome.js","webpack:///../../../node_modules/lodash/_assignValue.js","webpack:///../../../node_modules/lodash/_assocIndexOf.js","webpack:///../../../node_modules/lodash/_baseAssign.js","webpack:///../../../node_modules/lodash/_baseAssignIn.js","webpack:///../../../node_modules/lodash/_baseAssignValue.js","webpack:///../../../node_modules/lodash/_baseClone.js","webpack:///../../../node_modules/lodash/_baseCreate.js","webpack:///../../../node_modules/lodash/_baseEach.js","webpack:///../../../node_modules/lodash/_baseFor.js","webpack:///../../../node_modules/lodash/_baseForOwn.js","webpack:///../../../node_modules/lodash/_baseGet.js","webpack:///../../../node_modules/lodash/_baseGetAllKeys.js","webpack:///../../../node_modules/lodash/_baseHasIn.js","webpack:///../../../node_modules/lodash/_baseIsArguments.js","webpack:///../../../node_modules/lodash/_baseIsEqual.js","webpack:///../../../node_modules/lodash/_baseIsEqualDeep.js","webpack:///../../../node_modules/lodash/_baseIsMap.js","webpack:///../../../node_modules/lodash/_baseIsMatch.js","webpack:///../../../node_modules/lodash/_baseIsNative.js","webpack:///../../../node_modules/lodash/_baseIsSet.js","webpack:///../../../node_modules/lodash/_baseIsTypedArray.js","webpack:///../../../node_modules/lodash/_baseIteratee.js","webpack:///../../../node_modules/lodash/_baseKeys.js","webpack:///../../../node_modules/lodash/_baseKeysIn.js","webpack:///../../../node_modules/lodash/_baseMap.js","webpack:///../../../node_modules/lodash/_baseMatches.js","webpack:///../../../node_modules/lodash/_baseMatchesProperty.js","webpack:///../../../node_modules/lodash/_baseProperty.js","webpack:///../../../node_modules/lodash/_basePropertyDeep.js","webpack:///../../../node_modules/lodash/_baseTimes.js","webpack:///../../../node_modules/lodash/_baseToString.js","webpack:///../../../node_modules/lodash/_baseUnary.js","webpack:///../../../node_modules/lodash/_cacheHas.js","webpack:///../../../node_modules/lodash/_castFunction.js","webpack:///../../../node_modules/lodash/_castPath.js","webpack:///../../../node_modules/lodash/_cloneArrayBuffer.js","webpack:///../../../node_modules/lodash/_cloneBuffer.js","webpack:///../../../node_modules/lodash/_cloneDataView.js","webpack:///../../../node_modules/lodash/_cloneRegExp.js","webpack:///../../../node_modules/lodash/_cloneSymbol.js","webpack:///../../../node_modules/lodash/_cloneTypedArray.js","webpack:///../../../node_modules/lodash/_copyArray.js","webpack:///../../../node_modules/lodash/_copyObject.js","webpack:///../../../node_modules/lodash/_copySymbols.js","webpack:///../../../node_modules/lodash/_copySymbolsIn.js","webpack:///../../../node_modules/lodash/_coreJsData.js","webpack:///../../../node_modules/lodash/_createBaseEach.js","webpack:///../../../node_modules/lodash/_createBaseFor.js","webpack:///../../../node_modules/lodash/_defineProperty.js","webpack:///../../../node_modules/lodash/_equalArrays.js","webpack:///../../../node_modules/lodash/_equalByTag.js","webpack:///../../../node_modules/lodash/_equalObjects.js","webpack:///../../../node_modules/lodash/_getAllKeys.js","webpack:///../../../node_modules/lodash/_getAllKeysIn.js","webpack:///../../../node_modules/lodash/_getMapData.js","webpack:///../../../node_modules/lodash/_getMatchData.js","webpack:///../../../node_modules/lodash/_getNative.js","webpack:///../../../node_modules/lodash/_getPrototype.js","webpack:///../../../node_modules/lodash/_getSymbols.js","webpack:///../../../node_modules/lodash/_getSymbolsIn.js","webpack:///../../../node_modules/lodash/_getTag.js","webpack:///../../../node_modules/lodash/_getValue.js","webpack:///../../../node_modules/lodash/_hasPath.js","webpack:///../../../node_modules/lodash/_hashClear.js","webpack:///../../../node_modules/lodash/_hashDelete.js","webpack:///../../../node_modules/lodash/_hashGet.js","webpack:///../../../node_modules/lodash/_hashHas.js","webpack:///../../../node_modules/lodash/_hashSet.js","webpack:///../../../node_modules/lodash/_initCloneArray.js","webpack:///../../../node_modules/lodash/_initCloneByTag.js","webpack:///../../../node_modules/lodash/_initCloneObject.js","webpack:///../../../node_modules/lodash/_isIndex.js","webpack:///../../../node_modules/lodash/_isKey.js","webpack:///../../../node_modules/lodash/_isKeyable.js","webpack:///../../../node_modules/lodash/_isMasked.js","webpack:///../../../node_modules/lodash/_isPrototype.js","webpack:///../../../node_modules/lodash/_isStrictComparable.js","webpack:///../../../node_modules/lodash/_listCacheClear.js","webpack:///../../../node_modules/lodash/_listCacheDelete.js","webpack:///../../../node_modules/lodash/_listCacheGet.js","webpack:///../../../node_modules/lodash/_listCacheHas.js","webpack:///../../../node_modules/lodash/_listCacheSet.js","webpack:///../../../node_modules/lodash/_mapCacheClear.js","webpack:///../../../node_modules/lodash/_mapCacheDelete.js","webpack:///../../../node_modules/lodash/_mapCacheGet.js","webpack:///../../../node_modules/lodash/_mapCacheHas.js","webpack:///../../../node_modules/lodash/_mapCacheSet.js","webpack:///../../../node_modules/lodash/_mapToArray.js","webpack:///../../../node_modules/lodash/_matchesStrictComparable.js","webpack:///../../../node_modules/lodash/_memoizeCapped.js","webpack:///../../../node_modules/lodash/_nativeCreate.js","webpack:///../../../node_modules/lodash/_nativeKeys.js","webpack:///../../../node_modules/lodash/_nativeKeysIn.js","webpack:///../../../node_modules/lodash/_nodeUtil.js","webpack:///../../../node_modules/lodash/_overArg.js","webpack:///../../../node_modules/lodash/_setCacheAdd.js","webpack:///../../../node_modules/lodash/_setCacheHas.js","webpack:///../../../node_modules/lodash/_setToArray.js","webpack:///../../../node_modules/lodash/_stackClear.js","webpack:///../../../node_modules/lodash/_stackDelete.js","webpack:///../../../node_modules/lodash/_stackGet.js","webpack:///../../../node_modules/lodash/_stackHas.js","webpack:///../../../node_modules/lodash/_stackSet.js","webpack:///../../../node_modules/lodash/_stringToPath.js","webpack:///../../../node_modules/lodash/_toKey.js","webpack:///../../../node_modules/lodash/_toSource.js","webpack:///../../../node_modules/lodash/cloneDeep.js","webpack:///../../../node_modules/lodash/eq.js","webpack:///../../../node_modules/lodash/forOwn.js","webpack:///../../../node_modules/lodash/get.js","webpack:///../../../node_modules/lodash/hasIn.js","webpack:///../../../node_modules/lodash/identity.js","webpack:///../../../node_modules/lodash/isArguments.js","webpack:///../../../node_modules/lodash/isArray.js","webpack:///../../../node_modules/lodash/isArrayLike.js","webpack:///../../../node_modules/lodash/isBuffer.js","webpack:///../../../node_modules/lodash/isFunction.js","webpack:///../../../node_modules/lodash/isLength.js","webpack:///../../../node_modules/lodash/isMap.js","webpack:///../../../node_modules/lodash/isPlainObject.js","webpack:///../../../node_modules/lodash/isSet.js","webpack:///../../../node_modules/lodash/isString.js","webpack:///../../../node_modules/lodash/isTypedArray.js","webpack:///../../../node_modules/lodash/keys.js","webpack:///../../../node_modules/lodash/keysIn.js","webpack:///../../../node_modules/lodash/map.js","webpack:///../../../node_modules/lodash/memoize.js","webpack:///../../../node_modules/lodash/property.js","webpack:///../../../node_modules/lodash/stubArray.js","webpack:///../../../node_modules/lodash/stubFalse.js","webpack:///../../../node_modules/lodash/toString.js","webpack:///../../../node_modules/react-color/es/helpers/checkboard.js","webpack:///../../../node_modules/react-color/es/components/common/Checkboard.js","webpack:///../../../node_modules/react-color/es/components/common/Alpha.js","webpack:///../../../node_modules/react-color/es/helpers/alpha.js","webpack:///../../../node_modules/react-color/es/components/common/EditableInput.js","webpack:///../../../node_modules/react-color/es/helpers/hue.js","webpack:///../../../node_modules/react-color/es/components/common/Hue.js","webpack:///../../../node_modules/lodash-es/_assignMergeValue.js","webpack:///../../../node_modules/lodash-es/_baseFor.js","webpack:///../../../node_modules/lodash-es/_createBaseFor.js","webpack:///../../../node_modules/lodash-es/isArrayLikeObject.js","webpack:///../../../node_modules/lodash-es/_safeGet.js","webpack:///../../../node_modules/lodash-es/toPlainObject.js","webpack:///../../../node_modules/lodash-es/_baseMergeDeep.js","webpack:///../../../node_modules/lodash-es/_baseMerge.js","webpack:///../../../node_modules/lodash-es/identity.js","webpack:///../../../node_modules/lodash-es/_apply.js","webpack:///../../../node_modules/lodash-es/_overRest.js","webpack:///../../../node_modules/lodash-es/constant.js","webpack:///../../../node_modules/lodash-es/_baseSetToString.js","webpack:///../../../node_modules/lodash-es/_shortOut.js","webpack:///../../../node_modules/lodash-es/_setToString.js","webpack:///../../../node_modules/lodash-es/_baseRest.js","webpack:///../../../node_modules/lodash-es/_isIterateeCall.js","webpack:///../../../node_modules/lodash-es/merge.js","webpack:///../../../node_modules/lodash-es/_createAssigner.js","webpack:///../../../node_modules/react-color/es/components/common/Raised.js","webpack:///../../../node_modules/lodash-es/now.js","webpack:///../../../node_modules/lodash-es/_trimmedEndIndex.js","webpack:///../../../node_modules/lodash-es/_baseTrim.js","webpack:///../../../node_modules/lodash-es/toNumber.js","webpack:///../../../node_modules/lodash-es/debounce.js","webpack:///../../../node_modules/lodash-es/throttle.js","webpack:///../../../node_modules/react-color/es/helpers/saturation.js","webpack:///../../../node_modules/react-color/es/components/common/Saturation.js","webpack:///../../../node_modules/lodash-es/_baseEach.js","webpack:///../../../node_modules/lodash-es/_createBaseEach.js","webpack:///../../../node_modules/lodash-es/_baseForOwn.js","webpack:///../../../node_modules/lodash-es/_castFunction.js","webpack:///../../../node_modules/lodash-es/forEach.js","webpack:///../../../node_modules/tinycolor2/esm/tinycolor.js","webpack:///../../../node_modules/react-color/es/helpers/color.js","webpack:///../../../node_modules/react-color/es/components/common/ColorWrap.js","webpack:///../../../node_modules/react-color/es/helpers/interaction.js","webpack:///../../../node_modules/react-color/es/components/common/Swatch.js","webpack:///../../../node_modules/react-color/es/components/alpha/AlphaPointer.js","webpack:///../../../node_modules/react-color/es/components/alpha/Alpha.js","webpack:///../../../node_modules/lodash-es/_setCacheAdd.js","webpack:///../../../node_modules/lodash-es/_setCacheHas.js","webpack:///../../../node_modules/lodash-es/_SetCache.js","webpack:///../../../node_modules/lodash-es/_arraySome.js","webpack:///../../../node_modules/lodash-es/_cacheHas.js","webpack:///../../../node_modules/lodash-es/_equalArrays.js","webpack:///../../../node_modules/lodash-es/_mapToArray.js","webpack:///../../../node_modules/lodash-es/_setToArray.js","webpack:///../../../node_modules/lodash-es/_equalByTag.js","webpack:///../../../node_modules/lodash-es/_equalObjects.js","webpack:///../../../node_modules/lodash-es/_baseIsEqualDeep.js","webpack:///../../../node_modules/lodash-es/_baseIsEqual.js","webpack:///../../../node_modules/lodash-es/_baseIsMatch.js","webpack:///../../../node_modules/lodash-es/_isStrictComparable.js","webpack:///../../../node_modules/lodash-es/_getMatchData.js","webpack:///../../../node_modules/lodash-es/_matchesStrictComparable.js","webpack:///../../../node_modules/lodash-es/_baseMatches.js","webpack:///../../../node_modules/lodash-es/_isKey.js","webpack:///../../../node_modules/lodash-es/_castPath.js","webpack:///../../../node_modules/lodash-es/_baseGet.js","webpack:///../../../node_modules/lodash-es/get.js","webpack:///../../../node_modules/lodash-es/_baseHasIn.js","webpack:///../../../node_modules/lodash-es/_hasPath.js","webpack:///../../../node_modules/lodash-es/hasIn.js","webpack:///../../../node_modules/lodash-es/_baseMatchesProperty.js","webpack:///../../../node_modules/lodash-es/_baseProperty.js","webpack:///../../../node_modules/lodash-es/_basePropertyDeep.js","webpack:///../../../node_modules/lodash-es/property.js","webpack:///../../../node_modules/lodash-es/_baseIteratee.js","webpack:///../../../node_modules/lodash-es/_baseMap.js","webpack:///../../../node_modules/lodash-es/map.js","webpack:///../../../node_modules/react-color/es/components/block/BlockSwatches.js","webpack:///../../../node_modules/react-color/es/components/block/Block.js","webpack:///../../../node_modules/material-colors/dist/colors.es2015.js","webpack:///../../../node_modules/react-color/es/components/circle/CircleSwatch.js","webpack:///../../../node_modules/react-color/es/components/circle/Circle.js","webpack:///../../../node_modules/lodash-es/isUndefined.js","webpack:///../../../node_modules/react-color/es/components/chrome/ChromeFields.js","webpack:///../../../node_modules/react-color/es/components/chrome/ChromePointer.js","webpack:///../../../node_modules/react-color/es/components/chrome/ChromePointerCircle.js","webpack:///../../../node_modules/react-color/es/components/chrome/Chrome.js","webpack:///../../../node_modules/react-color/es/components/compact/CompactColor.js","webpack:///../../../node_modules/react-color/es/components/compact/CompactFields.js","webpack:///../../../node_modules/react-color/es/components/compact/Compact.js","webpack:///../../../node_modules/react-color/es/components/github/GithubSwatch.js","webpack:///../../../node_modules/react-color/es/components/github/Github.js","webpack:///../../../node_modules/react-color/es/components/hue/HuePointer.js","webpack:///../../../node_modules/react-color/es/components/hue/Hue.js","webpack:///../../../node_modules/react-color/es/components/material/Material.js","webpack:///../../../node_modules/react-color/es/components/photoshop/PhotoshopFields.js","webpack:///../../../node_modules/react-color/es/components/photoshop/PhotoshopPointerCircle.js","webpack:///../../../node_modules/react-color/es/components/photoshop/PhotoshopPointer.js","webpack:///../../../node_modules/react-color/es/components/photoshop/PhotoshopButton.js","webpack:///../../../node_modules/react-color/es/components/photoshop/PhotoshopPreviews.js","webpack:///../../../node_modules/react-color/es/components/photoshop/Photoshop.js","webpack:///../../../node_modules/react-color/es/components/sketch/SketchFields.js","webpack:///../../../node_modules/react-color/es/components/sketch/SketchPresetColors.js","webpack:///../../../node_modules/react-color/es/components/sketch/Sketch.js","webpack:///../../../node_modules/react-color/es/components/slider/SliderSwatch.js","webpack:///../../../node_modules/react-color/es/components/slider/SliderSwatches.js","webpack:///../../../node_modules/react-color/es/components/slider/SliderPointer.js","webpack:///../../../node_modules/react-color/es/components/slider/Slider.js","webpack:///../../../node_modules/react-color/es/components/swatches/SwatchesColor.js","webpack:///../../../node_modules/react-color/es/components/swatches/SwatchesGroup.js","webpack:///../../../node_modules/react-color/es/components/swatches/Swatches.js","webpack:///../../../node_modules/react-color/es/components/twitter/Twitter.js","webpack:///../../../node_modules/react-color/es/components/google/GooglePointerCircle.js","webpack:///../../../node_modules/react-color/es/components/google/GooglePointer.js","webpack:///../../../node_modules/react-color/es/components/google/GoogleFields.js","webpack:///../../../node_modules/react-color/es/components/google/Google.js","webpack:///../../../node_modules/react-window/dist/index.esm.js","webpack:///../../../node_modules/reactcss/lib/autoprefix.js","webpack:///../../../node_modules/reactcss/lib/components/active.js","webpack:///../../../node_modules/reactcss/lib/components/hover.js","webpack:///../../../node_modules/reactcss/lib/flattenNames.js","webpack:///../../../node_modules/reactcss/lib/index.js","webpack:///../../../node_modules/reactcss/lib/loop.js","webpack:///../../../node_modules/reactcss/lib/mergeClasses.js","webpack:///../../../node_modules/use-sync-external-store/cjs/use-sync-external-store-shim.production.min.js","webpack:///../../../node_modules/use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.production.min.js","webpack:///../../../node_modules/use-sync-external-store/shim/index.js","webpack:///../../../node_modules/use-sync-external-store/shim/with-selector.js","webpack:///../node_modules/zustand/esm/vanilla.mjs","webpack:///../node_modules/zustand/esm/index.mjs","webpack:///../node_modules/zustand/esm/middleware.mjs"],"sourcesContent":["/**\r\n * Javascript object that handles dates and compute the time.\r\n *\r\n * @export\r\n * @class FullDateInterface\r\n */\nclass FullDateInterface {\n  /**\r\n   * Creates an instance of FullDateInterface.\r\n   * @param {string} date formatted as yyyy-mm-ddTHH:MM:SS.FFFFFFZ\r\n   * @memberof FullDateInterface\r\n   */\n  constructor(date) {\n    this.fullDate = date;\n  }\n  /**\r\n   * returns time since 1 january 1970\r\n   *\r\n   * @returns {number} time in sec\r\n   * @memberof FullDateInterface\r\n   */\n\n\n  getTimeInSec() {\n    // yyyy-mm-ddTHH:MM:SS.FFFFFFZ\n    const dateString = this.fullDate.substring(0, 10);\n    const timeString = this.fullDate.substring(11, 28); // yyyy-mm-dd\n\n    const yyyy = parseInt(dateString.substring(0, 4), 10);\n    const mm = dateString.length >= 7 ? parseInt(dateString.substring(5, 7), 10) : undefined;\n    const dd = dateString.length >= 10 ? parseInt(dateString.substring(8, 10), 10) : undefined;\n\n    if (isNaN(yyyy) || mm !== undefined && isNaN(mm) || dd !== undefined && isNaN(dd) || yyyy > 3000 || mm && (mm < 1 || mm > 12) || dd && (dd < 1 || dd > 31)) {\n      throw new Error(`invalid date '${dateString}'`);\n    }\n\n    const dateJS = new Date(`${dateString}T00:00:00.000000Z`); // HHMMSS.FFFFFF\n\n    const HH = parseInt(timeString.substring(0, 2), 10);\n    const MM = timeString.length >= 5 ? parseInt(timeString.substring(3, 5), 10) : undefined;\n    const SS = timeString.length >= 8 ? parseInt(timeString.substring(6, 8), 10) : undefined;\n    const fractionalStr = timeString.substring(9, 15);\n    const FFFFFF = fractionalStr ? parseInt(fractionalStr, 10) * Math.pow(10, -fractionalStr.length) : undefined;\n\n    if (isNaN(HH) || MM !== undefined && isNaN(MM) || SS !== undefined && isNaN(SS) || FFFFFF !== undefined && isNaN(FFFFFF) || HH < 0 || HH > 23 || MM && (MM < 0 || MM > 59) || SS && (SS < 0 || SS > 59) || FFFFFF && (FFFFFF < 0 || FFFFFF > 999999)) {\n      throw new Error(`invalid time '${timeString}'`);\n    }\n\n    let timeInSec = dateJS.getTime() / 1000;\n    timeInSec += HH * 3600;\n\n    if (MM !== undefined) {\n      timeInSec += MM * 60;\n    }\n\n    if (SS !== undefined) {\n      timeInSec += SS;\n    }\n\n    if (FFFFFF !== undefined) {\n      timeInSec += FFFFFF;\n    }\n\n    return timeInSec;\n  }\n  /**\r\n   * returns time since 1 january 1970\r\n   *\r\n   * @returns {number} time in microsec\r\n   * @memberof FullDateInterface\r\n   */\n\n\n  getTimeInMicroSec() {\n    const timeInMicroSec = this.getTimeInSec() * 1e6;\n    return timeInMicroSec;\n  }\n\n}\n/**\r\n * Combines two javascript objects containing the date and time information\r\n *\r\n * @export\r\n * @param {DateInterface} date\r\n * @param {TimeInterface} time\r\n * @returns {FullDateInterface}\r\n */\n\nfunction combineDateTime(date, time) {\n  const hours = `${time.hours || '00'}`.padStart(2, '0');\n  const minutes = `${time.minutes || '00'}`.padStart(2, '0');\n  const seconds = `${time.seconds || '00'}`.padStart(2, '0');\n  const month = `${date.month}`.padStart(2, '0');\n  const day = `${date.day}`.padStart(2, '0');\n  const fractionalSeconds = `${time.fractionalSeconds || '000000'}`.padEnd(6, '0');\n  const dateString = `${date.year}-${month}-${day}`;\n  const timeString = `T${hours}:${minutes}:${seconds}.${fractionalSeconds}Z`;\n  const fullDateString = `${dateString}${timeString}`;\n  return new FullDateInterface(fullDateString);\n}\n\n/**\r\n * Check the number of days for a picked month and year\r\n * algorithm based on http://stackoverflow.com/questions/1433030/validate-number-of-days-in-a-given-month\r\n *\r\n * @param {number} m\r\n * @param {number} y\r\n * @returns {number} number of days\r\n */\nfunction daysInMonth(m, y) {\n  // m is 0 indexed: 0-11\n  switch (m) {\n    case 2:\n      return y % 4 === 0 && y % 100 || y % 400 === 0 ? 29 : 28;\n\n    case 9:\n    case 4:\n    case 6:\n    case 11:\n      return 30;\n\n    default:\n      return 31;\n  }\n}\n/**\r\n * Check if the date is valid\r\n *\r\n * @param {number} d\r\n * @param {number} m\r\n * @param {number} y\r\n * @returns {boolean} boolean result\r\n */\n\n\nfunction isValidDate(d, m, y) {\n  // make year is a number\n  if (isNaN(y)) {\n    return false;\n  }\n\n  return m > 0 && m <= 12 && d > 0 && d <= daysInMonth(m, y);\n}\n/**\r\n * Parses a DA formatted string into a Javascript object\r\n * @param {string} date a string in the DA VR format\r\n * @param {boolean} [validate] - true if an exception should be thrown if the date is invalid\r\n * @returns {DateInterface} Javascript object with properties year, month and day or undefined if not present or not 8 bytes long\r\n */\n\n\nfunction parseDA(date) {\n  if (date === undefined || date === null || date.length !== 8 || typeof date !== 'string') {\n    throw new Error(`invalid DA '${date}'`);\n  }\n\n  const yyyy = parseInt(date.substring(0, 4), 10);\n  const mm = parseInt(date.substring(4, 6), 10);\n  const dd = parseInt(date.substring(6, 8), 10);\n\n  if (isValidDate(dd, mm, yyyy) !== true) {\n    throw new Error(`invalid DA '${date}'`);\n  }\n\n  return {\n    year: yyyy,\n    month: mm,\n    day: dd\n  };\n}\n\n/**\r\n * Parses a TM formatted string into a javascript object with properties for hours, minutes, seconds and fractionalSeconds\r\n * @param {string} time - a string in the TM VR format\r\n * @returns {string} javascript object with properties for hours, minutes, seconds and fractionalSeconds or undefined if no element or data.  Missing fields are set to undefined\r\n */\nfunction parseTM(time) {\n  if (time === null || time === undefined || time.length < 2 || typeof time !== 'string') {\n    // must at least have HH\n    throw new Error(`invalid TM '${time}'`);\n  } // 0123456789\n  // HHMMSS.FFFFFF\n\n\n  const hh = parseInt(time.substring(0, 2), 10);\n  const mm = time.length >= 4 ? parseInt(time.substring(2, 4), 10) : undefined;\n  const ss = time.length >= 6 ? parseInt(time.substring(4, 6), 10) : undefined;\n  const fractionalStr = time.length >= 8 ? time.substring(7, 13) : undefined;\n  const ffffff = fractionalStr ? parseInt(fractionalStr, 10) * Math.pow(10, 6 - fractionalStr.length) : undefined;\n\n  if (isNaN(hh) || mm !== undefined && isNaN(mm) || ss !== undefined && isNaN(ss) || ffffff !== undefined && isNaN(ffffff) || hh < 0 || hh > 23 || mm && (mm < 0 || mm > 59) || ss && (ss < 0 || ss > 59) || ffffff && (ffffff < 0 || ffffff > 999999)) {\n    throw new Error(`invalid TM '${time}'`);\n  }\n\n  return {\n    hours: hh,\n    minutes: mm,\n    seconds: ss,\n    fractionalSeconds: ffffff\n  };\n}\n\n/**\r\n * Utility to create a FullDateInterface object given a string formatted as yyyy-mm-ddTHH:MM:SS.FFFFFFZ\r\n *\r\n * @export\r\n * @param {string} dateTime\r\n * @returns {FullDateInterface}\r\n */\n\nfunction dateTimeToFullDateInterface(dateTime) {\n  if (dateTime === undefined || dateTime === null) {\n    throw new Error('dateTimeToFullDateInterface : dateTime not defined.');\n  }\n\n  const date = parseDA(dateTime.substring(0, 8));\n  const time = parseTM(dateTime.substring(8));\n  return combineDateTime(date, time);\n}\n\n/**\r\n * Calculate the scan times\r\n *\r\n * @export\r\n * @param {InstanceMetadataForScanTimes[]} instances\r\n * @returns {FullDateInterface[]}\r\n */\n\nfunction calculateScanTimes(instances) {\n  const {\n    SeriesDate,\n    SeriesTime,\n    GEPrivatePostInjectionDateTime\n  } = instances[0];\n  const results = new Array(instances.length);\n  const seriesDate = parseDA(SeriesDate);\n  const seriesTime = parseTM(SeriesTime);\n  const seriesDateTime = combineDateTime(seriesDate, seriesTime);\n  let earliestAcquisitionDateTime = new FullDateInterface(`3000-01-01T00:00:00.000000Z`);\n  let timeError = earliestAcquisitionDateTime.getTimeInSec();\n  instances.forEach(instance => {\n    const {\n      AcquisitionDate,\n      AcquisitionTime\n    } = instance;\n    const acquisitionDate = parseDA(AcquisitionDate);\n    const acquisitionTime = parseTM(AcquisitionTime);\n    const acquisitionDateTime = combineDateTime(acquisitionDate, acquisitionTime);\n\n    if (earliestAcquisitionDateTime.getTimeInSec() >= timeError) {\n      earliestAcquisitionDateTime = acquisitionDateTime;\n    } else {\n      earliestAcquisitionDateTime = acquisitionDateTime.getTimeInSec() < earliestAcquisitionDateTime.getTimeInSec() ? acquisitionDateTime : earliestAcquisitionDateTime;\n    }\n  });\n\n  if (earliestAcquisitionDateTime.getTimeInSec() >= timeError) {\n    throw new Error('Earliest acquisition time or date could not be parsed.');\n  }\n\n  if (seriesDateTime.getTimeInSec() <= earliestAcquisitionDateTime.getTimeInSec()) {\n    return results.fill(seriesDateTime);\n  } else {\n    if (GEPrivatePostInjectionDateTime) {\n      // GE Private scan\n      return results.fill(dateTimeToFullDateInterface(GEPrivatePostInjectionDateTime));\n    } else {\n      /*const hasValidFrameTimes = instances.every(instance => {\r\n        return (\r\n          instance.FrameReferenceTime &&\r\n          instance.FrameReferenceTime > 0 &&\r\n          instance.ActualFrameDuration &&\r\n          instance.ActualFrameDuration > 0\r\n        );\r\n      });*/\n      // TODO: Temporarily commented out the checks and logic below to\n      // investigate the BQML_AC_DT_lessThan_S_DT_SIEMENS-instances case\n      //if (!hasValidFrameTimes) {\n      return results.fill(earliestAcquisitionDateTime); //}\n\n      /* Siemens PETsyngo\t3.x\tmulti-injection logic\r\n      - backcompute\tfrom\tcenter\t(average\tcount\trate\t)\tof\ttime\twindow\tfor\tbed\tposition\t(frame)\tin\tseries (reliable\tin\tall\tcases)\r\n      - Acquisition\tDate\t(0x0008,0x0022)\tand\tTime\t(0x0008,0x0032) are\tthe\tstart\tof\tthe\tbed\tposition\t(frame)\r\n      - Frame\tReference\tTime\t(0x0054,0x1300) is\tthe\toffset\t(ms)\tfrom\tthe\tscan\tDate\tand\tTime we\twant\tto\tthe\taverage\tcount\trate\ttime\r\n      */\n\n      /*return instances.map(instance => {\r\n        const {\r\n          FrameReferenceTime,\r\n          ActualFrameDuration,\r\n          RadionuclideHalfLife,\r\n          AcquisitionDate,\r\n          AcquisitionTime,\r\n        } = instance;\r\n        // Some of these checks are only here because the compiler is complaining\r\n        // We could potentially use the ! operator instead\r\n        if (!FrameReferenceTime || FrameReferenceTime <= 0) {\r\n          throw new Error(\r\n            `FrameReferenceTime is invalid: ${FrameReferenceTime}`\r\n          );\r\n        }\r\n               if (!ActualFrameDuration || ActualFrameDuration <= 0) {\r\n          throw new Error(\r\n            `ActualFrameDuration is invalid: ${ActualFrameDuration}`\r\n          );\r\n        }\r\n               if (!RadionuclideHalfLife) {\r\n          throw new Error('RadionuclideHalfLife is required');\r\n        }\r\n               if (!AcquisitionDate) {\r\n          throw new Error('AcquisitionDate is required');\r\n        }\r\n               if (!AcquisitionTime) {\r\n          throw new Error('AcquisitionTime is required');\r\n        }\r\n               const acquisitionDate: DateInterface = parseDA(AcquisitionDate);\r\n        const acquisitionTime: TimeInterface = parseTM(AcquisitionTime);\r\n        const acquisitionDateTime: FullDateInterface = combineDateTime(\r\n          acquisitionDate,\r\n          acquisitionTime\r\n        );\r\n               const frameDurationInSec = ActualFrameDuration / 1000;\r\n        const decayConstant = Math.log(2) / RadionuclideHalfLife;\r\n        const decayDuringFrame = decayConstant * frameDurationInSec;\r\n        // TODO: double check this is correctly copied from QIBA pseudocode\r\n        const averageCountRateTimeWithinFrameInSec =\r\n          (1 / decayConstant) *\r\n          Math.log(decayDuringFrame / (1 - Math.exp(-decayConstant)));\r\n        const scanDateTimeAsNumber =\r\n          Number(acquisitionDateTime) -\r\n          FrameReferenceTime / 1000 +\r\n          averageCountRateTimeWithinFrameInSec;\r\n               const scanDate = new Date(scanDateTimeAsNumber);\r\n        console.log('SIEMENS PATH');\r\n        console.log(new Date(scanDateTimeAsNumber));\r\n        return scanDate;\r\n      });*/\n    }\n  }\n}\n\nfunction calculateSUVlbmScalingFactor(inputs) {\n  const {\n    PatientSex,\n    PatientWeight,\n    PatientSize\n  } = inputs;\n  let LBM;\n  const weightSizeFactor = Math.pow(PatientWeight / (PatientSize * 100), 2); // reference: https://www.medicalconnections.co.uk/kb/calculating-suv-from-pet-images/\n\n  if (PatientSex === 'F') {\n    LBM = 1.07 * PatientWeight - 148 * weightSizeFactor;\n  } else if (PatientSex === 'M') {\n    LBM = 1.1 * PatientWeight - 120 * weightSizeFactor;\n  } else {\n    throw new Error(`PatientSex is an invalid value: ${PatientSex}`);\n  }\n\n  return LBM * 1000; // convert in gr\n}\n/**\r\n * From https://link.springer.com/article/10.1007/s00259-014-2961-x\r\n * and https://link.springer.com/article/10.2165/00003088-200544100-00004\r\n * and\r\n * @param inputs\r\n * @returns\r\n */\n\n\nfunction calculateSUVlbmJanmahasatianScalingFactor(inputs) {\n  const {\n    PatientSex,\n    PatientWeight,\n    PatientSize\n  } = inputs;\n  let LBM;\n  const bodyMassIndex = PatientWeight / Math.pow(PatientSize, 2);\n\n  if (PatientSex === 'F') {\n    LBM = 9270 * PatientWeight / (8780 + 244 * bodyMassIndex);\n  } else if (PatientSex === 'M') {\n    LBM = 9270 * PatientWeight / (6680 + 216 * bodyMassIndex);\n  } else {\n    throw new Error(`PatientSex is an invalid value: ${PatientSex}`);\n  }\n\n  return LBM * 1000; // convert in gr\n}\n\nfunction calculateSUVbsaScalingFactor(inputs) {\n  const {\n    PatientWeight,\n    PatientSize\n  } = inputs;\n  let BSA = Math.pow(PatientWeight, 0.425) * Math.pow(PatientSize * 100, 0.725) * 71.84;\n  return BSA;\n}\n\n/**\r\n * Calculate start time\r\n *\r\n * @export\r\n * @param {{\r\n *   RadiopharmaceuticalStartDateTime?: string;\r\n *   RadiopharmaceuticalStartTime?: string;\r\n *   SeriesDate?: string;\r\n * }} input\r\n * @returns {FullDateInterface}\r\n */\n\nfunction calculateStartTime(input) {\n  const {\n    RadiopharmaceuticalStartDateTime,\n    RadiopharmaceuticalStartTime,\n    SeriesDate\n  } = input;\n  let time;\n  let date;\n\n  if (RadiopharmaceuticalStartDateTime) {\n    return dateTimeToFullDateInterface(RadiopharmaceuticalStartDateTime);\n  } else if (RadiopharmaceuticalStartTime && SeriesDate) {\n    // start Date\tis not explicit - assume\tsame as\tSeries Date;\n    // but consider\tspanning midnight\n    // TODO: do we need some logic to check if the scan went over midnight?\n    time = parseTM(RadiopharmaceuticalStartTime);\n    date = parseDA(SeriesDate);\n    return combineDateTime(date, time);\n  }\n\n  throw new Error(`Invalid input: ${input}`);\n}\n\n/**\r\n * The injected dose used to calculate SUV is corrected for the\r\n * decay that occurs between the time of injection and the start of the scan\r\n *\r\n * @param {InstanceMetadata[]} instances\r\n * @returns {number[]}\r\n */\n\nfunction calculateDecayCorrection(instances) {\n  const {\n    RadionuclideTotalDose,\n    RadionuclideHalfLife,\n    RadiopharmaceuticalStartDateTime,\n    RadiopharmaceuticalStartTime,\n    SeriesDate\n  } = instances[0];\n\n  if (RadionuclideTotalDose === undefined || RadionuclideTotalDose === null) {\n    throw new Error('calculateDecayCorrection : RadionuclideTotalDose value not found.');\n  }\n\n  if (RadionuclideHalfLife === undefined || RadionuclideHalfLife === null) {\n    throw new Error('calculateDecayCorrection : RadionuclideHalfLife value not found.');\n  }\n\n  const scanTimes = calculateScanTimes(instances);\n  const startTime = calculateStartTime({\n    RadiopharmaceuticalStartDateTime,\n    RadiopharmaceuticalStartTime,\n    SeriesDate\n  });\n  return instances.map((_, index) => {\n    const scanTime = scanTimes[index];\n    const decayTimeInSec = scanTime.getTimeInSec() - startTime.getTimeInSec();\n\n    if (decayTimeInSec < 0) {\n      throw new Error('Decay time cannot be less than zero');\n    }\n\n    const decayedDose = RadionuclideTotalDose * Math.pow(2, -decayTimeInSec / RadionuclideHalfLife);\n    return 1 / decayedDose;\n  });\n}\n/**\r\n *\r\n * @param a Simple value or array of simple values\r\n * @param b Simple value or array of simple values\r\n * @returns boolean true if the values are equal.\r\n */\n\n\nconst deepEquals = (a, b) => {\n  return a === b || Array.isArray(a) && Array.isArray(b) && a.length === b.length && a.every((val, index) => val === b[index]);\n};\n/**\r\n * Calculate the SUV factor\r\n *\r\n * Note: Rescale Slope / Intercept must still be applied. These must be applied\r\n *       on a per-Frame basis, since some scanners may have different values per Frame.\r\n *\r\n * @export\r\n * @param {InstanceMetadata[]} instances\r\n * @returns {ScalingFactorResult[]}\r\n */\n\n\nfunction calculateSUVScalingFactors(instances) {\n  const {\n    CorrectedImage,\n    Units,\n    PhilipsPETPrivateGroup,\n    PatientWeight,\n    PatientSex,\n    PatientSize\n  } = instances[0];\n\n  if (!CorrectedImage.includes('ATTN') || !CorrectedImage.includes('DECY')) {\n    throw new Error(`CorrectedImage must contain \"ATTN\" and \"DECY\": ${CorrectedImage}`);\n  } // Sanity check that every instance provided has identical\n  // values for series-level metadata. If not, the provided\n  // data is invalid.\n\n\n  const isSingleSeries = instances.every(instance => {\n    return instance.Units === Units && deepEquals(instance.CorrectedImage, CorrectedImage) && instance.PatientWeight === PatientWeight && instance.PatientSex === PatientSex && instance.PatientSize === PatientSize && instance.RadionuclideHalfLife === instances[0].RadionuclideHalfLife && instance.RadionuclideTotalDose === instances[0].RadionuclideTotalDose && instance.DecayCorrection === instances[0].DecayCorrection && instance.SeriesDate === instances[0].SeriesDate && instance.SeriesTime === instances[0].SeriesTime;\n  });\n\n  if (!isSingleSeries) {\n    throw new Error('The set of instances does not appear to come from one Series. Every instance must have identical values for series-level metadata properties');\n  } // Treat null, undefined and zero as a missing PatientWeight.\n\n\n  if (!PatientWeight) {\n    throw new Error('PatientWeight value is missing. It is not possible to calculate the SUV factors');\n  }\n\n  let decayCorrectionArray = new Array(instances.length);\n  decayCorrectionArray = calculateDecayCorrection(instances);\n  let results = new Array(instances.length);\n  const weightInGrams = PatientWeight * 1000;\n\n  if (Units === 'BQML') {\n    results = decayCorrectionArray.map(function (value) {\n      return value * weightInGrams;\n    });\n  } else if (Units === 'CNTS') {\n    const hasValidSUVScaleFactor = instances.every(instance => {\n      var _instance$PhilipsPETP, _instance$PhilipsPETP2, _instance$PhilipsPETP3;\n\n      return instance.PhilipsPETPrivateGroup && ((_instance$PhilipsPETP = instance.PhilipsPETPrivateGroup) === null || _instance$PhilipsPETP === void 0 ? void 0 : _instance$PhilipsPETP.SUVScaleFactor) !== null && ((_instance$PhilipsPETP2 = instance.PhilipsPETPrivateGroup) === null || _instance$PhilipsPETP2 === void 0 ? void 0 : _instance$PhilipsPETP2.SUVScaleFactor) !== undefined && ((_instance$PhilipsPETP3 = instance.PhilipsPETPrivateGroup) === null || _instance$PhilipsPETP3 === void 0 ? void 0 : _instance$PhilipsPETP3.SUVScaleFactor) !== 0;\n    });\n    const hasValidActivityConcentrationScaleFactor = instances.every(instance => {\n      var _instance$PhilipsPETP4, _instance$PhilipsPETP5, _instance$PhilipsPETP6;\n\n      return instance.PhilipsPETPrivateGroup && !((_instance$PhilipsPETP4 = instance.PhilipsPETPrivateGroup) !== null && _instance$PhilipsPETP4 !== void 0 && _instance$PhilipsPETP4.SUVScaleFactor) && ((_instance$PhilipsPETP5 = instance.PhilipsPETPrivateGroup) === null || _instance$PhilipsPETP5 === void 0 ? void 0 : _instance$PhilipsPETP5.ActivityConcentrationScaleFactor) !== undefined && ((_instance$PhilipsPETP6 = instance.PhilipsPETPrivateGroup) === null || _instance$PhilipsPETP6 === void 0 ? void 0 : _instance$PhilipsPETP6.ActivityConcentrationScaleFactor) !== 0;\n    }); //console.log(`hasValidSUVScaleFactor: ${hasValidSUVScaleFactor}`);\n    //console.log(`hasValidActivityConcentrationScaleFactor: ${hasValidActivityConcentrationScaleFactor}`);\n\n    if (hasValidSUVScaleFactor) {\n      results = instances.map( // Added ! to tell Typescript that this can't be undefined, since we are testing it\n      // in the .every loop above.\n      instance => instance.PhilipsPETPrivateGroup.SUVScaleFactor);\n    } else if (hasValidActivityConcentrationScaleFactor) {\n      // if (0x7053,0x1000) not present, but (0x7053,0x1009) is present, then (0x7053,0x1009) * Rescale Slope,\n      // scales pixels to Bq/ml, and proceed as if Units are BQML\n      results = instances.map((instance, index) => {\n        // Added ! to tell Typescript that this can't be undefined, since we are testing it\n        // in the .every loop above.\n        return instance.PhilipsPETPrivateGroup.ActivityConcentrationScaleFactor * decayCorrectionArray[index] * weightInGrams;\n      });\n    } else {\n      throw new Error(`Units are in CNTS, but PhilipsPETPrivateGroup has invalid values: ${JSON.stringify(PhilipsPETPrivateGroup)}`);\n    }\n  } else if (Units === 'GML') {\n    // assumes that GML indicates SUVbw instead of SUVlbm\n    results.fill(1);\n  } else {\n    throw new Error(`Units has an invalid value: ${Units}`);\n  } // get BSA\n\n\n  let suvbsaFactor;\n\n  if (PatientSize === null || PatientSize === undefined) {\n    console.warn('PatientSize value is missing. It is not possible to calculate the SUV bsa factors');\n  } else {\n    const sulInputs = {\n      PatientWeight,\n      PatientSize\n    };\n    suvbsaFactor = calculateSUVbsaScalingFactor(sulInputs);\n  } // get LBM\n\n\n  let suvlbmFactor;\n  let suvlbmJenmaFactor;\n\n  if (PatientSize === null || PatientSize === undefined) {\n    console.warn('PatientSize value is missing. It is not possible to calculate the SUV lbm factors');\n  } else if (PatientSex === null || PatientSex === undefined) {\n    console.warn('PatientSex value is missing. It is not possible to calculate the SUV lbm factors');\n  } else {\n    const suvlbmInputs = {\n      PatientWeight,\n      PatientSex,\n      PatientSize\n    };\n    suvlbmFactor = calculateSUVlbmScalingFactor(suvlbmInputs);\n    suvlbmJenmaFactor = calculateSUVlbmJanmahasatianScalingFactor(suvlbmInputs);\n  }\n\n  return results.map(function (result, index) {\n    const factors = {\n      suvbw: result\n    };\n\n    if (suvbsaFactor) {\n      // multiply for BSA\n      factors.suvbsa = decayCorrectionArray[index] * suvbsaFactor;\n    }\n\n    if (suvlbmFactor) {\n      // multiply for LBM\n      factors.suvlbm = decayCorrectionArray[index] * suvlbmFactor;\n    }\n\n    if (suvlbmJenmaFactor) {\n      factors.suvlbmJanma = decayCorrectionArray[index] * suvlbmJenmaFactor;\n    } // factor formulaes taken from:\n    // https://www.medicalconnections.co.uk/kb/calculating-suv-from-pet-images/\n\n\n    return factors;\n  });\n}\n\nexport { calculateSUVScalingFactors };\n//# sourceMappingURL=calculate-suv.esm.js.map\n","const CORNERSTONE_COLOR_LUT = [\n    [0, 0, 0, 0],\n    [221, 84, 84, 255],\n    [77, 228, 121, 255],\n    [166, 70, 235, 255],\n    [189, 180, 116, 255],\n    [109, 182, 196, 255],\n    [204, 101, 157, 255],\n    [123, 211, 94, 255],\n    [93, 87, 218, 255],\n    [225, 128, 80, 255],\n    [73, 232, 172, 255],\n    [181, 119, 186, 255],\n    [176, 193, 112, 255],\n    [105, 153, 200, 255],\n    [208, 97, 120, 255],\n    [90, 215, 101, 255],\n    [135, 83, 222, 255],\n    [229, 178, 76, 255],\n    [122, 183, 181, 255],\n    [190, 115, 171, 255],\n    [149, 197, 108, 255],\n    [100, 118, 205, 255],\n    [212, 108, 93, 255],\n    [86, 219, 141, 255],\n    [183, 79, 226, 255],\n    [233, 233, 72, 255],\n    [118, 167, 187, 255],\n    [194, 111, 146, 255],\n    [116, 201, 104, 255],\n    [115, 96, 209, 255],\n    [216, 147, 89, 255],\n    [82, 223, 188, 255],\n    [230, 75, 224, 255],\n    [163, 184, 121, 255],\n    [114, 143, 191, 255],\n    [198, 107, 114, 255],\n    [99, 206, 122, 255],\n    [153, 92, 213, 255],\n    [220, 192, 85, 255],\n    [78, 215, 227, 255],\n    [234, 71, 173, 255],\n    [141, 188, 117, 255],\n    [110, 113, 195, 255],\n    [202, 128, 103, 255],\n    [95, 210, 157, 255],\n    [195, 88, 217, 255],\n    [206, 224, 81, 255],\n    [74, 166, 231, 255],\n    [185, 120, 139, 255],\n    [113, 192, 113, 255],\n    [133, 106, 199, 255],\n    [207, 162, 98, 255],\n    [91, 214, 198, 255],\n    [221, 84, 198, 255],\n    [159, 228, 77, 255],\n    [70, 111, 235, 255],\n    [189, 119, 116, 255],\n    [109, 196, 138, 255],\n    [165, 101, 204, 255],\n    [211, 201, 94, 255],\n    [87, 191, 218, 255],\n    [225, 80, 153, 255],\n    [106, 232, 73, 255],\n    [124, 119, 186, 255],\n    [193, 142, 112, 255],\n    [105, 200, 168, 255],\n    [203, 97, 208, 255],\n    [184, 215, 90, 255],\n    [83, 147, 222, 255],\n    [229, 76, 101, 255],\n    [122, 183, 130, 255],\n    [146, 115, 190, 255],\n    [197, 171, 108, 255],\n    [100, 205, 205, 255],\n    [212, 93, 177, 255],\n    [141, 219, 86, 255],\n    [79, 97, 226, 255],\n    [233, 99, 72, 255],\n    [118, 187, 150, 255],\n    [173, 111, 194, 255],\n    [197, 201, 104, 255],\n    [96, 171, 209, 255],\n    [216, 89, 137, 255],\n    [94, 223, 82, 255],\n    [107, 75, 230, 255],\n    [184, 153, 121, 255],\n    [114, 191, 175, 255],\n    [198, 107, 191, 255],\n    [166, 206, 99, 255],\n    [92, 132, 213, 255],\n    [220, 85, 91, 255],\n    [78, 227, 115, 255],\n    [159, 71, 234, 255],\n    [188, 176, 117, 255],\n    [110, 185, 195, 255],\n    [202, 103, 161, 255],\n    [129, 210, 95, 255],\n    [88, 88, 217, 255],\n    [224, 123, 81, 255],\n    [74, 231, 166, 255],\n    [177, 120, 185, 255],\n    [179, 192, 113, 255],\n    [106, 156, 199, 255],\n    [207, 98, 125, 255],\n    [91, 214, 96, 255],\n    [130, 84, 221, 255],\n    [228, 171, 77, 255],\n    [70, 235, 221, 255],\n    [189, 116, 174, 255],\n    [153, 196, 109, 255],\n    [101, 123, 204, 255],\n    [211, 104, 94, 255],\n    [87, 218, 136, 255],\n    [177, 80, 225, 255],\n    [232, 225, 73, 255],\n    [119, 169, 186, 255],\n    [193, 112, 149, 255],\n    [121, 200, 105, 255],\n    [111, 97, 208, 255],\n    [215, 142, 90, 255],\n    [83, 222, 181, 255],\n    [229, 76, 229, 255],\n    [165, 183, 122, 255],\n    [115, 146, 190, 255],\n    [197, 108, 119, 255],\n    [100, 205, 118, 255],\n    [148, 93, 212, 255],\n    [219, 186, 86, 255],\n    [79, 220, 226, 255],\n    [233, 72, 179, 255],\n    [144, 187, 118, 255],\n    [111, 118, 194, 255],\n    [201, 124, 104, 255],\n    [96, 209, 153, 255],\n    [189, 89, 216, 255],\n    [211, 223, 82, 255],\n    [75, 172, 230, 255],\n    [184, 121, 142, 255],\n    [117, 191, 114, 255],\n    [130, 107, 198, 255],\n    [206, 157, 99, 255],\n    [92, 213, 193, 255],\n    [220, 85, 203, 255],\n    [165, 227, 78, 255],\n    [71, 118, 234, 255],\n    [188, 117, 117, 255],\n    [110, 195, 135, 255],\n    [161, 103, 202, 255],\n    [210, 195, 95, 255],\n    [88, 195, 217, 255],\n    [224, 81, 158, 255],\n    [113, 231, 74, 255],\n    [123, 120, 185, 255],\n    [192, 139, 113, 255],\n    [106, 199, 164, 255],\n    [198, 98, 207, 255],\n    [188, 214, 91, 255],\n    [84, 153, 221, 255],\n    [228, 77, 108, 255],\n    [70, 235, 84, 255],\n    [143, 116, 189, 255],\n    [196, 167, 109, 255],\n    [101, 204, 199, 255],\n    [211, 94, 182, 255],\n    [147, 218, 87, 255],\n    [80, 104, 225, 255],\n    [232, 93, 73, 255],\n    [119, 186, 147, 255],\n    [170, 112, 193, 255],\n    [200, 200, 105, 255],\n    [97, 175, 208, 255],\n    [215, 90, 142, 255],\n    [100, 222, 83, 255],\n    [101, 76, 229, 255],\n    [183, 150, 122, 255],\n    [115, 190, 171, 255],\n    [197, 108, 194, 255],\n    [170, 205, 100, 255],\n    [93, 138, 212, 255],\n    [219, 86, 97, 255],\n    [79, 226, 110, 255],\n    [153, 72, 233, 255],\n    [187, 173, 118, 255],\n    [111, 187, 194, 255],\n    [201, 104, 165, 255],\n    [134, 209, 96, 255],\n    [89, 95, 216, 255],\n    [223, 117, 82, 255],\n    [75, 230, 159, 255],\n    [174, 121, 184, 255],\n    [182, 191, 114, 255],\n    [107, 160, 198, 255],\n    [206, 99, 130, 255],\n    [92, 213, 92, 255],\n    [124, 85, 220, 255],\n    [227, 165, 78, 255],\n    [71, 234, 214, 255],\n    [188, 117, 176, 255],\n    [156, 195, 110, 255],\n    [103, 128, 202, 255],\n    [210, 100, 95, 255],\n    [88, 217, 131, 255],\n    [170, 81, 224, 255],\n    [231, 218, 74, 255],\n    [120, 172, 185, 255],\n    [192, 113, 153, 255],\n    [125, 199, 106, 255],\n    [107, 98, 207, 255],\n    [214, 137, 91, 255],\n    [84, 221, 175, 255],\n    [222, 77, 228, 255],\n    [194, 235, 70, 255],\n    [116, 149, 189, 255],\n    [196, 109, 123, 255],\n    [101, 204, 114, 255],\n    [143, 94, 211, 255],\n    [218, 180, 87, 255],\n    [80, 225, 225, 255],\n    [232, 73, 186, 255],\n    [147, 186, 119, 255],\n    [112, 122, 193, 255],\n    [200, 121, 105, 255],\n    [97, 208, 148, 255],\n    [184, 90, 215, 255],\n    [216, 222, 83, 255],\n    [76, 178, 229, 255],\n    [183, 122, 145, 255],\n    [121, 190, 115, 255],\n    [126, 108, 197, 255],\n    [205, 153, 100, 255],\n    [93, 212, 187, 255],\n    [219, 86, 208, 255],\n    [171, 226, 79, 255],\n    [72, 126, 233, 255],\n    [187, 118, 121, 255],\n    [111, 194, 132, 255],\n    [157, 104, 201, 255],\n    [209, 190, 96, 255],\n    [89, 200, 216, 255],\n    [223, 82, 164, 255],\n    [120, 230, 75, 255],\n    [121, 121, 184, 255],\n    [191, 136, 114, 255],\n    [107, 198, 160, 255],\n    [192, 99, 206, 255],\n    [193, 213, 92, 255],\n    [85, 158, 220, 255],\n    [227, 78, 115, 255],\n    [71, 234, 78, 255],\n    [141, 117, 188, 255],\n    [195, 163, 110, 255],\n    [103, 202, 194, 255],\n    [210, 95, 186, 255],\n    [153, 217, 88, 255],\n    [81, 111, 224, 255],\n];\nexport default CORNERSTONE_COLOR_LUT;\n","const DEFINED_CURSORS = Symbol('DefinedCursors');\nconst STANDARD_CURSORS = new Set([\n    'alias',\n    'all-scroll',\n    'auto',\n    'cell',\n    'col-resize',\n    'context-menu',\n    'copy',\n    'crosshair',\n    'default',\n    'e-resize',\n    'ew-resize',\n    'grab',\n    'grabbing',\n    'help',\n    'move',\n    'ne-resize',\n    'nesw-resize',\n    'no-drop',\n    'none',\n    'not-allowed',\n    'n-resize',\n    'ns-resize',\n    'nw-resize',\n    'nwse-resize',\n    'pointer',\n    'progress',\n    'row-resize',\n    'se-resize',\n    's-resize',\n    'sw-resize',\n    'text',\n    'vertical-text',\n    'wait',\n    'w-resize',\n    'zoom-in',\n    'zoom-out',\n]);\nexport default class MouseCursor {\n    constructor(name, fallback) {\n        this.name = name + '';\n        this.fallback = fallback;\n    }\n    getName() {\n        return this.name + '';\n    }\n    addFallbackStyleProperty(style) {\n        const { fallback } = this;\n        if (fallback instanceof MouseCursor) {\n            return `${style}, ${fallback.getStyleProperty()}`;\n        }\n        return style + '';\n    }\n    getStyleProperty() {\n        return this.addFallbackStyleProperty(this.name) + '';\n    }\n    static getDefinedCursor(name) {\n        const definedCursors = getDefinedCursors(MouseCursor, DEFINED_CURSORS);\n        let mouseCursor = definedCursors.get(name);\n        if (mouseCursor instanceof MouseCursor) {\n            return mouseCursor;\n        }\n        if (STANDARD_CURSORS.has(name)) {\n            mouseCursor = new MouseCursor(name);\n            definedCursors.set(name, mouseCursor);\n            return mouseCursor;\n        }\n    }\n    static setDefinedCursor(name, cursor) {\n        if (cursor instanceof MouseCursor) {\n            const definedCursors = getDefinedCursors(MouseCursor, DEFINED_CURSORS);\n            definedCursors.set(name, cursor);\n            return true;\n        }\n        return false;\n    }\n}\nfunction getDefinedCursors(context, symbol) {\n    let definedCursors = context[symbol];\n    if (!(definedCursors instanceof Map)) {\n        definedCursors = new Map();\n        Object.defineProperty(context, symbol, { value: definedCursors });\n    }\n    return definedCursors;\n}\nconst standardCursorNames = STANDARD_CURSORS.values();\nexport { standardCursorNames };\n","import MouseCursor from './MouseCursor';\nconst ELEMENT_CURSORS_MAP = Symbol('ElementCursorsMap');\nfunction initElementCursor(element, cursor) {\n    _getElementCursors(element)[0] = cursor;\n    _setElementCursor(element, cursor);\n}\nfunction _setElementCursor(element, cursor) {\n    const cursors = _getElementCursors(element);\n    cursors[1] = cursors[0];\n    cursors[0] = cursor;\n    element.style.cursor = (cursor instanceof MouseCursor\n        ? cursor\n        : MouseCursor.getDefinedCursor('auto')).getStyleProperty();\n}\nfunction resetElementCursor(element) {\n    _setElementCursor(element, _getElementCursors(element)[1]);\n}\nfunction hideElementCursor(element) {\n    _setElementCursor(element, MouseCursor.getDefinedCursor('none'));\n}\nfunction _getElementCursors(element) {\n    let map = _getElementCursors[ELEMENT_CURSORS_MAP];\n    if (!(map instanceof WeakMap)) {\n        map = new WeakMap();\n        Object.defineProperty(_getElementCursors, ELEMENT_CURSORS_MAP, {\n            value: map,\n        });\n    }\n    let cursors = map.get(element);\n    if (!cursors) {\n        cursors = [null, null];\n        map.set(element, cursors);\n    }\n    return cursors;\n}\nexport { initElementCursor, resetElementCursor, hideElementCursor, _setElementCursor as setElementCursor, };\n","import { utilities } from '@cornerstonejs/core';\nimport MouseCursor from './MouseCursor';\nconst DEFAULT_NAME = 'image-cursor';\nexport default class ImageMouseCursor extends MouseCursor {\n    constructor(url, x, y, name, fallback) {\n        super(name || ImageMouseCursor.getUniqueInstanceName(DEFAULT_NAME), fallback);\n        this.url = url;\n        this.x = Number(x) || 0;\n        this.y = Number(y) || 0;\n    }\n    getStyleProperty() {\n        const { url, x, y } = this;\n        let style = `url('${url}')`;\n        if (x >= 0 && y >= 0 && (x > 0 || y > 0)) {\n            style += ` ${x} ${y}`;\n        }\n        return this.addFallbackStyleProperty(style);\n    }\n    static getUniqueInstanceName(prefix) {\n        return `${prefix}-${utilities.getRuntimeId(ImageMouseCursor)}`;\n    }\n}\n","const BASE = {\n    iconContent: '',\n    iconSize: 16,\n    viewBox: {\n        x: 16,\n        y: 16,\n    },\n    mousePoint: {\n        x: 8,\n        y: 8,\n    },\n    mousePointerGroupString: `\n    <path stroke=\"{{color}}\" d=\"M8 16L8 0\"></path>\n    <path stroke=\"{{color}}\" d=\"M16 8L0 8\"></path>\n  `,\n};\nconst SEGMENTATION_CURSOR_BOUNDARIES = {\n    x: 127,\n    y: 60,\n};\nconst MINUS_RECT = `\n<rect fill=\"{{color}}\" x=\"80.19\" y=\"25.03\" width=\"47.14\" height=\"15.85\"/>\n`;\nconst PLUS_RECT = `\n<rect fill=\"{{color}}\" x=\"80.19\" y=\"25.03\" width=\"47.14\" height=\"15.85\"/>\n<rect fill=\"{{color}}\" x=\"95.84\" y=\"9.38\" width=\"15.85\" height=\"47.14\"/>\n`;\nconst SCISSOR_ICON = `<path fill=\"{{color}}\" d=\"M82.89,10a12.09,12.09,0,0,0-16.8-2.5l-27.5,20.4-8.5-6.3a2.93,2.93,0,0,1-1.1-3,14.66,14.66,0,0,0,.1-6.6,14.08,14.08,0,1,0-6.5,15.2,2.87,2.87,0,0,1,3.2.2l8.2,6.1-8.2,6.1a2.87,2.87,0,0,1-3.2.2,14.16,14.16,0,1,0,6.7,14.4,14,14,0,0,0-.3-5.8,2.93,2.93,0,0,1,1.1-3l8.5-6.3,27.5,20.4A11.91,11.91,0,0,0,82.89,57l-31.7-23.5ZM15.29,21a5.9,5.9,0,1,1,5.9-5.9A5.91,5.91,0,0,1,15.29,21Zm0,36.8a5.9,5.9,0,1,1,5.9-5.9A5.91,5.91,0,0,1,15.29,57.77Zm28.3-21.5a2.8,2.8,0,1,1,2.8-2.8A2.8,2.8,0,0,1,43.59,36.27Z\" transform=\"translate(-1.17 -0.96)\"/>`;\nconst RECTANGLE_ICON = `<path fill=\"{{color}}\" d=\"M8.86,2.25V66.08H72.69V2.25H8.86ZM65.28,58.67h-49v-49h49v49Z\" transform=\"translate(-8.86 -2.25)\"/>`;\nconst CIRCLE_ICON = `<path fill=\"{{color}}\" d=\"M40.77,2.25A31.92,31.92,0,1,0,72.69,34.16,31.92,31.92,0,0,0,40.77,2.25Zm0,57.63A25.71,25.71,0,1,1,66.48,34.16,25.71,25.71,0,0,1,40.77,59.87Z\" transform=\"translate(-8.86 -2.25)\"/>`;\nconst CursorSVG = {\n    Angle: extend(BASE, {\n        name: 'Angle',\n        iconContent: `<path fill=\"{{color}}\" d=\"M1203 544q0 13-10 23l-393 393 393 393q10 10 10 23t-10 23l-50\n    50q-10 10-23 10t-23-10l-466-466q-10-10-10-23t10-23l466-466q10-10 23-10t23\n    10l50 50q10 10 10 23z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    ArrowAnnotate: extend(BASE, {\n        name: 'ArrowAnnotate',\n        iconContent: `<g id=\"arrowAnnotate-group\" fill=\"none\" stroke-width=\"1\" stroke=\"{{color}}\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n    <path id=\"arrowAnnotate-arrow\" d=\"M23,7 l-15,15 M7,17 l0,6 6,0\" stroke-width=\"2\" />\n  </g>`,\n        viewBox: {\n            x: 24,\n            y: 24,\n        },\n    }),\n    Bidirectional: extend(BASE, {\n        name: 'Bidirectional',\n        iconContent: `<g fill=\"{{color}}\" stroke-width=\"3\" stroke=\"{{color}}\">\n    <path d=\"M27.63 3.21L3.12 28.81\"></path>\n    <path d=\"M27.63 15.75L15.27 4.43\"></path>\n    <path d=\"M16.5 4.28C16.5 4.96 15.95 5.51 15.27 5.51C14.59 5.51 14.03 4.96 14.03 4.28C14.03 3.59 14.59 3.04 15.27 3.04C15.95 3.04 16.5 3.59 16.5 4.28Z\" ></path>\n    <path d=\"M28.87 3.19C28.87 3.87 28.31 4.43 27.63 4.43C26.95 4.43 26.4 3.87 26.4 3.19C26.4 2.51 26.95 1.95 27.63 1.95C28.31 1.95 28.87 2.51 28.87 3.19Z\"></path>\n    <path d=\"M28.87 15.75C28.87 16.43 28.31 16.99 27.63 16.99C26.95 16.99 26.4 16.43 26.4 15.75C26.4 15.07 26.95 14.51 27.63 14.51C28.31 14.51 28.87 15.07 28.87 15.75Z\"></path>\n    <path d=\"M4.73 28.44C4.73 29.12 4.17 29.68 3.49 29.68C2.81 29.68 2.25 29.12 2.25 28.44C2.25 27.76 2.81 27.2 3.49 27.2C4.17 27.2 4.73 27.76 4.73 28.44Z\"></path>\n  </g>`,\n        viewBox: {\n            x: 48,\n            y: 48,\n        },\n    }),\n    CobbAngle: extend(BASE, {\n        name: 'CobbAngle',\n        iconContent: `<g stroke=\"{{color}}\" stroke-width=\"3\">\n    <path d=\"M28.59 2.34L3.82 12.32\"></path>\n    <path d=\"M28.59 29.66L3.82 19.68\"></path>\n    <path stroke-dasharray=\"2\" fill-opacity=\"0\" d=\"M12.37\n      23.06C12.67 22.36 12.85 21.93 12.92 21.76C14.6 17.8 14.68 13.35 13.15\n      9.33C13.11 9.24 13.02 9 12.88 8.63\">\n    </path>\n  </g>`,\n        viewBox: {\n            x: 32,\n            y: 32,\n        },\n    }),\n    CircleROI: extend(BASE, {\n        name: 'CircleROI',\n        iconContent: `<circle stroke=\"{{color}}\" fill=\"none\" stroke-width=\"3\" cx=\"16\" cy=\"16\" r=\"14\" />`,\n        viewBox: {\n            x: 32,\n            y: 32,\n        },\n    }),\n    EllipticalROI: extend(BASE, {\n        name: 'EllipticalROI',\n        iconContent: `<path stroke=\"{{color}}\" fill=\"none\" stroke-width=\"3\" d=\"M30.74 15.76C30.74 20.99 24.14 25.23 16\n    25.23C7.86 25.23 1.26 20.99 1.26 15.76C1.26 10.54 7.86 6.3 16 6.3C24.14\n    6.3 30.74 10.54 30.74 15.76Z\" />`,\n        viewBox: {\n            x: 32,\n            y: 32,\n        },\n    }),\n    FreehandROI: extend(BASE, {\n        name: 'FreehandROI',\n        iconContent: `<g fill=\"{{color}}\" stroke=\"{{color}}\" stroke-width=\"2\">\n    <ellipse ry=\"1\" rx=\"1\" id=\"svg_3\" cy=\"4.240343\" cx=\"14.306499\"/>\n    <line id=\"svg_4\" y2=\"3.58462\" x2=\"12.242186\" y1=\"3.997482\" x1=\"13.432202\"/>\n    <line id=\"svg_5\" y2=\"3.268901\" x2=\"10.857882\" y1=\"3.608906\" x1=\"12.387902\"/>\n    <line id=\"svg_6\" y2=\"3.147471\" x2=\"9.740724\" y1=\"3.293187\" x1=\"10.955026\"/>\n    <line id=\"svg_7\" y2=\"3.147471\" x2=\"8.089274\" y1=\"3.196043\" x1=\"9.983585\"/>\n    <line id=\"svg_8\" y2=\"3.268901\" x2=\"6.874972\" y1=\"3.123185\" x1=\"8.307848\"/>\n    <line id=\"svg_9\" y2=\"3.657478\" x2=\"5.587812\" y1=\"3.220329\" x1=\"7.020688\"/>\n    <line id=\"svg_10\" y2=\"4.046054\" x2=\"4.737801\" y1=\"3.560334\" x1=\"5.854959\"/>\n    <line id=\"svg_11\" y2=\"4.337487\" x2=\"4.300652\" y1=\"3.997482\" x1=\"4.834945\"/>\n    <line id=\"svg_12\" y2=\"4.726063\" x2=\"3.88779\" y1=\"4.191771\" x1=\"4.470655\"/>\n    <line id=\"svg_15\" y2=\"5.3575\" x2=\"3.377783\" y1=\"4.604633\" x1=\"3.960648\"/>\n    <line id=\"svg_16\" y2=\"6.183226\" x2=\"2.916348\" y1=\"5.138926\" x1=\"3.547785\"/>\n    <line id=\"svg_17\" y2=\"6.960379\" x2=\"2.770632\" y1=\"5.867507\" x1=\"3.037779\"/>\n    <line id=\"svg_18\" y2=\"7.713246\" x2=\"2.673488\" y1=\"6.741804\" x1=\"2.819204\"/>\n    <line id=\"svg_19\" y2=\"8.684687\" x2=\"2.697774\" y1=\"7.616102\" x1=\"2.673488\"/>\n    <line id=\"svg_20\" y2=\"9.753273\" x2=\"2.892062\" y1=\"8.611829\" x1=\"2.697774\"/>\n    <line id=\"svg_21\" y2=\"10.724714\" x2=\"3.134923\" y1=\"9.534698\" x1=\"2.84349\"/>\n    <line id=\"svg_23\" y2=\"11.647583\" x2=\"3.596357\" y1=\"10.578998\" x1=\"3.086351\"/>\n    <line id=\"svg_25\" y2=\"12.521881\" x2=\"4.276366\" y1=\"11.501867\" x1=\"3.499213\"/>\n    <line id=\"svg_26\" y2=\"13.930471\" x2=\"5.830673\" y1=\"12.376165\" x1=\"4.13065\"/>\n    <line id=\"svg_28\" y2=\"14.707624\" x2=\"7.263549\" y1=\"13.881899\" x1=\"5.733528\"/>\n    <line id=\"svg_29\" y2=\"15.339061\" x2=\"8.963571\" y1=\"14.61048\" x1=\"7.06926\"/>\n    <line id=\"svg_30\" y2=\"15.581921\" x2=\"10.882168\" y1=\"15.314775\" x1=\"8.817855\"/>\n    <line id=\"svg_31\" y2=\"15.460491\" x2=\"12.023612\" y1=\"15.581921\" x1=\"10.785024\"/>\n    <line id=\"svg_33\" y2=\"15.120487\" x2=\"13.092197\" y1=\"15.484777\" x1=\"11.877895\"/>\n    <line id=\"svg_34\" y2=\"14.586194\" x2=\"13.86935\" y1=\"15.217631\" x1=\"12.897909\"/>\n    <line id=\"svg_35\" y2=\"13.833327\" x2=\"14.597931\" y1=\"14.756196\" x1=\"13.699348\"/>\n    <line id=\"svg_37\" y2=\"12.716169\" x2=\"15.180796\" y1=\"13.881899\" x1=\"14.549359\"/>\n    <line id=\"svg_39\" y2=\"11.429009\" x2=\"15.520801\" y1=\"12.813313\" x1=\"15.15651\"/>\n    <ellipse ry=\"1\" rx=\"1\" id=\"svg_40\" cy=\"10.967574\" cx=\"15.520801\"/>\n  </g>`,\n        viewBox: {\n            x: 18,\n            y: 18,\n        },\n    }),\n    FreehandROISculptor: extend(BASE, {\n        name: 'FreehandROISculptor',\n        iconContent: `<g id=\"icon-freehand-sculpt\" fill=\"none\" stroke-width=\"1.5\" stroke=\"{{color}}\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n    <line id=\"svg_1\" y2=\"2.559367\" x2=\"10.184807\" y1=\"4.467781\" x1=\"8.81711\"/>\n    <line id=\"svg_4\" y2=\"1.493836\" x2=\"11.727442\" y1=\"2.766112\" x1=\"10.089386\"/>\n    <line id=\"svg_7\" y2=\"1.080346\" x2=\"13.047428\" y1=\"1.748291\" x1=\"11.345759\"/>\n    <line id=\"svg_8\" y2=\"1.000829\" x2=\"14.351511\" y1=\"1.112153\" x1=\"12.77707\"/>\n    <line id=\"svg_9\" y2=\"1.350705\" x2=\"15.242104\" y1=\"0.905408\" x1=\"13.969828\"/>\n    <line id=\"svg_10\" y2=\"2.098167\" x2=\"15.862339\" y1=\"1.14396\" x1=\"14.955842\"/>\n    <line id=\"svg_11\" y2=\"3.195505\" x2=\"16.41896\" y1=\"1.939133\" x1=\"15.766918\"/>\n    <line id=\"svg_12\" y2=\"4.292843\" x2=\"16.530284\" y1=\"2.925147\" x1=\"16.387153\"/>\n    <line id=\"svg_16\" y2=\"5.644637\" x2=\"16.196311\" y1=\"3.831643\" x1=\"16.593898\"/>\n    <line id=\"svg_18\" y2=\"7.266789\" x2=\"15.623787\" y1=\"5.19934\" x1=\"16.275829\"/>\n    <line id=\"svg_19\" y2=\"10.813258\" x2=\"14.526449\" y1=\"6.726071\" x1=\"15.766918\"/>\n    <line id=\"svg_20\" y2=\"5.056209\" x2=\"8.085552\" y1=\"4.181519\" x1=\"8.976145\"/>\n    <line id=\"svg_23\" y2=\"5.326568\" x2=\"7.481221\" y1=\"4.78585\" x1=\"8.403621\"/>\n    <line id=\"svg_24\" y2=\"5.565119\" x2=\"6.749662\" y1=\"5.294761\" x1=\"7.624352\"/>\n    <line id=\"svg_25\" y2=\"5.994512\" x2=\"5.429675\" y1=\"5.533312\" x1=\"6.956407\"/>\n    <line id=\"svg_27\" y2=\"6.551133\" x2=\"4.284627\" y1=\"5.962706\" x1=\"5.572807\"/>\n    <line id=\"svg_28\" y2=\"7.584858\" x2=\"3.044158\" y1=\"6.392099\" x1=\"4.427758\"/>\n    <line id=\"svg_29\" y2=\"8.84123\" x2=\"2.185372\" y1=\"7.489437\" x1=\"3.219096\"/>\n    <line id=\"svg_31\" y2=\"10.606513\" x2=\"1.644654\" y1=\"8.602678\" x1=\"2.280792\"/>\n    <line id=\"svg_32\" y2=\"13.214679\" x2=\"1.48562\" y1=\"10.352058\" x1=\"1.724171\"/>\n    <line id=\"svg_33\" y2=\"14.375631\" x2=\"1.676461\" y1=\"12.992031\" x1=\"1.453813\"/>\n    <line id=\"svg_34\" y2=\"15.298031\" x2=\"2.264889\" y1=\"14.152983\" x1=\"1.517427\"/>\n    <line id=\"svg_35\" y2=\"16.172721\" x2=\"3.521261\" y1=\"14.948155\" x1=\"1.915013\"/>\n    <line id=\"svg_36\" y2=\"16.824762\" x2=\"5.207027\" y1=\"15.997783\" x1=\"3.28271\"/>\n    <line id=\"svg_38\" y2=\"17.063314\" x2=\"7.035924\" y1=\"16.745245\" x1=\"4.968475\"/>\n    <line id=\"svg_39\" y2=\"16.888376\" x2=\"9.278311\" y1=\"17.047411\" x1=\"6.733758\"/>\n    <line id=\"svg_40\" y2=\"16.284045\" x2=\"10.661911\" y1=\"16.983797\" x1=\"8.992048\"/>\n    <line id=\"svg_41\" y2=\"15.313934\" x2=\"11.647925\" y1=\"16.395369\" x1=\"10.455166\"/>\n    <line id=\"svg_44\" y2=\"13.898527\" x2=\"12.82478\" y1=\"15.425259\" x1=\"11.504794\"/>\n    <line id=\"svg_45\" y2=\"12.037824\" x2=\"14.144766\" y1=\"14.312017\" x1=\"12.522614\"/>\n    <line id=\"svg_47\" y2=\"10.59061\" x2=\"14.605966\" y1=\"12.228665\" x1=\"13.953925\"/>\n    <ellipse ry=\"1\" rx=\"1\" id=\"svg_48\" cy=\"3.982726\" cx=\"13.460918\"/>\n  </g>`,\n        viewBox: {\n            x: 18,\n            y: 18,\n        },\n    }),\n    Length: extend(BASE, {\n        name: 'Length',\n        iconContent: `<g id=\"length-group\" fill=\"none\" stroke-width=\"1\" stroke=\"{{color}}\" stroke-linecap=\"round\" stroke-linejoin=\"round\">\n    <path id=\"length-dashes\" d=\"m22.5,6 -16.5,16.5\" stroke-width=\"3\" stroke-dasharray=\"0.6666,5\" />\n  </g>`,\n        viewBox: {\n            x: 24,\n            y: 24,\n        },\n    }),\n    Height: extend(BASE, {\n        name: 'Height',\n        iconContent: `<path d=\"m 6 22 l 8.5 0 v -16 h 8\" stroke-width=\"3\" fill=\"none\" stroke=\"{{color}}\" />`,\n        viewBox: {\n            x: 24,\n            y: 24,\n        },\n    }),\n    Probe: extend(BASE, {\n        name: 'Probe',\n        iconContent: `<path fill=\"{{color}}\" d=\"M1152 896q0 106-75 181t-181 75-181-75-75-181 75-181 181-75 181 75\n    75 181zm-256-544q-148 0-273 73t-198 198-73 273 73 273 198 198 273 73 273-73\n    198-198 73-273-73-273-198-198-273-73zm768 544q0 209-103 385.5t-279.5\n    279.5-385.5 103-385.5-103-279.5-279.5-103-385.5 103-385.5 279.5-279.5\n    385.5-103 385.5 103 279.5 279.5 103 385.5z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    RectangleROI: extend(BASE, {\n        name: 'RectangleROI',\n        iconContent: `<path fill=\"{{color}}\" d=\"M1312 256h-832q-66 0-113 47t-47 113v832q0 66 47\n    113t113 47h832q66 0 113-47t47-113v-832q0-66-47-113t-113-47zm288 160v832q0\n    119-84.5 203.5t-203.5 84.5h-832q-119 0-203.5-84.5t-84.5-203.5v-832q0-119\n    84.5-203.5t203.5-84.5h832q119 0 203.5 84.5t84.5 203.5z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    TextMarker: extend(BASE, {\n        name: 'TextMarker',\n        iconContent: `<path fill=\"{{color}}\" d=\"M789 559l-170 450q33 0 136.5 2t160.5 2q19 0\n    57-2-87-253-184-452zm-725 1105l2-79q23-7 56-12.5t57-10.5 49.5-14.5 44.5-29\n    31-50.5l237-616 280-724h128q8 14 11 21l205 480q33 78 106 257.5t114 274.5q15\n    34 58 144.5t72 168.5q20 45 35 57 19 15 88 29.5t84 20.5q6 38 6 57 0 5-.5\n    13.5t-.5 12.5q-63 0-190-8t-191-8q-76 0-215 7t-178 8q0-43 4-78l131-28q1 0\n    12.5-2.5t15.5-3.5 14.5-4.5 15-6.5 11-8 9-11\n    2.5-14q0-16-31-96.5t-72-177.5-42-100l-450-2q-26 58-76.5 195.5t-50.5 162.5q0\n    22 14 37.5t43.5 24.5 48.5 13.5 57 8.5 41 4q1 19 1 58 0 9-2 27-58\n    0-174.5-10t-174.5-10q-8 0-26.5 4t-21.5 4q-80 14-188 14z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    Crosshairs: extend(BASE, {\n        name: 'Crosshairs',\n        iconContent: `<path fill=\"{{color}}\" d=\"M1325 1024h-109q-26 0-45-19t-19-45v-128q0-26\n    19-45t45-19h109q-32-108-112.5-188.5t-188.5-112.5v109q0 26-19 45t-45\n    19h-128q-26 0-45-19t-19-45v-109q-108 32-188.5 112.5t-112.5 188.5h109q26\n    0 45 19t19 45v128q0 26-19 45t-45 19h-109q32 108 112.5 188.5t188.5\n    112.5v-109q0-26 19-45t45-19h128q26 0 45 19t19 45v109q108-32\n    188.5-112.5t112.5-188.5zm339-192v128q0 26-19 45t-45 19h-143q-37 161-154.5\n    278.5t-278.5 154.5v143q0 26-19 45t-45 19h-128q-26\n    0-45-19t-19-45v-143q-161-37-278.5-154.5t-154.5-278.5h-143q-26\n    0-45-19t-19-45v-128q0-26 19-45t45-19h143q37-161\n    154.5-278.5t278.5-154.5v-143q0-26 19-45t45-19h128q26 0 45 19t19 45v143q161\n    37 278.5 154.5t154.5 278.5h143q26 0 45 19t19 45z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    Eraser: extend(BASE, {\n        name: 'Eraser',\n        iconContent: `<path transform=\"translate(0,1792) scale(1,-1)\" fill=\"{{color}}\" d=\"M960 1408l336-384h-768l-336 384h768zm1013-1077q15\n    34 9.5 71.5t-30.5 65.5l-896 1024q-38 44-96 44h-768q-38\n    0-69.5-20.5t-47.5-54.5q-15-34-9.5-71.5t30.5-65.5l896-1024q38-44 96-44h768q38\n    0 69.5 20.5t47.5 54.5z\" />`,\n        viewBox: {\n            x: 2048,\n            y: 1792,\n        },\n    }),\n    Magnify: extend(BASE, {\n        name: 'Magnify',\n        iconContent: `<path fill=\"{{color}}\" d=\"M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395\n    312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5\n    0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17\n    0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208\n    32s176 78.7 176 176-78.7 176-176 176z\" />`,\n        viewBox: {\n            x: 512,\n            y: 512,\n        },\n    }),\n    Pan: extend(BASE, {\n        name: 'Pan',\n        iconContent: `<path fill=\"{{color}}\" d=\"M1411 541l-355 355 355 355 144-144q29-31 70-14 39 17\n    39 59v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39 14-69l144-144-355-355-355\n    355 144 144q31 30 14 69-17 40-59 40h-448q-26 0-45-19t-19-45v-448q0-42 40-59\n    39-17 69 14l144 144 355-355-355-355-144 144q-19 19-45 19-12\n    0-24-5-40-17-40-59v-448q0-26 19-45t45-19h448q42 0 59 40 17 39-14 69l-144\n    144 355 355 355-355-144-144q-31-30-14-69 17-40 59-40h448q26 0 45 19t19\n    45v448q0 42-39 59-13 5-25 5-26 0-45-19z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    Rotate: extend(BASE, {\n        name: 'Rotate',\n        iconContent: `<path fill=\"{{color}}\" d=\"M1664 256v448q0 26-19 45t-45 19h-448q-42 0-59-40-17-39\n    14-69l138-138q-148-137-349-137-104 0-198.5 40.5t-163.5 109.5-109.5\n    163.5-40.5 198.5 40.5 198.5 109.5 163.5 163.5 109.5 198.5 40.5q119 0\n    225-52t179-147q7-10 23-12 15 0 25 9l137 138q9 8 9.5 20.5t-7.5 22.5q-109\n    132-264 204.5t-327 72.5q-156 0-298-61t-245-164-164-245-61-298 61-298\n    164-245 245-164 298-61q147 0 284.5 55.5t244.5 156.5l130-129q29-31 70-14\n    39 17 39 59z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    StackScroll: extend(BASE, {\n        name: 'StackScroll',\n        iconContent: `<path fill=\"{{color}}\" d=\"M24 21v2c0 0.547-0.453 1-1 1h-22c-0.547\n    0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1zM24 13v2c0\n    0.547-0.453 1-1 1h-22c-0.547 0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547\n    0 1 0.453 1 1zM24 5v2c0 0.547-0.453 1-1 1h-22c-0.547\n    0-1-0.453-1-1v-2c0-0.547 0.453-1 1-1h22c0.547 0 1 0.453 1 1z\" />`,\n        viewBox: {\n            x: 24,\n            y: 28,\n        },\n    }),\n    WindowLevelRegion: extend(BASE, {\n        name: 'WindowLevelRegion',\n        iconContent: `<path fill=\"{{color}}\" d=\"M1664 416v960q0 119-84.5 203.5t-203.5 84.5h-960q-119\n    0-203.5-84.5t-84.5-203.5v-960q0-119 84.5-203.5t203.5-84.5h960q119 0 203.5\n    84.5t84.5 203.5z\" />`,\n        viewBox: {\n            x: 1792,\n            y: 1792,\n        },\n    }),\n    WindowLevel: extend(BASE, {\n        name: 'WindowLevel',\n        iconContent: `\n    <path fill=\"{{color}}\" d=\"M14.5,3.5 a1 1 0 0 1 -11,11 Z\" stroke=\"none\" opacity=\"0.8\" />\n    <circle cx=\"9\" cy=\"9\" r=\"8\" fill=\"none\" stroke-width=\"2\" stroke=\"{{color}}\" />`,\n        viewBox: {\n            x: 18,\n            y: 18,\n        },\n    }),\n    Zoom: extend(BASE, {\n        name: 'Zoom',\n        iconContent: `\n  <path fill=\"{{color}}\" d=\"M508.5 481.6l-129-129c-2.3-2.3-5.3-3.5-8.5-3.5h-10.3C395\n    312 416 262.5 416 208 416 93.1 322.9 0 208 0S0 93.1 0 208s93.1 208 208 208c54.5\n    0 104-21 141.1-55.2V371c0 3.2 1.3 6.2 3.5 8.5l129 129c4.7 4.7 12.3 4.7 17\n    0l9.9-9.9c4.7-4.7 4.7-12.3 0-17zM208 384c-97.3 0-176-78.7-176-176S110.7 32 208\n    32s176 78.7 176 176-78.7 176-176 176z\" />\n  <path fill=\"{{color}}\" transform=\"scale(0.22,0.22) translate(1400,0)\" d=\"M1216\n    320q0 26-19 45t-45 19h-128v1024h128q26 0 45 19t19 45-19 45l-256 256q-19\n    19-45 19t-45-19l-256-256q-19-19-19-45t19-45 45-19h128v-1024h-128q-26\n    0-45-19t-19-45 19-45l256-256q19-19 45-19t45 19l256 256q19 19 19 45z\" />`,\n        viewBox: {\n            x: 640,\n            y: 512,\n        },\n    }),\n    SegmentationFreeHandEraseInside: extend(BASE, {\n        name: 'SegmentationFreeHandEraseInside',\n        iconContent: `${SCISSOR_ICON} ${MINUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    SegmentationFreeHandFillInside: extend(BASE, {\n        name: 'SegmentationFreeHandFillInside',\n        iconContent: `${SCISSOR_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    SegmentationFreeHandEraseOutside: extend(BASE, {\n        name: 'SegmentationFreeHandEraseOutside',\n        iconContent: `${SCISSOR_ICON} ${MINUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    SegmentationFreeHandFillOutside: extend(BASE, {\n        name: 'SegmentationFreeHandFillOutside',\n        iconContent: `${SCISSOR_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    SegmentationRectangleEraseInside: extend(BASE, {\n        name: 'SegmentationRectangleEraseInside',\n        iconContent: `${RECTANGLE_ICON} ${MINUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    RectangleScissor: extend(BASE, {\n        name: 'RectangleScissor',\n        iconContent: `${RECTANGLE_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    'RectangleScissor.FILL_INSIDE': extend(BASE, {\n        name: 'RectangleScissor.FILL_INSIDE',\n        iconContent: `${RECTANGLE_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    'RectangleScissor.FILL_OUTSIDE': extend(BASE, {\n        name: 'RectangleScissor.FILL_OUTSIDE',\n        iconContent: `${RECTANGLE_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    'RectangleScissor.ERASE_OUTSIDE': extend(BASE, {\n        name: 'RectangleScissor.ERASE_OUTSIDE',\n        iconContent: `${RECTANGLE_ICON} ${MINUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    'RectangleScissor.ERASE_INSIDE': extend(BASE, {\n        name: 'RectangleScissor.ERASE_INSIDE',\n        iconContent: `${RECTANGLE_ICON} ${MINUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    CircleScissor: extend(BASE, {\n        name: 'CircleScissor',\n        iconContent: `${CIRCLE_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    'CircleScissor.FILL_INSIDE': extend(BASE, {\n        name: 'CircleScissor.FILL_INSIDE',\n        iconContent: `${CIRCLE_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    'CircleScissor.ERASE_OUTSIDE': extend(BASE, {\n        name: 'CircleScissor.ERASE_OUTSIDE',\n        iconContent: `${CIRCLE_ICON} ${MINUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n    'CircleScissor.FILL_OUTSIDE': extend(BASE, {\n        name: 'CircleScissor.FILL_OUTSIDE',\n        iconContent: `${CIRCLE_ICON} ${PLUS_RECT}`,\n        viewBox: SEGMENTATION_CURSOR_BOUNDARIES,\n    }),\n};\nfunction extend(base, values) {\n    return Object.assign(Object.create(base), {\n        ...values,\n        name: values.name || base.name,\n    });\n}\nfunction registerCursor(toolName, iconContent, viewBox) {\n    CursorSVG[toolName] = extend(BASE, {\n        iconContent,\n        viewBox,\n    });\n}\nfunction getDefinedSVGCursorDescriptor(name) {\n    return CursorSVG[name];\n}\nconst svgCursorNames = Object.keys(CursorSVG);\nexport { getDefinedSVGCursorDescriptor, registerCursor, svgCursorNames, CursorSVG, };\n","import { ToolModes, AnnotationStyleStates } from '../enums';\nimport ImageMouseCursor from './ImageMouseCursor';\nimport { getDefinedSVGCursorDescriptor } from './SVGCursorDescriptor';\nimport { getStyleProperty } from '../stateManagement/annotation/config/helpers';\nconst PROPERTY = 'color';\nconst STATE = AnnotationStyleStates.Highlighted;\nconst MODE = ToolModes.Active;\nexport default class SVGMouseCursor extends ImageMouseCursor {\n    constructor(url, x, y, name, fallback) {\n        super(url, x, y, name, fallback);\n    }\n    static getDefinedCursor(name, pointer = false, color) {\n        if (!color) {\n            color = getStyleProperty(PROPERTY, {}, STATE, MODE);\n        }\n        const urn = getCursorURN(name, pointer, color);\n        let cursor = super.getDefinedCursor(urn);\n        if (!cursor) {\n            const descriptor = getDefinedSVGCursorDescriptor(name);\n            if (descriptor) {\n                cursor = createSVGMouseCursor(descriptor, urn, pointer, color, super.getDefinedCursor('default'));\n                super.setDefinedCursor(urn, cursor);\n            }\n        }\n        return cursor;\n    }\n}\nfunction format(template, dictionary) {\n    const dict = Object(dictionary);\n    const defined = Object.prototype.hasOwnProperty.bind(dict);\n    return (template + '').replace(/\\{\\{(\\w+)\\}\\}/g, (match, key) => {\n        return defined(key) ? dict[key] + '' : '';\n    });\n}\nfunction getCursorURN(name, pointer, color) {\n    const type = pointer ? 'pointer' : 'cursor';\n    return `${type}:${name}/${color}`;\n}\nfunction createSVGMouseCursor(descriptor, name, pointer, color, fallback) {\n    const { x, y } = descriptor.mousePoint;\n    return new SVGMouseCursor(createSVGIconUrl(descriptor, pointer, { color }), x, y, name, fallback);\n}\nfunction createSVGIconUrl(descriptor, pointer, options) {\n    const blob = createSVGIconBlob(descriptor, pointer, options);\n    const url = URL.createObjectURL(blob);\n    const urn = `${url}#${descriptor.name || 'unknown'}-${pointer ? 'pointer' : 'cursor'}`;\n    return urn;\n}\nfunction createSVGIconBlob(descriptor, pointer, options) {\n    const svgString = (pointer ? createSVGIconWithPointer : createSVGIcon)(descriptor, options);\n    return new Blob([svgString], { type: 'image/svg+xml' });\n}\nfunction createSVGIcon(descriptor, options) {\n    const { iconContent, iconSize, viewBox } = descriptor;\n    const svgString = `\n    <svg data-icon=\"cursor\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\"\n      width=\"${iconSize}\" height=\"${iconSize}\" viewBox=\"0 0\n      ${viewBox.x} ${viewBox.y}\">\n      ${iconContent}\n    </svg>`;\n    return format(svgString, options);\n}\nfunction createSVGIconWithPointer(descriptor, options) {\n    const { iconContent, iconSize, viewBox, mousePointerGroupString } = descriptor;\n    const scale = iconSize / Math.max(viewBox.x, viewBox.y, 1);\n    const svgSize = 16 + iconSize;\n    const svgString = `\n    <svg data-icon=\"cursor\" role=\"img\" xmlns=\"http://www.w3.org/2000/svg\"\n      width=\"${svgSize}\" height=\"${svgSize}\" viewBox=\"0 0 ${svgSize} ${svgSize}\">\n      <g>${mousePointerGroupString}</g>\n      <g transform=\"translate(16, 16) scale(${scale})\">${iconContent}</g>\n    </svg>`;\n    return format(svgString, options);\n}\n","import { setElementCursor } from './elementCursor';\nimport MouseCursor from './MouseCursor';\nimport SVGMouseCursor from './SVGMouseCursor';\nfunction setCursorForElement(element, cursorName) {\n    let cursor = SVGMouseCursor.getDefinedCursor(cursorName, true);\n    if (!cursor) {\n        cursor = MouseCursor.getDefinedCursor(cursorName);\n    }\n    if (!cursor) {\n        console.log(`Cursor ${cursorName} is not defined either as SVG or as a standard cursor.`);\n        cursor = MouseCursor.getDefinedCursor(cursorName);\n    }\n    setElementCursor(element, cursor);\n}\nexport default setCursorForElement;\n","import MouseCursor, { standardCursorNames } from './MouseCursor';\nimport ImageMouseCursor from './ImageMouseCursor';\nimport SVGMouseCursor from './SVGMouseCursor';\nimport * as elementCursor from './elementCursor';\nimport setCursorForElement from './setCursorForElement';\nimport { registerCursor, svgCursorNames, CursorSVG, } from './SVGCursorDescriptor';\nconst CursorNames = [...svgCursorNames, ...standardCursorNames];\nexport { MouseCursor, ImageMouseCursor, SVGMouseCursor, elementCursor, registerCursor, CursorNames, CursorSVG, setCursorForElement, };\n","import { state } from '../store/state';\nimport { getEnabledElement } from '@cornerstonejs/core';\nconst VIEWPORT_ELEMENT = 'viewport-element';\nfunction getSvgDrawingHelper(element) {\n    const enabledElement = getEnabledElement(element);\n    const { viewportId, renderingEngineId } = enabledElement;\n    const canvasHash = `${viewportId}:${renderingEngineId}`;\n    const svgLayerElement = _getSvgLayer(element);\n    Object.keys(state.svgNodeCache[canvasHash]).forEach((cacheKey) => {\n        state.svgNodeCache[canvasHash][cacheKey].touched = false;\n    });\n    return {\n        svgLayerElement: svgLayerElement,\n        svgNodeCacheForCanvas: state.svgNodeCache,\n        getSvgNode: getSvgNode.bind(this, canvasHash),\n        appendNode: appendNode.bind(this, svgLayerElement, canvasHash),\n        setNodeTouched: setNodeTouched.bind(this, canvasHash),\n        clearUntouched: clearUntouched.bind(this, svgLayerElement, canvasHash),\n    };\n}\nfunction _getSvgLayer(element) {\n    const viewportElement = `.${VIEWPORT_ELEMENT}`;\n    const internalDivElement = element.querySelector(viewportElement);\n    const svgLayer = internalDivElement?.querySelector(':scope > .svg-layer');\n    return svgLayer;\n}\nfunction getSvgNode(canvasHash, cacheKey) {\n    if (!state.svgNodeCache[canvasHash]) {\n        return;\n    }\n    if (state.svgNodeCache[canvasHash][cacheKey]) {\n        return state.svgNodeCache[canvasHash][cacheKey].domRef;\n    }\n}\nfunction appendNode(svgLayerElement, canvasHash, svgNode, cacheKey) {\n    if (!state.svgNodeCache[canvasHash]) {\n        return null;\n    }\n    state.svgNodeCache[canvasHash][cacheKey] = {\n        touched: true,\n        domRef: svgNode,\n    };\n    svgLayerElement.appendChild(svgNode);\n}\nfunction setNodeTouched(canvasHash, cacheKey) {\n    if (!state.svgNodeCache[canvasHash]) {\n        return;\n    }\n    if (state.svgNodeCache[canvasHash][cacheKey]) {\n        state.svgNodeCache[canvasHash][cacheKey].touched = true;\n    }\n}\nfunction clearUntouched(svgLayerElement, canvasHash) {\n    if (!state.svgNodeCache[canvasHash]) {\n        return;\n    }\n    Object.keys(state.svgNodeCache[canvasHash]).forEach((cacheKey) => {\n        const cacheEntry = state.svgNodeCache[canvasHash][cacheKey];\n        if (!cacheEntry.touched && cacheEntry.domRef) {\n            svgLayerElement.removeChild(cacheEntry.domRef);\n            delete state.svgNodeCache[canvasHash][cacheKey];\n        }\n    });\n}\nexport default getSvgDrawingHelper;\n","import getSvgDrawingHelper from './getSvgDrawingHelper';\nfunction draw(element, fn) {\n    const svgDrawingHelper = getSvgDrawingHelper(element);\n    fn(svgDrawingHelper);\n    svgDrawingHelper.clearUntouched();\n}\nexport default draw;\n","export function setAttributesIfNecessary(attributes, svgNode) {\n    Object.keys(attributes).forEach((key) => {\n        const currentValue = svgNode.getAttribute(key);\n        const newValue = attributes[key];\n        if (newValue === undefined || newValue === '') {\n            svgNode.removeAttribute(key);\n        }\n        else if (currentValue !== newValue) {\n            svgNode.setAttribute(key, newValue);\n        }\n    });\n}\nexport default setAttributesIfNecessary;\n","export function setNewAttributesIfValid(attributes, svgNode) {\n    Object.keys(attributes).forEach((key) => {\n        const newValue = attributes[key];\n        if (newValue !== undefined && newValue !== '') {\n            svgNode.setAttribute(key, newValue);\n        }\n    });\n}\nexport default setNewAttributesIfValid;\n","import _getHash from './_getHash';\nimport setAttributesIfNecessary from './setAttributesIfNecessary';\nimport setNewAttributesIfValid from './setNewAttributesIfValid';\nfunction drawCircle(svgDrawingHelper, annotationUID, circleUID, center, radius, options = {}, dataId = '') {\n    const { color, fill, width, lineWidth, lineDash, fillOpacity, strokeOpacity, } = Object.assign({\n        color: 'rgb(0, 255, 0)',\n        fill: 'transparent',\n        width: '2',\n        lineDash: undefined,\n        lineWidth: undefined,\n        strokeOpacity: 1,\n        fillOpacity: 1,\n    }, options);\n    const strokeWidth = lineWidth || width;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'circle', circleUID);\n    const existingCircleElement = svgDrawingHelper.getSvgNode(svgNodeHash);\n    const attributes = {\n        cx: `${center[0]}`,\n        cy: `${center[1]}`,\n        r: `${radius}`,\n        stroke: color,\n        fill,\n        'stroke-width': strokeWidth,\n        'stroke-dasharray': lineDash,\n        'fill-opacity': fillOpacity,\n        'stroke-opacity': strokeOpacity,\n    };\n    if (existingCircleElement) {\n        setAttributesIfNecessary(attributes, existingCircleElement);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const newCircleElement = document.createElementNS(svgns, 'circle');\n        if (dataId !== '') {\n            newCircleElement.setAttribute('data-id', dataId);\n        }\n        setNewAttributesIfValid(attributes, newCircleElement);\n        svgDrawingHelper.appendNode(newCircleElement, svgNodeHash);\n    }\n}\nexport default drawCircle;\n","import _getHash from './_getHash';\nimport setAttributesIfNecessary from './setAttributesIfNecessary';\nimport setNewAttributesIfValid from './setNewAttributesIfValid';\nfunction drawEllipseByCoordinates(svgDrawingHelper, annotationUID, ellipseUID, canvasCoordinates, options = {}, dataId = '') {\n    const { color, width, lineWidth, lineDash } = Object.assign({\n        color: 'rgb(0, 255, 0)',\n        width: '2',\n        lineWidth: undefined,\n        lineDash: undefined,\n    }, options);\n    const strokeWidth = lineWidth || width;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'ellipse', ellipseUID);\n    const existingEllipse = svgDrawingHelper.getSvgNode(svgNodeHash);\n    const [bottom, top, left, right] = canvasCoordinates;\n    const w = Math.hypot(left[0] - right[0], left[1] - right[1]);\n    const h = Math.hypot(top[0] - bottom[0], top[1] - bottom[1]);\n    const angle = (Math.atan2(left[1] - right[1], left[0] - right[0]) * 180) / Math.PI;\n    const center = [(left[0] + right[0]) / 2, (top[1] + bottom[1]) / 2];\n    const radiusX = w / 2;\n    const radiusY = h / 2;\n    const attributes = {\n        cx: `${center[0]}`,\n        cy: `${center[1]}`,\n        rx: `${radiusX}`,\n        ry: `${radiusY}`,\n        stroke: color,\n        fill: 'transparent',\n        transform: `rotate(${angle} ${center[0]} ${center[1]})`,\n        'stroke-width': strokeWidth,\n        'stroke-dasharray': lineDash,\n    };\n    if (existingEllipse) {\n        setAttributesIfNecessary(attributes, existingEllipse);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const svgEllipseElement = document.createElementNS(svgns, 'ellipse');\n        if (dataId !== '') {\n            svgEllipseElement.setAttribute('data-id', dataId);\n        }\n        setNewAttributesIfValid(attributes, svgEllipseElement);\n        svgDrawingHelper.appendNode(svgEllipseElement, svgNodeHash);\n    }\n}\nexport default drawEllipseByCoordinates;\n","import _getHash from './_getHash';\nimport drawEllipseByCoordinates from './drawEllipseByCoordinates';\nfunction drawEllipse(svgDrawingHelper, annotationUID, ellipseUID, corner1, corner2, options = {}, dataId = '') {\n    const top = [(corner1[0] + corner2[0]) / 2, corner1[1]];\n    const bottom = [(corner1[0] + corner2[0]) / 2, corner2[1]];\n    const left = [corner1[0], (corner1[1] + corner2[1]) / 2];\n    const right = [corner2[0], (corner1[1] + corner2[1]) / 2];\n    drawEllipseByCoordinates(svgDrawingHelper, annotationUID, ellipseUID, [bottom, top, left, right], (options = {}), (dataId = ''));\n}\nexport default drawEllipse;\n","import _getHash from './_getHash';\nimport setNewAttributesIfValid from './setNewAttributesIfValid';\nimport setAttributesIfNecessary from './setAttributesIfNecessary';\nfunction drawHandle(svgDrawingHelper, annotationUID, handleGroupUID, handle, options = {}, uniqueIndex) {\n    const { color, handleRadius, width, lineWidth, fill, type, opacity } = Object.assign({\n        color: 'rgb(0, 255, 0)',\n        handleRadius: '6',\n        width: '2',\n        lineWidth: undefined,\n        fill: 'transparent',\n        type: 'circle',\n        opacity: 1,\n    }, options);\n    const strokeWidth = lineWidth || width;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'handle', `hg-${handleGroupUID}-index-${uniqueIndex}`);\n    let attributes;\n    if (type === 'circle') {\n        attributes = {\n            cx: `${handle[0]}`,\n            cy: `${handle[1]}`,\n            r: handleRadius,\n            stroke: color,\n            fill,\n            'stroke-width': strokeWidth,\n            opacity: opacity,\n        };\n    }\n    else if (type === 'rect') {\n        const handleRadiusFloat = parseFloat(handleRadius);\n        const side = handleRadiusFloat * 1.5;\n        const x = handle[0] - side * 0.5;\n        const y = handle[1] - side * 0.5;\n        attributes = {\n            x: `${x}`,\n            y: `${y}`,\n            width: `${side}`,\n            height: `${side}`,\n            stroke: color,\n            fill,\n            'stroke-width': strokeWidth,\n            rx: `${side * 0.1}`,\n            opacity: opacity,\n        };\n    }\n    else {\n        throw new Error(`Unsupported handle type: ${type}`);\n    }\n    const existingHandleElement = svgDrawingHelper.getSvgNode(svgNodeHash);\n    if (existingHandleElement) {\n        setAttributesIfNecessary(attributes, existingHandleElement);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const newHandleElement = document.createElementNS(svgns, type);\n        setNewAttributesIfValid(attributes, newHandleElement);\n        svgDrawingHelper.appendNode(newHandleElement, svgNodeHash);\n    }\n}\nexport default drawHandle;\n","import drawHandle from './drawHandle';\nfunction drawHandles(svgDrawingHelper, annotationUID, handleGroupUID, handlePoints, options = {}) {\n    handlePoints.forEach((handle, i) => {\n        drawHandle(svgDrawingHelper, annotationUID, handleGroupUID, handle, options, i);\n    });\n}\nexport default drawHandles;\n","import _getHash from './_getHash';\nimport setNewAttributesIfValid from './setNewAttributesIfValid';\nimport setAttributesIfNecessary from './setAttributesIfNecessary';\nexport default function drawLine(svgDrawingHelper, annotationUID, lineUID, start, end, options = {}, dataId = '') {\n    if (isNaN(start[0]) || isNaN(start[1]) || isNaN(end[0]) || isNaN(end[1])) {\n        return;\n    }\n    const { color, width, lineWidth, lineDash, shadow } = Object.assign({\n        color: 'rgb(0, 255, 0)',\n        width: '2',\n        lineWidth: undefined,\n        lineDash: undefined,\n        shadow: undefined,\n    }, options);\n    const strokeWidth = lineWidth || width;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'line', lineUID);\n    const existingLine = svgDrawingHelper.getSvgNode(svgNodeHash);\n    const dropShadowStyle = shadow\n        ? `filter:url(#shadow-${svgDrawingHelper.svgLayerElement.id});`\n        : '';\n    const attributes = {\n        x1: `${start[0]}`,\n        y1: `${start[1]}`,\n        x2: `${end[0]}`,\n        y2: `${end[1]}`,\n        stroke: color,\n        style: dropShadowStyle,\n        'stroke-width': strokeWidth,\n        'stroke-dasharray': lineDash,\n    };\n    if (existingLine) {\n        setAttributesIfNecessary(attributes, existingLine);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const newLine = document.createElementNS(svgns, 'line');\n        if (dataId !== '') {\n            newLine.setAttribute('data-id', dataId);\n        }\n        setNewAttributesIfValid(attributes, newLine);\n        svgDrawingHelper.appendNode(newLine, svgNodeHash);\n    }\n}\n","import drawLine from './drawLine';\nexport default function drawHeight(svgDrawingHelper, annotationUID, heightUID, start, end, options = {}) {\n    if (isNaN(start[0]) || isNaN(start[1]) || isNaN(end[0]) || isNaN(end[1])) {\n        return;\n    }\n    const { color, width, lineWidth, lineDash } = Object.assign({\n        color: 'rgb(0, 255, 0)',\n        width: '2',\n        lineWidth: undefined,\n        lineDash: undefined,\n    }, options);\n    const midX = end[0] + (start[0] - end[0]) / 2;\n    const endfirstLine = [midX, start[1]];\n    const endsecondLine = [midX, end[1]];\n    const firstLine = {\n        start: start,\n        end: endfirstLine,\n    };\n    const secondLine = {\n        start: endfirstLine,\n        end: endsecondLine,\n    };\n    const threeLine = {\n        start: endsecondLine,\n        end: end,\n    };\n    drawLine(svgDrawingHelper, annotationUID, '1', firstLine.start, firstLine.end, {\n        color,\n        width,\n        lineWidth,\n    });\n    drawLine(svgDrawingHelper, annotationUID, '2', secondLine.start, secondLine.end, {\n        color,\n        width,\n        lineWidth,\n    });\n    drawLine(svgDrawingHelper, annotationUID, '3', threeLine.start, threeLine.end, {\n        color,\n        width,\n        lineWidth,\n    });\n}\n","import _getHash from './_getHash';\nimport setNewAttributesIfValid from './setNewAttributesIfValid';\nimport setAttributesIfNecessary from './setAttributesIfNecessary';\nexport default function drawPolyline(svgDrawingHelper, annotationUID, polylineUID, points, options) {\n    if (points.length < 2) {\n        return;\n    }\n    const { color = 'rgb(0, 255, 0)', width = 10, fillColor = 'none', fillOpacity = 0, lineWidth, lineDash, closePath = false, } = options;\n    const strokeWidth = lineWidth || width;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'polyline', polylineUID);\n    const existingPolyLine = svgDrawingHelper.getSvgNode(svgNodeHash);\n    let pointsAttribute = '';\n    for (const point of points) {\n        pointsAttribute += `${point[0].toFixed(1)}, ${point[1].toFixed(1)} `;\n    }\n    if (closePath) {\n        const firstPoint = points[0];\n        pointsAttribute += `${firstPoint[0]}, ${firstPoint[1]}`;\n    }\n    const attributes = {\n        points: pointsAttribute,\n        stroke: color,\n        fill: fillColor,\n        'fill-opacity': fillOpacity,\n        'stroke-width': strokeWidth,\n        'stroke-dasharray': lineDash,\n    };\n    if (existingPolyLine) {\n        setAttributesIfNecessary(attributes, existingPolyLine);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const newPolyLine = document.createElementNS(svgns, 'polyline');\n        setNewAttributesIfValid(attributes, newPolyLine);\n        svgDrawingHelper.appendNode(newPolyLine, svgNodeHash);\n    }\n}\n","import _getHash from './_getHash';\nimport setNewAttributesIfValid from './setNewAttributesIfValid';\nimport setAttributesIfNecessary from './setAttributesIfNecessary';\nexport default function drawPath(svgDrawingHelper, annotationUID, pathUID, points, options) {\n    const hasSubArrays = points.length && points[0].length && Array.isArray(points[0][0]);\n    const pointsArrays = hasSubArrays ? points : [points];\n    const { color = 'rgb(0, 255, 0)', width = 10, fillColor = 'none', fillOpacity = 0, lineWidth, lineDash, closePath = false, } = options;\n    const strokeWidth = lineWidth || width;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'path', pathUID);\n    const existingNode = svgDrawingHelper.getSvgNode(svgNodeHash);\n    let pointsAttribute = '';\n    for (let i = 0, numArrays = pointsArrays.length; i < numArrays; i++) {\n        const points = pointsArrays[i];\n        const numPoints = points.length;\n        if (numPoints < 2) {\n            continue;\n        }\n        for (let j = 0; j < numPoints; j++) {\n            const point = points[j];\n            const cmd = j ? 'L' : 'M';\n            pointsAttribute += `${cmd} ${point[0].toFixed(1)}, ${point[1].toFixed(1)} `;\n        }\n        if (closePath) {\n            pointsAttribute += 'Z ';\n        }\n    }\n    if (!pointsAttribute) {\n        return;\n    }\n    const attributes = {\n        d: pointsAttribute,\n        stroke: color,\n        fill: fillColor,\n        'fill-opacity': fillOpacity,\n        'stroke-width': strokeWidth,\n        'stroke-dasharray': lineDash,\n    };\n    if (existingNode) {\n        setAttributesIfNecessary(attributes, existingNode);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const newNode = document.createElementNS(svgns, 'path');\n        setNewAttributesIfValid(attributes, newNode);\n        svgDrawingHelper.appendNode(newNode, svgNodeHash);\n    }\n}\n","import _getHash from './_getHash';\nimport setAttributesIfNecessary from './setAttributesIfNecessary';\nfunction drawTextBox(svgDrawingHelper, annotationUID, textUID, textLines, position, options = {}) {\n    const mergedOptions = Object.assign({\n        fontFamily: 'Helvetica, Arial, sans-serif',\n        fontSize: '14px',\n        color: 'rgb(255, 255, 0)',\n        background: '',\n        padding: 25,\n        centerX: false,\n        centerY: true,\n    }, options);\n    const textGroupBoundingBox = _drawTextGroup(svgDrawingHelper, annotationUID, textUID, textLines, position, mergedOptions);\n    return textGroupBoundingBox;\n}\nfunction _drawTextGroup(svgDrawingHelper, annotationUID, textUID, textLines = [''], position, options) {\n    const { padding, color, fontFamily, fontSize, background } = options;\n    let textGroupBoundingBox;\n    const [x, y] = [position[0] + padding, position[1] + padding];\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'text', textUID);\n    const existingTextGroup = svgDrawingHelper.getSvgNode(svgNodeHash);\n    if (existingTextGroup) {\n        const textElement = existingTextGroup.querySelector('text');\n        const textSpans = Array.from(textElement.children);\n        for (let i = 0; i < textSpans.length; i++) {\n            const textSpanElement = textSpans[i];\n            const text = textLines[i] || '';\n            textSpanElement.textContent = text;\n        }\n        if (textLines.length > textSpans.length) {\n            for (let i = 0; i < textLines.length - textSpans.length; i++) {\n                const textLine = textLines[i + textSpans.length];\n                const textSpan = _createTextSpan(textLine);\n                textElement.appendChild(textSpan);\n            }\n            existingTextGroup.appendChild(textElement);\n            svgDrawingHelper.appendNode(existingTextGroup, svgNodeHash);\n        }\n        const textAttributes = {\n            fill: color,\n            'font-size': fontSize,\n            'font-family': fontFamily,\n        };\n        const textGroupAttributes = {\n            transform: `translate(${x} ${y})`,\n        };\n        setAttributesIfNecessary(textAttributes, textElement);\n        setAttributesIfNecessary(textGroupAttributes, existingTextGroup);\n        textGroupBoundingBox = _drawTextBackground(existingTextGroup, background);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const textGroup = document.createElementNS(svgns, 'g');\n        textGroup.setAttribute('transform', `translate(${x} ${y})`);\n        const textElement = _createTextElement(svgDrawingHelper, options);\n        for (let i = 0; i < textLines.length; i++) {\n            const textLine = textLines[i];\n            const textSpan = _createTextSpan(textLine);\n            textElement.appendChild(textSpan);\n        }\n        textGroup.appendChild(textElement);\n        svgDrawingHelper.appendNode(textGroup, svgNodeHash);\n        textGroupBoundingBox = _drawTextBackground(textGroup, background);\n    }\n    return Object.assign({}, textGroupBoundingBox, {\n        x,\n        y,\n        height: textGroupBoundingBox.height + padding,\n        width: textGroupBoundingBox.width + padding,\n    });\n}\nfunction _createTextElement(svgDrawingHelper, options) {\n    const { color, fontFamily, fontSize } = options;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const textElement = document.createElementNS(svgns, 'text');\n    const noSelectStyle = 'user-select: none; pointer-events: none; -webkit-tap-highlight-color:  rgba(255, 255, 255, 0);';\n    const dropShadowStyle = `filter:url(#shadow-${svgDrawingHelper.svgLayerElement.id});`;\n    const combinedStyle = `${noSelectStyle}${dropShadowStyle}`;\n    textElement.setAttribute('x', '0');\n    textElement.setAttribute('y', '0');\n    textElement.setAttribute('fill', color);\n    textElement.setAttribute('font-family', fontFamily);\n    textElement.setAttribute('font-size', fontSize);\n    textElement.setAttribute('style', combinedStyle);\n    return textElement;\n}\nfunction _createTextSpan(text) {\n    const svgns = 'http://www.w3.org/2000/svg';\n    const textSpanElement = document.createElementNS(svgns, 'tspan');\n    textSpanElement.setAttribute('x', '0');\n    textSpanElement.setAttribute('dy', '1.2em');\n    textSpanElement.textContent = text;\n    return textSpanElement;\n}\nfunction _drawTextBackground(group, color) {\n    let element = group.querySelector('rect.background');\n    if (!color) {\n        if (element) {\n            group.removeChild(element);\n        }\n        return group.getBBox();\n    }\n    if (!element) {\n        element = document.createElementNS('http://www.w3.org/2000/svg', 'rect');\n        element.setAttribute('class', 'background');\n        group.insertBefore(element, group.firstChild);\n    }\n    const bBox = group.getBBox();\n    const attributes = {\n        x: `${bBox.x}`,\n        y: `${bBox.y}`,\n        width: `${bBox.width}`,\n        height: `${bBox.height}`,\n        fill: color,\n    };\n    setAttributesIfNecessary(attributes, element);\n    return bBox;\n}\nexport default drawTextBox;\n","import drawLine from './drawLine';\nimport findClosestPoint from '../utilities/math/vec2/findClosestPoint';\nfunction drawLink(svgDrawingHelper, annotationUID, linkUID, annotationAnchorPoints, refPoint, boundingBox, options = {}) {\n    const start = annotationAnchorPoints.length > 0\n        ? findClosestPoint(annotationAnchorPoints, refPoint)\n        : refPoint;\n    const boundingBoxPoints = _boundingBoxPoints(boundingBox);\n    const end = findClosestPoint(boundingBoxPoints, start);\n    const mergedOptions = Object.assign({\n        color: 'rgb(255, 255, 0)',\n        lineWidth: '1',\n        lineDash: '2,3',\n    }, options);\n    drawLine(svgDrawingHelper, annotationUID, `link-${linkUID}`, start, end, mergedOptions);\n}\nfunction _boundingBoxPoints(boundingBox) {\n    const { x: left, y: top, height, width } = boundingBox;\n    const halfWidth = width / 2;\n    const halfHeight = height / 2;\n    const topMiddle = [left + halfWidth, top];\n    const leftMiddle = [left, top + halfHeight];\n    const bottomMiddle = [left + halfWidth, top + height];\n    const rightMiddle = [left + width, top + halfHeight];\n    return [topMiddle, leftMiddle, bottomMiddle, rightMiddle];\n}\nexport default drawLink;\n","import drawTextBox from './drawTextBox';\nimport drawLink from './drawLink';\nfunction drawLinkedTextBox(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, annotationAnchorPoints, textBox, options = {}) {\n    const mergedOptions = Object.assign({\n        handleRadius: '6',\n        centering: {\n            x: false,\n            y: true,\n        },\n    }, options);\n    const canvasBoundingBox = drawTextBox(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, mergedOptions);\n    drawLink(svgDrawingHelper, annotationUID, textBoxUID, annotationAnchorPoints, textBoxPosition, canvasBoundingBox, mergedOptions);\n    return canvasBoundingBox;\n}\nexport default drawLinkedTextBox;\n","import _getHash from './_getHash';\nimport setAttributesIfNecessary from './setAttributesIfNecessary';\nimport setNewAttributesIfValid from './setNewAttributesIfValid';\nexport default function drawRectByCoordinates(svgDrawingHelper, annotationUID, rectangleUID, canvasCoordinates, options = {}, dataId = '') {\n    const { color, width: _width, lineWidth, lineDash, } = Object.assign({\n        color: 'rgb(0, 255, 0)',\n        width: '2',\n        lineWidth: undefined,\n        lineDash: undefined,\n    }, options);\n    const strokeWidth = lineWidth || _width;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'rect', rectangleUID);\n    const existingRect = svgDrawingHelper.getSvgNode(svgNodeHash);\n    const [topLeft, topRight, bottomLeft, bottomRight] = canvasCoordinates;\n    const width = Math.hypot(topLeft[0] - topRight[0], topLeft[1] - topRight[1]);\n    const height = Math.hypot(topLeft[0] - bottomLeft[0], topLeft[1] - bottomLeft[1]);\n    const center = [\n        (bottomRight[0] + topLeft[0]) / 2,\n        (bottomRight[1] + topLeft[1]) / 2,\n    ];\n    const leftEdgeCenter = [\n        (bottomLeft[0] + topLeft[0]) / 2,\n        (bottomLeft[1] + topLeft[1]) / 2,\n    ];\n    const angle = (Math.atan2(center[1] - leftEdgeCenter[1], center[0] - leftEdgeCenter[0]) *\n        180) /\n        Math.PI;\n    const attributes = {\n        x: `${center[0] - width / 2}`,\n        y: `${center[1] - height / 2}`,\n        width: `${width}`,\n        height: `${height}`,\n        stroke: color,\n        fill: 'transparent',\n        transform: `rotate(${angle} ${center[0]} ${center[1]})`,\n        'stroke-width': strokeWidth,\n        'stroke-dasharray': lineDash,\n    };\n    if (existingRect) {\n        setAttributesIfNecessary(attributes, existingRect);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const svgRectElement = document.createElementNS(svgns, 'rect');\n        if (dataId !== '') {\n            svgRectElement.setAttribute('data-id', dataId);\n        }\n        setNewAttributesIfValid(attributes, svgRectElement);\n        svgDrawingHelper.appendNode(svgRectElement, svgNodeHash);\n    }\n}\n","import _getHash from './_getHash';\nimport drawRectByCoordinates from './drawRectByCoordinates';\nexport default function drawRect(svgDrawingHelper, annotationUID, rectangleUID, start, end, options = {}, dataId = '') {\n    const topLeft = [start[0], start[1]];\n    const topRight = [end[0], start[1]];\n    const bottomLeft = [start[0], end[1]];\n    const bottomRight = [end[0], end[1]];\n    drawRectByCoordinates(svgDrawingHelper, annotationUID, rectangleUID, [topLeft, topRight, bottomLeft, bottomRight], options, dataId);\n}\n","import drawLine from './drawLine';\nexport default function drawArrow(svgDrawingHelper, annotationUID, arrowUID, start, end, options = {}) {\n    if (isNaN(start[0]) || isNaN(start[1]) || isNaN(end[0]) || isNaN(end[1])) {\n        return;\n    }\n    const { color, width, lineWidth, lineDash } = Object.assign({\n        color: 'rgb(0, 255, 0)',\n        width: '2',\n        lineWidth: undefined,\n        lineDash: undefined,\n    }, options);\n    drawLine(svgDrawingHelper, annotationUID, arrowUID, start, end, {\n        color,\n        width,\n        lineWidth,\n        lineDash,\n    });\n    const headLength = 10;\n    const angle = Math.atan2(end[1] - start[1], end[0] - start[0]);\n    const firstLine = {\n        start: [\n            end[0] - headLength * Math.cos(angle - Math.PI / 7),\n            end[1] - headLength * Math.sin(angle - Math.PI / 7),\n        ],\n        end: end,\n    };\n    const secondLine = {\n        start: [\n            end[0] - headLength * Math.cos(angle + Math.PI / 7),\n            end[1] - headLength * Math.sin(angle + Math.PI / 7),\n        ],\n        end: end,\n    };\n    drawLine(svgDrawingHelper, annotationUID, '2', firstLine.start, firstLine.end, {\n        color,\n        width,\n        lineWidth,\n    });\n    drawLine(svgDrawingHelper, annotationUID, '3', secondLine.start, secondLine.end, {\n        color,\n        width,\n        lineWidth,\n    });\n}\n","import _getHash from './_getHash';\nimport _setAttributesIfNecessary from './setAttributesIfNecessary';\nimport _setNewAttributesIfValid from './setNewAttributesIfValid';\nexport default function drawRedactionRect(svgDrawingHelper, annotationUID, rectangleUID, start, end, options = {}) {\n    const { color, width: _width, lineWidth, lineDash, } = Object.assign({\n        color: 'rgb(0, 255, 0)',\n        width: '2',\n        lineWidth: undefined,\n        lineDash: undefined,\n    }, options);\n    const strokeWidth = lineWidth || _width;\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgNodeHash = _getHash(annotationUID, 'rect', rectangleUID);\n    const existingRect = svgDrawingHelper.getSvgNode(svgNodeHash);\n    const tlhc = [Math.min(start[0], end[0]), Math.min(start[1], end[1])];\n    const width = Math.abs(start[0] - end[0]);\n    const height = Math.abs(start[1] - end[1]);\n    const attributes = {\n        x: `${tlhc[0]}`,\n        y: `${tlhc[1]}`,\n        width: `${width}`,\n        height: `${height}`,\n        stroke: color,\n        fill: 'black',\n        'stroke-width': strokeWidth,\n        'stroke-dasharray': lineDash,\n    };\n    if (existingRect) {\n        _setAttributesIfNecessary(attributes, existingRect);\n        svgDrawingHelper.setNodeTouched(svgNodeHash);\n    }\n    else {\n        const svgRectElement = document.createElementNS(svgns, 'rect');\n        _setNewAttributesIfValid(attributes, svgRectElement);\n        svgDrawingHelper.appendNode(svgRectElement, svgNodeHash);\n    }\n}\n","var ChangeTypes;\n(function (ChangeTypes) {\n    ChangeTypes[\"Interaction\"] = \"Interaction\";\n    ChangeTypes[\"HandlesUpdated\"] = \"HandlesUpdated\";\n    ChangeTypes[\"StatsUpdated\"] = \"StatsUpdated\";\n    ChangeTypes[\"InitialSetup\"] = \"InitialSetup\";\n    ChangeTypes[\"Completed\"] = \"Completed\";\n    ChangeTypes[\"InterpolationUpdated\"] = \"InterpolationUpdated\";\n})(ChangeTypes || (ChangeTypes = {}));\nexport default ChangeTypes;\n","var Events;\n(function (Events) {\n    Events[\"TOOL_ACTIVATED\"] = \"CORNERSTONE_TOOLS_TOOL_ACTIVATED\";\n    Events[\"TOOLGROUP_VIEWPORT_ADDED\"] = \"CORNERSTONE_TOOLS_TOOLGROUP_VIEWPORT_ADDED\";\n    Events[\"TOOLGROUP_VIEWPORT_REMOVED\"] = \"CORNERSTONE_TOOLS_TOOLGROUP_VIEWPORT_REMOVED\";\n    Events[\"TOOL_MODE_CHANGED\"] = \"CORNERSTONE_TOOLS_TOOL_MODE_CHANGED\";\n    Events[\"ANNOTATION_ADDED\"] = \"CORNERSTONE_TOOLS_ANNOTATION_ADDED\";\n    Events[\"ANNOTATION_COMPLETED\"] = \"CORNERSTONE_TOOLS_ANNOTATION_COMPLETED\";\n    Events[\"ANNOTATION_MODIFIED\"] = \"CORNERSTONE_TOOLS_ANNOTATION_MODIFIED\";\n    Events[\"ANNOTATION_REMOVED\"] = \"CORNERSTONE_TOOLS_ANNOTATION_REMOVED\";\n    Events[\"ANNOTATION_SELECTION_CHANGE\"] = \"CORNERSTONE_TOOLS_ANNOTATION_SELECTION_CHANGE\";\n    Events[\"ANNOTATION_LOCK_CHANGE\"] = \"CORNERSTONE_TOOLS_ANNOTATION_LOCK_CHANGE\";\n    Events[\"ANNOTATION_VISIBILITY_CHANGE\"] = \"CORNERSTONE_TOOLS_ANNOTATION_VISIBILITY_CHANGE\";\n    Events[\"ANNOTATION_RENDERED\"] = \"CORNERSTONE_TOOLS_ANNOTATION_RENDERED\";\n    Events[\"ANNOTATION_INTERPOLATION_PROCESS_COMPLETED\"] = \"CORNERSTONE_TOOLS_ANNOTATION_INTERPOLATION_PROCESS_COMPLETED\";\n    Events[\"INTERPOLATED_ANNOTATIONS_REMOVED\"] = \"CORNERSTONE_TOOLS_INTERPOLATED_ANNOTATIONS_REMOVED\";\n    Events[\"SEGMENTATION_MODIFIED\"] = \"CORNERSTONE_TOOLS_SEGMENTATION_MODIFIED\";\n    Events[\"SEGMENTATION_RENDERED\"] = \"CORNERSTONE_TOOLS_SEGMENTATION_RENDERED\";\n    Events[\"SEGMENTATION_REPRESENTATION_ADDED\"] = \"CORNERSTONE_TOOLS_SEGMENTATION_REPRESENTATION_ADDED\";\n    Events[\"SEGMENTATION_ADDED\"] = \"CORNERSTONE_TOOLS_SEGMENTATION_ADDED\";\n    Events[\"SEGMENTATION_REPRESENTATION_MODIFIED\"] = \"CORNERSTONE_TOOLS_SEGMENTATION_REPRESENTATION_MODIFIED\";\n    Events[\"SEGMENTATION_REMOVED\"] = \"CORNERSTONE_TOOLS_SEGMENTATION_REMOVED\";\n    Events[\"SEGMENTATION_REPRESENTATION_REMOVED\"] = \"CORNERSTONE_TOOLS_SEGMENTATION_REPRESENTATION_REMOVED\";\n    Events[\"SEGMENTATION_DATA_MODIFIED\"] = \"CORNERSTONE_TOOLS_SEGMENTATION_DATA_MODIFIED\";\n    Events[\"KEY_DOWN\"] = \"CORNERSTONE_TOOLS_KEY_DOWN\";\n    Events[\"KEY_UP\"] = \"CORNERSTONE_TOOLS_KEY_UP\";\n    Events[\"MOUSE_DOWN\"] = \"CORNERSTONE_TOOLS_MOUSE_DOWN\";\n    Events[\"MOUSE_UP\"] = \"CORNERSTONE_TOOLS_MOUSE_UP\";\n    Events[\"MOUSE_DOWN_ACTIVATE\"] = \"CORNERSTONE_TOOLS_MOUSE_DOWN_ACTIVATE\";\n    Events[\"MOUSE_DRAG\"] = \"CORNERSTONE_TOOLS_MOUSE_DRAG\";\n    Events[\"MOUSE_MOVE\"] = \"CORNERSTONE_TOOLS_MOUSE_MOVE\";\n    Events[\"MOUSE_CLICK\"] = \"CORNERSTONE_TOOLS_MOUSE_CLICK\";\n    Events[\"MOUSE_DOUBLE_CLICK\"] = \"CORNERSTONE_TOOLS_MOUSE_DOUBLE_CLICK\";\n    Events[\"MOUSE_WHEEL\"] = \"CORNERSTONE_TOOLS_MOUSE_WHEEL\";\n    Events[\"TOUCH_START\"] = \"CORNERSTONE_TOOLS_TOUCH_START\";\n    Events[\"TOUCH_START_ACTIVATE\"] = \"CORNERSTONE_TOOLS_TOUCH_START_ACTIVATE\";\n    Events[\"TOUCH_PRESS\"] = \"CORNERSTONE_TOOLS_TOUCH_PRESS\";\n    Events[\"TOUCH_DRAG\"] = \"CORNERSTONE_TOOLS_TOUCH_DRAG\";\n    Events[\"TOUCH_END\"] = \"CORNERSTONE_TOOLS_TOUCH_END\";\n    Events[\"TOUCH_TAP\"] = \"CORNERSTONE_TOOLS_TAP\";\n    Events[\"TOUCH_SWIPE\"] = \"CORNERSTONE_TOOLS_SWIPE\";\n})(Events || (Events = {}));\nexport default Events;\n","var StrategyCallbacks;\n(function (StrategyCallbacks) {\n    StrategyCallbacks[\"OnInteractionStart\"] = \"onInteractionStart\";\n    StrategyCallbacks[\"OnInteractionEnd\"] = \"onInteractionEnd\";\n    StrategyCallbacks[\"Preview\"] = \"preview\";\n    StrategyCallbacks[\"RejectPreview\"] = \"rejectPreview\";\n    StrategyCallbacks[\"AcceptPreview\"] = \"acceptPreview\";\n    StrategyCallbacks[\"Fill\"] = \"fill\";\n    StrategyCallbacks[\"StrategyFunction\"] = \"strategyFunction\";\n    StrategyCallbacks[\"CreateIsInThreshold\"] = \"createIsInThreshold\";\n    StrategyCallbacks[\"Initialize\"] = \"initialize\";\n    StrategyCallbacks[\"INTERNAL_setValue\"] = \"setValue\";\n    StrategyCallbacks[\"ComputeInnerCircleRadius\"] = \"computeInnerCircleRadius\";\n})(StrategyCallbacks || (StrategyCallbacks = {}));\nexport default StrategyCallbacks;\n","var ToolModes;\n(function (ToolModes) {\n    ToolModes[\"Active\"] = \"Active\";\n    ToolModes[\"Passive\"] = \"Passive\";\n    ToolModes[\"Enabled\"] = \"Enabled\";\n    ToolModes[\"Disabled\"] = \"Disabled\";\n})(ToolModes || (ToolModes = {}));\nexport default ToolModes;\n","var Swipe;\n(function (Swipe) {\n    Swipe[\"UP\"] = \"UP\";\n    Swipe[\"DOWN\"] = \"DOWN\";\n    Swipe[\"LEFT\"] = \"LEFT\";\n    Swipe[\"RIGHT\"] = \"RIGHT\";\n})(Swipe || (Swipe = {}));\nexport { Swipe };\n","var AnnotationStyleStates;\n(function (AnnotationStyleStates) {\n    AnnotationStyleStates[\"Default\"] = \"\";\n    AnnotationStyleStates[\"Highlighted\"] = \"Highlighted\";\n    AnnotationStyleStates[\"Selected\"] = \"Selected\";\n    AnnotationStyleStates[\"Locked\"] = \"Locked\";\n    AnnotationStyleStates[\"AutoGenerated\"] = \"AutoGenerated\";\n})(AnnotationStyleStates || (AnnotationStyleStates = {}));\nexport default AnnotationStyleStates;\n","var ChangeTypes;\n(function (ChangeTypes) {\n    ChangeTypes[\"POLYSEG_CONTOUR_TO_LABELMAP\"] = \"Converting Contour to Labelmap\";\n    ChangeTypes[\"POLYSEG_SURFACE_TO_LABELMAP\"] = \"Converting Surfaces to Labelmap\";\n    ChangeTypes[\"POLYSEG_CONTOUR_TO_SURFACE\"] = \"Converting Contour to Surface\";\n    ChangeTypes[\"POLYSEG_LABELMAP_TO_SURFACE\"] = \"Converting Labelmap to Surface\";\n    ChangeTypes[\"SURFACE_CLIPPING\"] = \"Clipping Surfaces\";\n})(ChangeTypes || (ChangeTypes = {}));\nexport default ChangeTypes;\n","import { getEnabledElement, utilities as csUtils } from '@cornerstonejs/core';\nimport getViewportsForAnnotation from '../../../utilities/getViewportsForAnnotation';\nimport * as math from '../../../utilities/math';\nimport triggerAnnotationRenderForViewportIds from '../../../utilities/triggerAnnotationRenderForViewportIds';\nimport { getViewportIdsWithToolToRender } from '../../../utilities/viewportFilters';\nimport { addAnnotation, removeAnnotation, getAllAnnotations, getChildAnnotations, addChildAnnotation, clearParentAnnotation, } from '../../../stateManagement/annotation/annotationState';\nimport { ContourWindingDirection } from '../../../types/ContourAnnotation';\nimport { triggerAnnotationModified } from '../../../stateManagement/annotation/helpers/state';\nimport updateContourPolyline from '../../../utilities/contours/updateContourPolyline';\nimport { addContourSegmentationAnnotation, areSameSegment, isContourSegmentationAnnotation, removeContourSegmentationAnnotation, } from '../../../utilities/contourSegmentation';\nimport { getToolGroupForViewport } from '../../../store/ToolGroupManager';\nimport { hasTool, hasToolByName } from '../../../store/addTool';\nconst DEFAULT_CONTOUR_SEG_TOOL_NAME = 'PlanarFreehandContourSegmentationTool';\nexport default async function contourSegmentationCompletedListener(evt) {\n    const sourceAnnotation = evt.detail\n        .annotation;\n    if (!isContourSegmentationAnnotation(sourceAnnotation)) {\n        return;\n    }\n    const viewport = getViewport(sourceAnnotation);\n    const contourSegmentationAnnotations = getValidContourSegmentationAnnotations(viewport, sourceAnnotation);\n    if (!contourSegmentationAnnotations.length) {\n        return;\n    }\n    const sourcePolyline = convertContourPolylineToCanvasSpace(sourceAnnotation.data.contour.polyline, viewport);\n    const targetAnnotationInfo = findIntersectingContour(viewport, sourcePolyline, contourSegmentationAnnotations);\n    if (!targetAnnotationInfo) {\n        return;\n    }\n    const { targetAnnotation, targetPolyline, isContourHole } = targetAnnotationInfo;\n    if (isContourHole) {\n        const { contourHoleProcessingEnabled = false } = evt.detail;\n        if (!contourHoleProcessingEnabled) {\n            return;\n        }\n        createPolylineHole(viewport, targetAnnotation, sourceAnnotation);\n    }\n    else {\n        combinePolylines(viewport, targetAnnotation, targetPolyline, sourceAnnotation, sourcePolyline);\n    }\n}\nfunction isFreehandContourSegToolRegisteredForViewport(viewport, silent = false) {\n    const toolName = 'PlanarFreehandContourSegmentationTool';\n    const toolGroup = getToolGroupForViewport(viewport.id, viewport.renderingEngineId);\n    let errorMessage;\n    if (!toolGroup.hasTool(toolName)) {\n        errorMessage = `Tool ${toolName} not added to ${toolGroup.id} toolGroup`;\n    }\n    else if (!toolGroup.getToolOptions(toolName)) {\n        errorMessage = `Tool ${toolName} must be in active/passive state`;\n    }\n    if (errorMessage && !silent) {\n        console.warn(errorMessage);\n    }\n    return !errorMessage;\n}\nfunction getViewport(annotation) {\n    const viewports = getViewportsForAnnotation(annotation);\n    const viewportWithToolRegistered = viewports.find((viewport) => isFreehandContourSegToolRegisteredForViewport(viewport, true));\n    return viewportWithToolRegistered ?? viewports[0];\n}\nfunction convertContourPolylineToCanvasSpace(polyline, viewport) {\n    const numPoints = polyline.length;\n    const projectedPolyline = new Array(numPoints);\n    for (let i = 0; i < numPoints; i++) {\n        projectedPolyline[i] = viewport.worldToCanvas(polyline[i]);\n    }\n    return projectedPolyline;\n}\nfunction getValidContourSegmentationAnnotations(viewport, sourceAnnotation) {\n    const { annotationUID: sourceAnnotationUID } = sourceAnnotation;\n    const allAnnotations = getAllAnnotations();\n    return allAnnotations.filter((targetAnnotation) => targetAnnotation.annotationUID &&\n        targetAnnotation.annotationUID !== sourceAnnotationUID &&\n        isContourSegmentationAnnotation(targetAnnotation) &&\n        areSameSegment(targetAnnotation, sourceAnnotation) &&\n        viewport.isReferenceViewable(targetAnnotation.metadata));\n}\nfunction findIntersectingContour(viewport, sourcePolyline, contourSegmentationAnnotations) {\n    const sourceAABB = math.polyline.getAABB(sourcePolyline);\n    for (let i = 0; i < contourSegmentationAnnotations.length; i++) {\n        const targetAnnotation = contourSegmentationAnnotations[i];\n        const targetPolyline = convertContourPolylineToCanvasSpace(targetAnnotation.data.contour.polyline, viewport);\n        const targetAABB = math.polyline.getAABB(targetPolyline);\n        const aabbIntersect = math.aabb.intersectAABB(sourceAABB, targetAABB);\n        const lineSegmentsIntersect = aabbIntersect &&\n            math.polyline.intersectPolyline(sourcePolyline, targetPolyline);\n        const isContourHole = aabbIntersect &&\n            !lineSegmentsIntersect &&\n            math.polyline.containsPoints(targetPolyline, sourcePolyline);\n        if (lineSegmentsIntersect || isContourHole) {\n            return { targetAnnotation, targetPolyline, isContourHole };\n        }\n    }\n}\nexport function createPolylineHole(viewport, targetAnnotation, holeAnnotation) {\n    const { windingDirection: targetWindingDirection } = targetAnnotation.data.contour;\n    const { windingDirection: holeWindingDirection } = holeAnnotation.data.contour;\n    addChildAnnotation(targetAnnotation, holeAnnotation);\n    removeContourSegmentationAnnotation(holeAnnotation);\n    const { contour: holeContour } = holeAnnotation.data;\n    const holePolyline = convertContourPolylineToCanvasSpace(holeContour.polyline, viewport);\n    updateContourPolyline(holeAnnotation, {\n        points: holePolyline,\n        closed: holeContour.closed,\n    }, viewport);\n    const { element } = viewport;\n    const updatedToolNames = new Set([\n        DEFAULT_CONTOUR_SEG_TOOL_NAME,\n        targetAnnotation.metadata.toolName,\n        holeAnnotation.metadata.toolName,\n    ]);\n    for (const toolName of updatedToolNames.values()) {\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, toolName);\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n    }\n}\nfunction getContourHolesData(viewport, annotation) {\n    return getChildAnnotations(annotation).map((holeAnnotation) => {\n        const polyline = convertContourPolylineToCanvasSpace(holeAnnotation.data.contour.polyline, viewport);\n        return { annotation: holeAnnotation, polyline };\n    });\n}\nfunction combinePolylines(viewport, targetAnnotation, targetPolyline, sourceAnnotation, sourcePolyline) {\n    if (!hasToolByName(DEFAULT_CONTOUR_SEG_TOOL_NAME)) {\n        console.warn(`${DEFAULT_CONTOUR_SEG_TOOL_NAME} is not registered in cornerstone`);\n        return;\n    }\n    if (!isFreehandContourSegToolRegisteredForViewport(viewport)) {\n        return;\n    }\n    const sourceStartPoint = sourcePolyline[0];\n    const mergePolylines = math.polyline.containsPoint(targetPolyline, sourceStartPoint);\n    const contourHolesData = getContourHolesData(viewport, targetAnnotation);\n    const unassignedContourHolesSet = new Set(contourHolesData);\n    const reassignedContourHolesMap = new Map();\n    const assignHoleToPolyline = (parentPolyline, holeData) => {\n        let holes = reassignedContourHolesMap.get(parentPolyline);\n        if (!holes) {\n            holes = [];\n            reassignedContourHolesMap.set(parentPolyline, holes);\n        }\n        holes.push(holeData);\n        unassignedContourHolesSet.delete(holeData);\n    };\n    const newPolylines = [];\n    if (mergePolylines) {\n        const mergedPolyline = math.polyline.mergePolylines(targetPolyline, sourcePolyline);\n        newPolylines.push(mergedPolyline);\n        Array.from(unassignedContourHolesSet.keys()).forEach((holeData) => assignHoleToPolyline(mergedPolyline, holeData));\n    }\n    else {\n        const subtractedPolylines = math.polyline.subtractPolylines(targetPolyline, sourcePolyline);\n        subtractedPolylines.forEach((newPolyline) => {\n            newPolylines.push(newPolyline);\n            Array.from(unassignedContourHolesSet.keys()).forEach((holeData) => {\n                const containsHole = math.polyline.containsPoints(newPolyline, holeData.polyline);\n                if (containsHole) {\n                    assignHoleToPolyline(newPolyline, holeData);\n                    unassignedContourHolesSet.delete(holeData);\n                }\n            });\n        });\n    }\n    Array.from(reassignedContourHolesMap.values()).forEach((contourHolesDataArray) => contourHolesDataArray.forEach((contourHoleData) => clearParentAnnotation(contourHoleData.annotation)));\n    const { element } = viewport;\n    const enabledElement = getEnabledElement(element);\n    const { metadata, data } = targetAnnotation;\n    const { handles, segmentation } = data;\n    const { textBox } = handles;\n    removeAnnotation(sourceAnnotation.annotationUID);\n    removeAnnotation(targetAnnotation.annotationUID);\n    for (let i = 0; i < newPolylines.length; i++) {\n        const polyline = newPolylines[i];\n        const startPoint = viewport.canvasToWorld(polyline[0]);\n        const endPoint = viewport.canvasToWorld(polyline[polyline.length - 1]);\n        const newAnnotation = {\n            metadata: {\n                ...metadata,\n                toolName: DEFAULT_CONTOUR_SEG_TOOL_NAME,\n                originalToolName: metadata.originalToolName || metadata.toolName,\n            },\n            data: {\n                cachedStats: {},\n                handles: {\n                    points: [startPoint, endPoint],\n                    textBox: textBox ? { ...textBox } : undefined,\n                },\n                contour: {\n                    polyline: [],\n                    closed: true,\n                },\n                spline: targetAnnotation.data.spline,\n                segmentation: {\n                    ...segmentation,\n                },\n            },\n            annotationUID: csUtils.uuidv4(),\n            highlighted: true,\n            invalidated: true,\n            isLocked: false,\n            isVisible: undefined,\n            interpolationUID: targetAnnotation.interpolationUID,\n            interpolationCompleted: targetAnnotation.interpolationCompleted,\n        };\n        updateContourPolyline(newAnnotation, {\n            points: polyline,\n            closed: true,\n            targetWindingDirection: ContourWindingDirection.Clockwise,\n        }, viewport);\n        addAnnotation(newAnnotation, element);\n        addContourSegmentationAnnotation(newAnnotation);\n        triggerAnnotationModified(newAnnotation, viewport.element);\n        reassignedContourHolesMap\n            .get(polyline)\n            ?.forEach((holeData) => addChildAnnotation(newAnnotation, holeData.annotation));\n    }\n    updateViewports(enabledElement, targetAnnotation, sourceAnnotation);\n}\nfunction updateViewports(enabledElement, targetAnnotation, sourceAnnotation) {\n    const { viewport } = enabledElement;\n    const { element } = viewport;\n    const updatedTtoolNames = new Set([\n        DEFAULT_CONTOUR_SEG_TOOL_NAME,\n        targetAnnotation.metadata.toolName,\n        sourceAnnotation.metadata.toolName,\n    ]);\n    for (const toolName of updatedTtoolNames.values()) {\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, toolName);\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n    }\n    return new Promise((resolve) => window.requestAnimationFrame(resolve));\n}\n","import mouseDoubleClickListener from './mouseDoubleClickListener';\nimport mouseDownListener, { mouseDoubleClickIgnoreListener, } from './mouseDownListener';\nimport mouseMoveListener from './mouseMoveListener';\nfunction disable(element) {\n    element.removeEventListener('dblclick', mouseDoubleClickListener);\n    element.removeEventListener('mousedown', mouseDownListener);\n    element.removeEventListener('mousemove', mouseMoveListener);\n    element.removeEventListener('dblclick', mouseDoubleClickIgnoreListener, {\n        capture: true,\n    });\n}\nfunction enable(element) {\n    disable(element);\n    element.addEventListener('dblclick', mouseDoubleClickListener);\n    element.addEventListener('mousedown', mouseDownListener);\n    element.addEventListener('mousemove', mouseMoveListener);\n    element.addEventListener('dblclick', mouseDoubleClickIgnoreListener, {\n        capture: true,\n    });\n}\nexport default {\n    enable,\n    disable,\n};\n","import preventGhostClick from './preventGhostClick';\nimport touchStartListener from './touchStartListener';\nfunction disable(element) {\n    preventGhostClick.disable(element);\n    element.removeEventListener('touchstart', touchStartListener);\n}\nfunction enable(element) {\n    disable(element);\n    preventGhostClick.enable(element);\n    element.addEventListener('touchstart', touchStartListener, {\n        passive: false,\n    });\n}\nexport default {\n    enable,\n    disable,\n};\n","import wheelListener from './wheelListener';\nfunction enable(element) {\n    disable(element);\n    element.addEventListener('wheel', wheelListener, { passive: false });\n}\nfunction disable(element) {\n    element.removeEventListener('wheel', wheelListener);\n}\nexport default {\n    enable,\n    disable,\n};\n","import { cache, utilities as csUtils, VolumeViewport, getEnabledElementByViewportId, StackViewport, } from '@cornerstonejs/core';\nimport * as SegmentationState from '../../../stateManagement/segmentation/segmentationState';\nimport { SegmentationRepresentations } from '../../../enums';\nimport { getLabelmapActorEntry } from '../../../stateManagement/segmentation/helpers/getSegmentationActor';\nconst onLabelmapSegmentationDataModified = function (evt) {\n    const { segmentationId, modifiedSlicesToUse } = evt.detail;\n    const { representationData } = SegmentationState.getSegmentation(segmentationId);\n    const viewportIds = SegmentationState.getViewportIdsWithSegmentation(segmentationId);\n    const hasVolumeViewport = viewportIds.some((viewportId) => {\n        const { viewport } = getEnabledElementByViewportId(viewportId);\n        return viewport instanceof VolumeViewport;\n    });\n    const hasStackViewport = viewportIds.some((viewportId) => {\n        const { viewport } = getEnabledElementByViewportId(viewportId);\n        return viewport instanceof StackViewport;\n    });\n    const hasBothStackAndVolume = hasVolumeViewport && hasStackViewport;\n    viewportIds.forEach((viewportId) => {\n        const { viewport } = getEnabledElementByViewportId(viewportId);\n        if (viewport instanceof VolumeViewport) {\n            performVolumeLabelmapUpdate({\n                modifiedSlicesToUse: hasBothStackAndVolume ? [] : modifiedSlicesToUse,\n                representationData,\n                type: SegmentationRepresentations.Labelmap,\n            });\n        }\n        if (viewport instanceof StackViewport) {\n            performStackLabelmapUpdate({\n                viewportIds,\n                segmentationId,\n            });\n        }\n    });\n};\nfunction performVolumeLabelmapUpdate({ modifiedSlicesToUse, representationData, type, }) {\n    const segmentationVolume = cache.getVolume(representationData[type].volumeId);\n    if (!segmentationVolume) {\n        console.warn('segmentation not found in cache');\n        return;\n    }\n    const { imageData, vtkOpenGLTexture } = segmentationVolume;\n    let slicesToUpdate;\n    if (modifiedSlicesToUse?.length > 0) {\n        slicesToUpdate = modifiedSlicesToUse;\n    }\n    else {\n        const numSlices = imageData.getDimensions()[2];\n        slicesToUpdate = [...Array(numSlices).keys()];\n    }\n    slicesToUpdate.forEach((i) => {\n        vtkOpenGLTexture.setUpdatedFrame(i);\n    });\n    imageData.modified();\n}\nfunction performStackLabelmapUpdate({ viewportIds, segmentationId }) {\n    viewportIds.forEach((viewportId) => {\n        let representations = SegmentationState.getSegmentationRepresentations(viewportId, { segmentationId });\n        representations = representations.filter((representation) => representation.type === SegmentationRepresentations.Labelmap);\n        representations.forEach((representation) => {\n            if (representation.segmentationId !== segmentationId) {\n                return;\n            }\n            const enabledElement = getEnabledElementByViewportId(viewportId);\n            if (!enabledElement) {\n                return;\n            }\n            const { viewport } = enabledElement;\n            if (viewport instanceof VolumeViewport) {\n                return;\n            }\n            const actorEntry = getLabelmapActorEntry(viewportId, segmentationId);\n            if (!actorEntry) {\n                return;\n            }\n            const segImageData = actorEntry.actor.getMapper().getInputData();\n            const currentSegmentationImageId = SegmentationState.getCurrentLabelmapImageIdForViewport(viewportId, segmentationId);\n            const segmentationImage = cache.getImage(currentSegmentationImageId);\n            segImageData.modified();\n            csUtils.updateVTKImageDataWithCornerstoneImage(segImageData, segmentationImage);\n        });\n    });\n}\nexport default onLabelmapSegmentationDataModified;\n","import { triggerSegmentationRenderBySegmentationId } from '../../stateManagement/segmentation/SegmentationRenderingEngine';\nimport onLabelmapSegmentationDataModified from './labelmap/onLabelmapSegmentationDataModified';\nimport { getSegmentation } from '../../stateManagement/segmentation/getSegmentation';\nconst onSegmentationDataModified = function (evt) {\n    const { segmentationId } = evt.detail;\n    const { representationData } = getSegmentation(segmentationId);\n    if (representationData.Labelmap) {\n        onLabelmapSegmentationDataModified(evt);\n    }\n    triggerSegmentationRenderBySegmentationId(segmentationId);\n};\nexport default onSegmentationDataModified;\n","import { triggerSegmentationRenderBySegmentationId } from '../../stateManagement/segmentation/SegmentationRenderingEngine';\nconst segmentationModifiedListener = function (evt) {\n    const { segmentationId } = evt.detail;\n    triggerSegmentationRenderBySegmentationId(segmentationId);\n};\nexport default segmentationModifiedListener;\n","import vtkDataArray from '@kitware/vtk.js/Common/Core/DataArray';\nimport vtkImageData from '@kitware/vtk.js/Common/DataModel/ImageData';\nimport { BaseVolumeViewport, getEnabledElement, Enums, getEnabledElementByIds, cache, utilities, } from '@cornerstonejs/core';\nimport { triggerSegmentationRender } from '../../stateManagement/segmentation/SegmentationRenderingEngine';\nimport { updateLabelmapSegmentationImageReferences } from '../../stateManagement/segmentation/updateLabelmapSegmentationImageReferences';\nimport { getCurrentLabelmapImageIdForViewport } from '../../stateManagement/segmentation/getCurrentLabelmapImageIdForViewport';\nimport { SegmentationRepresentations } from '../../enums';\nimport { getLabelmapActorEntry } from '../../stateManagement/segmentation/helpers/getSegmentationActor';\nimport { getSegmentationRepresentations } from '../../stateManagement/segmentation/getSegmentationRepresentation';\nconst enable = function (element) {\n    const { viewport } = getEnabledElement(element);\n    if (viewport instanceof BaseVolumeViewport) {\n        return;\n    }\n    element.addEventListener(Enums.Events.STACK_NEW_IMAGE, _imageChangeEventListener);\n    element.addEventListener(Enums.Events.IMAGE_RENDERED, _imageChangeEventListener);\n};\nconst disable = function (element) {\n    element.removeEventListener(Enums.Events.STACK_NEW_IMAGE, _imageChangeEventListener);\n    element.removeEventListener(Enums.Events.IMAGE_RENDERED, _imageChangeEventListener);\n};\nconst perViewportManualTriggers = new Map();\nfunction _imageChangeEventListener(evt) {\n    const eventData = evt.detail;\n    const { viewportId, renderingEngineId } = eventData;\n    const { viewport } = getEnabledElementByIds(viewportId, renderingEngineId);\n    const representations = getSegmentationRepresentations(viewportId);\n    if (!representations?.length) {\n        return;\n    }\n    const labelmapRepresentations = representations.filter((representation) => representation.type === SegmentationRepresentations.Labelmap);\n    const actors = viewport.getActors();\n    labelmapRepresentations.forEach((representation) => {\n        const { segmentationId } = representation;\n        updateLabelmapSegmentationImageReferences(viewportId, segmentationId);\n    });\n    const labelmapActors = labelmapRepresentations\n        .map((representation) => {\n        return getLabelmapActorEntry(viewportId, representation.segmentationId);\n    })\n        .filter((actor) => actor !== undefined);\n    if (!labelmapActors.length) {\n        return;\n    }\n    labelmapActors.forEach((actor) => {\n        const validActor = labelmapRepresentations.find((representation) => {\n            const derivedImageId = getCurrentLabelmapImageIdForViewport(viewportId, representation.segmentationId);\n            return derivedImageId === actor.referencedId;\n        });\n        if (!validActor) {\n            viewport.removeActors([actor.uid]);\n        }\n    });\n    labelmapRepresentations.forEach((representation) => {\n        const { segmentationId } = representation;\n        const currentImageId = viewport.getCurrentImageId();\n        const derivedImageId = getCurrentLabelmapImageIdForViewport(viewportId, segmentationId);\n        if (!derivedImageId) {\n            return;\n        }\n        const derivedImage = cache.getImage(derivedImageId);\n        if (!derivedImage) {\n            console.warn('No derived image found in the cache for segmentation representation', representation);\n            return;\n        }\n        const segmentationActorInput = actors.find((actor) => actor.referencedId === derivedImageId);\n        if (!segmentationActorInput) {\n            const { dimensions, spacing, direction } = viewport.getImageDataMetadata(derivedImage);\n            const currentImage = cache.getImage(currentImageId) ||\n                {\n                    imageId: currentImageId,\n                };\n            const { origin: currentOrigin } = viewport.getImageDataMetadata(currentImage);\n            const originToUse = currentOrigin;\n            const constructor = derivedImage.voxelManager.getConstructor();\n            const newPixelData = derivedImage.voxelManager.getScalarData();\n            const scalarArray = vtkDataArray.newInstance({\n                name: 'Pixels',\n                numberOfComponents: 1,\n                values: new constructor(newPixelData),\n            });\n            const imageData = vtkImageData.newInstance();\n            imageData.setDimensions(dimensions[0], dimensions[1], 1);\n            imageData.setSpacing(spacing);\n            imageData.setDirection(direction);\n            imageData.setOrigin(originToUse);\n            imageData.getPointData().setScalars(scalarArray);\n            imageData.modified();\n            viewport.addImages([\n                {\n                    imageId: derivedImageId,\n                    representationUID: `${segmentationId}-${SegmentationRepresentations.Labelmap}`,\n                    callback: ({ imageActor }) => {\n                        imageActor.getMapper().setInputData(imageData);\n                    },\n                },\n            ]);\n            triggerSegmentationRender(viewportId);\n            return;\n        }\n        else {\n            const segmentationImageData = segmentationActorInput.actor\n                .getMapper()\n                .getInputData();\n            if (segmentationImageData.setDerivedImage) {\n                segmentationImageData.setDerivedImage(derivedImage);\n            }\n            else {\n                utilities.updateVTKImageDataWithCornerstoneImage(segmentationImageData, derivedImage);\n            }\n        }\n        viewport.render();\n        if (evt.type === Enums.Events.IMAGE_RENDERED) {\n            viewport.element.removeEventListener(Enums.Events.IMAGE_RENDERED, _imageChangeEventListener);\n        }\n    });\n}\nexport default {\n    enable,\n    disable,\n};\n","import * as contourSegUtils from '../../utilities/contourSegmentation';\nimport { contourSegmentationCompleted } from './contourSegmentation';\nexport default function annotationCompletedListener(evt) {\n    const annotation = evt.detail.annotation;\n    if (contourSegUtils.isContourSegmentationAnnotation(annotation)) {\n        contourSegmentationCompleted(evt);\n    }\n}\n","import { getRenderingEngines } from '@cornerstonejs/core';\nimport { triggerAnnotationRenderForViewportIds } from '../../utilities/triggerAnnotationRenderForViewportIds';\nfunction annotationSelectionListener(evt) {\n    const deselectedAnnotation = evt.detail.removed;\n    if (!deselectedAnnotation.length) {\n        return;\n    }\n    const renderingEngines = getRenderingEngines();\n    renderingEngines.forEach((renderingEngine) => {\n        const viewports = renderingEngine.getViewports();\n        const viewportIds = viewports.map((vp) => vp.id);\n        triggerAnnotationRenderForViewportIds(viewportIds);\n    });\n}\nexport default annotationSelectionListener;\n","import triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nfunction annotationModifiedListener(evt) {\n    const { viewportId } = evt.detail;\n    triggerAnnotationRenderForViewportIds([viewportId]);\n}\nexport default annotationModifiedListener;\n","import * as contourSegUtils from '../../utilities/contourSegmentation';\nimport { contourSegmentationRemoved } from './contourSegmentation';\nexport default function annotationRemovedListener(evt) {\n    const annotation = evt.detail.annotation;\n    if (contourSegUtils.isContourSegmentationAnnotation(annotation)) {\n        contourSegmentationRemoved(evt);\n    }\n}\n","import { removeContourSegmentationAnnotation } from '../../../utilities/contourSegmentation';\nexport default function contourSegmentationRemovedListener(evt) {\n    const annotation = evt.detail.annotation;\n    removeContourSegmentationAnnotation(annotation);\n}\n","import { Enums } from '@cornerstonejs/core';\nimport triggerAnnotationRender from '../utilities/triggerAnnotationRender';\nconst onImageRendered = function (evt) {\n    triggerAnnotationRender(evt.detail.element);\n};\nconst enable = function (element) {\n    element.addEventListener(Enums.Events.IMAGE_RENDERED, onImageRendered);\n};\nconst disable = function (element) {\n    element.removeEventListener(Enums.Events.IMAGE_RENDERED, onImageRendered);\n};\nexport default {\n    enable,\n    disable,\n};\n","import Events from '../enums/Events';\nimport { mouseClick, mouseDown, mouseDownActivate, mouseDoubleClick, mouseDrag, mouseMove, mouseUp, mouseWheel, } from './mouseEventHandlers';\nconst enable = function (element) {\n    element.addEventListener(Events.MOUSE_CLICK, mouseClick);\n    element.addEventListener(Events.MOUSE_DOWN, mouseDown);\n    element.addEventListener(Events.MOUSE_DOWN_ACTIVATE, mouseDownActivate);\n    element.addEventListener(Events.MOUSE_DOUBLE_CLICK, mouseDoubleClick);\n    element.addEventListener(Events.MOUSE_DRAG, mouseDrag);\n    element.addEventListener(Events.MOUSE_MOVE, mouseMove);\n    element.addEventListener(Events.MOUSE_UP, mouseUp);\n    element.addEventListener(Events.MOUSE_WHEEL, mouseWheel);\n};\nconst disable = function (element) {\n    element.removeEventListener(Events.MOUSE_CLICK, mouseClick);\n    element.removeEventListener(Events.MOUSE_DOWN, mouseDown);\n    element.removeEventListener(Events.MOUSE_DOWN_ACTIVATE, mouseDownActivate);\n    element.removeEventListener(Events.MOUSE_DOUBLE_CLICK, mouseDoubleClick);\n    element.removeEventListener(Events.MOUSE_DRAG, mouseDrag);\n    element.removeEventListener(Events.MOUSE_MOVE, mouseMove);\n    element.removeEventListener(Events.MOUSE_UP, mouseUp);\n    element.removeEventListener(Events.MOUSE_WHEEL, mouseWheel);\n};\nconst mouseToolEventDispatcher = {\n    enable,\n    disable,\n};\nexport default mouseToolEventDispatcher;\n","import Events from '../enums/Events';\nimport { keyDown, keyUp } from './keyboardEventHandlers';\nconst enable = function (element) {\n    element.addEventListener(Events.KEY_DOWN, keyDown);\n    element.addEventListener(Events.KEY_UP, keyUp);\n};\nconst disable = function (element) {\n    element.removeEventListener(Events.KEY_DOWN, keyDown);\n    element.removeEventListener(Events.KEY_UP, keyUp);\n};\nconst keyboardToolEventDispatcher = {\n    enable,\n    disable,\n};\nexport default keyboardToolEventDispatcher;\n","import { Enums } from '@cornerstonejs/core';\nimport { ToolModes } from '../enums';\nimport getToolsWithModesForMouseEvent from './shared/getToolsWithModesForMouseEvent';\nconst { Active, Passive, Enabled } = ToolModes;\nconst onCameraModified = function (evt) {\n    const enabledTools = getToolsWithModesForMouseEvent(evt, [\n        Active,\n        Passive,\n        Enabled,\n    ]);\n    enabledTools.forEach((tool) => {\n        if (tool.onCameraModified) {\n            tool.onCameraModified(evt);\n        }\n    });\n};\nconst enable = function (element) {\n    element.addEventListener(Enums.Events.CAMERA_MODIFIED, onCameraModified);\n};\nconst disable = function (element) {\n    element.removeEventListener(Enums.Events.CAMERA_MODIFIED, onCameraModified);\n};\nexport default {\n    enable,\n    disable,\n};\n","import { Enums } from '@cornerstonejs/core';\nimport { ToolModes } from '../enums';\nimport getToolsWithModesForMouseEvent from './shared/getToolsWithModesForMouseEvent';\nconst { Active, Passive, Enabled } = ToolModes;\nconst onImageSpacingCalibrated = function (evt) {\n    const enabledTools = getToolsWithModesForMouseEvent(evt, [\n        Active,\n        Passive,\n        Enabled,\n    ]);\n    enabledTools.forEach((tool) => {\n        if (tool.onImageSpacingCalibrated) {\n            tool.onImageSpacingCalibrated(evt);\n        }\n    });\n};\nconst enable = function (element) {\n    element.addEventListener(Enums.Events.IMAGE_SPACING_CALIBRATED, onImageSpacingCalibrated);\n};\nconst disable = function (element) {\n    element.removeEventListener(Enums.Events.IMAGE_SPACING_CALIBRATED, onImageSpacingCalibrated);\n};\nexport default {\n    enable,\n    disable,\n};\n","import Events from '../enums/Events';\nimport { touchStart, touchStartActivate, touchDrag, touchEnd, touchTap, touchPress, } from './touchEventHandlers';\nconst enable = function (element) {\n    element.addEventListener(Events.TOUCH_START, touchStart);\n    element.addEventListener(Events.TOUCH_START_ACTIVATE, touchStartActivate);\n    element.addEventListener(Events.TOUCH_DRAG, touchDrag);\n    element.addEventListener(Events.TOUCH_END, touchEnd);\n    element.addEventListener(Events.TOUCH_TAP, touchTap);\n    element.addEventListener(Events.TOUCH_PRESS, touchPress);\n};\nconst disable = function (element) {\n    element.removeEventListener(Events.TOUCH_START, touchStart);\n    element.removeEventListener(Events.TOUCH_START_ACTIVATE, touchStartActivate);\n    element.removeEventListener(Events.TOUCH_DRAG, touchDrag);\n    element.removeEventListener(Events.TOUCH_END, touchEnd);\n    element.removeEventListener(Events.TOUCH_PRESS, touchPress);\n};\nconst touchToolEventDispatcher = {\n    enable,\n    disable,\n};\nexport default touchToolEventDispatcher;\n","import { eventTarget } from '@cornerstonejs/core';\nimport Events from '../enums/Events';\nimport InterpolationManager from '../utilities/segmentation/InterpolationManager/InterpolationManager';\nconst enable = function () {\n    eventTarget.addEventListener(Events.ANNOTATION_COMPLETED, InterpolationManager.handleAnnotationCompleted);\n    eventTarget.addEventListener(Events.ANNOTATION_MODIFIED, InterpolationManager.handleAnnotationUpdate);\n    eventTarget.addEventListener(Events.ANNOTATION_REMOVED, InterpolationManager.handleAnnotationDelete);\n};\nconst disable = function () {\n    eventTarget.removeEventListener(Events.ANNOTATION_COMPLETED, InterpolationManager.handleAnnotationCompleted);\n    eventTarget.removeEventListener(Events.ANNOTATION_MODIFIED, InterpolationManager.handleAnnotationUpdate);\n    eventTarget.removeEventListener(Events.ANNOTATION_REMOVED, InterpolationManager.handleAnnotationDelete);\n};\nexport default {\n    enable,\n    disable,\n};\n","import { Enums } from '@cornerstonejs/core';\nimport { ToolModes } from '../enums';\nimport getToolsWithModesForMouseEvent from './shared/getToolsWithModesForMouseEvent';\nconst { Active, Passive, Enabled } = ToolModes;\nconst onCameraReset = function (evt) {\n    const enabledTools = getToolsWithModesForMouseEvent(evt, [\n        Active,\n        Passive,\n        Enabled,\n    ]);\n    enabledTools.forEach((tool) => {\n        if (tool.onResetCamera) {\n            tool.onResetCamera(evt);\n        }\n    });\n};\nconst enable = function (element) {\n    element.addEventListener(Enums.Events.CAMERA_RESET, onCameraReset);\n};\nconst disable = function (element) {\n    element.removeEventListener(Enums.Events.CAMERA_RESET, onCameraReset);\n};\nexport default {\n    enable,\n    disable,\n};\n","import { mouseEventListeners, wheelEventListener, touchEventListeners, keyEventListener, imageChangeEventListener, } from '../eventListeners';\nimport { imageRenderedEventDispatcher, cameraModifiedEventDispatcher, mouseToolEventDispatcher, touchToolEventDispatcher, keyboardToolEventDispatcher, imageSpacingCalibratedEventDispatcher, cameraResetEventDispatcher, } from '../eventDispatchers';\nimport { state } from './state';\nimport { annotationRenderingEngine } from '../stateManagement/annotation/AnnotationRenderingEngine';\nexport default function addEnabledElement(evt) {\n    const { element, viewportId } = evt.detail;\n    const svgLayer = _createSvgAnnotationLayer(viewportId);\n    _setSvgNodeCache(element);\n    _appendChild(svgLayer, element);\n    annotationRenderingEngine.addViewportElement(viewportId, element);\n    mouseEventListeners.enable(element);\n    wheelEventListener.enable(element);\n    touchEventListeners.enable(element);\n    keyEventListener.enable(element);\n    imageChangeEventListener.enable(element);\n    imageRenderedEventDispatcher.enable(element);\n    cameraModifiedEventDispatcher.enable(element);\n    imageSpacingCalibratedEventDispatcher.enable(element);\n    cameraResetEventDispatcher.enable(element);\n    mouseToolEventDispatcher.enable(element);\n    keyboardToolEventDispatcher.enable(element);\n    touchToolEventDispatcher.enable(element);\n    state.enabledElements.push(element);\n}\nfunction _createSvgAnnotationLayer(viewportId) {\n    const svgns = 'http://www.w3.org/2000/svg';\n    const svgLayer = document.createElementNS(svgns, 'svg');\n    const svgLayerId = `svg-layer-${viewportId}`;\n    svgLayer.classList.add('svg-layer');\n    svgLayer.setAttribute('id', svgLayerId);\n    svgLayer.setAttribute('xmlns', 'http://www.w3.org/2000/svg');\n    svgLayer.style.width = '100%';\n    svgLayer.style.height = '100%';\n    svgLayer.style.pointerEvents = 'none';\n    svgLayer.style.position = 'absolute';\n    const defs = document.createElementNS(svgns, 'defs');\n    const filter = document.createElementNS(svgns, 'filter');\n    const feOffset = document.createElementNS(svgns, 'feOffset');\n    const feColorMatrix = document.createElementNS(svgns, 'feColorMatrix');\n    const feBlend = document.createElementNS(svgns, 'feBlend');\n    filter.setAttribute('id', `shadow-${svgLayerId}`);\n    filter.setAttribute('filterUnits', 'userSpaceOnUse');\n    feOffset.setAttribute('result', 'offOut');\n    feOffset.setAttribute('in', 'SourceGraphic');\n    feOffset.setAttribute('dx', '0.5');\n    feOffset.setAttribute('dy', '0.5');\n    feColorMatrix.setAttribute('result', 'matrixOut');\n    feColorMatrix.setAttribute('in', 'offOut');\n    feColorMatrix.setAttribute('in2', 'matrix');\n    feColorMatrix.setAttribute('values', '0.2 0 0 0 0 0 0.2 0 0 0 0 0 0.2 0 0 0 0 0 1 0');\n    feBlend.setAttribute('in', 'SourceGraphic');\n    feBlend.setAttribute('in2', 'matrixOut');\n    feBlend.setAttribute('mode', 'normal');\n    filter.appendChild(feOffset);\n    filter.appendChild(feColorMatrix);\n    filter.appendChild(feBlend);\n    defs.appendChild(filter);\n    svgLayer.appendChild(defs);\n    return svgLayer;\n}\nfunction _setSvgNodeCache(element) {\n    const { viewportUid: viewportId, renderingEngineUid: renderingEngineId } = element.dataset;\n    const elementHash = `${viewportId}:${renderingEngineId}`;\n    state.svgNodeCache[elementHash] = {};\n}\nfunction _appendChild(newNode, referenceNode) {\n    referenceNode.querySelector('div.viewport-element').appendChild(newNode);\n}\n","import { state } from '../state';\nfunction getSynchronizersForViewport(viewportId, renderingEngineId) {\n    const synchronizersFilteredByIds = [];\n    if (!renderingEngineId && !viewportId) {\n        throw new Error('At least one of renderingEngineId or viewportId should be given');\n    }\n    for (let i = 0; i < state.synchronizers.length; i++) {\n        const synchronizer = state.synchronizers[i];\n        const notDisabled = !synchronizer.isDisabled();\n        const hasSourceViewport = synchronizer.hasSourceViewport(renderingEngineId, viewportId);\n        const hasTargetViewport = synchronizer.hasTargetViewport(renderingEngineId, viewportId);\n        if (notDisabled && (hasSourceViewport || hasTargetViewport)) {\n            synchronizersFilteredByIds.push(synchronizer);\n        }\n    }\n    return synchronizersFilteredByIds;\n}\nexport default getSynchronizersForViewport;\n","import { getEnabledElement } from '@cornerstonejs/core';\nimport { mouseEventListeners, wheelEventListener, touchEventListeners, keyEventListener, imageChangeEventListener, } from '../eventListeners';\nimport { imageRenderedEventDispatcher, cameraModifiedEventDispatcher, mouseToolEventDispatcher, keyboardToolEventDispatcher, imageSpacingCalibratedEventDispatcher, touchToolEventDispatcher, cameraResetEventDispatcher, } from '../eventDispatchers';\nimport filterToolsWithAnnotationsForElement from './filterToolsWithAnnotationsForElement';\nimport { state } from './state';\nimport getToolsWithModesForElement from '../utilities/getToolsWithModesForElement';\nimport { ToolModes } from '../enums';\nimport { removeAnnotation } from '../stateManagement';\nimport getSynchronizersForViewport from './SynchronizerManager/getSynchronizersForViewport';\nimport getToolGroupForViewport from './ToolGroupManager/getToolGroupForViewport';\nimport { annotationRenderingEngine } from '../stateManagement/annotation/AnnotationRenderingEngine';\nconst VIEWPORT_ELEMENT = 'viewport-element';\nfunction removeEnabledElement(elementDisabledEvt) {\n    const { element, viewportId } = elementDisabledEvt.detail;\n    _resetSvgNodeCache(element);\n    _removeSvgNode(element);\n    annotationRenderingEngine.removeViewportElement(viewportId, element);\n    mouseEventListeners.disable(element);\n    wheelEventListener.disable(element);\n    touchEventListeners.disable(element);\n    keyEventListener.disable(element);\n    imageChangeEventListener.disable(element);\n    imageRenderedEventDispatcher.disable(element);\n    cameraModifiedEventDispatcher.disable(element);\n    imageSpacingCalibratedEventDispatcher.disable(element);\n    cameraResetEventDispatcher.disable(element);\n    mouseToolEventDispatcher.disable(element);\n    keyboardToolEventDispatcher.disable(element);\n    touchToolEventDispatcher.disable(element);\n    _removeViewportFromSynchronizers(element);\n    _removeViewportFromToolGroup(element);\n    _removeEnabledElement(element);\n}\nconst _removeViewportFromSynchronizers = (element) => {\n    const enabledElement = getEnabledElement(element);\n    const synchronizers = getSynchronizersForViewport(enabledElement.viewportId, enabledElement.renderingEngineId);\n    synchronizers.forEach((sync) => {\n        sync.remove(enabledElement);\n    });\n};\nconst _removeViewportFromToolGroup = (element) => {\n    const { renderingEngineId, viewportId } = getEnabledElement(element);\n    const toolGroup = getToolGroupForViewport(viewportId, renderingEngineId);\n    if (toolGroup) {\n        toolGroup.removeViewports(renderingEngineId, viewportId);\n    }\n};\nconst _removeAllToolsForElement = function (element) {\n    const tools = getToolsWithModesForElement(element, [\n        ToolModes.Active,\n        ToolModes.Passive,\n    ]);\n    const toolsWithData = filterToolsWithAnnotationsForElement(element, tools);\n    toolsWithData.forEach(({ annotations }) => {\n        annotations.forEach((annotation) => {\n            removeAnnotation(annotation.annotationUID);\n        });\n    });\n};\nfunction _resetSvgNodeCache(element) {\n    const { viewportUid: viewportId, renderingEngineUid: renderingEngineId } = element.dataset;\n    const elementHash = `${viewportId}:${renderingEngineId}`;\n    delete state.svgNodeCache[elementHash];\n}\nfunction _removeSvgNode(element) {\n    const internalViewportNode = element.querySelector(`div.${VIEWPORT_ELEMENT}`);\n    const svgLayer = internalViewportNode.querySelector('svg');\n    if (svgLayer) {\n        internalViewportNode.removeChild(svgLayer);\n    }\n}\nconst _removeEnabledElement = function (element) {\n    const foundElementIndex = state.enabledElements.findIndex((el) => el === element);\n    if (foundElementIndex > -1) {\n        state.enabledElements.splice(foundElementIndex, 1);\n    }\n};\nexport default removeEnabledElement;\n","import { ToolModes } from '../enums';\nimport getToolsWithModesForElement from '../utilities/getToolsWithModesForElement';\nimport filterToolsWithAnnotationsForElement from './filterToolsWithAnnotationsForElement';\nexport default function cancelActiveManipulations(element) {\n    const tools = getToolsWithModesForElement(element, [\n        ToolModes.Active,\n        ToolModes.Passive,\n    ]);\n    const toolsWithData = filterToolsWithAnnotationsForElement(element, tools);\n    for (const { tool } of toolsWithData) {\n        const annotationUID = tool.cancel(element);\n        if (annotationUID) {\n            return annotationUID;\n        }\n    }\n}\n","import { getRenderingEngine, getEnabledElement, eventTarget, Enums, getEnabledElementByViewportId, } from '@cornerstonejs/core';\nclass Synchronizer {\n    constructor(synchronizerId, eventName, eventHandler, options) {\n        this._viewportOptions = {};\n        this._onEvent = (evt) => {\n            if (this._ignoreFiredEvents === true) {\n                return;\n            }\n            if (!this._targetViewports.length) {\n                return;\n            }\n            const enabledElement = this._eventSource === 'element'\n                ? getEnabledElement(evt.currentTarget)\n                : getEnabledElementByViewportId(evt.detail?.viewportId);\n            if (!enabledElement) {\n                return;\n            }\n            const { renderingEngineId, viewportId } = enabledElement;\n            if (!this._sourceViewports.find((s) => s.viewportId === viewportId)) {\n                return;\n            }\n            this.fireEvent({\n                renderingEngineId,\n                viewportId,\n            }, evt);\n        };\n        this._enabled = true;\n        this._eventName = eventName;\n        this._eventHandler = eventHandler;\n        this._ignoreFiredEvents = false;\n        this._sourceViewports = [];\n        this._targetViewports = [];\n        this._options = options || {};\n        this._eventSource = this._options.eventSource || 'element';\n        this._auxiliaryEvents = this._options.auxiliaryEvents || [];\n        this.id = synchronizerId;\n    }\n    isDisabled() {\n        return !this._enabled || !this._hasSourceElements();\n    }\n    setOptions(viewportId, options = {}) {\n        this._viewportOptions[viewportId] = options;\n    }\n    setEnabled(enabled) {\n        this._enabled = enabled;\n    }\n    getOptions(viewportId) {\n        return this._viewportOptions[viewportId];\n    }\n    add(viewportInfo) {\n        this.addTarget(viewportInfo);\n        this.addSource(viewportInfo);\n    }\n    addSource(viewportInfo) {\n        if (_containsViewport(this._sourceViewports, viewportInfo)) {\n            return;\n        }\n        const { renderingEngineId, viewportId } = viewportInfo;\n        const viewport = getRenderingEngine(renderingEngineId).getViewport(viewportId);\n        if (!viewport) {\n            console.warn(`Synchronizer.addSource: No viewport for ${renderingEngineId} ${viewportId}`);\n            return;\n        }\n        const eventSource = this._eventSource === 'element' ? viewport.element : eventTarget;\n        eventSource.addEventListener(this._eventName, this._onEvent.bind(this));\n        this._auxiliaryEvents.forEach(({ name, source }) => {\n            const target = source === 'element' ? viewport.element : eventTarget;\n            target.addEventListener(name, this._onEvent.bind(this));\n        });\n        this._updateDisableHandlers();\n        this._sourceViewports.push(viewportInfo);\n    }\n    addTarget(viewportInfo) {\n        if (_containsViewport(this._targetViewports, viewportInfo)) {\n            return;\n        }\n        this._targetViewports.push(viewportInfo);\n        this._updateDisableHandlers();\n    }\n    getSourceViewports() {\n        return this._sourceViewports;\n    }\n    getTargetViewports() {\n        return this._targetViewports;\n    }\n    destroy() {\n        this._sourceViewports.forEach((s) => this.removeSource(s));\n        this._targetViewports.forEach((t) => this.removeTarget(t));\n    }\n    remove(viewportInfo) {\n        this.removeTarget(viewportInfo);\n        this.removeSource(viewportInfo);\n    }\n    removeSource(viewportInfo) {\n        const index = _getViewportIndex(this._sourceViewports, viewportInfo);\n        if (index === -1) {\n            return;\n        }\n        const eventSource = this._eventSource === 'element'\n            ? this.getViewportElement(viewportInfo)\n            : eventTarget;\n        this._sourceViewports.splice(index, 1);\n        eventSource.removeEventListener(this._eventName, this._eventHandler);\n        this._auxiliaryEvents.forEach(({ name, source }) => {\n            const target = source === 'element'\n                ? this.getViewportElement(viewportInfo)\n                : eventTarget;\n            target.removeEventListener(name, this._eventHandler);\n        });\n        this._updateDisableHandlers();\n    }\n    removeTarget(viewportInfo) {\n        const index = _getViewportIndex(this._targetViewports, viewportInfo);\n        if (index === -1) {\n            return;\n        }\n        this._targetViewports.splice(index, 1);\n        this._updateDisableHandlers();\n    }\n    hasSourceViewport(renderingEngineId, viewportId) {\n        return _containsViewport(this._sourceViewports, {\n            renderingEngineId,\n            viewportId,\n        });\n    }\n    hasTargetViewport(renderingEngineId, viewportId) {\n        return _containsViewport(this._targetViewports, {\n            renderingEngineId,\n            viewportId,\n        });\n    }\n    fireEvent(sourceViewport, sourceEvent) {\n        if (this.isDisabled() || this._ignoreFiredEvents) {\n            return;\n        }\n        this._ignoreFiredEvents = true;\n        const promises = [];\n        try {\n            for (let i = 0; i < this._targetViewports.length; i++) {\n                const targetViewport = this._targetViewports[i];\n                const targetIsSource = sourceViewport.viewportId === targetViewport.viewportId;\n                if (targetIsSource) {\n                    continue;\n                }\n                const result = this._eventHandler(this, sourceViewport, targetViewport, sourceEvent, this._options);\n                if (result instanceof Promise) {\n                    promises.push(result);\n                }\n            }\n        }\n        catch (ex) {\n            console.warn(`Synchronizer, for: ${this._eventName}`, ex);\n        }\n        finally {\n            if (promises.length) {\n                Promise.allSettled(promises).then(() => {\n                    this._ignoreFiredEvents = false;\n                });\n            }\n            else {\n                this._ignoreFiredEvents = false;\n            }\n        }\n    }\n    _hasSourceElements() {\n        return this._sourceViewports.length !== 0;\n    }\n    _updateDisableHandlers() {\n        const viewports = _getUniqueViewports(this._sourceViewports, this._targetViewports);\n        const _remove = this.remove.bind(this);\n        const disableHandler = (elementDisabledEvent) => {\n            _remove(elementDisabledEvent.detail.element);\n        };\n        viewports.forEach((vp) => {\n            const eventSource = this.getEventSource(vp);\n            eventSource.removeEventListener(Enums.Events.ELEMENT_DISABLED, disableHandler);\n            eventSource.addEventListener(Enums.Events.ELEMENT_DISABLED, disableHandler);\n        });\n    }\n    getEventSource(viewportInfo) {\n        return this._eventSource === 'element'\n            ? this.getViewportElement(viewportInfo)\n            : eventTarget;\n    }\n    getViewportElement(viewportInfo) {\n        const { renderingEngineId, viewportId } = viewportInfo;\n        const renderingEngine = getRenderingEngine(renderingEngineId);\n        if (!renderingEngine) {\n            throw new Error(`No RenderingEngine for Id: ${renderingEngineId}`);\n        }\n        return renderingEngine.getViewport(viewportId).element;\n    }\n}\nfunction _getUniqueViewports(vp1, vp2) {\n    const unique = [];\n    const vps = vp1.concat(vp2);\n    for (let i = 0; i < vps.length; i++) {\n        const vp = vps[i];\n        if (!unique.some((u) => vp.renderingEngineId === u.renderingEngineId &&\n            vp.viewportId === u.viewportId)) {\n            unique.push(vp);\n        }\n    }\n    return unique;\n}\nfunction _getViewportIndex(arr, vp) {\n    return arr.findIndex((ar) => vp.renderingEngineId === ar.renderingEngineId &&\n        vp.viewportId === ar.viewportId);\n}\nfunction _containsViewport(arr, vp) {\n    return arr.some((ar) => ar.renderingEngineId === vp.renderingEngineId &&\n        ar.viewportId === vp.viewportId);\n}\nexport default Synchronizer;\n","import { state } from '../state';\nimport Synchronizer, {} from './Synchronizer';\nfunction createSynchronizer(synchronizerId, eventName, eventHandler, options) {\n    const synchronizerWithSameIdExists = state.synchronizers.some((sync) => sync.id === synchronizerId);\n    if (synchronizerWithSameIdExists) {\n        throw new Error(`Synchronizer with id '${synchronizerId}' already exists.`);\n    }\n    const synchronizer = new Synchronizer(synchronizerId, eventName, eventHandler, options);\n    state.synchronizers.push(synchronizer);\n    return synchronizer;\n}\nexport default createSynchronizer;\n","import { state } from '../state';\nfunction destroy() {\n    while (state.synchronizers.length > 0) {\n        const synchronizer = state.synchronizers.pop();\n        synchronizer.destroy();\n    }\n}\nexport default destroy;\n","import { state } from '../state';\nfunction getSynchronizer(synchronizerId) {\n    return state.synchronizers.find((s) => s.id === synchronizerId);\n}\nexport default getSynchronizer;\n","import { state } from '../state';\nfunction getAllSynchronizers() {\n    return state.synchronizers;\n}\nexport default getAllSynchronizers;\n","import { state } from '../state';\nfunction destroySynchronizer(synchronizerId) {\n    const synchronizerIndex = state.synchronizers.findIndex((sync) => sync.id === synchronizerId);\n    if (synchronizerIndex > -1) {\n        const synchronizer = state.synchronizers[synchronizerIndex];\n        synchronizer.destroy();\n        state.synchronizers.splice(synchronizerIndex, 1);\n    }\n}\nexport default destroySynchronizer;\n","import { triggerSegmentationRender } from '../../stateManagement/segmentation/SegmentationRenderingEngine';\nconst segmentationRepresentationModifiedListener = function (evt) {\n    const { viewportId } = evt.detail;\n    triggerSegmentationRender(viewportId);\n};\nexport default segmentationRepresentationModifiedListener;\n","import { eventTarget, Enums } from '@cornerstonejs/core';\nimport { getAnnotationManager } from './stateManagement/annotation/annotationState';\nimport { Events as TOOLS_EVENTS } from './enums';\nimport { addEnabledElement, removeEnabledElement } from './store';\nimport { resetCornerstoneToolsState } from './store/state';\nimport { annotationCompletedListener, annotationRemovedListener, annotationSelectionListener, annotationModifiedListener, segmentationDataModifiedEventListener, segmentationModifiedListener, } from './eventListeners';\nimport { annotationInterpolationEventDispatcher } from './eventDispatchers';\nimport * as ToolGroupManager from './store/ToolGroupManager';\nimport { defaultSegmentationStateManager } from './stateManagement/segmentation/SegmentationStateManager';\nimport segmentationRepresentationModifiedListener from './eventListeners/segmentation/segmentationRepresentationModifiedListener';\nlet csToolsInitialized = false;\nexport function init(defaultConfiguration = {}) {\n    if (csToolsInitialized) {\n        return;\n    }\n    _addCornerstoneEventListeners();\n    _addCornerstoneToolsEventListeners();\n    csToolsInitialized = true;\n}\nexport function destroy() {\n    _removeCornerstoneEventListeners();\n    _removeCornerstoneToolsEventListeners();\n    ToolGroupManager.destroy();\n    resetCornerstoneToolsState();\n    const annotationManager = getAnnotationManager();\n    const segmentationStateManager = defaultSegmentationStateManager;\n    annotationManager.restoreAnnotations({});\n    segmentationStateManager.resetState();\n    csToolsInitialized = false;\n}\nfunction _addCornerstoneEventListeners() {\n    _removeCornerstoneEventListeners();\n    const elementEnabledEvent = Enums.Events.ELEMENT_ENABLED;\n    const elementDisabledEvent = Enums.Events.ELEMENT_DISABLED;\n    eventTarget.addEventListener(elementEnabledEvent, addEnabledElement);\n    eventTarget.addEventListener(elementDisabledEvent, removeEnabledElement);\n    annotationInterpolationEventDispatcher.enable();\n}\nfunction _removeCornerstoneEventListeners() {\n    const elementEnabledEvent = Enums.Events.ELEMENT_ENABLED;\n    const elementDisabledEvent = Enums.Events.ELEMENT_DISABLED;\n    eventTarget.removeEventListener(elementEnabledEvent, addEnabledElement);\n    eventTarget.removeEventListener(elementDisabledEvent, removeEnabledElement);\n    annotationInterpolationEventDispatcher.disable();\n}\nfunction _addCornerstoneToolsEventListeners() {\n    _removeCornerstoneToolsEventListeners();\n    eventTarget.addEventListener(TOOLS_EVENTS.ANNOTATION_COMPLETED, annotationCompletedListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.ANNOTATION_MODIFIED, annotationModifiedListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.ANNOTATION_SELECTION_CHANGE, annotationSelectionListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.ANNOTATION_SELECTION_CHANGE, annotationSelectionListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.ANNOTATION_REMOVED, annotationRemovedListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.SEGMENTATION_MODIFIED, segmentationModifiedListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.SEGMENTATION_DATA_MODIFIED, segmentationDataModifiedEventListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.SEGMENTATION_REPRESENTATION_MODIFIED, segmentationRepresentationModifiedListener);\n    eventTarget.addEventListener(TOOLS_EVENTS.SEGMENTATION_REPRESENTATION_ADDED, segmentationRepresentationModifiedListener);\n}\nfunction _removeCornerstoneToolsEventListeners() {\n    eventTarget.removeEventListener(TOOLS_EVENTS.ANNOTATION_COMPLETED, annotationCompletedListener);\n    eventTarget.removeEventListener(TOOLS_EVENTS.ANNOTATION_MODIFIED, annotationModifiedListener);\n    eventTarget.removeEventListener(TOOLS_EVENTS.ANNOTATION_SELECTION_CHANGE, annotationSelectionListener);\n    eventTarget.removeEventListener(TOOLS_EVENTS.ANNOTATION_SELECTION_CHANGE, annotationSelectionListener);\n    eventTarget.removeEventListener(TOOLS_EVENTS.SEGMENTATION_MODIFIED, segmentationModifiedListener);\n    eventTarget.removeEventListener(TOOLS_EVENTS.SEGMENTATION_DATA_MODIFIED, segmentationDataModifiedEventListener);\n    eventTarget.removeEventListener(TOOLS_EVENTS.SEGMENTATION_REPRESENTATION_MODIFIED, segmentationRepresentationModifiedListener);\n    eventTarget.removeEventListener(TOOLS_EVENTS.SEGMENTATION_REPRESENTATION_ADDED, segmentationRepresentationModifiedListener);\n}\nexport default init;\n","import { getRenderingEngine } from '@cornerstonejs/core';\nexport default function cameraSyncCallback(synchronizerInstance, sourceViewport, targetViewport, cameraModifiedEvent) {\n    const { camera } = cameraModifiedEvent.detail;\n    const renderingEngine = getRenderingEngine(targetViewport.renderingEngineId);\n    if (!renderingEngine) {\n        throw new Error(`No RenderingEngine for Id: ${targetViewport.renderingEngineId}`);\n    }\n    const tViewport = renderingEngine.getViewport(targetViewport.viewportId);\n    tViewport.setCamera(camera);\n    tViewport.render();\n}\n","import { createSynchronizer } from '../../store/SynchronizerManager';\nimport { Enums } from '@cornerstonejs/core';\nimport cameraSyncCallback from '../callbacks/cameraSyncCallback';\nconst { CAMERA_MODIFIED } = Enums.Events;\nexport default function createCameraPositionSynchronizer(synchronizerName) {\n    const cameraPositionSynchronizer = createSynchronizer(synchronizerName, CAMERA_MODIFIED, cameraSyncCallback);\n    return cameraPositionSynchronizer;\n}\n","import { getRenderingEngine } from '@cornerstonejs/core';\nexport default function presentationViewSyncCallback(_synchronizerInstance, sourceViewport, targetViewport, _sourceEvent, options) {\n    const renderingEngine = getRenderingEngine(targetViewport.renderingEngineId);\n    if (!renderingEngine) {\n        throw new Error(`No RenderingEngine for Id: ${targetViewport.renderingEngineId}`);\n    }\n    const tViewport = renderingEngine.getViewport(targetViewport.viewportId);\n    const sViewport = renderingEngine.getViewport(sourceViewport.viewportId);\n    const presentationView = sViewport.getViewPresentation(options);\n    tViewport.setViewPresentation(presentationView);\n    tViewport.render();\n}\n","import { Enums } from '@cornerstonejs/core';\nimport { createSynchronizer } from '../../store/SynchronizerManager';\nimport presentationViewSyncCallback from '../callbacks/presentationViewSyncCallback';\nconst { CAMERA_MODIFIED } = Enums.Events;\nexport default function createPresentationViewSynchronizer(synchronizerName, options) {\n    const presentationView = createSynchronizer(synchronizerName, CAMERA_MODIFIED, presentationViewSyncCallback, { viewPresentation: options });\n    return presentationView;\n}\n","import { BaseVolumeViewport, getRenderingEngine, StackViewport, } from '@cornerstonejs/core';\nexport default function voiSyncCallback(synchronizerInstance, sourceViewport, targetViewport, modifiedEvent, options) {\n    const eventDetail = modifiedEvent.detail;\n    const { volumeId, range, invertStateChanged, invert, colormap } = eventDetail;\n    const renderingEngine = getRenderingEngine(targetViewport.renderingEngineId);\n    if (!renderingEngine) {\n        throw new Error(`Rendering Engine does not exist: ${targetViewport.renderingEngineId}`);\n    }\n    const tViewport = renderingEngine.getViewport(targetViewport.viewportId);\n    const tProperties = {\n        voiRange: range,\n    };\n    if (options?.syncInvertState && invertStateChanged) {\n        tProperties.invert = invert;\n    }\n    if (options?.syncColormap && colormap) {\n        tProperties.colormap = colormap;\n    }\n    if (tViewport instanceof BaseVolumeViewport) {\n        const isFusion = tViewport._actors && tViewport._actors.size > 1;\n        if (isFusion) {\n            tViewport.setProperties(tProperties, volumeId);\n        }\n        else {\n            tViewport.setProperties(tProperties);\n        }\n    }\n    else if (tViewport instanceof StackViewport) {\n        tViewport.setProperties(tProperties);\n    }\n    else {\n        throw new Error('Viewport type not supported.');\n    }\n    tViewport.render();\n}\n","import { createSynchronizer } from '../../store/SynchronizerManager';\nimport { Enums } from '@cornerstonejs/core';\nimport voiSyncCallback from '../callbacks/voiSyncCallback';\nexport default function createVOISynchronizer(synchronizerName, options) {\n    options = Object.assign({ syncInvertState: true, syncColormap: true }, options);\n    const VOISynchronizer = createSynchronizer(synchronizerName, Enums.Events.VOI_MODIFIED, voiSyncCallback, {\n        auxiliaryEvents: [\n            {\n                name: Enums.Events.COLORMAP_MODIFIED,\n            },\n        ],\n        ...options,\n    });\n    return VOISynchronizer;\n}\n","import { getRenderingEngine } from '@cornerstonejs/core';\nexport default function zoomPanSyncCallback(synchronizerInstance, sourceViewport, targetViewport) {\n    const renderingEngine = getRenderingEngine(targetViewport.renderingEngineId);\n    if (!renderingEngine) {\n        throw new Error(`No RenderingEngine for Id: ${targetViewport.renderingEngineId}`);\n    }\n    const options = synchronizerInstance.getOptions(targetViewport.viewportId);\n    const tViewport = renderingEngine.getViewport(targetViewport.viewportId);\n    const sViewport = renderingEngine.getViewport(sourceViewport.viewportId);\n    if (options?.syncZoom !== false) {\n        const srcZoom = sViewport.getZoom();\n        tViewport.setZoom(srcZoom);\n    }\n    if (options?.syncPan !== false) {\n        const srcPan = sViewport.getPan();\n        tViewport.setPan(srcPan);\n    }\n    tViewport.render();\n}\n","import { createSynchronizer } from '../../store/SynchronizerManager';\nimport { Enums } from '@cornerstonejs/core';\nimport zoomPanSyncCallback from '../callbacks/zoomPanSyncCallback';\nconst { CAMERA_MODIFIED } = Enums.Events;\nexport default function createZoomPanSynchronizer(synchronizerName) {\n    const zoomPanSynchronizer = createSynchronizer(synchronizerName, CAMERA_MODIFIED, zoomPanSyncCallback);\n    return zoomPanSynchronizer;\n}\n","import { vec3, mat4 } from 'gl-matrix';\nimport { getRenderingEngine, metaData, utilities, VolumeViewport, } from '@cornerstonejs/core';\nimport areViewportsCoplanar from './areViewportsCoplanar';\nconst getSpatialRegistration = (targetId, sourceId) => utilities.spatialRegistrationMetadataProvider.get('spatialRegistrationModule', targetId, sourceId);\nexport default async function imageSliceSyncCallback(synchronizerInstance, sourceViewport, targetViewport) {\n    const renderingEngine = getRenderingEngine(targetViewport.renderingEngineId);\n    if (!renderingEngine) {\n        throw new Error(`No RenderingEngine for Id: ${targetViewport.renderingEngineId}`);\n    }\n    const sViewport = renderingEngine.getViewport(sourceViewport.viewportId);\n    const options = synchronizerInstance.getOptions(targetViewport.viewportId);\n    if (options?.disabled) {\n        return;\n    }\n    const tViewport = renderingEngine.getViewport(targetViewport.viewportId);\n    const imageId1 = sViewport.getCurrentImageId();\n    const imagePlaneModule1 = metaData.get('imagePlaneModule', imageId1);\n    const sourceImagePositionPatient = imagePlaneModule1.imagePositionPatient;\n    const targetImageIds = tViewport.getImageIds();\n    if (!areViewportsCoplanar(sViewport, tViewport)) {\n        return;\n    }\n    let registrationMatrixMat4 = getSpatialRegistration(targetViewport.viewportId, sourceViewport.viewportId);\n    if (!registrationMatrixMat4) {\n        const frameOfReferenceUID1 = sViewport.getFrameOfReferenceUID();\n        const frameOfReferenceUID2 = tViewport.getFrameOfReferenceUID();\n        if (frameOfReferenceUID1 === frameOfReferenceUID2 &&\n            options?.useInitialPosition !== false) {\n            registrationMatrixMat4 = mat4.identity(mat4.create());\n        }\n        else {\n            utilities.calculateViewportsSpatialRegistration(sViewport, tViewport);\n            registrationMatrixMat4 = getSpatialRegistration(targetViewport.viewportId, sourceViewport.viewportId);\n        }\n        if (!registrationMatrixMat4) {\n            return;\n        }\n    }\n    const targetImagePositionPatientWithRegistrationMatrix = vec3.transformMat4(vec3.create(), sourceImagePositionPatient, registrationMatrixMat4);\n    const closestImageIdIndex2 = _getClosestImageIdIndex(targetImagePositionPatientWithRegistrationMatrix, targetImageIds);\n    let imageIndexToSet = closestImageIdIndex2.index;\n    if (tViewport instanceof VolumeViewport) {\n        imageIndexToSet = targetImageIds.length - closestImageIdIndex2.index - 1;\n    }\n    if (closestImageIdIndex2.index !== -1 &&\n        tViewport.getCurrentImageIdIndex() !== closestImageIdIndex2.index) {\n        await utilities.jumpToSlice(tViewport.element, {\n            imageIndex: imageIndexToSet,\n        });\n    }\n}\nfunction _getClosestImageIdIndex(targetPoint, imageIds) {\n    return imageIds.reduce((closestImageIdIndex, imageId, index) => {\n        const { imagePositionPatient } = metaData.get('imagePlaneModule', imageId);\n        const distance = vec3.distance(imagePositionPatient, targetPoint);\n        if (distance < closestImageIdIndex.distance) {\n            return {\n                distance,\n                index,\n            };\n        }\n        return closestImageIdIndex;\n    }, {\n        distance: Infinity,\n        index: -1,\n    });\n}\n","import { vec3 } from 'gl-matrix';\nexport default function areViewportsCoplanar(viewport1, viewport2) {\n    const { viewPlaneNormal: viewPlaneNormal1 } = viewport1.getCamera();\n    const { viewPlaneNormal: viewPlaneNormal2 } = viewport2.getCamera();\n    const dotProducts = vec3.dot(viewPlaneNormal1, viewPlaneNormal2);\n    return Math.abs(dotProducts) > 0.9;\n}\n","import { createSynchronizer } from '../../store/SynchronizerManager';\nimport { Enums } from '@cornerstonejs/core';\nimport imageSliceSyncCallback from '../callbacks/imageSliceSyncCallback';\nconst { STACK_NEW_IMAGE, VOLUME_NEW_IMAGE } = Enums.Events;\nexport default function createImageSliceSynchronizer(synchronizerName) {\n    const stackImageSynchronizer = createSynchronizer(synchronizerName, STACK_NEW_IMAGE, imageSliceSyncCallback, {\n        auxiliaryEvents: [\n            {\n                name: 'VOLUME_NEW_IMAGE',\n            },\n        ],\n    });\n    return stackImageSynchronizer;\n}\n","import { getRenderingEngine } from '@cornerstonejs/core';\nexport default function slabThicknessSyncCallback(_synchronizerInstance, sourceViewport, targetViewport) {\n    const renderingEngine = getRenderingEngine(targetViewport.renderingEngineId);\n    if (!renderingEngine) {\n        throw new Error(`No RenderingEngine for Id: ${targetViewport.renderingEngineId}`);\n    }\n    const tViewport = renderingEngine.getViewport(targetViewport.viewportId);\n    const sViewport = renderingEngine.getViewport(sourceViewport.viewportId);\n    const slabThickness = sViewport.getSlabThickness?.();\n    if (!slabThickness) {\n        return;\n    }\n    tViewport.setSlabThickness?.(slabThickness);\n    tViewport.render();\n}\n","import { Enums } from '@cornerstonejs/core';\nimport { createSynchronizer } from '../../store/SynchronizerManager';\nimport slabThicknessSyncCallback from '../callbacks/slabThicknessSyncCallback';\nconst { CAMERA_MODIFIED } = Enums.Events;\nexport default function createPresentationViewSynchronizer(synchronizerName) {\n    const presentationView = createSynchronizer(synchronizerName, CAMERA_MODIFIED, slabThicknessSyncCallback);\n    return presentationView;\n}\n","import createCameraPositionSynchronizer from './synchronizers/createCameraPositionSynchronizer';\nimport createPresentationViewSynchronizer from './synchronizers/createPresentationViewSynchronizer';\nimport createVOISynchronizer from './synchronizers/createVOISynchronizer';\nimport createZoomPanSynchronizer from './synchronizers/createZoomPanSynchronizer';\nimport createImageSliceSynchronizer from './synchronizers/createImageSliceSynchronizer';\nimport createSlabThicknessSynchronizer from './synchronizers/createSlabThicknessSynchronizer';\nconst createStackImageSynchronizer = createImageSliceSynchronizer;\nexport { createCameraPositionSynchronizer, createPresentationViewSynchronizer, createVOISynchronizer, createZoomPanSynchronizer, createImageSliceSynchronizer, createStackImageSynchronizer, createSlabThicknessSynchronizer, };\n","import { BaseTool } from './base';\nimport { getEnabledElement } from '@cornerstonejs/core';\nclass PanTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n    }) {\n        super(toolProps, defaultToolProps);\n    }\n    touchDragCallback(evt) {\n        this._dragCallback(evt);\n    }\n    mouseDragCallback(evt) {\n        this._dragCallback(evt);\n    }\n    _dragCallback(evt) {\n        const { element, deltaPoints } = evt.detail;\n        const enabledElement = getEnabledElement(element);\n        const deltaPointsWorld = deltaPoints.world;\n        if (deltaPointsWorld[0] === 0 &&\n            deltaPointsWorld[1] === 0 &&\n            deltaPointsWorld[2] === 0) {\n            return;\n        }\n        const camera = enabledElement.viewport.getCamera();\n        const { focalPoint, position } = camera;\n        const updatedPosition = [\n            position[0] - deltaPointsWorld[0],\n            position[1] - deltaPointsWorld[1],\n            position[2] - deltaPointsWorld[2],\n        ];\n        const updatedFocalPoint = [\n            focalPoint[0] - deltaPointsWorld[0],\n            focalPoint[1] - deltaPointsWorld[1],\n            focalPoint[2] - deltaPointsWorld[2],\n        ];\n        enabledElement.viewport.setCamera({\n            focalPoint: updatedFocalPoint,\n            position: updatedPosition,\n        });\n        enabledElement.viewport.render();\n    }\n}\nPanTool.toolName = 'Pan';\nexport default PanTool;\n","import vtkMath from '@kitware/vtk.js/Common/Core/Math';\nimport { Events } from '../enums';\nimport { eventTarget, getEnabledElement, getEnabledElementByIds, } from '@cornerstonejs/core';\nimport { mat4, vec3 } from 'gl-matrix';\nimport { BaseTool } from './base';\nimport { getToolGroup } from '../store/ToolGroupManager';\nclass TrackballRotateTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            rotateIncrementDegrees: 2,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this._resizeObservers = new Map();\n        this._hasResolutionChanged = false;\n        this.preMouseDownCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const actorEntry = viewport.getDefaultActor();\n            const actor = actorEntry.actor;\n            const mapper = actor.getMapper();\n            const hasSampleDistance = 'getSampleDistance' in mapper || 'getCurrentSampleDistance' in mapper;\n            if (!hasSampleDistance) {\n                return true;\n            }\n            const originalSampleDistance = mapper.getSampleDistance();\n            if (!this._hasResolutionChanged) {\n                mapper.setSampleDistance(originalSampleDistance * 2);\n                this._hasResolutionChanged = true;\n                if (this.cleanUp !== null) {\n                    document.removeEventListener('mouseup', this.cleanUp);\n                }\n                this.cleanUp = () => {\n                    mapper.setSampleDistance(originalSampleDistance);\n                    viewport.render();\n                    this._hasResolutionChanged = false;\n                };\n                document.addEventListener('mouseup', this.cleanUp, { once: true });\n            }\n            return true;\n        };\n        this._getViewportsInfo = () => {\n            const viewports = getToolGroup(this.toolGroupId).viewportsInfo;\n            return viewports;\n        };\n        this.onSetToolActive = () => {\n            const subscribeToElementResize = () => {\n                const viewportsInfo = this._getViewportsInfo();\n                viewportsInfo.forEach(({ viewportId, renderingEngineId }) => {\n                    if (!this._resizeObservers.has(viewportId)) {\n                        const { viewport } = getEnabledElementByIds(viewportId, renderingEngineId) || { viewport: null };\n                        if (!viewport) {\n                            return;\n                        }\n                        const { element } = viewport;\n                        const resizeObserver = new ResizeObserver(() => {\n                            const element = getEnabledElementByIds(viewportId, renderingEngineId);\n                            if (!element) {\n                                return;\n                            }\n                            const { viewport } = element;\n                            viewport.resetCamera();\n                            viewport.render();\n                        });\n                        resizeObserver.observe(element);\n                        this._resizeObservers.set(viewportId, resizeObserver);\n                    }\n                });\n            };\n            subscribeToElementResize();\n            this._viewportAddedListener = (evt) => {\n                if (evt.detail.toolGroupId === this.toolGroupId) {\n                    subscribeToElementResize();\n                }\n            };\n            eventTarget.addEventListener(Events.TOOLGROUP_VIEWPORT_ADDED, this._viewportAddedListener);\n        };\n        this.onSetToolDisabled = () => {\n            this._resizeObservers.forEach((resizeObserver, viewportId) => {\n                resizeObserver.disconnect();\n                this._resizeObservers.delete(viewportId);\n            });\n            if (this._viewportAddedListener) {\n                eventTarget.removeEventListener(Events.TOOLGROUP_VIEWPORT_ADDED, this._viewportAddedListener);\n                this._viewportAddedListener = null;\n            }\n        };\n        this.rotateCamera = (viewport, centerWorld, axis, angle) => {\n            const vtkCamera = viewport.getVtkActiveCamera();\n            const viewUp = vtkCamera.getViewUp();\n            const focalPoint = vtkCamera.getFocalPoint();\n            const position = vtkCamera.getPosition();\n            const newPosition = [0, 0, 0];\n            const newFocalPoint = [0, 0, 0];\n            const newViewUp = [0, 0, 0];\n            const transform = mat4.identity(new Float32Array(16));\n            mat4.translate(transform, transform, centerWorld);\n            mat4.rotate(transform, transform, angle, axis);\n            mat4.translate(transform, transform, [\n                -centerWorld[0],\n                -centerWorld[1],\n                -centerWorld[2],\n            ]);\n            vec3.transformMat4(newPosition, position, transform);\n            vec3.transformMat4(newFocalPoint, focalPoint, transform);\n            mat4.identity(transform);\n            mat4.rotate(transform, transform, angle, axis);\n            vec3.transformMat4(newViewUp, viewUp, transform);\n            viewport.setCamera({\n                position: newPosition,\n                viewUp: newViewUp,\n                focalPoint: newFocalPoint,\n            });\n        };\n        this.touchDragCallback = this._dragCallback.bind(this);\n        this.mouseDragCallback = this._dragCallback.bind(this);\n    }\n    _dragCallback(evt) {\n        const { element, currentPoints, lastPoints } = evt.detail;\n        const currentPointsCanvas = currentPoints.canvas;\n        const lastPointsCanvas = lastPoints.canvas;\n        const { rotateIncrementDegrees } = this.configuration;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const camera = viewport.getCamera();\n        const width = element.clientWidth;\n        const height = element.clientHeight;\n        const normalizedPosition = [\n            currentPointsCanvas[0] / width,\n            currentPointsCanvas[1] / height,\n        ];\n        const normalizedPreviousPosition = [\n            lastPointsCanvas[0] / width,\n            lastPointsCanvas[1] / height,\n        ];\n        const center = [width * 0.5, height * 0.5];\n        const centerWorld = viewport.canvasToWorld(center);\n        const normalizedCenter = [0.5, 0.5];\n        const radsq = (1.0 + Math.abs(normalizedCenter[0])) ** 2.0;\n        const op = [normalizedPreviousPosition[0], 0, 0];\n        const oe = [normalizedPosition[0], 0, 0];\n        const opsq = op[0] ** 2;\n        const oesq = oe[0] ** 2;\n        const lop = opsq > radsq ? 0 : Math.sqrt(radsq - opsq);\n        const loe = oesq > radsq ? 0 : Math.sqrt(radsq - oesq);\n        const nop = [op[0], 0, lop];\n        vtkMath.normalize(nop);\n        const noe = [oe[0], 0, loe];\n        vtkMath.normalize(noe);\n        const dot = vtkMath.dot(nop, noe);\n        if (Math.abs(dot) > 0.0001) {\n            const angleX = -2 *\n                Math.acos(vtkMath.clampValue(dot, -1.0, 1.0)) *\n                Math.sign(normalizedPosition[0] - normalizedPreviousPosition[0]) *\n                rotateIncrementDegrees;\n            const upVec = camera.viewUp;\n            const atV = camera.viewPlaneNormal;\n            const rightV = [0, 0, 0];\n            const forwardV = [0, 0, 0];\n            vtkMath.cross(upVec, atV, rightV);\n            vtkMath.normalize(rightV);\n            vtkMath.cross(atV, rightV, forwardV);\n            vtkMath.normalize(forwardV);\n            vtkMath.normalize(upVec);\n            this.rotateCamera(viewport, centerWorld, forwardV, angleX);\n            const angleY = (normalizedPreviousPosition[1] - normalizedPosition[1]) *\n                rotateIncrementDegrees;\n            this.rotateCamera(viewport, centerWorld, rightV, angleY);\n            viewport.render();\n        }\n    }\n}\nTrackballRotateTool.toolName = 'TrackballRotate';\nexport default TrackballRotateTool;\n","import { BaseTool } from './base';\nimport { getEnabledElement, VolumeViewport, cache, utilities, } from '@cornerstonejs/core';\nconst DEFAULT_MULTIPLIER = 4;\nconst DEFAULT_IMAGE_DYNAMIC_RANGE = 1024;\nconst PT = 'PT';\nclass WindowLevelTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n    }) {\n        super(toolProps, defaultToolProps);\n        this._getImageDynamicRangeFromMiddleSlice = (scalarData, dimensions) => {\n            const middleSliceIndex = Math.floor(dimensions[2] / 2);\n            const frameLength = dimensions[0] * dimensions[1];\n            let bytesPerVoxel;\n            let TypedArrayConstructor;\n            if (scalarData instanceof Float32Array) {\n                bytesPerVoxel = 4;\n                TypedArrayConstructor = Float32Array;\n            }\n            else if (scalarData instanceof Uint8Array) {\n                bytesPerVoxel = 1;\n                TypedArrayConstructor = Uint8Array;\n            }\n            else if (scalarData instanceof Uint16Array) {\n                bytesPerVoxel = 2;\n                TypedArrayConstructor = Uint16Array;\n            }\n            else if (scalarData instanceof Int16Array) {\n                bytesPerVoxel = 2;\n                TypedArrayConstructor = Int16Array;\n            }\n            const buffer = scalarData.buffer;\n            const byteOffset = middleSliceIndex * frameLength * bytesPerVoxel;\n            const frame = new TypedArrayConstructor(buffer, byteOffset, frameLength);\n            const { max, min } = this._getMinMax(frame, frameLength);\n            return max - min;\n        };\n    }\n    touchDragCallback(evt) {\n        this.mouseDragCallback(evt);\n    }\n    mouseDragCallback(evt) {\n        const { element, deltaPoints } = evt.detail;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        let volumeId, lower, upper, modality, newRange, viewportsContainingVolumeUID;\n        let isPreScaled = false;\n        const properties = viewport.getProperties();\n        if (viewport instanceof VolumeViewport) {\n            volumeId = viewport.getVolumeId();\n            viewportsContainingVolumeUID =\n                utilities.getViewportsWithVolumeId(volumeId);\n            ({ lower, upper } = properties.voiRange);\n            const volume = cache.getVolume(volumeId);\n            if (!volume) {\n                throw new Error('Volume not found ' + volumeId);\n            }\n            modality = volume.metadata.Modality;\n            isPreScaled = volume.scaling && Object.keys(volume.scaling).length > 0;\n        }\n        else if (properties.voiRange) {\n            modality = viewport.modality;\n            ({ lower, upper } = properties.voiRange);\n            const { preScale = { scaled: false } } = viewport.getImageData?.() || {};\n            isPreScaled =\n                preScale.scaled && preScale.scalingParameters?.suvbw !== undefined;\n        }\n        else {\n            throw new Error('Viewport is not a valid type');\n        }\n        if (modality === PT && isPreScaled) {\n            newRange = this.getPTScaledNewRange({\n                deltaPointsCanvas: deltaPoints.canvas,\n                lower,\n                upper,\n                clientHeight: element.clientHeight,\n                isPreScaled,\n                viewport,\n                volumeId,\n            });\n        }\n        else {\n            newRange = this.getNewRange({\n                viewport,\n                deltaPointsCanvas: deltaPoints.canvas,\n                volumeId,\n                lower,\n                upper,\n            });\n        }\n        if (newRange.lower >= newRange.upper) {\n            return;\n        }\n        viewport.setProperties({\n            voiRange: newRange,\n        });\n        viewport.render();\n        if (viewport instanceof VolumeViewport) {\n            viewportsContainingVolumeUID.forEach((vp) => {\n                if (viewport !== vp) {\n                    vp.render();\n                }\n            });\n            return;\n        }\n    }\n    getPTScaledNewRange({ deltaPointsCanvas, lower, upper, clientHeight, viewport, volumeId, isPreScaled, }) {\n        let multiplier = DEFAULT_MULTIPLIER;\n        if (isPreScaled) {\n            multiplier = 5 / clientHeight;\n        }\n        else {\n            multiplier =\n                this._getMultiplierFromDynamicRange(viewport, volumeId) ||\n                    DEFAULT_MULTIPLIER;\n        }\n        const deltaY = deltaPointsCanvas[1];\n        const wcDelta = deltaY * multiplier;\n        upper -= wcDelta;\n        upper = isPreScaled ? Math.max(upper, 0.1) : upper;\n        return { lower, upper };\n    }\n    getNewRange({ viewport, deltaPointsCanvas, volumeId, lower, upper }) {\n        const multiplier = this._getMultiplierFromDynamicRange(viewport, volumeId) ||\n            DEFAULT_MULTIPLIER;\n        const wwDelta = deltaPointsCanvas[0] * multiplier;\n        const wcDelta = deltaPointsCanvas[1] * multiplier;\n        let { windowWidth, windowCenter } = utilities.windowLevel.toWindowLevel(lower, upper);\n        windowWidth += wwDelta;\n        windowCenter += wcDelta;\n        windowWidth = Math.max(windowWidth, 1);\n        return utilities.windowLevel.toLowHighRange(windowWidth, windowCenter);\n    }\n    _getMultiplierFromDynamicRange(viewport, volumeId) {\n        let imageDynamicRange;\n        if (volumeId) {\n            const imageVolume = cache.getVolume(volumeId);\n            const { voxelManager } = viewport.getImageData();\n            const middleSlicePixelData = voxelManager.getMiddleSliceData();\n            const calculatedDynamicRange = middleSlicePixelData.reduce((acc, pixel) => {\n                return [Math.min(acc[0], pixel), Math.max(acc[1], pixel)];\n            }, [Infinity, -Infinity]);\n            const BitsStored = imageVolume?.metadata?.BitsStored;\n            const metadataDynamicRange = BitsStored ? 2 ** BitsStored : Infinity;\n            imageDynamicRange = Math.min(calculatedDynamicRange, metadataDynamicRange);\n        }\n        else {\n            imageDynamicRange = this._getImageDynamicRangeFromViewport(viewport);\n        }\n        const ratio = imageDynamicRange / DEFAULT_IMAGE_DYNAMIC_RANGE;\n        return ratio > 1 ? Math.round(ratio) : ratio;\n    }\n    _getImageDynamicRangeFromViewport(viewport) {\n        const { imageData, voxelManager } = viewport.getImageData();\n        if (voxelManager?.getRange) {\n            const range = voxelManager.getRange();\n            return range[1] - range[0];\n        }\n        const dimensions = imageData.getDimensions();\n        if (imageData.getRange) {\n            const imageDataRange = imageData.getRange();\n            return imageDataRange[1] - imageDataRange[0];\n        }\n        let scalarData;\n        if (imageData.getScalarData) {\n            scalarData = imageData.getScalarData();\n        }\n        else {\n            scalarData = imageData.getPointData().getScalars().getData();\n        }\n        if (dimensions[2] !== 1) {\n            return this._getImageDynamicRangeFromMiddleSlice(scalarData, dimensions);\n        }\n        let range;\n        if (scalarData.getRange) {\n            range = scalarData.getRange();\n        }\n        else {\n            const { min, max } = this._getMinMax(scalarData, scalarData.length);\n            range = [min, max];\n        }\n        return range[1] - range[0];\n    }\n    _getMinMax(frame, frameLength) {\n        let min = Infinity;\n        let max = -Infinity;\n        for (let i = 0; i < frameLength; i++) {\n            const voxel = frame[i];\n            if (voxel < min) {\n                min = voxel;\n            }\n            if (voxel > max) {\n                max = voxel;\n            }\n        }\n        return { max, min };\n    }\n}\nWindowLevelTool.toolName = 'WindowLevel';\nexport default WindowLevelTool;\n","import { AnnotationTool } from './base';\nimport { getEnabledElement, utilities } from '@cornerstonejs/core';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../stateManagement';\nimport { triggerAnnotationCompleted } from '../stateManagement/annotation/helpers/state';\nimport { drawRect as drawRectSvg } from '../drawingSvg';\nimport { state } from '../store/state';\nimport { Events } from '../enums';\nimport { getViewportIdsWithToolToRender } from '../utilities/viewportFilters';\nimport { resetElementCursor, hideElementCursor, } from '../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nimport { windowLevel } from '../utilities/voi';\nclass WindowLevelRegionTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            minWindowWidth: 10,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                invalidated: true,\n                highlighted: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                },\n                data: {\n                    handles: {\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                    },\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender } = this.editData;\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            this.editData = null;\n            this.isDrawing = false;\n            removeAnnotation(annotation.annotationUID);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            triggerAnnotationCompleted(annotation);\n            this.applyWindowLevelRegion(annotation, element);\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender } = this.editData;\n            const { data } = annotation;\n            const { currentPoints } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { worldToCanvas, canvasToWorld } = enabledElement.viewport;\n            const worldPos = currentPoints.world;\n            const { points } = data.handles;\n            const DEFAULT_HANDLE_INDEX = 3;\n            points[DEFAULT_HANDLE_INDEX] = [...worldPos];\n            const bottomLeftCanvas = worldToCanvas(points[0]);\n            const topRightCanvas = worldToCanvas(points[3]);\n            const bottomRightCanvas = [\n                topRightCanvas[0],\n                bottomLeftCanvas[1],\n            ];\n            const topLeftCanvas = [\n                bottomLeftCanvas[0],\n                topRightCanvas[1],\n            ];\n            const bottomRightWorld = canvasToWorld(bottomRightCanvas);\n            const topLeftWorld = canvasToWorld(topLeftCanvas);\n            points[1] = bottomRightWorld;\n            points[2] = topLeftWorld;\n            annotation.invalidated = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points } = data.handles;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                const dataId = `${annotationUID}-rect`;\n                const rectangleUID = '0';\n                drawRectSvg(svgDrawingHelper, annotationUID, rectangleUID, canvasCoordinates[0], canvasCoordinates[3], {\n                    color,\n                    lineDash,\n                    lineWidth,\n                }, dataId);\n                renderStatus = true;\n            }\n            return renderStatus;\n        };\n        this.applyWindowLevelRegion = (annotation, element) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const imageData = windowLevel.extractWindowLevelRegionToolData(viewport);\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const startCanvas = canvasCoordinates[0];\n            const endCanvas = canvasCoordinates[3];\n            let left = Math.min(startCanvas[0], endCanvas[0]);\n            let top = Math.min(startCanvas[1], endCanvas[1]);\n            let width = Math.abs(startCanvas[0] - endCanvas[0]);\n            let height = Math.abs(startCanvas[1] - endCanvas[1]);\n            left = utilities.clip(left, 0, imageData.width);\n            top = utilities.clip(top, 0, imageData.height);\n            width = Math.floor(Math.min(width, Math.abs(imageData.width - left)));\n            height = Math.floor(Math.min(height, Math.abs(imageData.height - top)));\n            const pixelLuminanceData = windowLevel.getLuminanceFromRegion(imageData, Math.round(left), Math.round(top), width, height);\n            const minMaxMean = windowLevel.calculateMinMaxMean(pixelLuminanceData, imageData.minPixelValue, imageData.maxPixelValue);\n            if (this.configuration.minWindowWidth === undefined) {\n                this.configuration.minWindowWidth = 10;\n            }\n            const windowWidth = Math.max(Math.abs(minMaxMean.max - minMaxMean.min), this.configuration.minWindowWidth);\n            const windowCenter = minMaxMean.mean;\n            const voiRange = utilities.windowLevel.toLowHighRange(windowWidth, windowCenter);\n            viewport.setProperties({ voiRange });\n            viewport.render();\n        };\n        this.cancel = () => {\n            return null;\n        };\n        this.isPointNearTool = () => {\n            return null;\n        };\n        this.toolSelectedCallback = () => {\n            return null;\n        };\n        this.handleSelectedCallback = () => {\n            return null;\n        };\n        this._activateModify = () => {\n            return null;\n        };\n        this._deactivateModify = () => {\n            return null;\n        };\n    }\n}\nWindowLevelRegionTool.toolName = 'WindowLevelRegion';\nexport default WindowLevelRegionTool;\n","import { getEnabledElementByIds, getEnabledElement, VolumeViewport, BaseVolumeViewport, utilities, } from '@cornerstonejs/core';\nimport { BaseTool } from './base';\nclass StackScrollTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            invert: false,\n            debounceIfNotLoaded: true,\n            loop: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.deltaY = 1;\n    }\n    mouseWheelCallback(evt) {\n        this._scroll(evt);\n    }\n    mouseDragCallback(evt) {\n        this._dragCallback(evt);\n    }\n    touchDragCallback(evt) {\n        this._dragCallback(evt);\n    }\n    _dragCallback(evt) {\n        this._scrollDrag(evt);\n    }\n    _scrollDrag(evt) {\n        const { deltaPoints, viewportId, renderingEngineId } = evt.detail;\n        const { viewport } = getEnabledElementByIds(viewportId, renderingEngineId);\n        const { debounceIfNotLoaded, invert, loop } = this.configuration;\n        const deltaPointY = deltaPoints.canvas[1];\n        let volumeId;\n        if (viewport instanceof VolumeViewport) {\n            volumeId = viewport.getVolumeId();\n        }\n        const pixelsPerImage = this._getPixelPerImage(viewport);\n        const deltaY = deltaPointY + this.deltaY;\n        if (!pixelsPerImage) {\n            return;\n        }\n        if (Math.abs(deltaY) >= pixelsPerImage) {\n            const imageIdIndexOffset = Math.round(deltaY / pixelsPerImage);\n            utilities.scroll(viewport, {\n                delta: invert ? -imageIdIndexOffset : imageIdIndexOffset,\n                volumeId,\n                debounceLoading: debounceIfNotLoaded,\n                loop: loop,\n            });\n            this.deltaY = deltaY % pixelsPerImage;\n        }\n        else {\n            this.deltaY = deltaY;\n        }\n    }\n    _scroll(evt) {\n        const { wheel, element } = evt.detail;\n        const { direction } = wheel;\n        const { invert } = this.configuration;\n        const { viewport } = getEnabledElement(element);\n        const delta = direction * (invert ? -1 : 1);\n        utilities.scroll(viewport, {\n            delta,\n            debounceLoading: this.configuration.debounceIfNotLoaded,\n            loop: this.configuration.loop,\n            volumeId: viewport instanceof BaseVolumeViewport\n                ? viewport.getVolumeId()\n                : undefined,\n            scrollSlabs: this.configuration.scrollSlabs,\n        });\n    }\n    _getPixelPerImage(viewport) {\n        const { element } = viewport;\n        const numberOfSlices = viewport.getNumberOfSlices();\n        return Math.max(2, element.offsetHeight / Math.max(numberOfSlices, 8));\n    }\n}\nStackScrollTool.toolName = 'StackScroll';\nexport default StackScrollTool;\n","import { BaseVolumeViewport, getEnabledElement } from '@cornerstonejs/core';\nimport { mat4, vec3 } from 'gl-matrix';\nimport { BaseTool } from './base';\nimport angleBetweenLines from '../utilities/math/angle/angleBetweenLines';\nclass PlanarRotateTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n    }) {\n        super(toolProps, defaultToolProps);\n        this.mouseWheelCallback = (evt) => {\n            const { element, wheel } = evt.detail;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { invert } = this.configuration;\n            const angle = wheel.direction * 10 * (invert ? -1 : 1);\n            this.setAngle(viewport, angle);\n        };\n        this.touchDragCallback = this._dragCallback.bind(this);\n        this.mouseDragCallback = this._dragCallback.bind(this);\n    }\n    _dragCallback(evt) {\n        const { element, currentPoints, startPoints } = evt.detail;\n        const currentPointWorld = currentPoints.world;\n        const startPointWorld = startPoints.world;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const camera = viewport.getCamera();\n        const width = element.clientWidth;\n        const height = element.clientHeight;\n        const centerCanvas = [width * 0.5, height * 0.5];\n        const centerWorld = viewport.canvasToWorld(centerCanvas);\n        let angle = angleBetweenLines([startPointWorld, centerWorld], [centerWorld, currentPointWorld]);\n        const { viewPlaneNormal } = camera;\n        const v1 = vec3.sub(vec3.create(), centerWorld, startPointWorld);\n        const v2 = vec3.sub(vec3.create(), centerWorld, currentPointWorld);\n        const cross = vec3.cross(vec3.create(), v1, v2);\n        if (vec3.dot(viewPlaneNormal, cross) > 0) {\n            angle = -angle;\n        }\n        if (Number.isNaN(angle)) {\n            return;\n        }\n        this.setAngle(viewport, angle);\n    }\n    setAngle(viewport, angle) {\n        const { viewPlaneNormal, viewUp } = viewport.getCamera();\n        if (viewport instanceof BaseVolumeViewport) {\n            const rotAngle = (((angle + 360) % 360) * Math.PI) / 180;\n            const rotMat = mat4.identity(new Float32Array(16));\n            mat4.rotate(rotMat, rotMat, rotAngle, viewPlaneNormal);\n            const rotatedViewUp = vec3.transformMat4(vec3.create(), viewUp, rotMat);\n            viewport.setCamera({ viewUp: rotatedViewUp });\n        }\n        else {\n            const { rotation } = viewport.getViewPresentation();\n            viewport.setViewPresentation({\n                rotation: (rotation + angle + 360) % 360,\n            });\n        }\n        viewport.render();\n    }\n}\nPlanarRotateTool.toolName = 'PlanarRotate';\nexport default PlanarRotateTool;\n","import { vec3 } from 'gl-matrix';\nimport vtkMath from '@kitware/vtk.js/Common/Core/Math';\nimport { getEnabledElement } from '@cornerstonejs/core';\nimport { BaseTool } from './base';\nclass ZoomTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            zoomToCenter: false,\n            minZoomScale: 0.001,\n            maxZoomScale: 3000,\n            pinchToZoom: true,\n            pan: true,\n            invert: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.preMouseDownCallback = (evt) => {\n            const eventData = evt.detail;\n            const { element, currentPoints } = eventData;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const camera = enabledElement.viewport.getCamera();\n            const { focalPoint } = camera;\n            this.initialMousePosWorld = worldPos;\n            let dirVec = vec3.fromValues(focalPoint[0] - worldPos[0], focalPoint[1] - worldPos[1], focalPoint[2] - worldPos[2]);\n            dirVec = vec3.normalize(vec3.create(), dirVec);\n            this.dirVec = dirVec;\n            return false;\n        };\n        this.preTouchStartCallback = (evt) => {\n            if (!this.configuration.pinchToZoom) {\n                return this.preMouseDownCallback(evt);\n            }\n        };\n        this._dragParallelProjection = (evt, viewport, camera, pinch = false) => {\n            const { element, deltaPoints } = evt.detail;\n            const deltaY = pinch\n                ? evt.detail.deltaDistance.canvas\n                : deltaPoints.canvas[1];\n            const size = [element.clientWidth, element.clientHeight];\n            const { parallelScale, focalPoint, position } = camera;\n            const zoomScale = 5 / size[1];\n            const k = deltaY * zoomScale * (this.configuration.invert ? -1 : 1);\n            const parallelScaleToSet = (1.0 - k) * parallelScale;\n            let focalPointToSet = focalPoint;\n            let positionToSet = position;\n            if (!this.configuration.zoomToCenter) {\n                const distanceToCanvasCenter = vec3.distance(focalPoint, this.initialMousePosWorld);\n                positionToSet = vec3.scaleAndAdd(vec3.create(), position, this.dirVec, -distanceToCanvasCenter * k);\n                focalPointToSet = vec3.scaleAndAdd(vec3.create(), focalPoint, this.dirVec, -distanceToCanvasCenter * k);\n            }\n            const imageData = viewport.getImageData();\n            let spacing = [1, 1, 1];\n            if (imageData) {\n                spacing = imageData.spacing;\n            }\n            const { minZoomScale, maxZoomScale } = this.configuration;\n            const t = element.clientHeight * spacing[1] * 0.5;\n            const scale = t / parallelScaleToSet;\n            let cappedParallelScale = parallelScaleToSet;\n            let thresholdExceeded = false;\n            if (imageData) {\n                if (scale < minZoomScale) {\n                    cappedParallelScale = t / minZoomScale;\n                    thresholdExceeded = true;\n                }\n                else if (scale >= maxZoomScale) {\n                    cappedParallelScale = t / maxZoomScale;\n                    thresholdExceeded = true;\n                }\n            }\n            viewport.setCamera({\n                parallelScale: cappedParallelScale,\n                focalPoint: thresholdExceeded ? focalPoint : focalPointToSet,\n                position: thresholdExceeded ? position : positionToSet,\n            });\n        };\n        this._dragPerspectiveProjection = (evt, viewport, camera, pinch = false) => {\n            const { element, deltaPoints } = evt.detail;\n            const deltaY = pinch\n                ? evt.detail.deltaDistance.canvas\n                : deltaPoints.canvas[1];\n            const size = [element.clientWidth, element.clientHeight];\n            const { position, focalPoint, viewPlaneNormal } = camera;\n            const distance = vtkMath.distance2BetweenPoints(position, focalPoint);\n            const zoomScale = Math.sqrt(distance) / size[1];\n            const directionOfProjection = [\n                -viewPlaneNormal[0],\n                -viewPlaneNormal[1],\n                -viewPlaneNormal[2],\n            ];\n            const k = this.configuration.invert\n                ? deltaY / zoomScale\n                : deltaY * zoomScale;\n            let tmp = k * directionOfProjection[0];\n            position[0] += tmp;\n            focalPoint[0] += tmp;\n            tmp = k * directionOfProjection[1];\n            position[1] += tmp;\n            focalPoint[1] += tmp;\n            tmp = k * directionOfProjection[2];\n            position[2] += tmp;\n            focalPoint[2] += tmp;\n            viewport.setCamera({ position, focalPoint });\n        };\n        this.initialMousePosWorld = [0, 0, 0];\n        this.dirVec = [0, 0, 0];\n        if (this.configuration.pinchToZoom) {\n            this.touchDragCallback = this._pinchCallback.bind(this);\n        }\n        else {\n            this.touchDragCallback = this._dragCallback.bind(this);\n        }\n        this.mouseDragCallback = this._dragCallback.bind(this);\n    }\n    _pinchCallback(evt) {\n        const pointsList = evt.detail\n            .currentPointsList;\n        if (pointsList.length > 1) {\n            const { element, currentPoints } = evt.detail;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const camera = viewport.getCamera();\n            const worldPos = currentPoints.world;\n            const { focalPoint } = camera;\n            this.initialMousePosWorld = worldPos;\n            let dirVec = vec3.fromValues(focalPoint[0] - worldPos[0], focalPoint[1] - worldPos[1], focalPoint[2] - worldPos[2]);\n            dirVec = vec3.normalize(vec3.create(), dirVec);\n            this.dirVec = dirVec;\n            if (camera.parallelProjection) {\n                this._dragParallelProjection(evt, viewport, camera, true);\n            }\n            else {\n                this._dragPerspectiveProjection(evt, viewport, camera, true);\n            }\n            viewport.render();\n        }\n        if (this.configuration.pan) {\n            this._panCallback(evt);\n        }\n    }\n    _dragCallback(evt) {\n        const { element } = evt.detail;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const camera = viewport.getCamera();\n        if (camera.parallelProjection) {\n            this._dragParallelProjection(evt, viewport, camera);\n        }\n        else {\n            this._dragPerspectiveProjection(evt, viewport, camera);\n        }\n        viewport.render();\n    }\n    _panCallback(evt) {\n        const { element, deltaPoints } = evt.detail;\n        const enabledElement = getEnabledElement(element);\n        const deltaPointsWorld = deltaPoints.world;\n        const camera = enabledElement.viewport.getCamera();\n        const { focalPoint, position } = camera;\n        const updatedPosition = [\n            position[0] - deltaPointsWorld[0],\n            position[1] - deltaPointsWorld[1],\n            position[2] - deltaPointsWorld[2],\n        ];\n        const updatedFocalPoint = [\n            focalPoint[0] - deltaPointsWorld[0],\n            focalPoint[1] - deltaPointsWorld[1],\n            focalPoint[2] - deltaPointsWorld[2],\n        ];\n        enabledElement.viewport.setCamera({\n            focalPoint: updatedFocalPoint,\n            position: updatedPosition,\n        });\n        enabledElement.viewport.render();\n    }\n}\nZoomTool.toolName = 'Zoom';\nexport default ZoomTool;\n","import { BaseTool } from './base';\nimport { getEnabledElement, VolumeViewport } from '@cornerstonejs/core';\nimport { utilities } from '@cornerstonejs/core';\nimport { getPointInLineOfSightWithCriteria } from '../utilities/planar';\nimport { getToolGroupForViewport } from '../store/ToolGroupManager';\nclass MIPJumpToClickTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            targetViewportIds: [],\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n    }\n    mouseClickCallback(evt) {\n        const { element, currentPoints } = evt.detail;\n        const enabledElement = getEnabledElement(element);\n        const { viewport, renderingEngine } = enabledElement;\n        const volumeId = viewport.getVolumeId();\n        if (!volumeId) {\n            throw new Error(`MIPJumpToClickTool: targetId is not a volumeId, you should only use MIPJumpToClickTool with a volumeId as the targetId`);\n        }\n        let maxIntensity = -Infinity;\n        const maxFn = (intensity, point) => {\n            if (intensity > maxIntensity) {\n                maxIntensity = intensity;\n                return point;\n            }\n        };\n        const brightestPoint = getPointInLineOfSightWithCriteria(viewport, currentPoints.world, volumeId, maxFn);\n        if (!brightestPoint || !brightestPoint.length) {\n            return;\n        }\n        const { targetViewportIds, toolGroupId } = this.configuration;\n        const viewports = renderingEngine.getViewports().filter((vp) => {\n            if (targetViewportIds?.indexOf(vp.id) >= 0) {\n                return true;\n            }\n            const foundToolGroup = getToolGroupForViewport(vp.id, renderingEngine.id);\n            if (toolGroupId && toolGroupId === foundToolGroup?.id) {\n                return true;\n            }\n            return false;\n        });\n        viewports.forEach((viewport) => {\n            if (viewport instanceof VolumeViewport) {\n                viewport.jumpToWorld(brightestPoint);\n            }\n            else {\n                console.warn('Cannot jump to specified world coordinates for a viewport that is not a VolumeViewport');\n            }\n        });\n    }\n}\nMIPJumpToClickTool.toolName = 'MIPJumpToClickTool';\nexport default MIPJumpToClickTool;\n","import { vec2, vec3 } from 'gl-matrix';\nimport vtkMath from '@kitware/vtk.js/Common/Core/Math';\nimport vtkMatrixBuilder from '@kitware/vtk.js/Common/Core/MatrixBuilder';\nimport { AnnotationTool } from './base';\nimport { getEnabledElementByIds, getEnabledElement, utilities as csUtils, Enums, CONSTANTS, } from '@cornerstonejs/core';\nimport { getToolGroup, getToolGroupForViewport, } from '../store/ToolGroupManager';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../stateManagement/annotation/annotationState';\nimport { drawCircle as drawCircleSvg, drawHandles as drawHandlesSvg, drawLine as drawLineSvg, } from '../drawingSvg';\nimport { state } from '../store/state';\nimport { Events } from '../enums';\nimport { getViewportIdsWithToolToRender } from '../utilities/viewportFilters';\nimport { resetElementCursor, hideElementCursor, } from '../cursors/elementCursor';\nimport liangBarksyClip from '../utilities/math/vec2/liangBarksyClip';\nimport * as lineSegment from '../utilities/math/line';\nimport { isAnnotationLocked } from '../stateManagement/annotation/annotationLocking';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nconst { RENDERING_DEFAULTS } = CONSTANTS;\nfunction defaultReferenceLineColor() {\n    return 'rgb(0, 200, 0)';\n}\nfunction defaultReferenceLineControllable() {\n    return true;\n}\nfunction defaultReferenceLineDraggableRotatable() {\n    return true;\n}\nfunction defaultReferenceLineSlabThicknessControlsOn() {\n    return true;\n}\nconst OPERATION = {\n    DRAG: 1,\n    ROTATE: 2,\n    SLAB: 3,\n};\nconst EPSILON = 1e-3;\nclass CrosshairsTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse'],\n        configuration: {\n            shadow: true,\n            viewportIndicators: false,\n            viewportIndicatorsConfig: {\n                radius: 5,\n                x: null,\n                y: null,\n            },\n            autoPan: {\n                enabled: false,\n                panSize: 10,\n            },\n            referenceLinesCenterGapRadius: 20,\n            filterActorUIDsToSetSlabThickness: [],\n            slabThicknessBlendMode: Enums.BlendModes.MAXIMUM_INTENSITY_BLEND,\n            mobile: {\n                enabled: false,\n                opacity: 0.8,\n                handleRadius: 9,\n            },\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.toolCenter = [0, 0, 0];\n        this.initializeViewport = ({ renderingEngineId, viewportId, }) => {\n            const enabledElement = getEnabledElementByIds(viewportId, renderingEngineId);\n            const { FrameOfReferenceUID, viewport } = enabledElement;\n            const { element } = viewport;\n            const { position, focalPoint, viewPlaneNormal } = viewport.getCamera();\n            let annotations = this._getAnnotations(enabledElement);\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (annotations.length) {\n                removeAnnotation(annotations[0].annotationUID);\n            }\n            const annotation = {\n                highlighted: false,\n                metadata: {\n                    cameraPosition: [...position],\n                    cameraFocalPoint: [...focalPoint],\n                    FrameOfReferenceUID,\n                    toolName: this.getToolName(),\n                },\n                data: {\n                    handles: {\n                        rotationPoints: [],\n                        slabThicknessPoints: [],\n                        toolCenter: this.toolCenter,\n                    },\n                    activeOperation: null,\n                    activeViewportIds: [],\n                    viewportId,\n                },\n            };\n            addAnnotation(annotation, element);\n            return {\n                normal: viewPlaneNormal,\n                point: viewport.canvasToWorld([\n                    viewport.canvas.clientWidth / 2,\n                    viewport.canvas.clientHeight / 2,\n                ]),\n            };\n        };\n        this._getViewportsInfo = () => {\n            const viewports = getToolGroup(this.toolGroupId).viewportsInfo;\n            return viewports;\n        };\n        this.resetCrosshairs = () => {\n            const viewportsInfo = this._getViewportsInfo();\n            for (const viewportInfo of viewportsInfo) {\n                const { viewportId, renderingEngineId } = viewportInfo;\n                const enabledElement = getEnabledElementByIds(viewportId, renderingEngineId);\n                const viewport = enabledElement.viewport;\n                const resetPan = true;\n                const resetZoom = true;\n                const resetToCenter = true;\n                const resetRotation = true;\n                const suppressEvents = true;\n                viewport.resetCamera({\n                    resetPan,\n                    resetZoom,\n                    resetToCenter,\n                    resetRotation,\n                    suppressEvents,\n                });\n                viewport.resetSlabThickness();\n                const { element } = viewport;\n                let annotations = this._getAnnotations(enabledElement);\n                annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n                if (annotations.length) {\n                    removeAnnotation(annotations[0].annotationUID);\n                }\n                viewport.render();\n            }\n            this._computeToolCenter(viewportsInfo);\n        };\n        this.computeToolCenter = () => {\n            const viewportsInfo = this._getViewportsInfo();\n            this._computeToolCenter(viewportsInfo);\n        };\n        this._computeToolCenter = (viewportsInfo) => {\n            if (!viewportsInfo.length || viewportsInfo.length === 1) {\n                console.warn('For crosshairs to operate, at least two viewports must be given.');\n                return;\n            }\n            const [firstViewport, secondViewport, thirdViewport] = viewportsInfo;\n            const { normal: normal1, point: point1 } = this.initializeViewport(firstViewport);\n            const { normal: normal2, point: point2 } = this.initializeViewport(secondViewport);\n            let normal3 = [0, 0, 0];\n            let point3 = vec3.create();\n            if (thirdViewport) {\n                ({ normal: normal3, point: point3 } =\n                    this.initializeViewport(thirdViewport));\n            }\n            else {\n                vec3.add(point3, point1, point2);\n                vec3.scale(point3, point3, 0.5);\n                vec3.cross(normal3, normal1, normal2);\n            }\n            const firstPlane = csUtils.planar.planeEquation(normal1, point1);\n            const secondPlane = csUtils.planar.planeEquation(normal2, point2);\n            const thirdPlane = csUtils.planar.planeEquation(normal3, point3);\n            this.toolCenter = csUtils.planar.threePlaneIntersection(firstPlane, secondPlane, thirdPlane);\n            triggerAnnotationRenderForViewportIds(viewportsInfo.map(({ viewportId }) => viewportId));\n        };\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { currentPoints } = eventDetail;\n            const jumpWorld = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            this._jump(enabledElement, jumpWorld);\n            const annotations = this._getAnnotations(enabledElement);\n            const filteredAnnotations = this.filterInteractableAnnotationsForElement(viewport.element, annotations);\n            const { data } = filteredAnnotations[0];\n            const { rotationPoints } = data.handles;\n            const viewportIdArray = [];\n            for (let i = 0; i < rotationPoints.length - 1; ++i) {\n                const otherViewport = rotationPoints[i][1];\n                const viewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                const viewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id);\n                if (!viewportControllable || !viewportDraggableRotatable) {\n                    continue;\n                }\n                viewportIdArray.push(otherViewport.id);\n                i++;\n            }\n            data.activeViewportIds = [...viewportIdArray];\n            data.handles.activeOperation = OPERATION.DRAG;\n            evt.preventDefault();\n            hideElementCursor(element);\n            this._activateModify(element);\n            return filteredAnnotations[0];\n        };\n        this.cancel = () => {\n            console.log('Not implemented yet');\n        };\n        this.handleSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            this._activateModify(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            if (this._pointNearTool(element, annotation, canvasCoords, 6)) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation, interactionType) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            this._activateModify(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n        };\n        this.onCameraModified = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            const viewport = enabledElement.viewport;\n            const annotations = this._getAnnotations(enabledElement);\n            const filteredToolAnnotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            const viewportAnnotation = filteredToolAnnotations[0];\n            if (!viewportAnnotation) {\n                return;\n            }\n            const currentCamera = viewport.getCamera();\n            const oldCameraPosition = viewportAnnotation.metadata.cameraPosition;\n            const deltaCameraPosition = [0, 0, 0];\n            vtkMath.subtract(currentCamera.position, oldCameraPosition, deltaCameraPosition);\n            const oldCameraFocalPoint = viewportAnnotation.metadata.cameraFocalPoint;\n            const deltaCameraFocalPoint = [0, 0, 0];\n            vtkMath.subtract(currentCamera.focalPoint, oldCameraFocalPoint, deltaCameraFocalPoint);\n            viewportAnnotation.metadata.cameraPosition = [...currentCamera.position];\n            viewportAnnotation.metadata.cameraFocalPoint = [\n                ...currentCamera.focalPoint,\n            ];\n            const viewportControllable = this._getReferenceLineControllable(viewport.id);\n            const viewportDraggableRotatable = this._getReferenceLineDraggableRotatable(viewport.id);\n            if (!csUtils.isEqual(currentCamera.position, oldCameraPosition, 1e-3) &&\n                viewportControllable &&\n                viewportDraggableRotatable) {\n                let isRotation = false;\n                const cameraModifiedSameForPosAndFocalPoint = csUtils.isEqual(deltaCameraPosition, deltaCameraFocalPoint, 1e-3);\n                if (!cameraModifiedSameForPosAndFocalPoint) {\n                    isRotation = true;\n                }\n                const cameraModifiedInPlane = Math.abs(vtkMath.dot(deltaCameraPosition, currentCamera.viewPlaneNormal)) < 1e-2;\n                if (!isRotation && !cameraModifiedInPlane) {\n                    this.toolCenter[0] += deltaCameraPosition[0];\n                    this.toolCenter[1] += deltaCameraPosition[1];\n                    this.toolCenter[2] += deltaCameraPosition[2];\n                }\n            }\n            if (this.configuration.autoPan?.enabled) {\n                const toolGroup = getToolGroupForViewport(viewport.id, renderingEngine.id);\n                const otherViewportIds = toolGroup\n                    .getViewportIds()\n                    .filter((id) => id !== viewport.id);\n                otherViewportIds.forEach((viewportId) => {\n                    this._autoPanViewportIfNecessary(viewportId, renderingEngine);\n                });\n            }\n            const requireSameOrientation = false;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName(), requireSameOrientation);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.onResetCamera = (evt) => {\n            this.resetCrosshairs();\n        };\n        this.mouseMoveCallback = (evt, filteredToolAnnotations) => {\n            const { element, currentPoints } = evt.detail;\n            const canvasCoords = currentPoints.canvas;\n            let imageNeedsUpdate = false;\n            for (let i = 0; i < filteredToolAnnotations.length; i++) {\n                const annotation = filteredToolAnnotations[i];\n                if (isAnnotationLocked(annotation.annotationUID)) {\n                    continue;\n                }\n                const { data, highlighted } = annotation;\n                if (!data.handles) {\n                    continue;\n                }\n                const previousActiveOperation = data.handles.activeOperation;\n                const previousActiveViewportIds = data.activeViewportIds && data.activeViewportIds.length > 0\n                    ? [...data.activeViewportIds]\n                    : [];\n                data.activeViewportIds = [];\n                data.handles.activeOperation = null;\n                const handleNearImagePoint = this.getHandleNearImagePoint(element, annotation, canvasCoords, 6);\n                let near = false;\n                if (handleNearImagePoint) {\n                    near = true;\n                }\n                else {\n                    near = this._pointNearTool(element, annotation, canvasCoords, 6);\n                }\n                const nearToolAndNotMarkedActive = near && !highlighted;\n                const notNearToolAndMarkedActive = !near && highlighted;\n                if (nearToolAndNotMarkedActive || notNearToolAndMarkedActive) {\n                    annotation.highlighted = !highlighted;\n                    imageNeedsUpdate = true;\n                }\n                else if (data.handles.activeOperation !== previousActiveOperation ||\n                    !this._areViewportIdArraysEqual(data.activeViewportIds, previousActiveViewportIds)) {\n                    imageNeedsUpdate = true;\n                }\n            }\n            return imageNeedsUpdate;\n        };\n        this.filterInteractableAnnotationsForElement = (element, annotations) => {\n            if (!annotations || !annotations.length) {\n                return [];\n            }\n            const enabledElement = getEnabledElement(element);\n            const { viewportId } = enabledElement;\n            const viewportUIDSpecificCrosshairs = annotations.filter((annotation) => annotation.data.viewportId === viewportId);\n            return viewportUIDSpecificCrosshairs;\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport, renderingEngine } = enabledElement;\n            const { element } = viewport;\n            const annotations = this._getAnnotations(enabledElement);\n            const camera = viewport.getCamera();\n            const filteredToolAnnotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            const viewportAnnotation = filteredToolAnnotations[0];\n            if (!annotations?.length || !viewportAnnotation?.data) {\n                return renderStatus;\n            }\n            const annotationUID = viewportAnnotation.annotationUID;\n            const { clientWidth, clientHeight } = viewport.canvas;\n            const canvasDiagonalLength = Math.sqrt(clientWidth * clientWidth + clientHeight * clientHeight);\n            const canvasMinDimensionLength = Math.min(clientWidth, clientHeight);\n            const data = viewportAnnotation.data;\n            const crosshairCenterCanvas = viewport.worldToCanvas(this.toolCenter);\n            const otherViewportAnnotations = this._filterAnnotationsByUniqueViewportOrientations(enabledElement, annotations);\n            const referenceLines = [];\n            const canvasBox = [0, 0, clientWidth, clientHeight];\n            otherViewportAnnotations.forEach((annotation) => {\n                const { data } = annotation;\n                data.handles.toolCenter = this.toolCenter;\n                const otherViewport = renderingEngine.getViewport(data.viewportId);\n                const otherCamera = otherViewport.getCamera();\n                const otherViewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                const otherViewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id);\n                const otherViewportSlabThicknessControlsOn = this._getReferenceLineSlabThicknessControlsOn(otherViewport.id);\n                const { clientWidth, clientHeight } = otherViewport.canvas;\n                const otherCanvasDiagonalLength = Math.sqrt(clientWidth * clientWidth + clientHeight * clientHeight);\n                const otherCanvasCenter = [\n                    clientWidth * 0.5,\n                    clientHeight * 0.5,\n                ];\n                const otherViewportCenterWorld = otherViewport.canvasToWorld(otherCanvasCenter);\n                const direction = [0, 0, 0];\n                vtkMath.cross(camera.viewPlaneNormal, otherCamera.viewPlaneNormal, direction);\n                vtkMath.normalize(direction);\n                vtkMath.multiplyScalar(direction, otherCanvasDiagonalLength);\n                const pointWorld0 = [0, 0, 0];\n                vtkMath.add(otherViewportCenterWorld, direction, pointWorld0);\n                const pointWorld1 = [0, 0, 0];\n                vtkMath.subtract(otherViewportCenterWorld, direction, pointWorld1);\n                const pointCanvas0 = viewport.worldToCanvas(pointWorld0);\n                const otherViewportCenterCanvas = viewport.worldToCanvas(otherViewportCenterWorld);\n                const canvasUnitVectorFromCenter = vec2.create();\n                vec2.subtract(canvasUnitVectorFromCenter, pointCanvas0, otherViewportCenterCanvas);\n                vec2.normalize(canvasUnitVectorFromCenter, canvasUnitVectorFromCenter);\n                const canvasVectorFromCenterLong = vec2.create();\n                vec2.scale(canvasVectorFromCenterLong, canvasUnitVectorFromCenter, canvasDiagonalLength * 100);\n                const canvasVectorFromCenterMid = vec2.create();\n                vec2.scale(canvasVectorFromCenterMid, canvasUnitVectorFromCenter, canvasMinDimensionLength * 0.4);\n                const canvasVectorFromCenterShort = vec2.create();\n                vec2.scale(canvasVectorFromCenterShort, canvasUnitVectorFromCenter, canvasMinDimensionLength * 0.2);\n                const canvasVectorFromCenterStart = vec2.create();\n                const centerGap = this.configuration.referenceLinesCenterGapRadius;\n                vec2.scale(canvasVectorFromCenterStart, canvasUnitVectorFromCenter, otherViewportAnnotations.length === 2 ? centerGap : 0);\n                const refLinePointOne = vec2.create();\n                const refLinePointTwo = vec2.create();\n                const refLinePointThree = vec2.create();\n                const refLinePointFour = vec2.create();\n                let refLinesCenter = vec2.clone(crosshairCenterCanvas);\n                if (!otherViewportDraggableRotatable || !otherViewportControllable) {\n                    refLinesCenter = vec2.clone(otherViewportCenterCanvas);\n                }\n                vec2.add(refLinePointOne, refLinesCenter, canvasVectorFromCenterStart);\n                vec2.add(refLinePointTwo, refLinesCenter, canvasVectorFromCenterLong);\n                vec2.subtract(refLinePointThree, refLinesCenter, canvasVectorFromCenterStart);\n                vec2.subtract(refLinePointFour, refLinesCenter, canvasVectorFromCenterLong);\n                liangBarksyClip(refLinePointOne, refLinePointTwo, canvasBox);\n                liangBarksyClip(refLinePointThree, refLinePointFour, canvasBox);\n                const rotHandleOne = vec2.create();\n                vec2.subtract(rotHandleOne, crosshairCenterCanvas, canvasVectorFromCenterMid);\n                const rotHandleTwo = vec2.create();\n                vec2.add(rotHandleTwo, crosshairCenterCanvas, canvasVectorFromCenterMid);\n                let stHandlesCenterCanvas = vec2.clone(crosshairCenterCanvas);\n                if (!otherViewportDraggableRotatable &&\n                    otherViewportSlabThicknessControlsOn) {\n                    stHandlesCenterCanvas = vec2.clone(otherViewportCenterCanvas);\n                }\n                let stHandlesCenterWorld = [...this.toolCenter];\n                if (!otherViewportDraggableRotatable &&\n                    otherViewportSlabThicknessControlsOn) {\n                    stHandlesCenterWorld = [...otherViewportCenterWorld];\n                }\n                const worldUnitVectorFromCenter = [0, 0, 0];\n                vtkMath.subtract(pointWorld0, pointWorld1, worldUnitVectorFromCenter);\n                vtkMath.normalize(worldUnitVectorFromCenter);\n                const { viewPlaneNormal } = camera;\n                const { matrix } = vtkMatrixBuilder\n                    .buildFromDegree()\n                    .rotate(90, viewPlaneNormal);\n                const worldUnitOrthoVectorFromCenter = [0, 0, 0];\n                vec3.transformMat4(worldUnitOrthoVectorFromCenter, worldUnitVectorFromCenter, matrix);\n                const slabThicknessValue = otherViewport.getSlabThickness();\n                const worldOrthoVectorFromCenter = [\n                    ...worldUnitOrthoVectorFromCenter,\n                ];\n                vtkMath.multiplyScalar(worldOrthoVectorFromCenter, slabThicknessValue);\n                const worldVerticalRefPoint = [0, 0, 0];\n                vtkMath.add(stHandlesCenterWorld, worldOrthoVectorFromCenter, worldVerticalRefPoint);\n                const canvasVerticalRefPoint = viewport.worldToCanvas(worldVerticalRefPoint);\n                const canvasOrthoVectorFromCenter = vec2.create();\n                vec2.subtract(canvasOrthoVectorFromCenter, stHandlesCenterCanvas, canvasVerticalRefPoint);\n                const stLinePointOne = vec2.create();\n                vec2.subtract(stLinePointOne, stHandlesCenterCanvas, canvasVectorFromCenterLong);\n                vec2.add(stLinePointOne, stLinePointOne, canvasOrthoVectorFromCenter);\n                const stLinePointTwo = vec2.create();\n                vec2.add(stLinePointTwo, stHandlesCenterCanvas, canvasVectorFromCenterLong);\n                vec2.add(stLinePointTwo, stLinePointTwo, canvasOrthoVectorFromCenter);\n                liangBarksyClip(stLinePointOne, stLinePointTwo, canvasBox);\n                const stLinePointThree = vec2.create();\n                vec2.add(stLinePointThree, stHandlesCenterCanvas, canvasVectorFromCenterLong);\n                vec2.subtract(stLinePointThree, stLinePointThree, canvasOrthoVectorFromCenter);\n                const stLinePointFour = vec2.create();\n                vec2.subtract(stLinePointFour, stHandlesCenterCanvas, canvasVectorFromCenterLong);\n                vec2.subtract(stLinePointFour, stLinePointFour, canvasOrthoVectorFromCenter);\n                liangBarksyClip(stLinePointThree, stLinePointFour, canvasBox);\n                const stHandleOne = vec2.create();\n                const stHandleTwo = vec2.create();\n                const stHandleThree = vec2.create();\n                const stHandleFour = vec2.create();\n                vec2.subtract(stHandleOne, stHandlesCenterCanvas, canvasVectorFromCenterShort);\n                vec2.add(stHandleOne, stHandleOne, canvasOrthoVectorFromCenter);\n                vec2.add(stHandleTwo, stHandlesCenterCanvas, canvasVectorFromCenterShort);\n                vec2.add(stHandleTwo, stHandleTwo, canvasOrthoVectorFromCenter);\n                vec2.subtract(stHandleThree, stHandlesCenterCanvas, canvasVectorFromCenterShort);\n                vec2.subtract(stHandleThree, stHandleThree, canvasOrthoVectorFromCenter);\n                vec2.add(stHandleFour, stHandlesCenterCanvas, canvasVectorFromCenterShort);\n                vec2.subtract(stHandleFour, stHandleFour, canvasOrthoVectorFromCenter);\n                referenceLines.push([\n                    otherViewport,\n                    refLinePointOne,\n                    refLinePointTwo,\n                    refLinePointThree,\n                    refLinePointFour,\n                    stLinePointOne,\n                    stLinePointTwo,\n                    stLinePointThree,\n                    stLinePointFour,\n                    rotHandleOne,\n                    rotHandleTwo,\n                    stHandleOne,\n                    stHandleTwo,\n                    stHandleThree,\n                    stHandleFour,\n                ]);\n            });\n            const newRtpoints = [];\n            const newStpoints = [];\n            const viewportColor = this._getReferenceLineColor(viewport.id);\n            const color = viewportColor !== undefined ? viewportColor : 'rgb(200, 200, 200)';\n            referenceLines.forEach((line, lineIndex) => {\n                const otherViewport = line[0];\n                const viewportColor = this._getReferenceLineColor(otherViewport.id);\n                const viewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                const viewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id) ||\n                    this.configuration.mobile?.enabled;\n                const viewportSlabThicknessControlsOn = this._getReferenceLineSlabThicknessControlsOn(otherViewport.id) ||\n                    this.configuration.mobile?.enabled;\n                const selectedViewportId = data.activeViewportIds.find((id) => id === otherViewport.id);\n                let color = viewportColor !== undefined ? viewportColor : 'rgb(200, 200, 200)';\n                let lineWidth = 1;\n                const lineActive = data.handles.activeOperation !== null &&\n                    data.handles.activeOperation === OPERATION.DRAG &&\n                    selectedViewportId;\n                if (lineActive) {\n                    lineWidth = 2.5;\n                }\n                let lineUID = `${lineIndex}`;\n                if (viewportControllable && viewportDraggableRotatable) {\n                    lineUID = `${lineIndex}One`;\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, line[1], line[2], {\n                        color,\n                        lineWidth,\n                    });\n                    lineUID = `${lineIndex}Two`;\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, line[3], line[4], {\n                        color,\n                        lineWidth,\n                    });\n                }\n                else {\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, line[2], line[4], {\n                        color,\n                        lineWidth,\n                    });\n                }\n                if (viewportControllable) {\n                    color =\n                        viewportColor !== undefined ? viewportColor : 'rgb(200, 200, 200)';\n                    const rotHandlesActive = data.handles.activeOperation === OPERATION.ROTATE;\n                    const rotationHandles = [line[9], line[10]];\n                    const rotHandleWorldOne = [\n                        viewport.canvasToWorld(line[9]),\n                        otherViewport,\n                        line[1],\n                        line[2],\n                    ];\n                    const rotHandleWorldTwo = [\n                        viewport.canvasToWorld(line[10]),\n                        otherViewport,\n                        line[3],\n                        line[4],\n                    ];\n                    newRtpoints.push(rotHandleWorldOne, rotHandleWorldTwo);\n                    const slabThicknessHandlesActive = data.handles.activeOperation === OPERATION.SLAB;\n                    const slabThicknessHandles = [line[11], line[12], line[13], line[14]];\n                    const slabThicknessHandleWorldOne = [\n                        viewport.canvasToWorld(line[11]),\n                        otherViewport,\n                        line[5],\n                        line[6],\n                    ];\n                    const slabThicknessHandleWorldTwo = [\n                        viewport.canvasToWorld(line[12]),\n                        otherViewport,\n                        line[5],\n                        line[6],\n                    ];\n                    const slabThicknessHandleWorldThree = [\n                        viewport.canvasToWorld(line[13]),\n                        otherViewport,\n                        line[7],\n                        line[8],\n                    ];\n                    const slabThicknessHandleWorldFour = [\n                        viewport.canvasToWorld(line[14]),\n                        otherViewport,\n                        line[7],\n                        line[8],\n                    ];\n                    newStpoints.push(slabThicknessHandleWorldOne, slabThicknessHandleWorldTwo, slabThicknessHandleWorldThree, slabThicknessHandleWorldFour);\n                    if ((lineActive || this.configuration.mobile?.enabled) &&\n                        !rotHandlesActive &&\n                        !slabThicknessHandlesActive &&\n                        viewportDraggableRotatable &&\n                        viewportSlabThicknessControlsOn) {\n                        let handleUID = `${lineIndex}One`;\n                        drawHandlesSvg(svgDrawingHelper, annotationUID, handleUID, rotationHandles, {\n                            color,\n                            handleRadius: this.configuration.mobile?.enabled\n                                ? this.configuration.mobile?.handleRadius\n                                : 3,\n                            opacity: this.configuration.mobile?.enabled\n                                ? this.configuration.mobile?.opacity\n                                : 1,\n                            type: 'circle',\n                        });\n                        handleUID = `${lineIndex}Two`;\n                        drawHandlesSvg(svgDrawingHelper, annotationUID, handleUID, slabThicknessHandles, {\n                            color,\n                            handleRadius: this.configuration.mobile?.enabled\n                                ? this.configuration.mobile?.handleRadius\n                                : 3,\n                            opacity: this.configuration.mobile?.enabled\n                                ? this.configuration.mobile?.opacity\n                                : 1,\n                            type: 'rect',\n                        });\n                    }\n                    else if (lineActive &&\n                        !rotHandlesActive &&\n                        !slabThicknessHandlesActive &&\n                        viewportDraggableRotatable) {\n                        const handleUID = `${lineIndex}`;\n                        drawHandlesSvg(svgDrawingHelper, annotationUID, handleUID, rotationHandles, {\n                            color,\n                            handleRadius: this.configuration.mobile?.enabled\n                                ? this.configuration.mobile?.handleRadius\n                                : 3,\n                            opacity: this.configuration.mobile?.enabled\n                                ? this.configuration.mobile?.opacity\n                                : 1,\n                            type: 'circle',\n                        });\n                    }\n                    else if (selectedViewportId &&\n                        !rotHandlesActive &&\n                        !slabThicknessHandlesActive &&\n                        viewportSlabThicknessControlsOn) {\n                        const handleUID = `${lineIndex}`;\n                        drawHandlesSvg(svgDrawingHelper, annotationUID, handleUID, slabThicknessHandles, {\n                            color,\n                            handleRadius: this.configuration.mobile?.enabled\n                                ? this.configuration.mobile?.handleRadius\n                                : 3,\n                            opacity: this.configuration.mobile?.enabled\n                                ? this.configuration.mobile?.opacity\n                                : 1,\n                            type: 'rect',\n                        });\n                    }\n                    else if (rotHandlesActive && viewportDraggableRotatable) {\n                        const handleUID = `${lineIndex}`;\n                        drawHandlesSvg(svgDrawingHelper, annotationUID, handleUID, rotationHandles, {\n                            color,\n                            handleRadius: 2,\n                            fill: color,\n                            type: 'circle',\n                        });\n                    }\n                    else if (slabThicknessHandlesActive &&\n                        selectedViewportId &&\n                        viewportSlabThicknessControlsOn) {\n                        drawHandlesSvg(svgDrawingHelper, annotationUID, lineUID, slabThicknessHandles, {\n                            color,\n                            handleRadius: 2,\n                            fill: color,\n                            type: 'rect',\n                        });\n                    }\n                    const slabThicknessValue = otherViewport.getSlabThickness();\n                    if (slabThicknessValue > 0.5 && viewportSlabThicknessControlsOn) {\n                        lineUID = `${lineIndex}STOne`;\n                        drawLineSvg(svgDrawingHelper, annotationUID, lineUID, line[5], line[6], {\n                            color,\n                            width: 1,\n                            lineDash: [2, 3],\n                        });\n                        lineUID = `${lineIndex}STTwo`;\n                        drawLineSvg(svgDrawingHelper, annotationUID, lineUID, line[7], line[8], {\n                            color,\n                            width: line,\n                            lineDash: [2, 3],\n                        });\n                    }\n                }\n            });\n            renderStatus = true;\n            data.handles.rotationPoints = newRtpoints;\n            data.handles.slabThicknessPoints = newStpoints;\n            if (this.configuration.viewportIndicators) {\n                const { viewportIndicatorsConfig } = this.configuration;\n                const xOffset = viewportIndicatorsConfig?.xOffset || 0.95;\n                const yOffset = viewportIndicatorsConfig?.yOffset || 0.05;\n                const referenceColorCoordinates = [\n                    clientWidth * xOffset,\n                    clientHeight * yOffset,\n                ];\n                const circleRadius = viewportIndicatorsConfig?.circleRadius || canvasDiagonalLength * 0.01;\n                const circleUID = '0';\n                drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, referenceColorCoordinates, circleRadius, { color, fill: color });\n            }\n            return renderStatus;\n        };\n        this._getAnnotations = (enabledElement) => {\n            const { viewport } = enabledElement;\n            const annotations = getAnnotations(this.getToolName(), viewport.element) || [];\n            const viewportIds = this._getViewportsInfo().map(({ viewportId }) => viewportId);\n            const toolGroupAnnotations = annotations.filter((annotation) => {\n                const { data } = annotation;\n                return viewportIds.includes(data.viewportId);\n            });\n            return toolGroupAnnotations;\n        };\n        this._onNewVolume = () => {\n            const viewportsInfo = this._getViewportsInfo();\n            this._computeToolCenter(viewportsInfo);\n        };\n        this._areViewportIdArraysEqual = (viewportIdArrayOne, viewportIdArrayTwo) => {\n            if (viewportIdArrayOne.length !== viewportIdArrayTwo.length) {\n                return false;\n            }\n            viewportIdArrayOne.forEach((id) => {\n                let itemFound = false;\n                for (let i = 0; i < viewportIdArrayTwo.length; ++i) {\n                    if (id === viewportIdArrayTwo[i]) {\n                        itemFound = true;\n                        break;\n                    }\n                }\n                if (itemFound === false) {\n                    return false;\n                }\n            });\n            return true;\n        };\n        this._getAnnotationsForViewportsWithDifferentCameras = (enabledElement, annotations) => {\n            const { viewportId, renderingEngine, viewport } = enabledElement;\n            const otherViewportAnnotations = annotations.filter((annotation) => annotation.data.viewportId !== viewportId);\n            if (!otherViewportAnnotations || !otherViewportAnnotations.length) {\n                return [];\n            }\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, position } = camera;\n            const viewportsWithDifferentCameras = otherViewportAnnotations.filter((annotation) => {\n                const { viewportId } = annotation.data;\n                const targetViewport = renderingEngine.getViewport(viewportId);\n                const cameraOfTarget = targetViewport.getCamera();\n                return !(csUtils.isEqual(cameraOfTarget.viewPlaneNormal, viewPlaneNormal, 1e-2) && csUtils.isEqual(cameraOfTarget.position, position, 1));\n            });\n            return viewportsWithDifferentCameras;\n        };\n        this._filterViewportWithSameOrientation = (enabledElement, referenceAnnotation, annotations) => {\n            const { renderingEngine } = enabledElement;\n            const { data } = referenceAnnotation;\n            const viewport = renderingEngine.getViewport(data.viewportId);\n            const linkedViewportAnnotations = annotations.filter((annotation) => {\n                const { data } = annotation;\n                const otherViewport = renderingEngine.getViewport(data.viewportId);\n                const otherViewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                return otherViewportControllable === true;\n            });\n            if (!linkedViewportAnnotations || !linkedViewportAnnotations.length) {\n                return [];\n            }\n            const camera = viewport.getCamera();\n            const viewPlaneNormal = camera.viewPlaneNormal;\n            vtkMath.normalize(viewPlaneNormal);\n            const otherViewportsAnnotationsWithSameCameraDirection = linkedViewportAnnotations.filter((annotation) => {\n                const { viewportId } = annotation.data;\n                const otherViewport = renderingEngine.getViewport(viewportId);\n                const otherCamera = otherViewport.getCamera();\n                const otherViewPlaneNormal = otherCamera.viewPlaneNormal;\n                vtkMath.normalize(otherViewPlaneNormal);\n                return (csUtils.isEqual(viewPlaneNormal, otherViewPlaneNormal, 1e-2) &&\n                    csUtils.isEqual(camera.viewUp, otherCamera.viewUp, 1e-2));\n            });\n            return otherViewportsAnnotationsWithSameCameraDirection;\n        };\n        this._filterAnnotationsByUniqueViewportOrientations = (enabledElement, annotations) => {\n            const { renderingEngine, viewport } = enabledElement;\n            const camera = viewport.getCamera();\n            const viewPlaneNormal = camera.viewPlaneNormal;\n            vtkMath.normalize(viewPlaneNormal);\n            const otherLinkedViewportAnnotationsFromSameScene = annotations.filter((annotation) => {\n                const { data } = annotation;\n                const otherViewport = renderingEngine.getViewport(data.viewportId);\n                const otherViewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                return (viewport !== otherViewport &&\n                    otherViewportControllable === true);\n            });\n            const otherViewportsAnnotationsWithUniqueCameras = [];\n            for (let i = 0; i < otherLinkedViewportAnnotationsFromSameScene.length; ++i) {\n                const annotation = otherLinkedViewportAnnotationsFromSameScene[i];\n                const { viewportId } = annotation.data;\n                const otherViewport = renderingEngine.getViewport(viewportId);\n                const otherCamera = otherViewport.getCamera();\n                const otherViewPlaneNormal = otherCamera.viewPlaneNormal;\n                vtkMath.normalize(otherViewPlaneNormal);\n                if (csUtils.isEqual(viewPlaneNormal, otherViewPlaneNormal, 1e-2) ||\n                    csUtils.isOpposite(viewPlaneNormal, otherViewPlaneNormal, 1e-2)) {\n                    continue;\n                }\n                let cameraFound = false;\n                for (let jj = 0; jj < otherViewportsAnnotationsWithUniqueCameras.length; ++jj) {\n                    const annotation = otherViewportsAnnotationsWithUniqueCameras[jj];\n                    const { viewportId } = annotation.data;\n                    const stockedViewport = renderingEngine.getViewport(viewportId);\n                    const cameraOfStocked = stockedViewport.getCamera();\n                    if (csUtils.isEqual(cameraOfStocked.viewPlaneNormal, otherCamera.viewPlaneNormal, 1e-2) &&\n                        csUtils.isEqual(cameraOfStocked.position, otherCamera.position, 1)) {\n                        cameraFound = true;\n                    }\n                }\n                if (!cameraFound) {\n                    otherViewportsAnnotationsWithUniqueCameras.push(annotation);\n                }\n            }\n            const otherNonLinkedViewportAnnotationsFromSameScene = annotations.filter((annotation) => {\n                const { data } = annotation;\n                const otherViewport = renderingEngine.getViewport(data.viewportId);\n                const otherViewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                return (viewport !== otherViewport &&\n                    otherViewportControllable !== true);\n            });\n            for (let i = 0; i < otherNonLinkedViewportAnnotationsFromSameScene.length; ++i) {\n                const annotation = otherNonLinkedViewportAnnotationsFromSameScene[i];\n                const { viewportId } = annotation.data;\n                const otherViewport = renderingEngine.getViewport(viewportId);\n                const otherCamera = otherViewport.getCamera();\n                const otherViewPlaneNormal = otherCamera.viewPlaneNormal;\n                vtkMath.normalize(otherViewPlaneNormal);\n                if (csUtils.isEqual(viewPlaneNormal, otherViewPlaneNormal, 1e-2) ||\n                    csUtils.isOpposite(viewPlaneNormal, otherViewPlaneNormal, 1e-2)) {\n                    continue;\n                }\n                let cameraFound = false;\n                for (let jj = 0; jj < otherViewportsAnnotationsWithUniqueCameras.length; ++jj) {\n                    const annotation = otherViewportsAnnotationsWithUniqueCameras[jj];\n                    const { viewportId } = annotation.data;\n                    const stockedViewport = renderingEngine.getViewport(viewportId);\n                    const cameraOfStocked = stockedViewport.getCamera();\n                    if (csUtils.isEqual(cameraOfStocked.viewPlaneNormal, otherCamera.viewPlaneNormal, 1e-2) &&\n                        csUtils.isEqual(cameraOfStocked.position, otherCamera.position, 1)) {\n                        cameraFound = true;\n                    }\n                }\n                if (!cameraFound) {\n                    otherViewportsAnnotationsWithUniqueCameras.push(annotation);\n                }\n            }\n            const otherViewportAnnotations = this._getAnnotationsForViewportsWithDifferentCameras(enabledElement, annotations);\n            for (let i = 0; i < otherViewportAnnotations.length; ++i) {\n                const annotation = otherViewportAnnotations[i];\n                if (otherViewportsAnnotationsWithUniqueCameras.some((element) => element === annotation)) {\n                    continue;\n                }\n                const { viewportId } = annotation.data;\n                const otherViewport = renderingEngine.getViewport(viewportId);\n                const otherCamera = otherViewport.getCamera();\n                const otherViewPlaneNormal = otherCamera.viewPlaneNormal;\n                vtkMath.normalize(otherViewPlaneNormal);\n                if (csUtils.isEqual(viewPlaneNormal, otherViewPlaneNormal, 1e-2) ||\n                    csUtils.isOpposite(viewPlaneNormal, otherViewPlaneNormal, 1e-2)) {\n                    continue;\n                }\n                let cameraFound = false;\n                for (let jj = 0; jj < otherViewportsAnnotationsWithUniqueCameras.length; ++jj) {\n                    const annotation = otherViewportsAnnotationsWithUniqueCameras[jj];\n                    const { viewportId } = annotation.data;\n                    const stockedViewport = renderingEngine.getViewport(viewportId);\n                    const cameraOfStocked = stockedViewport.getCamera();\n                    if (csUtils.isEqual(cameraOfStocked.viewPlaneNormal, otherCamera.viewPlaneNormal, 1e-2) &&\n                        csUtils.isEqual(cameraOfStocked.position, otherCamera.position, 1)) {\n                        cameraFound = true;\n                    }\n                }\n                if (!cameraFound) {\n                    otherViewportsAnnotationsWithUniqueCameras.push(annotation);\n                }\n            }\n            return otherViewportsAnnotationsWithUniqueCameras;\n        };\n        this._checkIfViewportsRenderingSameScene = (viewport, otherViewport) => {\n            const volumeIds = viewport.getAllVolumeIds();\n            const otherVolumeIds = otherViewport.getAllVolumeIds();\n            return (volumeIds.length === otherVolumeIds.length &&\n                volumeIds.every((id) => otherVolumeIds.includes(id)));\n        };\n        this._jump = (enabledElement, jumpWorld) => {\n            state.isInteractingWithTool = true;\n            const { viewport, renderingEngine } = enabledElement;\n            const annotations = this._getAnnotations(enabledElement);\n            const delta = [0, 0, 0];\n            vtkMath.subtract(jumpWorld, this.toolCenter, delta);\n            const otherViewportAnnotations = this._getAnnotationsForViewportsWithDifferentCameras(enabledElement, annotations);\n            const viewportsAnnotationsToUpdate = otherViewportAnnotations.filter((annotation) => {\n                const { data } = annotation;\n                const otherViewport = renderingEngine.getViewport(data.viewportId);\n                const sameScene = this._checkIfViewportsRenderingSameScene(viewport, otherViewport);\n                return (this._getReferenceLineControllable(otherViewport.id) &&\n                    this._getReferenceLineDraggableRotatable(otherViewport.id) &&\n                    sameScene);\n            });\n            if (viewportsAnnotationsToUpdate.length === 0) {\n                state.isInteractingWithTool = false;\n                return false;\n            }\n            this._applyDeltaShiftToSelectedViewportCameras(renderingEngine, viewportsAnnotationsToUpdate, delta);\n            state.isInteractingWithTool = false;\n            return true;\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = !this.configuration.mobile?.enabled;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            this.editData.annotation.data.handles.activeOperation = null;\n            this.editData.annotation.data.activeViewportIds = [];\n            this._deactivateModify(element);\n            resetElementCursor(element);\n            this.editData = null;\n            const requireSameOrientation = false;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName(), requireSameOrientation);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const delta = eventDetail.deltaPoints.world;\n            if (Math.abs(delta[0]) < 1e-3 &&\n                Math.abs(delta[1]) < 1e-3 &&\n                Math.abs(delta[2]) < 1e-3) {\n                return;\n            }\n            const { element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const annotations = this._getAnnotations(enabledElement);\n            const filteredToolAnnotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            const viewportAnnotation = filteredToolAnnotations[0];\n            if (!viewportAnnotation) {\n                return;\n            }\n            const { handles } = viewportAnnotation.data;\n            const { currentPoints } = evt.detail;\n            const canvasCoords = currentPoints.canvas;\n            if (handles.activeOperation === OPERATION.DRAG) {\n                const otherViewportAnnotations = this._getAnnotationsForViewportsWithDifferentCameras(enabledElement, annotations);\n                const viewportsAnnotationsToUpdate = otherViewportAnnotations.filter((annotation) => {\n                    const { data } = annotation;\n                    const otherViewport = renderingEngine.getViewport(data.viewportId);\n                    const otherViewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                    const otherViewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id);\n                    return (otherViewportControllable === true &&\n                        otherViewportDraggableRotatable === true &&\n                        viewportAnnotation.data.activeViewportIds.find((id) => id === otherViewport.id));\n                });\n                this._applyDeltaShiftToSelectedViewportCameras(renderingEngine, viewportsAnnotationsToUpdate, delta);\n            }\n            else if (handles.activeOperation === OPERATION.ROTATE) {\n                const otherViewportAnnotations = this._getAnnotationsForViewportsWithDifferentCameras(enabledElement, annotations);\n                const viewportsAnnotationsToUpdate = otherViewportAnnotations.filter((annotation) => {\n                    const { data } = annotation;\n                    const otherViewport = renderingEngine.getViewport(data.viewportId);\n                    const otherViewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                    const otherViewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id);\n                    return (otherViewportControllable === true &&\n                        otherViewportDraggableRotatable === true);\n                });\n                const dir1 = vec2.create();\n                const dir2 = vec2.create();\n                const center = [\n                    this.toolCenter[0],\n                    this.toolCenter[1],\n                    this.toolCenter[2],\n                ];\n                const centerCanvas = viewport.worldToCanvas(center);\n                const finalPointCanvas = eventDetail.currentPoints.canvas;\n                const originalPointCanvas = vec2.create();\n                vec2.sub(originalPointCanvas, finalPointCanvas, eventDetail.deltaPoints.canvas);\n                vec2.sub(dir1, originalPointCanvas, centerCanvas);\n                vec2.sub(dir2, finalPointCanvas, centerCanvas);\n                let angle = vec2.angle(dir1, dir2);\n                if (this._isClockWise(centerCanvas, originalPointCanvas, finalPointCanvas)) {\n                    angle *= -1;\n                }\n                angle = Math.round(angle * 100) / 100;\n                const rotationAxis = viewport.getCamera().viewPlaneNormal;\n                const { matrix } = vtkMatrixBuilder\n                    .buildFromRadian()\n                    .translate(center[0], center[1], center[2])\n                    .rotate(angle, rotationAxis)\n                    .translate(-center[0], -center[1], -center[2]);\n                const otherViewportsIds = [];\n                viewportsAnnotationsToUpdate.forEach((annotation) => {\n                    const { data } = annotation;\n                    data.handles.toolCenter = center;\n                    const otherViewport = renderingEngine.getViewport(data.viewportId);\n                    const camera = otherViewport.getCamera();\n                    const { viewUp, position, focalPoint } = camera;\n                    viewUp[0] += position[0];\n                    viewUp[1] += position[1];\n                    viewUp[2] += position[2];\n                    vec3.transformMat4(focalPoint, focalPoint, matrix);\n                    vec3.transformMat4(position, position, matrix);\n                    vec3.transformMat4(viewUp, viewUp, matrix);\n                    viewUp[0] -= position[0];\n                    viewUp[1] -= position[1];\n                    viewUp[2] -= position[2];\n                    otherViewport.setCamera({\n                        position,\n                        viewUp,\n                        focalPoint,\n                    });\n                    otherViewportsIds.push(otherViewport.id);\n                });\n                renderingEngine.renderViewports(otherViewportsIds);\n            }\n            else if (handles.activeOperation === OPERATION.SLAB) {\n                const otherViewportAnnotations = this._getAnnotationsForViewportsWithDifferentCameras(enabledElement, annotations);\n                const referenceAnnotations = otherViewportAnnotations.filter((annotation) => {\n                    const { data } = annotation;\n                    const otherViewport = renderingEngine.getViewport(data.viewportId);\n                    const otherViewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                    const otherViewportSlabThicknessControlsOn = this._getReferenceLineSlabThicknessControlsOn(otherViewport.id);\n                    return (otherViewportControllable === true &&\n                        otherViewportSlabThicknessControlsOn === true &&\n                        viewportAnnotation.data.activeViewportIds.find((id) => id === otherViewport.id));\n                });\n                if (referenceAnnotations.length === 0) {\n                    return;\n                }\n                const viewportsAnnotationsToUpdate = this._filterViewportWithSameOrientation(enabledElement, referenceAnnotations[0], annotations);\n                const viewportsIds = [];\n                viewportsIds.push(viewport.id);\n                viewportsAnnotationsToUpdate.forEach((annotation) => {\n                    const { data } = annotation;\n                    const otherViewport = renderingEngine.getViewport(data.viewportId);\n                    const camera = otherViewport.getCamera();\n                    const normal = camera.viewPlaneNormal;\n                    const dotProd = vtkMath.dot(delta, normal);\n                    const projectedDelta = [...normal];\n                    vtkMath.multiplyScalar(projectedDelta, dotProd);\n                    if (Math.abs(projectedDelta[0]) > 1e-3 ||\n                        Math.abs(projectedDelta[1]) > 1e-3 ||\n                        Math.abs(projectedDelta[2]) > 1e-3) {\n                        const mod = Math.sqrt(projectedDelta[0] * projectedDelta[0] +\n                            projectedDelta[1] * projectedDelta[1] +\n                            projectedDelta[2] * projectedDelta[2]);\n                        const currentPoint = eventDetail.lastPoints.world;\n                        const direction = [0, 0, 0];\n                        const currentCenter = [\n                            this.toolCenter[0],\n                            this.toolCenter[1],\n                            this.toolCenter[2],\n                        ];\n                        const viewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id);\n                        if (!viewportDraggableRotatable) {\n                            const { rotationPoints } = this.editData.annotation.data.handles;\n                            const otherViewportRotationPoints = rotationPoints.filter((point) => point[1].uid === otherViewport.id);\n                            if (otherViewportRotationPoints.length === 2) {\n                                const point1 = viewport.canvasToWorld(otherViewportRotationPoints[0][3]);\n                                const point2 = viewport.canvasToWorld(otherViewportRotationPoints[1][3]);\n                                vtkMath.add(point1, point2, currentCenter);\n                                vtkMath.multiplyScalar(currentCenter, 0.5);\n                            }\n                        }\n                        vtkMath.subtract(currentPoint, currentCenter, direction);\n                        const dotProdDirection = vtkMath.dot(direction, normal);\n                        const projectedDirection = [...normal];\n                        vtkMath.multiplyScalar(projectedDirection, dotProdDirection);\n                        const normalizedProjectedDirection = [\n                            projectedDirection[0],\n                            projectedDirection[1],\n                            projectedDirection[2],\n                        ];\n                        vec3.normalize(normalizedProjectedDirection, normalizedProjectedDirection);\n                        const normalizedProjectedDelta = [\n                            projectedDelta[0],\n                            projectedDelta[1],\n                            projectedDelta[2],\n                        ];\n                        vec3.normalize(normalizedProjectedDelta, normalizedProjectedDelta);\n                        let slabThicknessValue = otherViewport.getSlabThickness();\n                        if (csUtils.isOpposite(normalizedProjectedDirection, normalizedProjectedDelta, 1e-3)) {\n                            slabThicknessValue -= mod;\n                        }\n                        else {\n                            slabThicknessValue += mod;\n                        }\n                        slabThicknessValue = Math.abs(slabThicknessValue);\n                        slabThicknessValue = Math.max(RENDERING_DEFAULTS.MINIMUM_SLAB_THICKNESS, slabThicknessValue);\n                        const near = this._pointNearReferenceLine(viewportAnnotation, canvasCoords, 6, otherViewport);\n                        if (near) {\n                            slabThicknessValue = RENDERING_DEFAULTS.MINIMUM_SLAB_THICKNESS;\n                        }\n                        const toolGroup = getToolGroupForViewport(otherViewport.id, renderingEngine.id);\n                        const crosshairsInstance = toolGroup.getToolInstance(this.getToolName());\n                        crosshairsInstance.setSlabThickness(otherViewport, slabThicknessValue);\n                        viewportsIds.push(otherViewport.id);\n                    }\n                });\n                renderingEngine.renderViewports(viewportsIds);\n            }\n        };\n        this._pointNearReferenceLine = (annotation, canvasCoords, proximity, lineViewport) => {\n            const { data } = annotation;\n            const { rotationPoints } = data.handles;\n            for (let i = 0; i < rotationPoints.length - 1; ++i) {\n                const otherViewport = rotationPoints[i][1];\n                if (otherViewport.id !== lineViewport.id) {\n                    continue;\n                }\n                const viewportControllable = this._getReferenceLineControllable(otherViewport.id);\n                if (!viewportControllable) {\n                    continue;\n                }\n                const lineSegment1 = {\n                    start: {\n                        x: rotationPoints[i][2][0],\n                        y: rotationPoints[i][2][1],\n                    },\n                    end: {\n                        x: rotationPoints[i][3][0],\n                        y: rotationPoints[i][3][1],\n                    },\n                };\n                const distanceToPoint1 = lineSegment.distanceToPoint([lineSegment1.start.x, lineSegment1.start.y], [lineSegment1.end.x, lineSegment1.end.y], [canvasCoords[0], canvasCoords[1]]);\n                const lineSegment2 = {\n                    start: {\n                        x: rotationPoints[i + 1][2][0],\n                        y: rotationPoints[i + 1][2][1],\n                    },\n                    end: {\n                        x: rotationPoints[i + 1][3][0],\n                        y: rotationPoints[i + 1][3][1],\n                    },\n                };\n                const distanceToPoint2 = lineSegment.distanceToPoint([lineSegment2.start.x, lineSegment2.start.y], [lineSegment2.end.x, lineSegment2.end.y], [canvasCoords[0], canvasCoords[1]]);\n                if (distanceToPoint1 <= proximity || distanceToPoint2 <= proximity) {\n                    return true;\n                }\n                i++;\n            }\n            return false;\n        };\n        this._getReferenceLineColor =\n            toolProps.configuration?.getReferenceLineColor ||\n                defaultReferenceLineColor;\n        this._getReferenceLineControllable =\n            toolProps.configuration?.getReferenceLineControllable ||\n                defaultReferenceLineControllable;\n        this._getReferenceLineDraggableRotatable =\n            toolProps.configuration?.getReferenceLineDraggableRotatable ||\n                defaultReferenceLineDraggableRotatable;\n        this._getReferenceLineSlabThicknessControlsOn =\n            toolProps.configuration?.getReferenceLineSlabThicknessControlsOn ||\n                defaultReferenceLineSlabThicknessControlsOn;\n    }\n    onSetToolActive() {\n        const viewportsInfo = this._getViewportsInfo();\n        this._unsubscribeToViewportNewVolumeSet(viewportsInfo);\n        this._subscribeToViewportNewVolumeSet(viewportsInfo);\n        this._computeToolCenter(viewportsInfo);\n    }\n    onSetToolPassive() {\n        const viewportsInfo = this._getViewportsInfo();\n        this._computeToolCenter(viewportsInfo);\n    }\n    onSetToolEnabled() {\n        const viewportsInfo = this._getViewportsInfo();\n        this._computeToolCenter(viewportsInfo);\n    }\n    onSetToolDisabled() {\n        const viewportsInfo = this._getViewportsInfo();\n        this._unsubscribeToViewportNewVolumeSet(viewportsInfo);\n        viewportsInfo.forEach(({ renderingEngineId, viewportId }) => {\n            const enabledElement = getEnabledElementByIds(viewportId, renderingEngineId);\n            if (!enabledElement) {\n                return;\n            }\n            const annotations = this._getAnnotations(enabledElement);\n            if (annotations?.length) {\n                annotations.forEach((annotation) => {\n                    removeAnnotation(annotation.annotationUID);\n                });\n            }\n        });\n    }\n    getHandleNearImagePoint(element, annotation, canvasCoords, proximity) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        let point = this._getRotationHandleNearImagePoint(viewport, annotation, canvasCoords, proximity);\n        if (point !== null) {\n            return point;\n        }\n        point = this._getSlabThicknessHandleNearImagePoint(viewport, annotation, canvasCoords, proximity);\n        if (point !== null) {\n            return point;\n        }\n    }\n    _unsubscribeToViewportNewVolumeSet(viewportsInfo) {\n        viewportsInfo.forEach(({ viewportId, renderingEngineId }) => {\n            const { viewport } = getEnabledElementByIds(viewportId, renderingEngineId);\n            const { element } = viewport;\n            element.removeEventListener(Enums.Events.VOLUME_VIEWPORT_NEW_VOLUME, this._onNewVolume);\n        });\n    }\n    _subscribeToViewportNewVolumeSet(viewports) {\n        viewports.forEach(({ viewportId, renderingEngineId }) => {\n            const { viewport } = getEnabledElementByIds(viewportId, renderingEngineId);\n            const { element } = viewport;\n            element.addEventListener(Enums.Events.VOLUME_VIEWPORT_NEW_VOLUME, this._onNewVolume);\n        });\n    }\n    _autoPanViewportIfNecessary(viewportId, renderingEngine) {\n        const viewport = renderingEngine.getViewport(viewportId);\n        const { clientWidth, clientHeight } = viewport.canvas;\n        const toolCenterCanvas = viewport.worldToCanvas(this.toolCenter);\n        const pan = this.configuration.autoPan.panSize;\n        const visiblePointCanvas = [\n            toolCenterCanvas[0],\n            toolCenterCanvas[1],\n        ];\n        if (toolCenterCanvas[0] < 0) {\n            visiblePointCanvas[0] = pan;\n        }\n        else if (toolCenterCanvas[0] > clientWidth) {\n            visiblePointCanvas[0] = clientWidth - pan;\n        }\n        if (toolCenterCanvas[1] < 0) {\n            visiblePointCanvas[1] = pan;\n        }\n        else if (toolCenterCanvas[1] > clientHeight) {\n            visiblePointCanvas[1] = clientHeight - pan;\n        }\n        if (visiblePointCanvas[0] === toolCenterCanvas[0] &&\n            visiblePointCanvas[1] === toolCenterCanvas[1]) {\n            return;\n        }\n        const visiblePointWorld = viewport.canvasToWorld(visiblePointCanvas);\n        const deltaPointsWorld = [\n            visiblePointWorld[0] - this.toolCenter[0],\n            visiblePointWorld[1] - this.toolCenter[1],\n            visiblePointWorld[2] - this.toolCenter[2],\n        ];\n        const camera = viewport.getCamera();\n        const { focalPoint, position } = camera;\n        const updatedPosition = [\n            position[0] - deltaPointsWorld[0],\n            position[1] - deltaPointsWorld[1],\n            position[2] - deltaPointsWorld[2],\n        ];\n        const updatedFocalPoint = [\n            focalPoint[0] - deltaPointsWorld[0],\n            focalPoint[1] - deltaPointsWorld[1],\n            focalPoint[2] - deltaPointsWorld[2],\n        ];\n        viewport.setCamera({\n            focalPoint: updatedFocalPoint,\n            position: updatedPosition,\n        });\n        viewport.render();\n    }\n    setSlabThickness(viewport, slabThickness) {\n        let actorUIDs;\n        const { filterActorUIDsToSetSlabThickness } = this.configuration;\n        if (filterActorUIDsToSetSlabThickness &&\n            filterActorUIDsToSetSlabThickness.length > 0) {\n            actorUIDs = filterActorUIDsToSetSlabThickness;\n        }\n        let blendModeToUse = this.configuration.slabThicknessBlendMode;\n        if (slabThickness === RENDERING_DEFAULTS.MINIMUM_SLAB_THICKNESS) {\n            blendModeToUse = Enums.BlendModes.COMPOSITE;\n        }\n        const immediate = false;\n        viewport.setBlendMode(blendModeToUse, actorUIDs, immediate);\n        viewport.setSlabThickness(slabThickness, actorUIDs);\n    }\n    _isClockWise(a, b, c) {\n        return (b[0] - a[0]) * (c[1] - a[1]) - (b[1] - a[1]) * (c[0] - a[0]) > 0;\n    }\n    _applyDeltaShiftToSelectedViewportCameras(renderingEngine, viewportsAnnotationsToUpdate, delta) {\n        viewportsAnnotationsToUpdate.forEach((annotation) => {\n            this._applyDeltaShiftToViewportCamera(renderingEngine, annotation, delta);\n        });\n    }\n    _applyDeltaShiftToViewportCamera(renderingEngine, annotation, delta) {\n        const { data } = annotation;\n        const viewport = renderingEngine.getViewport(data.viewportId);\n        const camera = viewport.getCamera();\n        const normal = camera.viewPlaneNormal;\n        const dotProd = vtkMath.dot(delta, normal);\n        const projectedDelta = [...normal];\n        vtkMath.multiplyScalar(projectedDelta, dotProd);\n        if (Math.abs(projectedDelta[0]) > 1e-3 ||\n            Math.abs(projectedDelta[1]) > 1e-3 ||\n            Math.abs(projectedDelta[2]) > 1e-3) {\n            const newFocalPoint = [0, 0, 0];\n            const newPosition = [0, 0, 0];\n            vtkMath.add(camera.focalPoint, projectedDelta, newFocalPoint);\n            vtkMath.add(camera.position, projectedDelta, newPosition);\n            viewport.setCamera({\n                focalPoint: newFocalPoint,\n                position: newPosition,\n            });\n            viewport.render();\n        }\n    }\n    _getRotationHandleNearImagePoint(viewport, annotation, canvasCoords, proximity) {\n        const { data } = annotation;\n        const { rotationPoints } = data.handles;\n        for (let i = 0; i < rotationPoints.length; i++) {\n            const point = rotationPoints[i][0];\n            const otherViewport = rotationPoints[i][1];\n            const viewportControllable = this._getReferenceLineControllable(otherViewport.id);\n            if (!viewportControllable) {\n                continue;\n            }\n            const viewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id);\n            if (!viewportDraggableRotatable) {\n                continue;\n            }\n            const annotationCanvasCoordinate = viewport.worldToCanvas(point);\n            if (vec2.distance(canvasCoords, annotationCanvasCoordinate) < proximity) {\n                data.handles.activeOperation = OPERATION.ROTATE;\n                this.editData = {\n                    annotation,\n                };\n                return point;\n            }\n        }\n        return null;\n    }\n    _getSlabThicknessHandleNearImagePoint(viewport, annotation, canvasCoords, proximity) {\n        const { data } = annotation;\n        const { slabThicknessPoints } = data.handles;\n        for (let i = 0; i < slabThicknessPoints.length; i++) {\n            const point = slabThicknessPoints[i][0];\n            const otherViewport = slabThicknessPoints[i][1];\n            const viewportControllable = this._getReferenceLineControllable(otherViewport.id);\n            if (!viewportControllable) {\n                continue;\n            }\n            const viewportSlabThicknessControlsOn = this._getReferenceLineSlabThicknessControlsOn(otherViewport.id);\n            if (!viewportSlabThicknessControlsOn) {\n                continue;\n            }\n            const annotationCanvasCoordinate = viewport.worldToCanvas(point);\n            if (vec2.distance(canvasCoords, annotationCanvasCoordinate) < proximity) {\n                data.handles.activeOperation = OPERATION.SLAB;\n                data.activeViewportIds = [otherViewport.id];\n                this.editData = {\n                    annotation,\n                };\n                return point;\n            }\n        }\n        return null;\n    }\n    _pointNearTool(element, annotation, canvasCoords, proximity) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const { clientWidth, clientHeight } = viewport.canvas;\n        const canvasDiagonalLength = Math.sqrt(clientWidth * clientWidth + clientHeight * clientHeight);\n        const { data } = annotation;\n        const { rotationPoints } = data.handles;\n        const { slabThicknessPoints } = data.handles;\n        const viewportIdArray = [];\n        for (let i = 0; i < rotationPoints.length - 1; ++i) {\n            const otherViewport = rotationPoints[i][1];\n            const viewportControllable = this._getReferenceLineControllable(otherViewport.id);\n            const viewportDraggableRotatable = this._getReferenceLineDraggableRotatable(otherViewport.id);\n            if (!viewportControllable || !viewportDraggableRotatable) {\n                continue;\n            }\n            const lineSegment1 = {\n                start: {\n                    x: rotationPoints[i][2][0],\n                    y: rotationPoints[i][2][1],\n                },\n                end: {\n                    x: rotationPoints[i][3][0],\n                    y: rotationPoints[i][3][1],\n                },\n            };\n            const distanceToPoint1 = lineSegment.distanceToPoint([lineSegment1.start.x, lineSegment1.start.y], [lineSegment1.end.x, lineSegment1.end.y], [canvasCoords[0], canvasCoords[1]]);\n            const lineSegment2 = {\n                start: {\n                    x: rotationPoints[i + 1][2][0],\n                    y: rotationPoints[i + 1][2][1],\n                },\n                end: {\n                    x: rotationPoints[i + 1][3][0],\n                    y: rotationPoints[i + 1][3][1],\n                },\n            };\n            const distanceToPoint2 = lineSegment.distanceToPoint([lineSegment2.start.x, lineSegment2.start.y], [lineSegment2.end.x, lineSegment2.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint1 <= proximity || distanceToPoint2 <= proximity) {\n                viewportIdArray.push(otherViewport.id);\n                data.handles.activeOperation = OPERATION.DRAG;\n            }\n            i++;\n        }\n        for (let i = 0; i < slabThicknessPoints.length - 1; ++i) {\n            const otherViewport = slabThicknessPoints[i][1];\n            if (viewportIdArray.find((id) => id === otherViewport.id)) {\n                continue;\n            }\n            const viewportControllable = this._getReferenceLineControllable(otherViewport.id);\n            const viewportSlabThicknessControlsOn = this._getReferenceLineSlabThicknessControlsOn(otherViewport.id);\n            if (!viewportControllable || !viewportSlabThicknessControlsOn) {\n                continue;\n            }\n            const stPointLineCanvas1 = slabThicknessPoints[i][2];\n            const stPointLineCanvas2 = slabThicknessPoints[i][3];\n            const centerCanvas = vec2.create();\n            vec2.add(centerCanvas, stPointLineCanvas1, stPointLineCanvas2);\n            vec2.scale(centerCanvas, centerCanvas, 0.5);\n            const canvasUnitVectorFromCenter = vec2.create();\n            vec2.subtract(canvasUnitVectorFromCenter, stPointLineCanvas1, centerCanvas);\n            vec2.normalize(canvasUnitVectorFromCenter, canvasUnitVectorFromCenter);\n            const canvasVectorFromCenterStart = vec2.create();\n            vec2.scale(canvasVectorFromCenterStart, canvasUnitVectorFromCenter, canvasDiagonalLength * 0.05);\n            const stPointLineCanvas1Start = vec2.create();\n            const stPointLineCanvas2Start = vec2.create();\n            vec2.add(stPointLineCanvas1Start, centerCanvas, canvasVectorFromCenterStart);\n            vec2.subtract(stPointLineCanvas2Start, centerCanvas, canvasVectorFromCenterStart);\n            const lineSegment1 = {\n                start: {\n                    x: stPointLineCanvas1Start[0],\n                    y: stPointLineCanvas1Start[1],\n                },\n                end: {\n                    x: stPointLineCanvas1[0],\n                    y: stPointLineCanvas1[1],\n                },\n            };\n            const distanceToPoint1 = lineSegment.distanceToPoint([lineSegment1.start.x, lineSegment1.start.y], [lineSegment1.end.x, lineSegment1.end.y], [canvasCoords[0], canvasCoords[1]]);\n            const lineSegment2 = {\n                start: {\n                    x: stPointLineCanvas2Start[0],\n                    y: stPointLineCanvas2Start[1],\n                },\n                end: {\n                    x: stPointLineCanvas2[0],\n                    y: stPointLineCanvas2[1],\n                },\n            };\n            const distanceToPoint2 = lineSegment.distanceToPoint([lineSegment2.start.x, lineSegment2.start.y], [lineSegment2.end.x, lineSegment2.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint1 <= proximity || distanceToPoint2 <= proximity) {\n                viewportIdArray.push(otherViewport.id);\n                data.handles.activeOperation = null;\n            }\n            i++;\n        }\n        data.activeViewportIds = [...viewportIdArray];\n        this.editData = {\n            annotation,\n        };\n        return data.handles.activeOperation === OPERATION.DRAG ? true : false;\n    }\n}\nCrosshairsTool.toolName = 'Crosshairs';\nexport default CrosshairsTool;\n","import { BaseTool } from './base';\nimport { Events } from '../enums';\nimport { getEnabledElement, StackViewport } from '@cornerstonejs/core';\nimport { getViewportIdsWithToolToRender } from '../utilities/viewportFilters';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nimport { state } from '../store/state';\nimport { Enums } from '@cornerstonejs/core';\nimport { hideElementCursor, resetElementCursor, } from '../cursors/elementCursor';\nconst MAGNIFY_VIEWPORT_ID = 'magnify-viewport';\nclass MagnifyTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            magnifySize: 10,\n            magnifyWidth: 250,\n            magnifyHeight: 250,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this._hasBeenRemoved = false;\n        this.preMouseDownCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element, currentPoints } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            if (!(viewport instanceof StackViewport)) {\n                throw new Error('MagnifyTool only works on StackViewports');\n            }\n            const referencedImageId = this._getReferencedImageId(viewport);\n            if (!referencedImageId) {\n                throw new Error('MagnifyTool: No referenced image id found, reconstructed planes not supported yet');\n            }\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                referencedImageId,\n                viewportIdsToRender,\n                enabledElement,\n                renderingEngine,\n                currentPoints,\n            };\n            this._createMagnificationViewport();\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return true;\n        };\n        this.preTouchStartCallback = (evt) => {\n            this.preMouseDownCallback(evt);\n        };\n        this._createMagnificationViewport = () => {\n            const { enabledElement, referencedImageId, viewportIdsToRender, renderingEngine, currentPoints, } = this.editData;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            const viewportProperties = viewport.getProperties();\n            const { canvas: canvasPos, world: worldPos } = currentPoints;\n            let magnifyToolElement;\n            magnifyToolElement = element.querySelector('.magnifyTool');\n            if (magnifyToolElement === null) {\n                const magnifyElement = document.createElement('div');\n                magnifyElement.classList.add('magnifyTool');\n                magnifyElement.style.display = 'block';\n                magnifyElement.style.width = `${this.configuration.magnifyWidth}px`;\n                magnifyElement.style.height = `${this.configuration.magnifyHeight}px`;\n                magnifyElement.style.position = 'absolute';\n                magnifyToolElement = magnifyElement;\n                const viewportElement = element.querySelector('.viewport-element');\n                viewportElement.appendChild(magnifyElement);\n                const viewportInput = {\n                    viewportId: MAGNIFY_VIEWPORT_ID,\n                    type: Enums.ViewportType.STACK,\n                    element: magnifyToolElement,\n                };\n                renderingEngine.enableElement(viewportInput);\n            }\n            magnifyToolElement.style.top = `${canvasPos[1] - this.configuration.magnifyHeight / 2}px`;\n            magnifyToolElement.style.left = `${canvasPos[0] - this.configuration.magnifyWidth / 2}px`;\n            const magnifyViewport = renderingEngine.getViewport(MAGNIFY_VIEWPORT_ID);\n            magnifyViewport.setStack([referencedImageId]).then(() => {\n                if (this._hasBeenRemoved) {\n                    return;\n                }\n                magnifyViewport.setProperties(viewportProperties);\n                const { parallelScale } = viewport.getCamera();\n                const { focalPoint, position, viewPlaneNormal } = magnifyViewport.getCamera();\n                const distance = Math.sqrt(Math.pow(focalPoint[0] - position[0], 2) +\n                    Math.pow(focalPoint[1] - position[1], 2) +\n                    Math.pow(focalPoint[2] - position[2], 2));\n                const updatedFocalPoint = [\n                    worldPos[0],\n                    worldPos[1],\n                    worldPos[2],\n                ];\n                const updatedPosition = [\n                    updatedFocalPoint[0] + distance * viewPlaneNormal[0],\n                    updatedFocalPoint[1] + distance * viewPlaneNormal[1],\n                    updatedFocalPoint[2] + distance * viewPlaneNormal[2],\n                ];\n                magnifyViewport.setCamera({\n                    parallelScale: parallelScale * (1 / this.configuration.magnifySize),\n                    focalPoint: updatedFocalPoint,\n                    position: updatedPosition,\n                });\n                magnifyViewport.render();\n            });\n            magnifyToolElement.style.display = 'block';\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { deltaPoints, element, currentPoints } = eventDetail;\n            const deltaPointsWorld = deltaPoints.world;\n            const canvasPos = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            const magnifyViewport = renderingEngine.getViewport(MAGNIFY_VIEWPORT_ID);\n            const magnifyElement = element.querySelector('.magnifyTool');\n            if (!magnifyElement) {\n                return;\n            }\n            magnifyElement.style.top = `${canvasPos[1] - this.configuration.magnifyHeight / 2}px`;\n            magnifyElement.style.left = `${canvasPos[0] - this.configuration.magnifyWidth / 2}px`;\n            const { focalPoint, position } = magnifyViewport.getCamera();\n            const updatedPosition = [\n                position[0] + deltaPointsWorld[0],\n                position[1] + deltaPointsWorld[1],\n                position[2] + deltaPointsWorld[2],\n            ];\n            const updatedFocalPoint = [\n                focalPoint[0] + deltaPointsWorld[0],\n                focalPoint[1] + deltaPointsWorld[1],\n                focalPoint[2] + deltaPointsWorld[2],\n            ];\n            magnifyViewport.setCamera({\n                focalPoint: updatedFocalPoint,\n                position: updatedPosition,\n            });\n            magnifyViewport.render();\n        };\n        this._dragEndCallback = (evt) => {\n            const { element } = evt.detail;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            renderingEngine.disableElement(MAGNIFY_VIEWPORT_ID);\n            const viewportElement = element.querySelector('.viewport-element');\n            const magnifyToolElement = viewportElement.querySelector('.magnifyTool');\n            viewportElement.removeChild(magnifyToolElement);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            this._hasBeenRemoved = true;\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            this._hasBeenRemoved = false;\n            element.addEventListener(Events.MOUSE_UP, this._dragEndCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._dragEndCallback);\n            element.addEventListener(Events.TOUCH_END, this._dragEndCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._dragEndCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._dragEndCallback);\n            element.removeEventListener(Events.TOUCH_END, this._dragEndCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n    }\n    _getReferencedImageId(viewport) {\n        const targetId = this.getTargetId(viewport);\n        let referencedImageId;\n        if (viewport instanceof StackViewport) {\n            referencedImageId = targetId.split('imageId:')[1];\n        }\n        return referencedImageId;\n    }\n}\nMagnifyTool.toolName = 'Magnify';\nexport default MagnifyTool;\n","import { AnnotationTool } from './base';\nimport { getEnabledElement, utilities as csUtils, eventTarget, Enums, getRenderingEngine, CONSTANTS, getEnabledElementByViewportId, } from '@cornerstonejs/core';\nimport { addAnnotation, getAllAnnotations, getAnnotations, removeAnnotation, } from '../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../stateManagement/annotation/annotationLocking';\nimport { isAnnotationVisible } from '../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationCompleted } from '../stateManagement/annotation/helpers/state';\nimport { drawCircle as drawCircleSvg, drawHandles as drawHandlesSvg, } from '../drawingSvg';\nimport { state } from '../store/state';\nimport { Events, MouseBindings, KeyboardBindings, Events as cstEvents, SegmentationRepresentations, ToolModes, } from '../enums';\nimport { getViewportIdsWithToolToRender } from '../utilities/viewportFilters';\nimport { resetElementCursor, hideElementCursor, } from '../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nimport { getCanvasCircleRadius } from '../utilities/math/circle';\nimport { vec2, vec3 } from 'gl-matrix';\nimport { getToolGroupForViewport } from '../store/ToolGroupManager';\nimport debounce from '../utilities/debounce';\nimport { distanceToPoint } from '../utilities/math/point';\nimport { addSegmentationRepresentations } from '../stateManagement/segmentation';\nconst MAGNIFY_CLASSNAME = 'advancedMagnifyTool';\nconst MAGNIFY_VIEWPORT_INITIAL_RADIUS = 125;\nconst { Events: csEvents } = Enums;\nconst isSegmentation = (actor) => actor.uid !== actor.referencedId;\nvar AdvancedMagnifyToolActions;\n(function (AdvancedMagnifyToolActions) {\n    AdvancedMagnifyToolActions[\"ShowZoomFactorsList\"] = \"showZoomFactorsList\";\n})(AdvancedMagnifyToolActions || (AdvancedMagnifyToolActions = {}));\nconst ADVANCED_MAGNIFY_TOOL_NAME = 'AdvancedMagnify';\nconst PARALLEL_THRESHOLD = 1 - CONSTANTS.EPSILON;\nclass AdvancedMagnifyTool extends AnnotationTool {\n    static { this.Actions = AdvancedMagnifyToolActions; }\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            magnifyingGlass: {\n                radius: 125,\n                zoomFactor: 3,\n                zoomFactorList: [1.5, 2, 2.5, 3, 3.5, 4, 4.5, 5],\n                autoPan: {\n                    enabled: true,\n                    padding: 10,\n                },\n            },\n            actions: {\n                showZoomFactorsList: {\n                    method: 'showZoomFactorsList',\n                    bindings: [\n                        {\n                            mouseButton: MouseBindings.Secondary,\n                            modifierKey: KeyboardBindings.Shift,\n                        },\n                    ],\n                },\n            },\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            const worldPos = currentPoints.world;\n            const canvasPos = currentPoints.canvas;\n            const { magnifyingGlass: config } = this.configuration;\n            const { radius, zoomFactor, autoPan } = config;\n            const canvasHandlePoints = this._getCanvasHandlePoints(canvasPos, radius);\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const annotationUID = csUtils.uuidv4();\n            const magnifyViewportId = csUtils.uuidv4();\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                annotationUID,\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                },\n                data: {\n                    sourceViewportId: viewport.id,\n                    magnifyViewportId,\n                    zoomFactor,\n                    isCanvasAnnotation: true,\n                    handles: {\n                        points: canvasHandlePoints,\n                        activeHandleIndex: null,\n                    },\n                },\n            };\n            this.magnifyViewportManager.createViewport(annotation, {\n                magnifyViewportId,\n                sourceEnabledElement: enabledElement,\n                position: canvasPos,\n                radius,\n                zoomFactor,\n                autoPan: {\n                    enabled: autoPan.enabled,\n                    padding: autoPan.padding,\n                    callback: (data) => {\n                        const annotationPoints = annotation.data.handles.points;\n                        const { canvas: canvasDelta } = data.delta;\n                        for (let i = 0, len = annotationPoints.length; i < len; i++) {\n                            const point = annotationPoints[i];\n                            point[0] += canvasDelta[0];\n                            point[1] += canvasDelta[1];\n                            annotation.invalidated = true;\n                        }\n                    },\n                },\n            });\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.onSetToolDisabled = () => {\n            this.magnifyViewportManager.dispose();\n            const annotations = getAllAnnotations();\n            annotations.forEach((annotation) => {\n                if (annotation.metadata.toolName === this.getToolName()) {\n                    removeAnnotation(annotation.annotationUID);\n                }\n            });\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasCoordinates = points;\n            const canvasTop = canvasCoordinates[0];\n            const canvasBottom = canvasCoordinates[2];\n            const canvasLeft = canvasCoordinates[3];\n            const radius = Math.abs(canvasBottom[1] - canvasTop[1]) * 0.5;\n            const center = [\n                canvasLeft[0] + radius,\n                canvasTop[1] + radius,\n            ];\n            const radiusPoint = getCanvasCircleRadius([center, canvasCoords]);\n            if (Math.abs(radiusPoint - radius) < proximity * 2) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n            };\n            hideElementCursor(element);\n            this._activateModify(element);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation, handle) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { data } = annotation;\n            annotation.highlighted = true;\n            const { points } = data.handles;\n            const handleIndex = points.findIndex((p) => p === handle);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n            const { data } = annotation;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            resetElementCursor(element);\n            this.editData = null;\n            this.isDrawing = false;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this._dragDrawCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { deltaPoints } = eventDetail;\n            const canvasDelta = deltaPoints?.canvas ?? [0, 0, 0];\n            const { annotation, viewportIdsToRender } = this.editData;\n            const { points } = annotation.data.handles;\n            points.forEach((point) => {\n                point[0] += canvasDelta[0];\n                point[1] += canvasDelta[1];\n            });\n            annotation.invalidated = true;\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragModifyCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex } = this.editData;\n            const { data } = annotation;\n            if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const canvasDelta = deltaPoints.canvas;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += canvasDelta[0];\n                    point[1] += canvasDelta[1];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                this._dragHandle(evt);\n                annotation.invalidated = true;\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragHandle = (evt) => {\n            const eventDetail = evt.detail;\n            const { annotation } = this.editData;\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasCoordinates = points;\n            const canvasTop = canvasCoordinates[0];\n            const canvasBottom = canvasCoordinates[2];\n            const canvasLeft = canvasCoordinates[3];\n            const radius = Math.abs(canvasBottom[1] - canvasTop[1]) * 0.5;\n            const canvasCenter = [\n                canvasLeft[0] + radius,\n                canvasTop[1] + radius,\n            ];\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            const newRadius = getCanvasCircleRadius([\n                canvasCenter,\n                currentCanvasPoints,\n            ]);\n            const newCanvasHandlePoints = this._getCanvasHandlePoints(canvasCenter, newRadius);\n            points[0] = newCanvasHandlePoints[0];\n            points[1] = newCanvasHandlePoints[1];\n            points[2] = newCanvasHandlePoints[2];\n            points[3] = newCanvasHandlePoints[3];\n        };\n        this.cancel = (element) => {\n            if (!this.isDrawing) {\n                return;\n            }\n            this.isDrawing = false;\n            this._deactivateModify(element);\n            resetElementCursor(element);\n            const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n            const { data } = annotation;\n            annotation.highlighted = false;\n            data.handles.activeHandleIndex = null;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            return annotation.annotationUID;\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = annotations?.filter((annotation) => annotation.data.sourceViewportId ===\n                viewport.id);\n            const filteredAnnotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!filteredAnnotations?.length) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < filteredAnnotations.length; i++) {\n                const annotation = filteredAnnotations[i];\n                const { annotationUID, data } = annotation;\n                const { magnifyViewportId, zoomFactor, handles } = data;\n                const { points, activeHandleIndex } = handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n                const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                const canvasCoordinates = points;\n                const canvasTop = canvasCoordinates[0];\n                const canvasBottom = canvasCoordinates[2];\n                const canvasLeft = canvasCoordinates[3];\n                const radius = Math.abs(canvasBottom[1] - canvasTop[1]) * 0.5;\n                const center = [\n                    canvasLeft[0] + radius,\n                    canvasTop[1] + radius,\n                ];\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                const dataId = `${annotationUID}-advancedMagnify`;\n                const circleUID = '0';\n                drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, center, radius, {\n                    color,\n                    lineWidth: 5,\n                }, dataId);\n                const magnifyViewport = this.magnifyViewportManager.getViewport(magnifyViewportId);\n                magnifyViewport.position = center;\n                magnifyViewport.radius = radius;\n                magnifyViewport.zoomFactor = zoomFactor;\n                magnifyViewport.update();\n                renderStatus = true;\n            }\n            return renderStatus;\n        };\n        this._getCanvasHandlePoints = (canvasCenterPos, canvasRadius) => {\n            return [\n                [canvasCenterPos[0], canvasCenterPos[1] - canvasRadius, 0],\n                [canvasCenterPos[0] + canvasRadius, canvasCenterPos[1], 0],\n                [canvasCenterPos[0], canvasCenterPos[1] + canvasRadius, 0],\n                [canvasCenterPos[0] - canvasRadius, canvasCenterPos[1], 0],\n            ];\n        };\n        this.magnifyViewportManager = AdvancedMagnifyViewportManager.getInstance();\n    }\n    showZoomFactorsList(evt, annotation) {\n        const { element, currentPoints } = evt.detail;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const { canvas: canvasPoint } = currentPoints;\n        const viewportElement = element.querySelector(':scope .viewport-element');\n        const currentZoomFactor = annotation.data.zoomFactor;\n        const remove = () => dropdown.parentElement.removeChild(dropdown);\n        const dropdown = this._getZoomFactorsListDropdown(currentZoomFactor, (newZoomFactor) => {\n            if (newZoomFactor !== undefined) {\n                annotation.data.zoomFactor = Number.parseFloat(newZoomFactor);\n                annotation.invalidated = true;\n            }\n            remove();\n            viewport.render();\n        });\n        Object.assign(dropdown.style, {\n            left: `${canvasPoint[0]}px`,\n            top: `${canvasPoint[1]}px`,\n        });\n        viewportElement.appendChild(dropdown);\n        dropdown.focus();\n    }\n    _getZoomFactorsListDropdown(currentZoomFactor, onChangeCallback) {\n        const { zoomFactorList } = this.configuration.magnifyingGlass;\n        const dropdown = document.createElement('select');\n        dropdown.size = 5;\n        Object.assign(dropdown.style, {\n            width: '50px',\n            position: 'absolute',\n        });\n        ['mousedown', 'mouseup', 'mousemove', 'click'].forEach((eventName) => {\n            dropdown.addEventListener(eventName, (evt) => evt.stopPropagation());\n        });\n        dropdown.addEventListener('change', (evt) => {\n            evt.stopPropagation();\n            onChangeCallback(dropdown.value);\n        });\n        dropdown.addEventListener('keydown', (evt) => {\n            const shouldCancel = (evt.keyCode ?? evt.which === 27) ||\n                evt.key?.toLowerCase() === 'escape';\n            if (shouldCancel) {\n                evt.stopPropagation();\n                onChangeCallback();\n            }\n        });\n        zoomFactorList.forEach((zoomFactor) => {\n            const option = document.createElement('option');\n            option.label = zoomFactor;\n            option.title = `Zoom factor ${zoomFactor.toFixed(1)}`;\n            option.value = zoomFactor;\n            option.defaultSelected = zoomFactor === currentZoomFactor;\n            dropdown.add(option);\n        });\n        return dropdown;\n    }\n}\nclass AdvancedMagnifyViewportManager {\n    constructor() {\n        this.createViewport = (annotation, viewportInfo) => {\n            const { magnifyViewportId, sourceEnabledElement, position, radius, zoomFactor, autoPan, } = viewportInfo;\n            const { viewport: sourceViewport } = sourceEnabledElement;\n            const { element: sourceElement } = sourceViewport;\n            const magnifyViewport = new AdvancedMagnifyViewport({\n                magnifyViewportId,\n                sourceEnabledElement,\n                radius,\n                position,\n                zoomFactor,\n                autoPan,\n            });\n            this._addSourceElementEventListener(sourceElement);\n            this._magnifyViewportsMap.set(magnifyViewport.viewportId, {\n                annotation,\n                magnifyViewport,\n                magnifyViewportInfo: viewportInfo,\n            });\n            return magnifyViewport;\n        };\n        this._annotationRemovedCallback = (evt) => {\n            const { annotation } = evt.detail;\n            if (annotation.metadata.toolName !== ADVANCED_MAGNIFY_TOOL_NAME) {\n                return;\n            }\n            this.destroyViewport(annotation.data.magnifyViewportId);\n        };\n        this._newStackImageCallback = (evt) => {\n            const { viewportId: sourceViewportId, imageId } = evt.detail;\n            const magnifyViewportsMapEntries = this._getMagnifyViewportsMapEntriesBySourceViewportId(sourceViewportId);\n            const { viewport } = getEnabledElementByViewportId(sourceViewportId);\n            if (viewport.stackActorReInitialized) {\n                this._reset(sourceViewportId);\n            }\n            magnifyViewportsMapEntries.forEach(({ annotation }) => {\n                annotation.metadata.referencedImageId = imageId;\n                annotation.invalidated = true;\n            });\n        };\n        this._newVolumeImageCallback = (evt) => {\n            const { renderingEngineId, viewportId: sourceViewportId } = evt.detail;\n            const renderingEngine = getRenderingEngine(renderingEngineId);\n            const sourceViewport = renderingEngine.getViewport(sourceViewportId);\n            const { viewPlaneNormal: currentViewPlaneNormal } = sourceViewport.getCamera();\n            const magnifyViewportsMapEntries = this._getMagnifyViewportsMapEntriesBySourceViewportId(sourceViewportId);\n            magnifyViewportsMapEntries.forEach(({ annotation }) => {\n                const { viewPlaneNormal } = annotation.metadata;\n                const isParallel = Math.abs(vec3.dot(viewPlaneNormal, currentViewPlaneNormal)) >\n                    PARALLEL_THRESHOLD;\n                if (!isParallel) {\n                    return;\n                }\n                const { handles } = annotation.data;\n                const worldImagePlanePoint = sourceViewport.canvasToWorld([0, 0]);\n                const vecHandleToImagePlane = vec3.sub(vec3.create(), worldImagePlanePoint, handles.points[0]);\n                const worldDist = vec3.dot(vecHandleToImagePlane, currentViewPlaneNormal);\n                const worldDelta = vec3.scale(vec3.create(), currentViewPlaneNormal, worldDist);\n                for (let i = 0, len = handles.points.length; i < len; i++) {\n                    const point = handles.points[i];\n                    point[0] += worldDelta[0];\n                    point[1] += worldDelta[1];\n                    point[2] += worldDelta[2];\n                }\n                annotation.invalidated = true;\n            });\n        };\n        this._magnifyViewportsMap = new Map();\n        this._initialize();\n    }\n    static getInstance() {\n        AdvancedMagnifyViewportManager._singleton =\n            AdvancedMagnifyViewportManager._singleton ??\n                new AdvancedMagnifyViewportManager();\n        return AdvancedMagnifyViewportManager._singleton;\n    }\n    getViewport(magnifyViewportId) {\n        return this._magnifyViewportsMap.get(magnifyViewportId)?.magnifyViewport;\n    }\n    dispose() {\n        this._removeEventListeners();\n        this._destroyViewports();\n    }\n    destroyViewport(magnifyViewportId) {\n        const magnifyViewportMapEntry = this._magnifyViewportsMap.get(magnifyViewportId);\n        if (magnifyViewportMapEntry) {\n            const { magnifyViewport } = magnifyViewportMapEntry;\n            const { viewport: sourceViewport } = magnifyViewport.sourceEnabledElement;\n            const { element: sourceElement } = sourceViewport;\n            this._removeSourceElementEventListener(sourceElement);\n            magnifyViewport.dispose();\n            this._magnifyViewportsMap.delete(magnifyViewportId);\n        }\n    }\n    _destroyViewports() {\n        const magnifyViewportIds = Array.from(this._magnifyViewportsMap.keys());\n        magnifyViewportIds.forEach((magnifyViewportId) => this.destroyViewport(magnifyViewportId));\n    }\n    _getMagnifyViewportsMapEntriesBySourceViewportId(sourceViewportId) {\n        const magnifyViewportsMapEntries = Array.from(this._magnifyViewportsMap.values());\n        return magnifyViewportsMapEntries.filter(({ magnifyViewport }) => {\n            const { viewport } = magnifyViewport.sourceEnabledElement;\n            return viewport.id === sourceViewportId;\n        });\n    }\n    _reset(sourceViewportId) {\n        const magnifyViewports = this._getMagnifyViewportsMapEntriesBySourceViewportId(sourceViewportId);\n        magnifyViewports.forEach(({ magnifyViewport, annotation, magnifyViewportInfo }) => {\n            this.destroyViewport(magnifyViewport.viewportId);\n            const newEnabledElement = getEnabledElementByViewportId(sourceViewportId);\n            this.createViewport(annotation, {\n                ...magnifyViewportInfo,\n                sourceEnabledElement: {\n                    ...newEnabledElement,\n                },\n            });\n        });\n    }\n    _addEventListeners() {\n        eventTarget.addEventListener(cstEvents.ANNOTATION_REMOVED, this._annotationRemovedCallback);\n    }\n    _removeEventListeners() {\n        eventTarget.removeEventListener(cstEvents.ANNOTATION_REMOVED, this._annotationRemovedCallback);\n    }\n    _addSourceElementEventListener(element) {\n        element.addEventListener(csEvents.STACK_NEW_IMAGE, this._newStackImageCallback);\n        const newStackHandler = (evt) => {\n            const { viewportId: sourceViewportId } = evt.detail;\n            this._reset(sourceViewportId);\n        };\n        element.addEventListener(csEvents.VIEWPORT_NEW_IMAGE_SET, newStackHandler);\n        const newVolumeHandler = (evt) => {\n            const { viewportId: sourceViewportId } = evt.detail;\n            this._reset(sourceViewportId);\n        };\n        element.addEventListener(csEvents.VOLUME_VIEWPORT_NEW_VOLUME, newVolumeHandler);\n        element.addEventListener(csEvents.VOLUME_NEW_IMAGE, this._newVolumeImageCallback);\n        element.newStackHandler = newStackHandler;\n        element.newVolumeHandler = newVolumeHandler;\n    }\n    _removeSourceElementEventListener(element) {\n        element.removeEventListener(csEvents.STACK_NEW_IMAGE, this._newStackImageCallback);\n        element.removeEventListener(csEvents.VOLUME_NEW_IMAGE, this._newVolumeImageCallback);\n        element.removeEventListener(csEvents.VIEWPORT_NEW_IMAGE_SET, element.newStackHandler);\n        element.removeEventListener(csEvents.VOLUME_VIEWPORT_NEW_VOLUME, element.newVolumeHandler);\n        delete element.newStackHandler;\n        delete element.newVolumeHandler;\n    }\n    _initialize() {\n        this._addEventListeners();\n    }\n}\nclass AdvancedMagnifyViewport {\n    constructor({ magnifyViewportId, sourceEnabledElement, radius = MAGNIFY_VIEWPORT_INITIAL_RADIUS, position = [0, 0], zoomFactor, autoPan, }) {\n        this._enabledElement = null;\n        this._sourceToolGroup = null;\n        this._magnifyToolGroup = null;\n        this._isViewportReady = false;\n        this._radius = 0;\n        this._resized = false;\n        this._canAutoPan = false;\n        this._viewportId = magnifyViewportId ?? csUtils.uuidv4();\n        this._sourceEnabledElement = sourceEnabledElement;\n        this._autoPan = autoPan;\n        this.radius = radius;\n        this.position = position;\n        this.zoomFactor = zoomFactor;\n        this.visible = true;\n        this._browserMouseDownCallback = this._browserMouseDownCallback.bind(this);\n        this._browserMouseUpCallback = this._browserMouseUpCallback.bind(this);\n        this._handleToolModeChanged = this._handleToolModeChanged.bind(this);\n        this._mouseDragCallback = this._mouseDragCallback.bind(this);\n        this._resizeViewportAsync = (debounce(this._resizeViewport.bind(this), 1));\n        this._initialize();\n    }\n    get sourceEnabledElement() {\n        return this._sourceEnabledElement;\n    }\n    get viewportId() {\n        return this._viewportId;\n    }\n    get radius() {\n        return this._radius;\n    }\n    set radius(radius) {\n        if (Math.abs(this._radius - radius) > 0.00001) {\n            this._radius = radius;\n            this._resized = true;\n        }\n    }\n    update() {\n        const { radius, position, visible } = this;\n        const { viewport } = this._enabledElement;\n        const { element } = viewport;\n        const size = 2 * radius;\n        const [x, y] = position;\n        if (this._resized) {\n            this._resizeViewportAsync();\n            this._resized = false;\n        }\n        Object.assign(element.style, {\n            display: visible ? 'block' : 'hidden',\n            width: `${size}px`,\n            height: `${size}px`,\n            left: `${-radius}px`,\n            top: `${-radius}px`,\n            transform: `translate(${x}px, ${y}px)`,\n        });\n        if (this._isViewportReady) {\n            this._syncViewports();\n            viewport.render();\n        }\n    }\n    dispose() {\n        const { viewport } = this._enabledElement;\n        const { element } = viewport;\n        const renderingEngine = viewport.getRenderingEngine();\n        this._removeEventListeners(element);\n        renderingEngine.disableElement(viewport.id);\n        if (element.parentNode) {\n            element.parentNode.removeChild(element);\n        }\n    }\n    _handleToolModeChanged(evt) {\n        const { _magnifyToolGroup: magnifyToolGroup } = this;\n        const { toolGroupId, toolName, mode, toolBindingsOptions } = evt.detail;\n        if (this._sourceToolGroup?.id !== toolGroupId) {\n            return;\n        }\n        switch (mode) {\n            case ToolModes.Active:\n                magnifyToolGroup.setToolActive(toolName, toolBindingsOptions);\n                break;\n            case ToolModes.Passive:\n                magnifyToolGroup.setToolPassive(toolName);\n                break;\n            case ToolModes.Enabled:\n                magnifyToolGroup.setToolEnabled(toolName);\n                break;\n            case ToolModes.Disabled:\n                magnifyToolGroup.setToolDisabled(toolName);\n                break;\n            default:\n                throw new Error(`Unknow tool mode (${mode})`);\n        }\n    }\n    _inheritBorderRadius(magnifyElement) {\n        const viewport = magnifyElement.querySelector('.viewport-element');\n        const canvas = magnifyElement.querySelector('.cornerstone-canvas');\n        viewport.style.borderRadius = 'inherit';\n        canvas.style.borderRadius = 'inherit';\n    }\n    _createViewportNode() {\n        const magnifyElement = document.createElement('div');\n        const { radius } = this;\n        const size = radius * 2;\n        magnifyElement.classList.add(MAGNIFY_CLASSNAME);\n        Object.assign(magnifyElement.style, {\n            display: 'block',\n            width: `${size}px`,\n            height: `${size}px`,\n            position: 'absolute',\n            overflow: 'hidden',\n            borderRadius: '50%',\n            boxSizing: 'border-box',\n            left: `${-radius}px`,\n            top: `${-radius}px`,\n            transform: `translate(-1000px, -1000px)`,\n        });\n        return magnifyElement;\n    }\n    _convertZoomFactorToParallelScale(viewport, magnifyViewport, zoomFactor) {\n        const { parallelScale } = viewport.getCamera();\n        const canvasRatio = magnifyViewport.canvas.offsetWidth / viewport.canvas.offsetWidth;\n        return parallelScale * (1 / zoomFactor) * canvasRatio;\n    }\n    _isStackViewport(viewport) {\n        return 'setStack' in viewport;\n    }\n    _isVolumeViewport(viewport) {\n        return 'addVolumes' in viewport;\n    }\n    _cloneToolGroups(sourceViewport, magnifyViewport) {\n        const sourceActors = sourceViewport.getActors();\n        const magnifyToolGroupId = `${magnifyViewport.id}-toolGroup`;\n        const sourceToolGroup = getToolGroupForViewport(sourceViewport.id, sourceViewport.renderingEngineId);\n        const magnifyToolGroup = sourceToolGroup.clone(magnifyToolGroupId, (toolName) => {\n            const toolInstance = sourceToolGroup.getToolInstance(toolName);\n            const isAnnotationTool = toolInstance instanceof AnnotationTool &&\n                !(toolInstance instanceof AdvancedMagnifyTool);\n            return isAnnotationTool;\n        });\n        magnifyToolGroup.addViewport(magnifyViewport.id, magnifyViewport.renderingEngineId);\n        sourceActors.filter(isSegmentation).forEach((actor) => {\n            addSegmentationRepresentations(this.viewportId, [\n                {\n                    segmentationId: actor.referencedId,\n                    type: SegmentationRepresentations.Labelmap,\n                },\n            ]);\n        });\n        return { sourceToolGroup, magnifyToolGroup };\n    }\n    _cloneStack(sourceViewport, magnifyViewport) {\n        const imageIds = sourceViewport.getImageIds();\n        magnifyViewport.setStack(imageIds).then(() => {\n            this._isViewportReady = true;\n            this.update();\n        });\n    }\n    _cloneVolumes(sourceViewport, magnifyViewport) {\n        const actors = sourceViewport.getActors();\n        const volumeInputArray = actors\n            .filter((actor) => !isSegmentation(actor))\n            .map((actor) => ({ volumeId: actor.uid }));\n        magnifyViewport.setVolumes(volumeInputArray).then(() => {\n            this._isViewportReady = true;\n            this.update();\n        });\n        return magnifyViewport;\n    }\n    _cloneViewport(sourceViewport, magnifyElement) {\n        const { viewportId: magnifyViewportId } = this;\n        const renderingEngine = sourceViewport.getRenderingEngine();\n        const { options: sourceViewportOptions } = sourceViewport;\n        const viewportInput = {\n            element: magnifyElement,\n            viewportId: magnifyViewportId,\n            type: sourceViewport.type,\n            defaultOptions: { ...sourceViewportOptions },\n        };\n        renderingEngine.enableElement(viewportInput);\n        const magnifyViewport = (renderingEngine.getViewport(magnifyViewportId));\n        if (this._isStackViewport(sourceViewport)) {\n            this._cloneStack(sourceViewport, magnifyViewport);\n        }\n        else if (this._isVolumeViewport(sourceViewport)) {\n            this._cloneVolumes(sourceViewport, magnifyViewport);\n        }\n        this._inheritBorderRadius(magnifyElement);\n        const toolGroups = this._cloneToolGroups(sourceViewport, magnifyViewport);\n        this._sourceToolGroup = toolGroups.sourceToolGroup;\n        this._magnifyToolGroup = toolGroups.magnifyToolGroup;\n    }\n    _cancelMouseEventCallback(evt) {\n        evt.stopPropagation();\n        evt.preventDefault();\n    }\n    _browserMouseUpCallback(evt) {\n        const { element } = this._enabledElement.viewport;\n        document.removeEventListener('mouseup', this._browserMouseUpCallback);\n        element.addEventListener('mouseup', this._cancelMouseEventCallback);\n        element.addEventListener('mousemove', this._cancelMouseEventCallback);\n    }\n    _browserMouseDownCallback(evt) {\n        const { element } = this._enabledElement.viewport;\n        this._canAutoPan = !!evt.target?.closest('.advancedMagnifyTool');\n        document.addEventListener('mouseup', this._browserMouseUpCallback);\n        element.removeEventListener('mouseup', this._cancelMouseEventCallback);\n        element.removeEventListener('mousemove', this._cancelMouseEventCallback);\n    }\n    _mouseDragCallback(evt) {\n        if (!state.isInteractingWithTool) {\n            return;\n        }\n        const { _autoPan: autoPan } = this;\n        if (!autoPan.enabled || !this._canAutoPan) {\n            return;\n        }\n        const { currentPoints } = evt.detail;\n        const { viewport } = this._enabledElement;\n        const { canvasToWorld } = viewport;\n        const { canvas: canvasCurrent } = currentPoints;\n        const { radius: magnifyRadius } = this;\n        const canvasCenter = [magnifyRadius, magnifyRadius];\n        const dist = distanceToPoint(canvasCenter, canvasCurrent);\n        const maxDist = magnifyRadius - autoPan.padding;\n        if (dist <= maxDist) {\n            return;\n        }\n        const panDist = dist - maxDist;\n        const canvasDeltaPos = vec2.sub(vec2.create(), canvasCurrent, canvasCenter);\n        vec2.normalize(canvasDeltaPos, canvasDeltaPos);\n        vec2.scale(canvasDeltaPos, canvasDeltaPos, panDist);\n        const newCanvasPosition = vec2.add(vec2.create(), this.position, canvasDeltaPos);\n        const currentWorldPos = canvasToWorld(this.position);\n        const newWorldPos = canvasToWorld(newCanvasPosition);\n        const worldDeltaPos = vec3.sub(vec3.create(), newWorldPos, currentWorldPos);\n        const autoPanCallbackData = {\n            points: {\n                currentPosition: {\n                    canvas: this.position,\n                    world: currentWorldPos,\n                },\n                newPosition: {\n                    canvas: newCanvasPosition,\n                    world: newWorldPos,\n                },\n            },\n            delta: {\n                canvas: canvasDeltaPos,\n                world: worldDeltaPos,\n            },\n        };\n        autoPan.callback(autoPanCallbackData);\n    }\n    _addBrowserEventListeners(element) {\n        document.addEventListener('mousedown', this._browserMouseDownCallback, true);\n        element.addEventListener('mousedown', this._cancelMouseEventCallback);\n        element.addEventListener('mouseup', this._cancelMouseEventCallback);\n        element.addEventListener('mousemove', this._cancelMouseEventCallback);\n        element.addEventListener('dblclick', this._cancelMouseEventCallback);\n    }\n    _removeBrowserEventListeners(element) {\n        document.removeEventListener('mousedown', this._browserMouseDownCallback, true);\n        document.removeEventListener('mouseup', this._browserMouseUpCallback);\n        element.removeEventListener('mousedown', this._cancelMouseEventCallback);\n        element.removeEventListener('mouseup', this._cancelMouseEventCallback);\n        element.removeEventListener('mousemove', this._cancelMouseEventCallback);\n        element.removeEventListener('dblclick', this._cancelMouseEventCallback);\n    }\n    _addEventListeners(element) {\n        eventTarget.addEventListener(cstEvents.TOOL_MODE_CHANGED, this._handleToolModeChanged);\n        element.addEventListener(cstEvents.MOUSE_MOVE, this._mouseDragCallback);\n        element.addEventListener(cstEvents.MOUSE_DRAG, this._mouseDragCallback);\n        this._addBrowserEventListeners(element);\n    }\n    _removeEventListeners(element) {\n        eventTarget.removeEventListener(cstEvents.TOOL_MODE_CHANGED, this._handleToolModeChanged);\n        element.addEventListener(cstEvents.MOUSE_MOVE, this._mouseDragCallback);\n        element.addEventListener(cstEvents.MOUSE_DRAG, this._mouseDragCallback);\n        this._removeBrowserEventListeners(element);\n    }\n    _initialize() {\n        const { _sourceEnabledElement: sourceEnabledElement } = this;\n        const { viewport: sourceViewport } = sourceEnabledElement;\n        const { canvas: sourceCanvas } = sourceViewport;\n        const magnifyElement = this._createViewportNode();\n        sourceCanvas.parentNode.appendChild(magnifyElement);\n        this._addEventListeners(magnifyElement);\n        this._cloneViewport(sourceViewport, magnifyElement);\n        this._enabledElement = getEnabledElement(magnifyElement);\n    }\n    _syncViewportsCameras(sourceViewport, magnifyViewport) {\n        const worldPos = sourceViewport.canvasToWorld(this.position);\n        const parallelScale = this._convertZoomFactorToParallelScale(sourceViewport, magnifyViewport, this.zoomFactor);\n        const { focalPoint, position, viewPlaneNormal } = magnifyViewport.getCamera();\n        const distance = Math.sqrt(Math.pow(focalPoint[0] - position[0], 2) +\n            Math.pow(focalPoint[1] - position[1], 2) +\n            Math.pow(focalPoint[2] - position[2], 2));\n        const updatedFocalPoint = [\n            worldPos[0],\n            worldPos[1],\n            worldPos[2],\n        ];\n        const updatedPosition = [\n            updatedFocalPoint[0] + distance * viewPlaneNormal[0],\n            updatedFocalPoint[1] + distance * viewPlaneNormal[1],\n            updatedFocalPoint[2] + distance * viewPlaneNormal[2],\n        ];\n        magnifyViewport.setCamera({\n            parallelScale,\n            focalPoint: updatedFocalPoint,\n            position: updatedPosition,\n        });\n    }\n    _syncStackViewports(sourceViewport, magnifyViewport) {\n        magnifyViewport.setImageIdIndex(sourceViewport.getCurrentImageIdIndex());\n    }\n    _syncViewports() {\n        const { viewport: sourceViewport } = this._sourceEnabledElement;\n        const { viewport: magnifyViewport } = this._enabledElement;\n        const sourceProperties = sourceViewport.getProperties();\n        const imageData = magnifyViewport.getImageData();\n        if (!imageData) {\n            return;\n        }\n        magnifyViewport.setProperties(sourceProperties);\n        this._syncViewportsCameras(sourceViewport, magnifyViewport);\n        if (this._isStackViewport(sourceViewport)) {\n            this._syncStackViewports(sourceViewport, magnifyViewport);\n        }\n        this._syncViewportsCameras(sourceViewport, magnifyViewport);\n        magnifyViewport.render();\n    }\n    _resizeViewport() {\n        const { viewport } = this._enabledElement;\n        const renderingEngine = viewport.getRenderingEngine();\n        renderingEngine.resize();\n    }\n}\nAdvancedMagnifyTool.toolName = 'AdvancedMagnify';\nexport { AdvancedMagnifyTool as default };\n","import { vec3 } from 'gl-matrix';\nimport { getRenderingEngines, CONSTANTS, utilities as csUtils, } from '@cornerstonejs/core';\nimport { getEnabledElementByViewportId } from '@cornerstonejs/core';\nimport { addAnnotation } from '../stateManagement/annotation/annotationState';\nimport { drawLine as drawLineSvg } from '../drawingSvg';\nimport { filterViewportsWithToolEnabled } from '../utilities/viewportFilters';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nimport AnnotationDisplayTool from './base/AnnotationDisplayTool';\nconst { EPSILON } = CONSTANTS;\nclass ReferenceLines extends AnnotationDisplayTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            sourceViewportId: '',\n            enforceSameFrameOfReference: true,\n            showFullDimension: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.editData = null;\n        this._init = () => {\n            const renderingEngines = getRenderingEngines();\n            const renderingEngine = renderingEngines[0];\n            if (!renderingEngine) {\n                return;\n            }\n            let viewports = renderingEngine.getViewports();\n            viewports = filterViewportsWithToolEnabled(viewports, this.getToolName());\n            const sourceViewport = renderingEngine.getViewport(this.configuration.sourceViewportId);\n            if (!sourceViewport?.getImageData()) {\n                return;\n            }\n            const { element } = sourceViewport;\n            const { viewUp, viewPlaneNormal } = sourceViewport.getCamera();\n            const sourceViewportCanvasCornersInWorld = csUtils.getViewportImageCornersInWorld(sourceViewport);\n            let annotation = this.editData?.annotation;\n            const FrameOfReferenceUID = sourceViewport.getFrameOfReferenceUID();\n            if (!annotation) {\n                const newAnnotation = {\n                    highlighted: true,\n                    invalidated: true,\n                    metadata: {\n                        toolName: this.getToolName(),\n                        viewPlaneNormal: [...viewPlaneNormal],\n                        viewUp: [...viewUp],\n                        FrameOfReferenceUID,\n                        referencedImageId: null,\n                    },\n                    data: {\n                        handles: {\n                            points: sourceViewportCanvasCornersInWorld,\n                        },\n                    },\n                };\n                addAnnotation(newAnnotation, element);\n                annotation = newAnnotation;\n            }\n            else {\n                this.editData.annotation.data.handles.points =\n                    sourceViewportCanvasCornersInWorld;\n            }\n            this.editData = {\n                sourceViewportId: sourceViewport.id,\n                renderingEngine,\n                annotation,\n            };\n            triggerAnnotationRenderForViewportIds(viewports\n                .filter((viewport) => viewport.id !== sourceViewport.id)\n                .map((viewport) => viewport.id));\n        };\n        this.onSetToolEnabled = () => {\n            this._init();\n        };\n        this.onSetToolConfiguration = () => {\n            this._init();\n        };\n        this.onCameraModified = (evt) => {\n            this._init();\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            const { viewport: targetViewport } = enabledElement;\n            if (!this.editData) {\n                return false;\n            }\n            const { annotation, sourceViewportId } = this.editData;\n            let renderStatus = false;\n            const { viewport: sourceViewport } = getEnabledElementByViewportId(sourceViewportId) || {};\n            if (!sourceViewport) {\n                return renderStatus;\n            }\n            if (sourceViewport.id === targetViewport.id) {\n                return renderStatus;\n            }\n            if (!annotation || !annotation?.data?.handles?.points) {\n                return renderStatus;\n            }\n            if (this.configuration.enforceSameFrameOfReference &&\n                sourceViewport.getFrameOfReferenceUID() !==\n                    targetViewport.getFrameOfReferenceUID()) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            const topLeft = annotation.data.handles.points[0];\n            const topRight = annotation.data.handles.points[1];\n            const bottomLeft = annotation.data.handles.points[2];\n            const bottomRight = annotation.data.handles.points[3];\n            const { focalPoint, viewPlaneNormal, viewUp } = targetViewport.getCamera();\n            const { viewPlaneNormal: sourceViewPlaneNormal } = sourceViewport.getCamera();\n            if (this.isParallel(viewPlaneNormal, sourceViewPlaneNormal)) {\n                return renderStatus;\n            }\n            const targetViewportPlane = csUtils.planar.planeEquation(viewPlaneNormal, focalPoint);\n            const pointSet1 = [topLeft, bottomLeft, topRight, bottomRight];\n            const pointSet2 = [topLeft, topRight, bottomLeft, bottomRight];\n            let pointSetToUse = pointSet1;\n            let topBottomVec = vec3.subtract(vec3.create(), pointSet1[0], pointSet1[1]);\n            topBottomVec = vec3.normalize(vec3.create(), topBottomVec);\n            let topRightVec = vec3.subtract(vec3.create(), pointSet1[2], pointSet1[0]);\n            topRightVec = vec3.normalize(vec3.create(), topRightVec);\n            const newNormal = vec3.cross(vec3.create(), topBottomVec, topRightVec);\n            if (this.isParallel(newNormal, viewPlaneNormal)) {\n                return renderStatus;\n            }\n            if (this.isPerpendicular(topBottomVec, viewPlaneNormal)) {\n                pointSetToUse = pointSet2;\n            }\n            const lineStartWorld = csUtils.planar.linePlaneIntersection(pointSetToUse[0], pointSetToUse[1], targetViewportPlane);\n            const lineEndWorld = csUtils.planar.linePlaneIntersection(pointSetToUse[2], pointSetToUse[3], targetViewportPlane);\n            const { annotationUID } = annotation;\n            styleSpecifier.annotationUID = annotationUID;\n            const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n            const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n            const color = this.getStyle('color', styleSpecifier, annotation);\n            const shadow = this.getStyle('shadow', styleSpecifier, annotation);\n            let canvasCoordinates = [lineStartWorld, lineEndWorld].map((world) => targetViewport.worldToCanvas(world));\n            if (this.configuration.showFullDimension) {\n                canvasCoordinates = this.handleFullDimension(targetViewport, lineStartWorld, viewPlaneNormal, viewUp, lineEndWorld, canvasCoordinates);\n            }\n            if (canvasCoordinates.length < 2) {\n                return renderStatus;\n            }\n            const dataId = `${annotationUID}-line`;\n            const lineUID = '1';\n            drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], canvasCoordinates[1], {\n                color,\n                width: lineWidth,\n                lineDash,\n                shadow,\n            }, dataId);\n            renderStatus = true;\n            return renderStatus;\n        };\n        this.isPerpendicular = (vec1, vec2) => {\n            const dot = vec3.dot(vec1, vec2);\n            return Math.abs(dot) < EPSILON;\n        };\n    }\n    handleFullDimension(targetViewport, lineStartWorld, viewPlaneNormal, viewUp, lineEndWorld, canvasCoordinates) {\n        const renderingEngine = targetViewport.getRenderingEngine();\n        const targetId = this.getTargetId(targetViewport);\n        const targetImage = this.getTargetImageData(targetId);\n        const referencedImageId = this.getReferencedImageId(targetViewport, lineStartWorld, viewPlaneNormal, viewUp);\n        if (referencedImageId && targetImage) {\n            try {\n                const { imageData, dimensions } = targetImage;\n                const [topLeftImageCoord, topRightImageCoord, bottomRightImageCoord, bottomLeftImageCoord,] = [\n                    imageData.indexToWorld([0, 0, 0]),\n                    imageData.indexToWorld([dimensions[0] - 1, 0, 0]),\n                    imageData.indexToWorld([\n                        dimensions[0] - 1,\n                        dimensions[1] - 1,\n                        0,\n                    ]),\n                    imageData.indexToWorld([0, dimensions[1] - 1, 0]),\n                ].map((world) => csUtils.worldToImageCoords(referencedImageId, world));\n                const [lineStartImageCoord, lineEndImageCoord] = [\n                    lineStartWorld,\n                    lineEndWorld,\n                ].map((world) => csUtils.worldToImageCoords(referencedImageId, world));\n                canvasCoordinates = [\n                    [topLeftImageCoord, topRightImageCoord],\n                    [topRightImageCoord, bottomRightImageCoord],\n                    [bottomLeftImageCoord, bottomRightImageCoord],\n                    [topLeftImageCoord, bottomLeftImageCoord],\n                ]\n                    .map(([start, end]) => this.intersectInfiniteLines(start, end, lineStartImageCoord, lineEndImageCoord))\n                    .filter((point) => point && this.isInBound(point, dimensions))\n                    .map((point) => {\n                    const world = csUtils.imageToWorldCoords(referencedImageId, point);\n                    return targetViewport.worldToCanvas(world);\n                });\n            }\n            catch (err) {\n                console.log(err);\n            }\n        }\n        return canvasCoordinates;\n    }\n    intersectInfiniteLines(line1Start, line1End, line2Start, line2End) {\n        const [x1, y1] = line1Start;\n        const [x2, y2] = line1End;\n        const [x3, y3] = line2Start;\n        const [x4, y4] = line2End;\n        const a1 = y2 - y1;\n        const b1 = x1 - x2;\n        const c1 = x2 * y1 - x1 * y2;\n        const a2 = y4 - y3;\n        const b2 = x3 - x4;\n        const c2 = x4 * y3 - x3 * y4;\n        if (Math.abs(a1 * b2 - a2 * b1) < EPSILON) {\n            return;\n        }\n        const x = (b1 * c2 - b2 * c1) / (a1 * b2 - a2 * b1);\n        const y = (a2 * c1 - a1 * c2) / (a1 * b2 - a2 * b1);\n        return [x, y];\n    }\n    isParallel(vec1, vec2) {\n        return Math.abs(vec3.dot(vec1, vec2)) > 1 - EPSILON;\n    }\n    isInBound(point, dimensions) {\n        return (point[0] >= 0 &&\n            point[0] <= dimensions[0] &&\n            point[1] >= 0 &&\n            point[1] <= dimensions[1]);\n    }\n}\nReferenceLines.toolName = 'ReferenceLines';\nexport default ReferenceLines;\n","import { vec3 } from 'gl-matrix';\nimport { metaData, CONSTANTS, getRenderingEngine, utilities as csUtils, } from '@cornerstonejs/core';\nimport { addAnnotation, getAnnotations, } from '../stateManagement/annotation/annotationState';\nimport { getToolGroup } from '../store/ToolGroupManager';\nimport { drawLine as drawLineSvg } from '../drawingSvg';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nimport AnnotationDisplayTool from './base/AnnotationDisplayTool';\nconst { EPSILON } = CONSTANTS;\nclass OverlayGridTool extends AnnotationDisplayTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            sourceImageIds: [],\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.onSetToolEnabled = () => {\n            this._init();\n        };\n        this.onSetToolActive = () => {\n            this._init();\n        };\n        this._init = () => {\n            const sourceImageIds = this.configuration.sourceImageIds;\n            if (!sourceImageIds?.length) {\n                console.warn('OverlayGridTool: No sourceImageIds provided in configuration');\n                return;\n            }\n            const imagePlaneModule = metaData.get('imagePlaneModule', sourceImageIds[0]);\n            if (!imagePlaneModule) {\n                console.warn('OverlayGridTool: No imagePlaneModule found for sourceImageIds');\n                return;\n            }\n            const { frameOfReferenceUID } = imagePlaneModule;\n            const viewportsInfo = getToolGroup(this.toolGroupId).viewportsInfo;\n            if (!viewportsInfo?.length) {\n                console.warn('OverlayGridTool: No viewports found');\n                return;\n            }\n            const annotations = getAnnotations(this.getToolName(), frameOfReferenceUID);\n            if (!annotations?.length) {\n                const pointSets = sourceImageIds.map((id) => {\n                    return this.calculateImageIdPointSets(id);\n                });\n                const newAnnotation = {\n                    highlighted: true,\n                    invalidated: true,\n                    metadata: {\n                        toolName: this.getToolName(),\n                        FrameOfReferenceUID: frameOfReferenceUID,\n                        referencedImageId: null,\n                    },\n                    data: {\n                        viewportData: new Map(),\n                        pointSets,\n                    },\n                };\n                addAnnotation(newAnnotation, frameOfReferenceUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportsInfo.map(({ viewportId }) => viewportId));\n        };\n        this.calculateImageIdPointSets = (imageId) => {\n            const { imagePositionPatient, rows, columns, rowCosines, columnCosines, rowPixelSpacing, columnPixelSpacing, } = metaData.get('imagePlaneModule', imageId);\n            const topLeft = [...imagePositionPatient];\n            const topRight = [...imagePositionPatient];\n            const bottomLeft = [...imagePositionPatient];\n            const bottomRight = [...imagePositionPatient];\n            vec3.scaleAndAdd(topRight, imagePositionPatient, columnCosines, columns * columnPixelSpacing);\n            vec3.scaleAndAdd(bottomLeft, imagePositionPatient, rowCosines, rows * rowPixelSpacing);\n            vec3.scaleAndAdd(bottomRight, bottomLeft, columnCosines, columns * columnPixelSpacing);\n            const pointSet1 = [topLeft, bottomLeft, topRight, bottomRight];\n            const pointSet2 = [topLeft, topRight, bottomLeft, bottomRight];\n            return { pointSet1, pointSet2 };\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            const sourceImageIds = this.configuration.sourceImageIds;\n            let renderStatus = false;\n            if (!sourceImageIds?.length) {\n                return renderStatus;\n            }\n            const { viewport: targetViewport, FrameOfReferenceUID } = enabledElement;\n            const targetImageIds = targetViewport.getImageIds();\n            if (targetImageIds.length < 2) {\n                return renderStatus;\n            }\n            const annotations = getAnnotations(this.getToolName(), FrameOfReferenceUID);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const annotation = annotations[0];\n            const { annotationUID } = annotation;\n            const { focalPoint, viewPlaneNormal } = targetViewport.getCamera();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            const imageIdNormal = (this.getImageIdNormal(sourceImageIds[0]));\n            if (this.isParallel(viewPlaneNormal, imageIdNormal)) {\n                return renderStatus;\n            }\n            const targetViewportPlane = csUtils.planar.planeEquation(viewPlaneNormal, focalPoint);\n            const pointSets = annotation.data.pointSets;\n            const viewportData = annotation.data.viewportData;\n            for (let i = 0; i < sourceImageIds.length; i++) {\n                const { pointSet1, pointSet2 } = pointSets[i];\n                const targetData = viewportData.get(targetViewport.id) ||\n                    this.initializeViewportData(viewportData, targetViewport.id);\n                if (!targetData.pointSetsToUse[i]) {\n                    let pointSetToUse = pointSet1;\n                    let topBottomVec = vec3.subtract(vec3.create(), pointSet1[0], pointSet1[1]);\n                    topBottomVec = vec3.normalize(vec3.create(), topBottomVec);\n                    if (this.isPerpendicular(topBottomVec, viewPlaneNormal)) {\n                        pointSetToUse = pointSet2;\n                    }\n                    targetData.pointSetsToUse[i] = pointSetToUse;\n                    targetData.lineStartsWorld[i] = csUtils.planar.linePlaneIntersection(pointSetToUse[0], pointSetToUse[1], targetViewportPlane);\n                    targetData.lineEndsWorld[i] = csUtils.planar.linePlaneIntersection(pointSetToUse[2], pointSetToUse[3], targetViewportPlane);\n                }\n                const lineStartWorld = targetData.lineStartsWorld[i];\n                const lineEndWorld = targetData.lineEndsWorld[i];\n                styleSpecifier.annotationUID = annotationUID;\n                const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n                const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                const shadow = this.getStyle('shadow', styleSpecifier, annotation);\n                const canvasCoordinates = [lineStartWorld, lineEndWorld].map((world) => targetViewport.worldToCanvas(world));\n                const dataId = `${annotationUID}-line`;\n                const lineUID = `${i}`;\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], canvasCoordinates[1], {\n                    color,\n                    width: lineWidth,\n                    lineDash,\n                    shadow,\n                }, dataId);\n            }\n            renderStatus = true;\n            return renderStatus;\n        };\n        this.initializeViewportData = (viewportData, id) => {\n            viewportData.set(id, {\n                pointSetsToUse: [],\n                lineStartsWorld: [],\n                lineEndsWorld: [],\n            });\n            return viewportData.get(id);\n        };\n        this.isPerpendicular = (vec1, vec2) => {\n            const dot = vec3.dot(vec1, vec2);\n            return Math.abs(dot) < EPSILON;\n        };\n    }\n    isParallel(vec1, vec2) {\n        return Math.abs(vec3.dot(vec1, vec2)) > 1 - EPSILON;\n    }\n    getImageIdNormal(imageId) {\n        const { imageOrientationPatient } = metaData.get('imagePlaneModule', imageId);\n        const rowCosineVec = vec3.fromValues(imageOrientationPatient[0], imageOrientationPatient[1], imageOrientationPatient[2]);\n        const colCosineVec = vec3.fromValues(imageOrientationPatient[3], imageOrientationPatient[4], imageOrientationPatient[5]);\n        return vec3.cross(vec3.create(), rowCosineVec, colCosineVec);\n    }\n}\nOverlayGridTool.toolName = 'OverlayGrid';\nexport default OverlayGridTool;\n","import { getRenderingEngine } from '@cornerstonejs/core';\nimport { addAnnotation, getAnnotations, } from '../stateManagement/annotation/annotationState';\nimport { drawPath } from '../drawingSvg';\nimport { getToolGroup } from '../store/ToolGroupManager';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nimport AnnotationDisplayTool from './base/AnnotationDisplayTool';\nimport { distanceToPoint } from '../utilities/math/point';\nimport { pointToString } from '../utilities/pointToString';\nimport { polyDataUtils } from '../utilities';\nclass SegmentationIntersectionTool extends AnnotationDisplayTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        configuration: {\n            opacity: 0.5,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this._init = () => {\n            const viewportsInfo = getToolGroup(this.toolGroupId).viewportsInfo;\n            if (!viewportsInfo?.length) {\n                console.warn(this.getToolName() + 'Tool: No viewports found');\n                return;\n            }\n            const firstViewport = getRenderingEngine(viewportsInfo[0].renderingEngineId)?.getViewport(viewportsInfo[0].viewportId);\n            if (!firstViewport) {\n                return;\n            }\n            const frameOfReferenceUID = firstViewport.getFrameOfReferenceUID();\n            const annotations = getAnnotations(this.getToolName(), frameOfReferenceUID);\n            if (!annotations?.length) {\n                const actorsWorldPointsMap = new Map();\n                calculateSurfaceSegmentationIntersections(actorsWorldPointsMap, viewportsInfo);\n                const newAnnotation = {\n                    highlighted: true,\n                    invalidated: true,\n                    metadata: {\n                        toolName: this.getToolName(),\n                        FrameOfReferenceUID: frameOfReferenceUID,\n                        referencedImageId: null,\n                    },\n                    data: {\n                        actorsWorldPointsMap,\n                    },\n                };\n                addAnnotation(newAnnotation, frameOfReferenceUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportsInfo.map(({ viewportId }) => viewportId));\n        };\n        this.onSetToolEnabled = () => {\n            this._init();\n        };\n        this.onCameraModified = (evt) => {\n            this._init();\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            const { viewport, FrameOfReferenceUID } = enabledElement;\n            let renderStatus = false;\n            const annotations = getAnnotations(this.getToolName(), FrameOfReferenceUID);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const annotation = annotations[0];\n            const { annotationUID } = annotation;\n            const actorsWorldPointsMap = annotation.data.actorsWorldPointsMap;\n            calculateSurfaceSegmentationIntersectionsForViewport(actorsWorldPointsMap, viewport);\n            const actorEntries = viewport.getActors();\n            const cacheId = getCacheId(viewport);\n            actorEntries.forEach((actorEntry) => {\n                if (!actorEntry?.clippingFilter) {\n                    return;\n                }\n                const actorWorldPointMap = actorsWorldPointsMap.get(actorEntry.uid);\n                if (!actorWorldPointMap) {\n                    return;\n                }\n                if (!actorWorldPointMap.get(cacheId)) {\n                    return;\n                }\n                let polyLineIdx = 1;\n                const { worldPointsSet, color } = actorWorldPointMap.get(cacheId);\n                for (let i = 0; i < worldPointsSet.length; i++) {\n                    const worldPoints = worldPointsSet[i];\n                    const canvasPoints = worldPoints.map((point) => viewport.worldToCanvas(point));\n                    const options = {\n                        color: color,\n                        fillColor: color,\n                        fillOpacity: this.configuration.opacity,\n                        closePath: true,\n                        lineWidth: 2,\n                    };\n                    const polyLineUID = actorEntry.uid + '#' + polyLineIdx;\n                    drawPath(svgDrawingHelper, annotationUID, polyLineUID, canvasPoints, options);\n                    polyLineIdx++;\n                }\n            });\n            renderStatus = true;\n            return renderStatus;\n        };\n    }\n}\nfunction calculateSurfaceSegmentationIntersections(actorsWorldPointsMap, viewportsInfo) {\n    viewportsInfo.forEach(({ viewportId, renderingEngineId }) => {\n        const viewport = getRenderingEngine(renderingEngineId)?.getViewport(viewportId);\n        calculateSurfaceSegmentationIntersectionsForViewport(actorsWorldPointsMap, viewport);\n    });\n}\nfunction calculateSurfaceSegmentationIntersectionsForViewport(actorsWorldPointsMap, viewport) {\n    const actorEntries = viewport.getActors();\n    const cacheId = getCacheId(viewport);\n    actorEntries.forEach((actorEntry) => {\n        if (!actorEntry?.clippingFilter) {\n            return;\n        }\n        let actorWorldPointsMap = actorsWorldPointsMap.get(actorEntry.uid);\n        if (!actorWorldPointsMap) {\n            actorWorldPointsMap = new Map();\n            actorsWorldPointsMap.set(actorEntry.uid, actorWorldPointsMap);\n        }\n        if (!actorWorldPointsMap.get(cacheId)) {\n            const polyData = actorEntry.clippingFilter.getOutputData();\n            const worldPointsSet = polyDataUtils.getPolyDataPoints(polyData);\n            if (!worldPointsSet) {\n                return;\n            }\n            const colorArray = actorEntry.actor.getProperty().getColor();\n            const color = colorToString(colorArray);\n            actorWorldPointsMap.set(cacheId, { worldPointsSet, color });\n        }\n    });\n}\nfunction getCacheId(viewport) {\n    const { viewPlaneNormal } = viewport.getCamera();\n    const imageIndex = viewport.getCurrentImageIdIndex();\n    return `${viewport.id}-${pointToString(viewPlaneNormal)}-${imageIndex}`;\n}\nfunction colorToString(colorArray) {\n    function colorComponentToString(component) {\n        let componentString = Math.floor(component * 255).toString(16);\n        if (componentString.length === 1) {\n            componentString = '0' + componentString;\n        }\n        return componentString;\n    }\n    return ('#' +\n        colorComponentToString(colorArray[0]) +\n        colorComponentToString(colorArray[1]) +\n        colorComponentToString(colorArray[2]));\n}\nfunction removeExtraPoints(viewport, worldPointsSet) {\n    return worldPointsSet.map((worldPoints) => {\n        const canvasPoints = worldPoints.map((point) => {\n            const canvasPoint = viewport.worldToCanvas(point);\n            return [Math.floor(canvasPoint[0]), Math.floor(canvasPoint[1])];\n        });\n        let lastPoint;\n        const newWorldPoints = [];\n        let newCanvasPoints = [];\n        for (let i = 0; i < worldPoints.length; i++) {\n            if (lastPoint) {\n                if (distanceToPoint(lastPoint, canvasPoints[i]) > 0) {\n                    newWorldPoints.push(worldPoints[i]);\n                    newCanvasPoints.push(canvasPoints[i]);\n                }\n            }\n            lastPoint = canvasPoints[i];\n        }\n        const firstPoint = newCanvasPoints[0];\n        for (let j = Math.min(30, newCanvasPoints.length); j < newCanvasPoints.length; j++) {\n            if (distanceToPoint(firstPoint, newCanvasPoints[j]) < 0.5) {\n                newCanvasPoints = newCanvasPoints.slice(0, j);\n                return newWorldPoints.slice(0, j);\n            }\n        }\n        return newWorldPoints;\n    });\n}\nSegmentationIntersectionTool.toolName = 'SegmentationIntersection';\nexport default SegmentationIntersectionTool;\n","import { getEnabledElement, StackViewport, VolumeViewport, utilities, getEnabledElementByIds, } from '@cornerstonejs/core';\nimport { addAnnotation, getAnnotations, } from '../stateManagement/annotation/annotationState';\nimport { isAnnotationVisible } from '../stateManagement/annotation/annotationVisibility';\nimport { drawLine } from '../drawingSvg';\nimport { getViewportIdsWithToolToRender } from '../utilities/viewportFilters';\nimport triggerAnnotationRenderForViewportIds from '../utilities/triggerAnnotationRenderForViewportIds';\nimport { vec3 } from 'gl-matrix';\nimport AnnotationDisplayTool from './base/AnnotationDisplayTool';\nimport vtkMath from '@kitware/vtk.js/Common/Core/Math';\nimport { hideElementCursor, resetElementCursor, } from '../cursors/elementCursor';\nimport { getToolGroup } from '../store/ToolGroupManager';\nclass ReferenceCursors extends AnnotationDisplayTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            displayThreshold: 5,\n            positionSync: true,\n            disableCursor: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isDrawing = false;\n        this.isHandleOutsideImage = false;\n        this._elementWithCursor = null;\n        this._currentCursorWorldPosition = null;\n        this._currentCanvasPosition = null;\n        this._disableCursorEnabled = false;\n        this.mouseMoveCallback = (evt) => {\n            const { detail } = evt;\n            const { element, currentPoints } = detail;\n            this._currentCursorWorldPosition = currentPoints.world;\n            this._currentCanvasPosition = currentPoints.canvas;\n            this._elementWithCursor = element;\n            const annotation = this.getActiveAnnotation(element);\n            if (annotation === null) {\n                this.createInitialAnnotation(currentPoints.world, element);\n                return false;\n            }\n            this.updateAnnotationPosition(element, annotation);\n            return false;\n        };\n        this.createInitialAnnotation = (worldPos, element) => {\n            const enabledElement = getEnabledElement(element);\n            if (!enabledElement) {\n                throw new Error('No enabled element found');\n            }\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            if (!viewPlaneNormal || !viewUp) {\n                throw new Error('Camera not found');\n            }\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                },\n                data: {\n                    label: '',\n                    handles: {\n                        points: [[...worldPos]],\n                        activeHandleIndex: null,\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                    },\n                },\n            };\n            const annotations = getAnnotations(this.getToolName(), element);\n            if (annotations.length > 0) {\n                return null;\n            }\n            const annotationId = addAnnotation(annotation, element);\n            if (annotationId === null) {\n                return;\n            }\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName(), false);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.onCameraModified = (evt) => {\n            const eventDetail = evt.detail;\n            const { element, previousCamera, camera } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const viewport = enabledElement.viewport;\n            if (element !== this._elementWithCursor) {\n                return;\n            }\n            const oldFocalPoint = previousCamera.focalPoint;\n            const cameraNormal = camera.viewPlaneNormal;\n            const newFocalPoint = camera.focalPoint;\n            const deltaCameraFocalPoint = [0, 0, 0];\n            vtkMath.subtract(newFocalPoint, oldFocalPoint, deltaCameraFocalPoint);\n            if (deltaCameraFocalPoint.reduce((a, b) => a + b, 0) === 0) {\n                return;\n            }\n            const dotProduct = vtkMath.dot(deltaCameraFocalPoint, cameraNormal);\n            if (Math.abs(dotProduct) < 1e-2) {\n                return;\n            }\n            if (!this._currentCanvasPosition) {\n                return;\n            }\n            const newWorldPos = viewport.canvasToWorld(this._currentCanvasPosition);\n            this._currentCursorWorldPosition = newWorldPos;\n            this.updateAnnotationPosition(element, this.getActiveAnnotation(element));\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport, FrameOfReferenceUID } = enabledElement;\n            const isElementWithCursor = this._elementWithCursor === viewport.element;\n            if (this.configuration.positionSync && !isElementWithCursor) {\n                this.updateViewportImage(viewport);\n            }\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { handles } = data;\n                const { points } = handles;\n                if (!annotationUID) {\n                    return renderStatus;\n                }\n                styleSpecifier.annotationUID = annotationUID;\n                const lineWidthBase = parseFloat(this.getStyle('lineWidth', styleSpecifier, annotation));\n                const lineWidth = typeof lineWidthBase === 'number' && isElementWithCursor\n                    ? lineWidthBase\n                    : lineWidthBase;\n                const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                if (points[0].some((e) => isNaN(e))) {\n                    return renderStatus;\n                }\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                const crosshairUIDs = {\n                    upper: 'upper',\n                    right: 'right',\n                    lower: 'lower',\n                    left: 'left',\n                };\n                const [x, y] = canvasCoordinates[0];\n                const centerSpace = isElementWithCursor ? 20 : 7;\n                const lineLength = isElementWithCursor ? 5 : 7;\n                drawLine(svgDrawingHelper, annotationUID, crosshairUIDs.upper, [x, y - (centerSpace / 2 + lineLength)], [x, y - centerSpace / 2], { color, lineDash, lineWidth });\n                drawLine(svgDrawingHelper, annotationUID, crosshairUIDs.lower, [x, y + (centerSpace / 2 + lineLength)], [x, y + centerSpace / 2], { color, lineDash, lineWidth });\n                drawLine(svgDrawingHelper, annotationUID, crosshairUIDs.right, [x + (centerSpace / 2 + lineLength), y], [x + centerSpace / 2, y], { color, lineDash, lineWidth });\n                drawLine(svgDrawingHelper, annotationUID, crosshairUIDs.left, [x - (centerSpace / 2 + lineLength), y], [x - centerSpace / 2, y], { color, lineDash, lineWidth });\n                renderStatus = true;\n            }\n            return renderStatus;\n        };\n        this._disableCursorEnabled = this.configuration.disableCursor;\n    }\n    onSetToolActive() {\n        this._disableCursorEnabled = this.configuration.disableCursor;\n        if (!this._disableCursorEnabled) {\n            return;\n        }\n        const viewportIds = getToolGroup(this.toolGroupId).viewportsInfo;\n        if (!viewportIds) {\n            return;\n        }\n        const enabledElements = viewportIds.map((e) => getEnabledElementByIds(e.viewportId, e.renderingEngineId));\n        enabledElements.forEach((element) => {\n            if (element) {\n                hideElementCursor(element.viewport.element);\n            }\n        });\n    }\n    onSetToolDisabled() {\n        if (!this._disableCursorEnabled) {\n            return;\n        }\n        const viewportIds = getToolGroup(this.toolGroupId).viewportsInfo;\n        if (!viewportIds) {\n            return;\n        }\n        const enabledElements = viewportIds.map((e) => getEnabledElementByIds(e.viewportId, e.renderingEngineId));\n        enabledElements.forEach((element) => {\n            if (element) {\n                resetElementCursor(element.viewport.element);\n            }\n        });\n    }\n    getActiveAnnotation(element) {\n        const annotations = getAnnotations(this.getToolName(), element);\n        if (!annotations.length) {\n            return null;\n        }\n        const targetAnnotation = annotations[0];\n        return targetAnnotation;\n    }\n    updateAnnotationPosition(element, annotation) {\n        const worldPos = this._currentCursorWorldPosition;\n        if (!worldPos) {\n            return;\n        }\n        if (!annotation.data?.handles?.points) {\n            return;\n        }\n        annotation.data.handles.points = [[...worldPos]];\n        annotation.invalidated = true;\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName(), false);\n        const enabledElement = getEnabledElement(element);\n        if (!enabledElement) {\n            return;\n        }\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n    }\n    filterInteractableAnnotationsForElement(element, annotations) {\n        if (!(annotations instanceof Array) || annotations.length === 0) {\n            return [];\n        }\n        const annotation = annotations[0];\n        const viewport = getEnabledElement(element)?.viewport;\n        if (!viewport) {\n            return [];\n        }\n        const camera = viewport.getCamera();\n        const { viewPlaneNormal, focalPoint } = camera;\n        if (!viewPlaneNormal || !focalPoint) {\n            return [];\n        }\n        const points = annotation.data?.handles?.points;\n        if (!(points instanceof Array) || points.length !== 1) {\n            return [];\n        }\n        const worldPos = points[0];\n        const plane = utilities.planar.planeEquation(viewPlaneNormal, focalPoint);\n        const distance = utilities.planar.planeDistanceToPoint(plane, worldPos);\n        return distance < this.configuration.displayThreshold ? [annotation] : [];\n    }\n    updateViewportImage(viewport) {\n        const currentMousePosition = this._currentCursorWorldPosition;\n        if (!currentMousePosition || currentMousePosition.some((e) => isNaN(e))) {\n            return;\n        }\n        if (viewport instanceof StackViewport) {\n            const closestIndex = utilities.getClosestStackImageIndexForPoint(currentMousePosition, viewport);\n            if (closestIndex === null) {\n                return;\n            }\n            if (closestIndex !== viewport.getCurrentImageIdIndex()) {\n                viewport.setImageIdIndex(closestIndex);\n            }\n        }\n        else if (viewport instanceof VolumeViewport) {\n            const { focalPoint, viewPlaneNormal } = viewport.getCamera();\n            if (!focalPoint || !viewPlaneNormal) {\n                return;\n            }\n            const plane = utilities.planar.planeEquation(viewPlaneNormal, focalPoint);\n            const currentDistance = utilities.planar.planeDistanceToPoint(plane, currentMousePosition, true);\n            if (Math.abs(currentDistance) < 0.5) {\n                return;\n            }\n            const normalizedViewPlane = vec3.normalize(vec3.create(), vec3.fromValues(...viewPlaneNormal));\n            const scaledPlaneNormal = vec3.scale(vec3.create(), normalizedViewPlane, currentDistance);\n            const newFocalPoint = vec3.add(vec3.create(), vec3.fromValues(...focalPoint), scaledPlaneNormal);\n            const isInBounds = true;\n            if (isInBounds) {\n                viewport.setCamera({ focalPoint: newFocalPoint });\n                const renderingEngine = viewport.getRenderingEngine();\n                if (renderingEngine) {\n                    renderingEngine.renderViewport(viewport.id);\n                }\n            }\n        }\n    }\n}\nReferenceCursors.toolName = 'ReferenceCursors';\nexport default ReferenceCursors;\n","import AnnotationDisplayTool from './base/AnnotationDisplayTool';\nimport { vec3 } from 'gl-matrix';\nimport { getEnabledElementByIds, getRenderingEngines, utilities as csUtils, } from '@cornerstonejs/core';\nimport { addAnnotation, getAnnotations, } from '../stateManagement/annotation/annotationState';\nimport { drawLine as drawLineSvg, drawTextBox as drawTextBoxSvg, } from '../drawingSvg';\nimport { getToolGroup } from '../store/ToolGroupManager';\nconst viewportsWithAnnotations = [];\nclass ScaleOverlayTool extends AnnotationDisplayTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        configuration: {\n            viewportId: '',\n            scaleLocation: 'bottom',\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.editData = null;\n        this._init = () => {\n            const renderingEngines = getRenderingEngines();\n            const renderingEngine = renderingEngines[0];\n            if (!renderingEngine) {\n                return;\n            }\n            const viewportIds = getToolGroup(this.toolGroupId).viewportsInfo;\n            if (!viewportIds) {\n                return;\n            }\n            const enabledElements = viewportIds.map((e) => getEnabledElementByIds(e.viewportId, e.renderingEngineId));\n            let { viewport } = enabledElements[0];\n            const { FrameOfReferenceUID } = enabledElements[0];\n            if (this.configuration.viewportId) {\n                enabledElements.forEach((element) => {\n                    if (element.viewport.id == this.configuration.viewportId) {\n                        viewport = element.viewport;\n                    }\n                });\n            }\n            if (!viewport) {\n                return;\n            }\n            const { viewUp, viewPlaneNormal } = viewport.getCamera();\n            const viewportCanvasCornersInWorld = csUtils.getViewportImageCornersInWorld(viewport);\n            let annotation = this.editData.annotation;\n            const annotations = getAnnotations(this.getToolName(), viewport.element);\n            if (annotations.length) {\n                annotation = annotations.filter((thisAnnotation) => thisAnnotation.data.viewportId == viewport.id)[0];\n            }\n            enabledElements.forEach((element) => {\n                const { viewport } = element;\n                if (!viewportsWithAnnotations.includes(viewport.id)) {\n                    const newAnnotation = {\n                        metadata: {\n                            toolName: this.getToolName(),\n                            viewPlaneNormal: [...viewPlaneNormal],\n                            viewUp: [...viewUp],\n                            FrameOfReferenceUID,\n                            referencedImageId: null,\n                        },\n                        data: {\n                            handles: {\n                                points: csUtils.getViewportImageCornersInWorld(viewport),\n                            },\n                            viewportId: viewport.id,\n                        },\n                    };\n                    viewportsWithAnnotations.push(viewport.id);\n                    addAnnotation(newAnnotation, viewport.element);\n                    annotation = newAnnotation;\n                }\n            });\n            if (this.editData.annotation &&\n                this.editData.annotation.data.viewportId == viewport.id) {\n                this.editData.annotation.data.handles.points =\n                    viewportCanvasCornersInWorld;\n                this.editData.annotation.data.viewportId = viewport.id;\n            }\n            this.editData = {\n                viewport,\n                renderingEngine,\n                annotation,\n            };\n        };\n        this.onSetToolEnabled = () => {\n            this._init();\n        };\n        this.onCameraModified = (evt) => {\n            this.configuration.viewportId = evt.detail.viewportId;\n            this._init();\n        };\n        this.computeScaleSize = (worldWidthViewport, worldHeightViewport, location) => {\n            const scaleSizes = [\n                16000, 8000, 4000, 2000, 1000, 500, 250, 100, 50, 25, 10, 5, 2,\n            ];\n            let currentScaleSize;\n            if (location == 'top' || location == 'bottom') {\n                currentScaleSize = scaleSizes.filter((scaleSize) => scaleSize < worldWidthViewport * 0.6 &&\n                    scaleSize > worldWidthViewport * 0.2);\n            }\n            else {\n                currentScaleSize = scaleSizes.filter((scaleSize) => scaleSize < worldHeightViewport * 0.6 &&\n                    scaleSize > worldHeightViewport * 0.2);\n            }\n            return currentScaleSize[0];\n        };\n        this.computeEndScaleTicks = (canvasCoordinates, location) => {\n            const locationTickOffset = {\n                bottom: [\n                    [0, -10],\n                    [0, -10],\n                ],\n                top: [\n                    [0, 10],\n                    [0, 10],\n                ],\n                left: [\n                    [0, 0],\n                    [10, 0],\n                ],\n                right: [\n                    [0, 0],\n                    [-10, 0],\n                ],\n            };\n            const endTick1 = [\n                [\n                    canvasCoordinates[1][0] + locationTickOffset[location][0][0],\n                    canvasCoordinates[1][1] + locationTickOffset[location][0][0],\n                ],\n                [\n                    canvasCoordinates[1][0] + locationTickOffset[location][1][0],\n                    canvasCoordinates[1][1] + locationTickOffset[location][1][1],\n                ],\n            ];\n            const endTick2 = [\n                [\n                    canvasCoordinates[0][0] + locationTickOffset[location][0][0],\n                    canvasCoordinates[0][1] + locationTickOffset[location][0][0],\n                ],\n                [\n                    canvasCoordinates[0][0] + locationTickOffset[location][1][0],\n                    canvasCoordinates[0][1] + locationTickOffset[location][1][1],\n                ],\n            ];\n            return {\n                endTick1: endTick1,\n                endTick2: endTick2,\n            };\n        };\n        this.computeInnerScaleTicks = (scaleSize, location, annotationUID, leftTick, rightTick) => {\n            let canvasScaleSize;\n            if (location == 'bottom' || location == 'top') {\n                canvasScaleSize = rightTick[0][0] - leftTick[0][0];\n            }\n            else if (location == 'left' || location == 'right') {\n                canvasScaleSize = rightTick[0][1] - leftTick[0][1];\n            }\n            const tickIds = [];\n            const tickUIDs = [];\n            const tickCoordinates = [];\n            let numberSmallTicks = scaleSize;\n            if (scaleSize >= 50) {\n                numberSmallTicks = scaleSize / 10;\n            }\n            const tickSpacing = canvasScaleSize / numberSmallTicks;\n            for (let i = 0; i < numberSmallTicks - 1; i++) {\n                const locationOffset = {\n                    bottom: [\n                        [tickSpacing * (i + 1), 0],\n                        [tickSpacing * (i + 1), 5],\n                    ],\n                    top: [\n                        [tickSpacing * (i + 1), 0],\n                        [tickSpacing * (i + 1), -5],\n                    ],\n                    left: [\n                        [0, tickSpacing * (i + 1)],\n                        [-5, tickSpacing * (i + 1)],\n                    ],\n                    right: [\n                        [0, tickSpacing * (i + 1)],\n                        [5, tickSpacing * (i + 1)],\n                    ],\n                };\n                tickIds.push(`${annotationUID}-tick${i}`);\n                tickUIDs.push(`tick${i}`);\n                if ((i + 1) % 5 == 0) {\n                    tickCoordinates.push([\n                        [\n                            leftTick[0][0] + locationOffset[location][0][0],\n                            leftTick[0][1] + locationOffset[location][0][1],\n                        ],\n                        [\n                            leftTick[1][0] + locationOffset[location][0][0],\n                            leftTick[1][1] + locationOffset[location][0][1],\n                        ],\n                    ]);\n                }\n                else {\n                    tickCoordinates.push([\n                        [\n                            leftTick[0][0] + locationOffset[location][0][0],\n                            leftTick[0][1] + locationOffset[location][0][1],\n                        ],\n                        [\n                            leftTick[1][0] + locationOffset[location][1][0],\n                            leftTick[1][1] + locationOffset[location][1][1],\n                        ],\n                    ]);\n                }\n            }\n            return { tickIds, tickUIDs, tickCoordinates };\n        };\n        this.computeWorldScaleCoordinates = (scaleSize, location, pointSet) => {\n            let worldCoordinates;\n            let topBottomVec = vec3.subtract(vec3.create(), pointSet[0], pointSet[1]);\n            topBottomVec = vec3.normalize(vec3.create(), topBottomVec);\n            let topRightVec = vec3.subtract(vec3.create(), pointSet[2], pointSet[0]);\n            topRightVec = vec3.normalize(vec3.create(), topRightVec);\n            const midpointLocation = {\n                bottom: [pointSet[1], pointSet[2]],\n                top: [pointSet[0], pointSet[3]],\n                right: [pointSet[2], pointSet[3]],\n                left: [pointSet[0], pointSet[1]],\n            };\n            const midpoint = vec3\n                .add(vec3.create(), midpointLocation[location][0], midpointLocation[location][0])\n                .map((i) => i / 2);\n            const offset = scaleSize /\n                2 /\n                Math.sqrt(Math.pow(topBottomVec[0], 2) +\n                    Math.pow(topBottomVec[1], 2) +\n                    Math.pow(topBottomVec[2], 2));\n            if (location == 'top' || location == 'bottom') {\n                worldCoordinates = [\n                    vec3.subtract(vec3.create(), midpoint, topRightVec.map((i) => i * offset)),\n                    vec3.add(vec3.create(), midpoint, topRightVec.map((i) => i * offset)),\n                ];\n            }\n            else if (location == 'left' || location == 'right') {\n                worldCoordinates = [\n                    vec3.add(vec3.create(), midpoint, topBottomVec.map((i) => i * offset)),\n                    vec3.subtract(vec3.create(), midpoint, topBottomVec.map((i) => i * offset)),\n                ];\n            }\n            return worldCoordinates;\n        };\n        this.computeCanvasScaleCoordinates = (canvasSize, canvasCoordinates, vscaleBounds, hscaleBounds, location) => {\n            let scaleCanvasCoordinates;\n            if (location == 'top' || location == 'bottom') {\n                const worldDistanceOnCanvas = canvasCoordinates[0][0] - canvasCoordinates[1][0];\n                scaleCanvasCoordinates = [\n                    [canvasSize.width / 2 - worldDistanceOnCanvas / 2, vscaleBounds.height],\n                    [canvasSize.width / 2 + worldDistanceOnCanvas / 2, vscaleBounds.height],\n                ];\n            }\n            else if (location == 'left' || location == 'right') {\n                const worldDistanceOnCanvas = canvasCoordinates[0][1] - canvasCoordinates[1][1];\n                scaleCanvasCoordinates = [\n                    [hscaleBounds.width, canvasSize.height / 2 - worldDistanceOnCanvas / 2],\n                    [hscaleBounds.width, canvasSize.height / 2 + worldDistanceOnCanvas / 2],\n                ];\n            }\n            return scaleCanvasCoordinates;\n        };\n        this.computeScaleBounds = (canvasSize, horizontalReduction, verticalReduction, location) => {\n            const hReduction = horizontalReduction * Math.min(1000, canvasSize.width);\n            const vReduction = verticalReduction * Math.min(1000, canvasSize.height);\n            const locationBounds = {\n                bottom: [-vReduction, -hReduction],\n                top: [vReduction, hReduction],\n                left: [vReduction, hReduction],\n                right: [-vReduction, -hReduction],\n            };\n            const canvasBounds = {\n                bottom: [canvasSize.height, canvasSize.width],\n                top: [0, canvasSize.width],\n                left: [canvasSize.height, 0],\n                right: [canvasSize.height, canvasSize.width],\n            };\n            return {\n                height: canvasBounds[location][0] + locationBounds[location][0],\n                width: canvasBounds[location][1] + locationBounds[location][1],\n            };\n        };\n    }\n    renderAnnotation(enabledElement, svgDrawingHelper) {\n        if (!this.editData.viewport) {\n            return;\n        }\n        const location = this.configuration.scaleLocation;\n        const { viewport } = enabledElement;\n        const annotations = getAnnotations(this.getToolName(), viewport.element);\n        const annotation = annotations.filter((thisAnnotation) => thisAnnotation.data.viewportId == viewport.id)[0];\n        const canvas = enabledElement.viewport.canvas;\n        const renderStatus = false;\n        if (!viewport) {\n            return renderStatus;\n        }\n        const styleSpecifier = {\n            toolGroupId: this.toolGroupId,\n            toolName: this.getToolName(),\n            viewportId: enabledElement.viewport.id,\n        };\n        const canvasSize = {\n            width: canvas.width / window.devicePixelRatio || 1,\n            height: canvas.height / window.devicePixelRatio || 1,\n        };\n        const topLeft = annotation.data.handles.points[0];\n        const topRight = annotation.data.handles.points[1];\n        const bottomLeft = annotation.data.handles.points[2];\n        const bottomRight = annotation.data.handles.points[3];\n        const pointSet1 = [topLeft, bottomLeft, topRight, bottomRight];\n        const worldWidthViewport = vec3.distance(bottomLeft, bottomRight);\n        const worldHeightViewport = vec3.distance(topLeft, bottomLeft);\n        const hscaleBounds = this.computeScaleBounds(canvasSize, 0.05, 0.05, location);\n        const vscaleBounds = this.computeScaleBounds(canvasSize, 0.05, 0.05, location);\n        const scaleSize = this.computeScaleSize(worldWidthViewport, worldHeightViewport, location);\n        const canvasCoordinates = this.computeWorldScaleCoordinates(scaleSize, location, pointSet1).map((world) => viewport.worldToCanvas(world));\n        const scaleCanvasCoordinates = this.computeCanvasScaleCoordinates(canvasSize, canvasCoordinates, vscaleBounds, hscaleBounds, location);\n        const scaleTicks = this.computeEndScaleTicks(scaleCanvasCoordinates, location);\n        const { annotationUID } = annotation;\n        styleSpecifier.annotationUID = annotationUID;\n        const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n        const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n        const color = this.getStyle('color', styleSpecifier, annotation);\n        const shadow = this.getStyle('shadow', styleSpecifier, annotation);\n        const scaleId = `${annotationUID}-scaleline`;\n        const scaleLineUID = '1';\n        drawLineSvg(svgDrawingHelper, annotationUID, scaleLineUID, scaleCanvasCoordinates[0], scaleCanvasCoordinates[1], {\n            color,\n            width: lineWidth,\n            lineDash,\n            shadow,\n        }, scaleId);\n        const leftTickId = `${annotationUID}-left`;\n        const leftTickUID = '2';\n        drawLineSvg(svgDrawingHelper, annotationUID, leftTickUID, scaleTicks.endTick1[0], scaleTicks.endTick1[1], {\n            color,\n            width: lineWidth,\n            lineDash,\n            shadow,\n        }, leftTickId);\n        const rightTickId = `${annotationUID}-right`;\n        const rightTickUID = '3';\n        drawLineSvg(svgDrawingHelper, annotationUID, rightTickUID, scaleTicks.endTick2[0], scaleTicks.endTick2[1], {\n            color,\n            width: lineWidth,\n            lineDash,\n            shadow,\n        }, rightTickId);\n        const locationTextOffest = {\n            bottom: [-10, -42],\n            top: [-12, -35],\n            left: [-40, -20],\n            right: [-50, -20],\n        };\n        const textCanvasCoordinates = [\n            scaleCanvasCoordinates[0][0] + locationTextOffest[location][0],\n            scaleCanvasCoordinates[0][1] + locationTextOffest[location][1],\n        ];\n        const textBoxLines = this._getTextLines(scaleSize);\n        const { tickIds, tickUIDs, tickCoordinates } = this.computeInnerScaleTicks(scaleSize, location, annotationUID, scaleTicks.endTick1, scaleTicks.endTick2);\n        for (let i = 0; i < tickUIDs.length; i++) {\n            drawLineSvg(svgDrawingHelper, annotationUID, tickUIDs[i], tickCoordinates[i][0], tickCoordinates[i][1], {\n                color,\n                width: lineWidth,\n                lineDash,\n                shadow,\n            }, tickIds[i]);\n        }\n        const textUID = 'text0';\n        drawTextBoxSvg(svgDrawingHelper, annotationUID, textUID, textBoxLines, [textCanvasCoordinates[0], textCanvasCoordinates[1]], {\n            fontFamily: 'Helvetica Neue, Helvetica, Arial, sans-serif',\n            fontSize: '14px',\n            lineDash: '2,3',\n            lineWidth: '1',\n            shadow: true,\n            color: color,\n        });\n        return renderStatus;\n    }\n    _getTextLines(scaleSize) {\n        let scaleSizeDisplayValue;\n        let scaleSizeUnits;\n        if (scaleSize >= 50) {\n            scaleSizeDisplayValue = scaleSize / 10;\n            scaleSizeUnits = ' cm';\n        }\n        else {\n            scaleSizeDisplayValue = scaleSize;\n            scaleSizeUnits = ' mm';\n        }\n        const textLines = [scaleSizeDisplayValue.toString().concat(scaleSizeUnits)];\n        return textLines;\n    }\n}\nScaleOverlayTool.toolName = 'ScaleOverlay';\nexport default ScaleOverlayTool;\n","import { getEnabledElement } from '@cornerstonejs/core';\nimport { BaseTool } from './base';\nimport { getAnnotations } from '../stateManagement';\nimport { point } from '../utilities/math';\nimport { Events, ToolModes, AnnotationStyleStates } from '../enums';\nimport { triggerAnnotationRenderForViewportIds } from '../utilities/triggerAnnotationRenderForViewportIds';\nimport { hideElementCursor, resetElementCursor, } from '../cursors/elementCursor';\nimport { getStyleProperty } from '../stateManagement/annotation/config/helpers';\nimport { triggerAnnotationModified } from '../stateManagement/annotation/helpers/state';\nimport CircleSculptCursor from './SculptorTool/CircleSculptCursor';\nimport { distancePointToContour } from './distancePointToContour';\nimport { getToolGroupForViewport } from '../store/ToolGroupManager';\nclass SculptorTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            minSpacing: 1,\n            referencedToolNames: [\n                'PlanarFreehandROI',\n                'PlanarFreehandContourSegmentationTool',\n            ],\n            toolShape: 'circle',\n            referencedToolName: 'PlanarFreehandROI',\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.registeredShapes = new Map();\n        this.isActive = false;\n        this.commonData = {\n            activeAnnotationUID: null,\n            viewportIdsToRender: [],\n            isEditingOpenContour: false,\n            canvasLocation: undefined,\n        };\n        this.preMouseDownCallback = (evt) => {\n            const eventData = evt.detail;\n            const element = eventData.element;\n            this.configureToolSize(evt);\n            this.selectFreehandTool(eventData);\n            if (this.commonData.activeAnnotationUID === null) {\n                return;\n            }\n            this.isActive = true;\n            hideElementCursor(element);\n            this.activateModify(element);\n            return true;\n        };\n        this.mouseMoveCallback = (evt) => {\n            if (this.mode === ToolModes.Active) {\n                this.configureToolSize(evt);\n                this.updateCursor(evt);\n            }\n            else {\n                this.commonData.canvasLocation = undefined;\n            }\n        };\n        this.endCallback = (evt) => {\n            const eventData = evt.detail;\n            const { element } = eventData;\n            const config = this.configuration;\n            const enabledElement = getEnabledElement(element);\n            this.isActive = false;\n            this.deactivateModify(element);\n            resetElementCursor(element);\n            const { renderingEngineId, viewportId } = enabledElement;\n            const toolGroup = getToolGroupForViewport(viewportId, renderingEngineId);\n            const toolInstance = toolGroup.getToolInstance(config.referencedToolName);\n            const annotations = this.filterSculptableAnnotationsForElement(element);\n            const activeAnnotation = annotations.find((annotation) => annotation.annotationUID === this.commonData.activeAnnotationUID);\n            if (toolInstance.configuration.calculateStats) {\n                activeAnnotation.invalidated = true;\n            }\n            triggerAnnotationModified(activeAnnotation, element);\n        };\n        this.dragCallback = (evt) => {\n            const eventData = evt.detail;\n            const element = eventData.element;\n            this.updateCursor(evt);\n            const annotations = this.filterSculptableAnnotationsForElement(element);\n            const activeAnnotation = annotations.find((annotation) => annotation.annotationUID === this.commonData.activeAnnotationUID);\n            if (!annotations?.length || !this.isActive) {\n                return;\n            }\n            const points = activeAnnotation.data.contour.polyline;\n            this.sculpt(eventData, points);\n        };\n        this.registerShapes(CircleSculptCursor.shapeName, CircleSculptCursor);\n        this.setToolShape(this.configuration.toolShape);\n    }\n    registerShapes(shapeName, shapeClass) {\n        const shape = new shapeClass();\n        this.registeredShapes.set(shapeName, shape);\n    }\n    sculpt(eventData, points) {\n        const config = this.configuration;\n        const element = eventData.element;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const cursorShape = this.registeredShapes.get(this.selectedShape);\n        this.sculptData = {\n            mousePoint: eventData.currentPoints.world,\n            mouseCanvasPoint: eventData.currentPoints.canvas,\n            points,\n            maxSpacing: cursorShape.getMaxSpacing(config.minSpacing),\n            element: element,\n        };\n        const pushedHandles = cursorShape.pushHandles(viewport, this.sculptData);\n        if (pushedHandles.first !== undefined) {\n            this.insertNewHandles(pushedHandles);\n        }\n    }\n    interpolatePointsWithinMaxSpacing(i, points, indicesToInsertAfter, maxSpacing) {\n        const { element } = this.sculptData;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const nextHandleIndex = contourIndex(i + 1, points.length);\n        const currentCanvasPoint = viewport.worldToCanvas(points[i]);\n        const nextCanvasPoint = viewport.worldToCanvas(points[nextHandleIndex]);\n        const distanceToNextHandle = point.distanceToPoint(currentCanvasPoint, nextCanvasPoint);\n        if (distanceToNextHandle > maxSpacing) {\n            indicesToInsertAfter.push(i);\n        }\n    }\n    updateCursor(evt) {\n        const eventData = evt.detail;\n        const element = eventData.element;\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine, viewport } = enabledElement;\n        this.commonData.viewportIdsToRender = [viewport.id];\n        const annotations = this.filterSculptableAnnotationsForElement(element);\n        if (!annotations?.length) {\n            return;\n        }\n        const activeAnnotation = annotations.find((annotation) => annotation.annotationUID === this.commonData.activeAnnotationUID);\n        this.commonData.canvasLocation = eventData.currentPoints.canvas;\n        if (this.isActive) {\n            activeAnnotation.highlighted = true;\n        }\n        else {\n            const cursorShape = this.registeredShapes.get(this.selectedShape);\n            const canvasCoords = eventData.currentPoints.canvas;\n            cursorShape.updateToolSize(canvasCoords, viewport, activeAnnotation);\n        }\n        triggerAnnotationRenderForViewportIds(this.commonData.viewportIdsToRender);\n    }\n    filterSculptableAnnotationsForElement(element) {\n        const config = this.configuration;\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngineId, viewportId } = enabledElement;\n        const sculptableAnnotations = [];\n        const toolGroup = getToolGroupForViewport(viewportId, renderingEngineId);\n        const toolInstance = toolGroup.getToolInstance(config.referencedToolName);\n        config.referencedToolNames.forEach((referencedToolName) => {\n            const annotations = getAnnotations(referencedToolName, element);\n            if (annotations) {\n                sculptableAnnotations.push(...annotations);\n            }\n        });\n        return toolInstance.filterInteractableAnnotationsForElement(element, sculptableAnnotations);\n    }\n    configureToolSize(evt) {\n        const cursorShape = this.registeredShapes.get(this.selectedShape);\n        cursorShape.configureToolSize(evt);\n    }\n    insertNewHandles(pushedHandles) {\n        const indicesToInsertAfter = this.findNewHandleIndices(pushedHandles);\n        let newIndexModifier = 0;\n        for (let i = 0; i < indicesToInsertAfter?.length; i++) {\n            const insertIndex = indicesToInsertAfter[i] + 1 + newIndexModifier;\n            this.insertHandleRadially(insertIndex);\n            newIndexModifier++;\n        }\n    }\n    findNewHandleIndices(pushedHandles) {\n        const { points, maxSpacing } = this.sculptData;\n        const indicesToInsertAfter = [];\n        for (let i = pushedHandles.first; i <= pushedHandles.last; i++) {\n            this.interpolatePointsWithinMaxSpacing(i, points, indicesToInsertAfter, maxSpacing);\n        }\n        return indicesToInsertAfter;\n    }\n    insertHandleRadially(insertIndex) {\n        const { points } = this.sculptData;\n        if (insertIndex > points.length - 1 &&\n            this.commonData.isEditingOpenContour) {\n            return;\n        }\n        const cursorShape = this.registeredShapes.get(this.selectedShape);\n        const previousIndex = insertIndex - 1;\n        const nextIndex = contourIndex(insertIndex, points.length);\n        const insertPosition = cursorShape.getInsertPosition(previousIndex, nextIndex, this.sculptData);\n        const handleData = insertPosition;\n        points.splice(insertIndex, 0, handleData);\n    }\n    selectFreehandTool(eventData) {\n        const closestAnnotationUID = this.getClosestFreehandToolOnElement(eventData);\n        if (closestAnnotationUID === undefined) {\n            return;\n        }\n        this.commonData.activeAnnotationUID = closestAnnotationUID;\n    }\n    getClosestFreehandToolOnElement(eventData) {\n        const { element } = eventData;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const config = this.configuration;\n        const annotations = this.filterSculptableAnnotationsForElement(element);\n        if (!annotations?.length) {\n            return;\n        }\n        const canvasPoints = eventData.currentPoints.canvas;\n        const closest = {\n            distance: Infinity,\n            toolIndex: undefined,\n            annotationUID: undefined,\n        };\n        for (let i = 0; i < annotations?.length; i++) {\n            if (annotations[i].isLocked || !annotations[i].isVisible) {\n                continue;\n            }\n            const distanceFromTool = distancePointToContour(viewport, annotations[i], canvasPoints);\n            if (distanceFromTool === -1) {\n                continue;\n            }\n            if (distanceFromTool < closest.distance) {\n                closest.distance = distanceFromTool;\n                closest.toolIndex = i;\n                closest.annotationUID = annotations[i].annotationUID;\n            }\n        }\n        this.commonData.isEditingOpenContour =\n            !annotations[closest.toolIndex].data.contour.closed;\n        config.referencedToolName =\n            annotations[closest.toolIndex].metadata.toolName;\n        return closest.annotationUID;\n    }\n    activateModify(element) {\n        element.addEventListener(Events.MOUSE_UP, this.endCallback);\n        element.addEventListener(Events.MOUSE_CLICK, this.endCallback);\n        element.addEventListener(Events.MOUSE_DRAG, this.dragCallback);\n        element.addEventListener(Events.TOUCH_TAP, this.endCallback);\n        element.addEventListener(Events.TOUCH_END, this.endCallback);\n        element.addEventListener(Events.TOUCH_DRAG, this.dragCallback);\n    }\n    deactivateModify(element) {\n        element.removeEventListener(Events.MOUSE_UP, this.endCallback);\n        element.removeEventListener(Events.MOUSE_CLICK, this.endCallback);\n        element.removeEventListener(Events.MOUSE_DRAG, this.dragCallback);\n        element.removeEventListener(Events.TOUCH_TAP, this.endCallback);\n        element.removeEventListener(Events.TOUCH_END, this.endCallback);\n        element.removeEventListener(Events.TOUCH_DRAG, this.dragCallback);\n    }\n    setToolShape(toolShape) {\n        this.selectedShape =\n            this.registeredShapes.get(toolShape) ?? CircleSculptCursor.shapeName;\n    }\n    renderAnnotation(enabledElement, svgDrawingHelper) {\n        const { viewport } = enabledElement;\n        const { element } = viewport;\n        const viewportIdsToRender = this.commonData.viewportIdsToRender;\n        if (!this.commonData.canvasLocation ||\n            this.mode !== ToolModes.Active ||\n            !viewportIdsToRender.includes(viewport.id)) {\n            return;\n        }\n        const annotations = this.filterSculptableAnnotationsForElement(element);\n        if (!annotations?.length) {\n            return;\n        }\n        const styleSpecifier = {\n            toolGroupId: this.toolGroupId,\n            toolName: this.getToolName(),\n            viewportId: enabledElement.viewport.id,\n        };\n        let color = getStyleProperty('color', styleSpecifier, AnnotationStyleStates.Default, this.mode);\n        if (this.isActive) {\n            color = getStyleProperty('color', styleSpecifier, AnnotationStyleStates.Highlighted, this.mode);\n        }\n        const cursorShape = this.registeredShapes.get(this.selectedShape);\n        cursorShape.renderShape(svgDrawingHelper, this.commonData.canvasLocation, {\n            color,\n        });\n    }\n}\nexport const contourIndex = (i, length) => {\n    return (i + length) % length;\n};\nSculptorTool.toolName = 'SculptorTool';\nexport default SculptorTool;\n","import { BaseTool } from './base';\nimport { getEnabledElement } from '@cornerstonejs/core';\nimport { mat4, vec3 } from 'gl-matrix';\nconst DIRECTIONS = {\n    X: [1, 0, 0],\n    Y: [0, 1, 0],\n    Z: [0, 0, 1],\n    CUSTOM: [],\n};\nclass VolumeRotateTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            direction: DIRECTIONS.Z,\n            rotateIncrementDegrees: 30,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n    }\n    mouseWheelCallback(evt) {\n        const { element, wheel } = evt.detail;\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const { direction, rotateIncrementDegrees } = this.configuration;\n        const camera = viewport.getCamera();\n        const { viewUp, position, focalPoint } = camera;\n        const { direction: deltaY } = wheel;\n        const [cx, cy, cz] = focalPoint;\n        const [ax, ay, az] = direction;\n        const angle = (deltaY * (rotateIncrementDegrees * Math.PI)) / 180;\n        const newPosition = [0, 0, 0];\n        const newFocalPoint = [0, 0, 0];\n        const newViewUp = [0, 0, 0];\n        const transform = mat4.identity(new Float32Array(16));\n        mat4.translate(transform, transform, [cx, cy, cz]);\n        mat4.rotate(transform, transform, angle, [ax, ay, az]);\n        mat4.translate(transform, transform, [-cx, -cy, -cz]);\n        vec3.transformMat4(newPosition, position, transform);\n        vec3.transformMat4(newFocalPoint, focalPoint, transform);\n        mat4.identity(transform);\n        mat4.rotate(transform, transform, angle, [ax, ay, az]);\n        vec3.transformMat4(newViewUp, viewUp, transform);\n        viewport.setCamera({\n            position: newPosition,\n            viewUp: newViewUp,\n            focalPoint: newFocalPoint,\n        });\n        viewport.render();\n    }\n}\nVolumeRotateTool.toolName = 'VolumeRotateMouseWheel';\nexport default VolumeRotateTool;\n","import { Events } from '../../enums';\nimport { getEnabledElement, utilities as csUtils } from '@cornerstonejs/core';\nimport { getCalibratedLengthUnitsAndScale } from '../../utilities/getCalibratedUnits';\nimport { AnnotationTool } from '../base';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport * as lineSegment from '../../utilities/math/line';\nimport { drawHandles as drawHandlesSvg, drawLine as drawLineSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nconst { transformWorldToIndex } = csUtils;\nclass LengthTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            hideElementCursor(element);\n            this.isDrawing = true;\n            const { viewPlaneNormal, viewUp, position: cameraPosition, } = viewport.getCamera();\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                    toolName: this.getToolName(),\n                    referencedImageId,\n                    viewUp,\n                    cameraPosition,\n                },\n                data: {\n                    handles: {\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                    },\n                    label: '',\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 1,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const [point1, point2] = data.handles.points;\n            const canvasPoint1 = viewport.worldToCanvas(point1);\n            const canvasPoint2 = viewport.worldToCanvas(point2);\n            const line = {\n                start: {\n                    x: canvasPoint1[0],\n                    y: canvasPoint1[1],\n                },\n                end: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n            };\n            const distanceToPoint = lineSegment.distanceToPoint([line.start.x, line.start.y], [line.end.x, line.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                data.handles.points[handleIndex] = [...worldPos];\n                annotation.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points, activeHandleIndex } = data.handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash, shadow } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].unit == null) {\n                    data.cachedStats[targetId] = {\n                        length: null,\n                        unit: null,\n                    };\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates, {\n                        color,\n                        lineDash,\n                        lineWidth,\n                    });\n                }\n                const dataId = `${annotationUID}-line`;\n                const lineUID = '1';\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], canvasCoordinates[1], {\n                    color,\n                    width: lineWidth,\n                    lineDash,\n                    shadow,\n                }, dataId);\n                renderStatus = true;\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!data.handles.textBox.hasMoved) {\n                    const canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    handleSelectedCallback(evt, annotation, handle) {\n        const eventDetail = evt.detail;\n        const { element } = eventDetail;\n        const { data } = annotation;\n        annotation.highlighted = true;\n        let movingTextBox = false;\n        let handleIndex;\n        if (handle.worldPosition) {\n            movingTextBox = true;\n        }\n        else {\n            handleIndex = data.handles.points.findIndex((p) => p === handle);\n        }\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            handleIndex,\n            movingTextBox,\n        };\n        this._activateModify(element);\n        hideElementCursor(element);\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        evt.preventDefault();\n    }\n    _calculateLength(pos1, pos2) {\n        const dx = pos1[0] - pos2[0];\n        const dy = pos1[1] - pos2[1];\n        const dz = pos1[2] - pos2[2];\n        return Math.sqrt(dx * dx + dy * dy + dz * dz);\n    }\n    _calculateCachedStats(annotation, renderingEngine, enabledElement) {\n        const data = annotation.data;\n        const { element } = enabledElement.viewport;\n        const worldPos1 = data.handles.points[0];\n        const worldPos2 = data.handles.points[1];\n        const { cachedStats } = data;\n        const targetIds = Object.keys(cachedStats);\n        for (let i = 0; i < targetIds.length; i++) {\n            const targetId = targetIds[i];\n            const image = this.getTargetImageData(targetId);\n            if (!image) {\n                continue;\n            }\n            const { imageData, dimensions } = image;\n            const index1 = transformWorldToIndex(imageData, worldPos1);\n            const index2 = transformWorldToIndex(imageData, worldPos2);\n            const handles = [index1, index2];\n            const { scale, unit } = getCalibratedLengthUnitsAndScale(image, handles);\n            const length = this._calculateLength(worldPos1, worldPos2) / scale;\n            this._isInsideVolume(index1, index2, dimensions)\n                ? (this.isHandleOutsideImage = false)\n                : (this.isHandleOutsideImage = true);\n            cachedStats[targetId] = {\n                length,\n                unit,\n            };\n        }\n        annotation.invalidated = false;\n        triggerAnnotationModified(annotation, element);\n        return cachedStats;\n    }\n    _isInsideVolume(index1, index2, dimensions) {\n        return (csUtils.indexWithinDimensions(index1, dimensions) &&\n            csUtils.indexWithinDimensions(index2, dimensions));\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { length, unit } = cachedVolumeStats;\n    if (length === undefined || length === null || isNaN(length)) {\n        return;\n    }\n    const textLines = [`${csUtils.roundNumber(length)} ${unit}`];\n    return textLines;\n}\nLengthTool.toolName = 'Length';\nexport default LengthTool;\n","import { Events } from '../../enums';\nimport { getEnabledElement, utilities as csUtils } from '@cornerstonejs/core';\nimport { getCalibratedLengthUnitsAndScale } from '../../utilities/getCalibratedUnits';\nimport { AnnotationTool } from '../base';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport * as lineSegment from '../../utilities/math/line';\nimport { drawHandles as drawHandlesSvg, drawHeight as drawHeightSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nconst { transformWorldToIndex } = csUtils;\nclass HeightTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            hideElementCursor(element);\n            this.isDrawing = true;\n            const { viewPlaneNormal, viewUp, position: cameraPosition, } = viewport.getCamera();\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                    toolName: this.getToolName(),\n                    referencedImageId,\n                    viewUp,\n                    cameraPosition,\n                },\n                data: {\n                    handles: {\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                    },\n                    label: '',\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 1,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const [point1, point2] = data.handles.points;\n            const canvasPoint1 = viewport.worldToCanvas(point1);\n            const canvasPoint2 = viewport.worldToCanvas(point2);\n            const line = {\n                start: {\n                    x: canvasPoint1[0],\n                    y: canvasPoint1[1],\n                },\n                end: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n            };\n            const distanceToPoint = lineSegment.distanceToPoint([line.start.x, line.start.y], [line.end.x, line.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                data.handles.points[handleIndex] = [...worldPos];\n                annotation.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                const enabledElement = getEnabledElement(element);\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points, activeHandleIndex } = data.handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash, shadow } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                let activeHandleCanvasCoords;\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].unit == null) {\n                    data.cachedStats[targetId] = {\n                        length: null,\n                        unit: null,\n                    };\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates, {\n                        color,\n                        lineDash,\n                        lineWidth,\n                    });\n                }\n                const heightUID = '0';\n                drawHeightSvg(svgDrawingHelper, annotationUID, heightUID, canvasCoordinates[0], canvasCoordinates[1], {\n                    color,\n                    width: lineWidth,\n                    lineDash: lineDash,\n                });\n                renderStatus = true;\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!data.handles.textBox.hasMoved) {\n                    const canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    handleSelectedCallback(evt, annotation, handle) {\n        const eventDetail = evt.detail;\n        const { element } = eventDetail;\n        const { data } = annotation;\n        annotation.highlighted = true;\n        let movingTextBox = false;\n        let handleIndex;\n        if (handle.worldPosition) {\n            movingTextBox = true;\n        }\n        else {\n            handleIndex = data.handles.points.findIndex((p) => p === handle);\n        }\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            handleIndex,\n            movingTextBox,\n        };\n        this._activateModify(element);\n        hideElementCursor(element);\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        evt.preventDefault();\n    }\n    _calculateHeight(pos1, pos2) {\n        const dx = pos2[0] - pos1[0];\n        const dy = pos2[1] - pos1[1];\n        const dz = pos2[2] - pos1[2];\n        if (dx == 0) {\n            if (dy != 0) {\n                return Math.abs(dz);\n            }\n            else {\n                return 0;\n            }\n        }\n        else if (dy == 0) {\n            return Math.abs(dz);\n        }\n        else if (dz == 0) {\n            return Math.abs(dy);\n        }\n    }\n    _calculateCachedStats(annotation, renderingEngine, enabledElement) {\n        const data = annotation.data;\n        const { element } = enabledElement.viewport;\n        const worldPos1 = data.handles.points[0];\n        const worldPos2 = data.handles.points[1];\n        const { cachedStats } = data;\n        const targetIds = Object.keys(cachedStats);\n        for (let i = 0; i < targetIds.length; i++) {\n            const targetId = targetIds[i];\n            const image = this.getTargetImageData(targetId);\n            if (!image) {\n                continue;\n            }\n            const { imageData, dimensions } = image;\n            const index1 = transformWorldToIndex(imageData, worldPos1);\n            const index2 = transformWorldToIndex(imageData, worldPos2);\n            const handles = [index1, index2];\n            const { scale, unit } = getCalibratedLengthUnitsAndScale(image, handles);\n            const height = this._calculateHeight(worldPos1, worldPos2) / scale;\n            const outside = this._isInsideVolume(index1, index2, dimensions);\n            this.isHandleOutsideImage = outside;\n            cachedStats[targetId] = {\n                height,\n                unit,\n            };\n        }\n        annotation.invalidated = false;\n        triggerAnnotationModified(annotation, element);\n        return cachedStats;\n    }\n    _isInsideVolume(index1, index2, dimensions) {\n        return (csUtils.indexWithinDimensions(index1, dimensions) &&\n            csUtils.indexWithinDimensions(index2, dimensions));\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { height, unit } = cachedVolumeStats;\n    if (height === undefined || height === null || isNaN(height)) {\n        return;\n    }\n    const textLines = [`${csUtils.roundNumber(height)} ${unit}`];\n    return textLines;\n}\nHeightTool.toolName = 'Height';\nexport default HeightTool;\n","import { vec2, vec3 } from 'gl-matrix';\nimport { getEnabledElement, VolumeViewport, utilities as csUtils, } from '@cornerstonejs/core';\nimport { AnnotationTool } from '../base';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { getCalibratedProbeUnitsAndValue } from '../../utilities/getCalibratedUnits';\nimport { drawHandles as drawHandlesSvg, drawTextBox as drawTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { Events } from '../../enums';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { getPixelValueUnits } from '../../utilities/getPixelValueUnits';\nimport { isViewportPreScaled } from '../../utilities/viewport/isViewportPreScaled';\nconst { transformWorldToIndex } = csUtils;\nclass ProbeTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                invalidated: true,\n                highlighted: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                },\n                data: {\n                    label: '',\n                    handles: { points: [[...worldPos]] },\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                newAnnotation: true,\n                viewportIdsToRender,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n            const { viewportId, renderingEngine } = getEnabledElement(element);\n            this.eventDispatchDetail = {\n                viewportId,\n                renderingEngineId: renderingEngine.id,\n            };\n            this._deactivateModify(element);\n            resetElementCursor(element);\n            this.editData = null;\n            this.isDrawing = false;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const { annotation, viewportIdsToRender } = this.editData;\n            const { data } = annotation;\n            data.handles.points[0] = [...worldPos];\n            annotation.invalidated = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const annotationUID = annotation.annotationUID;\n                const data = annotation.data;\n                const point = data.handles.points[0];\n                const canvasCoordinates = viewport.worldToCanvas(point);\n                styleSpecifier.annotationUID = annotationUID;\n                const { color } = this.getAnnotationStyle({ annotation, styleSpecifier });\n                if (!data.cachedStats) {\n                    data.cachedStats = {};\n                }\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].value == null) {\n                    data.cachedStats[targetId] = {\n                        Modality: null,\n                        index: null,\n                        value: null,\n                    };\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                    if (viewport instanceof VolumeViewport) {\n                        const { referencedImageId } = annotation.metadata;\n                        for (const targetId in data.cachedStats) {\n                            if (targetId.startsWith('imageId')) {\n                                const viewports = renderingEngine.getStackViewports();\n                                const invalidatedStack = viewports.find((vp) => {\n                                    const referencedImageURI = csUtils.imageIdToURI(referencedImageId);\n                                    const hasImageURI = vp.hasImageURI(referencedImageURI);\n                                    const currentImageURI = csUtils.imageIdToURI(vp.getCurrentImageId());\n                                    return hasImageURI && currentImageURI !== referencedImageURI;\n                                });\n                                if (invalidatedStack) {\n                                    delete data.cachedStats[targetId];\n                                }\n                            }\n                        }\n                    }\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                const handleGroupUID = '0';\n                drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, [canvasCoordinates], { color });\n                renderStatus = true;\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (textLines) {\n                    const textCanvasCoordinates = [\n                        canvasCoordinates[0] + 6,\n                        canvasCoordinates[1] - 6,\n                    ];\n                    const textUID = '0';\n                    drawTextBoxSvg(svgDrawingHelper, annotationUID, textUID, textLines, [textCanvasCoordinates[0], textCanvasCoordinates[1]], options);\n                }\n            }\n            return renderStatus;\n        };\n    }\n    isPointNearTool() {\n        return false;\n    }\n    toolSelectedCallback() { }\n    getHandleNearImagePoint(element, annotation, canvasCoords, proximity) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const { data } = annotation;\n        const point = data.handles.points[0];\n        const annotationCanvasCoordinate = viewport.worldToCanvas(point);\n        const near = vec2.distance(canvasCoords, annotationCanvasCoordinate) < proximity;\n        if (near === true) {\n            return point;\n        }\n    }\n    handleSelectedCallback(evt, annotation) {\n        const eventDetail = evt.detail;\n        const { element } = eventDetail;\n        annotation.highlighted = true;\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n        };\n        this._activateModify(element);\n        hideElementCursor(element);\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        evt.preventDefault();\n    }\n    _calculateCachedStats(annotation, renderingEngine, enabledElement) {\n        const data = annotation.data;\n        const { renderingEngineId, viewport } = enabledElement;\n        const { element } = viewport;\n        const worldPos = data.handles.points[0];\n        const { cachedStats } = data;\n        const targetIds = Object.keys(cachedStats);\n        for (let i = 0; i < targetIds.length; i++) {\n            const targetId = targetIds[i];\n            const pixelUnitsOptions = {\n                isPreScaled: isViewportPreScaled(viewport, targetId),\n                isSuvScaled: this.isSuvScaled(viewport, targetId, annotation.metadata.referencedImageId),\n            };\n            const image = this.getTargetImageData(targetId);\n            if (!image) {\n                continue;\n            }\n            const { dimensions, imageData, metadata, voxelManager } = image;\n            const modality = metadata.Modality;\n            let ijk = transformWorldToIndex(imageData, worldPos);\n            ijk = vec3.round(ijk, ijk);\n            if (csUtils.indexWithinDimensions(ijk, dimensions)) {\n                this.isHandleOutsideImage = false;\n                let value = voxelManager.getAtIJKPoint(ijk);\n                if (targetId.startsWith('imageId:')) {\n                    const imageId = targetId.split('imageId:')[1];\n                    const imageURI = csUtils.imageIdToURI(imageId);\n                    const viewports = csUtils.getViewportsWithImageURI(imageURI);\n                    const viewport = viewports[0];\n                    ijk[2] = viewport.getCurrentImageIdIndex();\n                }\n                let modalityUnit;\n                if (modality === 'US') {\n                    const calibratedResults = getCalibratedProbeUnitsAndValue(image, [\n                        ijk,\n                    ]);\n                    const hasEnhancedRegionValues = calibratedResults.values.every((value) => value !== null);\n                    value = (hasEnhancedRegionValues ? calibratedResults.values : value);\n                    modalityUnit = hasEnhancedRegionValues\n                        ? calibratedResults.units\n                        : 'raw';\n                }\n                else {\n                    modalityUnit = getPixelValueUnits(modality, annotation.metadata.referencedImageId, pixelUnitsOptions);\n                }\n                cachedStats[targetId] = {\n                    index: ijk,\n                    value,\n                    Modality: modality,\n                    modalityUnit,\n                };\n            }\n            else {\n                this.isHandleOutsideImage = true;\n                cachedStats[targetId] = {\n                    index: ijk,\n                    Modality: modality,\n                };\n            }\n            annotation.invalidated = false;\n            triggerAnnotationModified(annotation, element);\n        }\n        return cachedStats;\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { index, value, modalityUnit } = cachedVolumeStats;\n    if (value === undefined) {\n        return;\n    }\n    const textLines = [];\n    textLines.push(`(${index[0]}, ${index[1]}, ${index[2]})`);\n    if (value instanceof Array && modalityUnit instanceof Array) {\n        for (let i = 0; i < value.length; i++) {\n            textLines.push(`${csUtils.roundNumber(value[i])} ${modalityUnit[i]}`);\n        }\n    }\n    else {\n        textLines.push(`${csUtils.roundNumber(value)} ${modalityUnit}`);\n    }\n    return textLines;\n}\nProbeTool.toolName = 'Probe';\nexport default ProbeTool;\n","import { getEnabledElement } from '@cornerstonejs/core';\nimport { drawHandles as drawHandlesSvg, drawTextBox as drawTextBoxSvg, } from '../../drawingSvg';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { hideElementCursor } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport ProbeTool from './ProbeTool';\nclass DragProbeTool extends ProbeTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.postMouseDownCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const annotation = {\n                invalidated: true,\n                highlighted: true,\n                isVisible: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID: viewport.getFrameOfReferenceUID(),\n                    referencedImageId,\n                },\n                data: {\n                    label: '',\n                    handles: { points: [[...worldPos]] },\n                    cachedStats: {},\n                },\n            };\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                newAnnotation: true,\n                viewportIdsToRender,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.postTouchStartCallback = (evt) => {\n            return this.postMouseDownCallback(evt);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            if (!this.editData) {\n                return renderStatus;\n            }\n            const annotations = this.filterInteractableAnnotationsForElement(viewport.element, [this.editData.annotation]);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            const annotation = this.editData.annotation;\n            const annotationUID = annotation.annotationUID;\n            const data = annotation.data;\n            const point = data.handles.points[0];\n            const canvasCoordinates = viewport.worldToCanvas(point);\n            styleSpecifier.annotationUID = annotationUID;\n            const { color } = this.getAnnotationStyle({\n                annotation,\n                styleSpecifier,\n            });\n            if (!data.cachedStats[targetId] ||\n                data.cachedStats[targetId].value == null) {\n                data.cachedStats[targetId] = {\n                    Modality: null,\n                    index: null,\n                    value: null,\n                };\n                this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n            }\n            else if (annotation.invalidated) {\n                this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n            }\n            if (!viewport.getRenderingEngine()) {\n                console.warn('Rendering Engine has been destroyed');\n                return renderStatus;\n            }\n            const handleGroupUID = '0';\n            drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, [canvasCoordinates], { color });\n            renderStatus = true;\n            const textLines = this.configuration.getTextLines(data, targetId);\n            if (textLines) {\n                const textCanvasCoordinates = [\n                    canvasCoordinates[0] + 6,\n                    canvasCoordinates[1] - 6,\n                ];\n                const textUID = '0';\n                drawTextBoxSvg(svgDrawingHelper, annotationUID, textUID, textLines, [textCanvasCoordinates[0], textCanvasCoordinates[1]], this.getLinkedTextBoxStyle(styleSpecifier, annotation));\n            }\n            return renderStatus;\n        };\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { index, value, modalityUnit } = cachedVolumeStats;\n    if (value === undefined) {\n        return;\n    }\n    const textLines = [];\n    textLines.push(`(${index[0]}, ${index[1]}, ${index[2]})`);\n    textLines.push(`${value.toFixed(2)} ${modalityUnit}`);\n    return textLines;\n}\nDragProbeTool.toolName = 'DragProbe';\nexport default DragProbeTool;\n","import { AnnotationTool } from '../base';\nimport { getEnabledElement, VolumeViewport, utilities as csUtils, } from '@cornerstonejs/core';\nimport { getCalibratedLengthUnitsAndScale } from '../../utilities/getCalibratedUnits';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { drawCircle as drawCircleSvg, drawEllipseByCoordinates as drawEllipseSvg, drawHandles as drawHandlesSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { Events } from '../../enums';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport getWorldWidthAndHeightFromTwoPoints from '../../utilities/planar/getWorldWidthAndHeightFromTwoPoints';\nimport { pointInEllipse, getCanvasEllipseCorners, } from '../../utilities/math/ellipse';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { getPixelValueUnits } from '../../utilities/getPixelValueUnits';\nimport { isViewportPreScaled } from '../../utilities/viewport/isViewportPreScaled';\nimport { BasicStatsCalculator } from '../../utilities/math/basic';\nconst { transformWorldToIndex } = csUtils;\nclass EllipticalROITool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            storePointData: false,\n            centerPointRadius: 0,\n            getTextLines: defaultGetTextLines,\n            statsCalculator: BasicStatsCalculator,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isHandleOutsideImage = false;\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const canvasPos = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                },\n                data: {\n                    label: '',\n                    handles: {\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                        activeHandleIndex: null,\n                    },\n                    cachedStats: {},\n                    initialRotation: viewport.getRotation(),\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                centerWorld: worldPos,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const canvasCorners = getCanvasEllipseCorners(canvasCoordinates);\n            const [canvasPoint1, canvasPoint2] = canvasCorners;\n            const minorEllipse = {\n                left: Math.min(canvasPoint1[0], canvasPoint2[0]) + proximity / 2,\n                top: Math.min(canvasPoint1[1], canvasPoint2[1]) + proximity / 2,\n                width: Math.abs(canvasPoint1[0] - canvasPoint2[0]) - proximity,\n                height: Math.abs(canvasPoint1[1] - canvasPoint2[1]) - proximity,\n            };\n            const majorEllipse = {\n                left: Math.min(canvasPoint1[0], canvasPoint2[0]) - proximity / 2,\n                top: Math.min(canvasPoint1[1], canvasPoint2[1]) - proximity / 2,\n                width: Math.abs(canvasPoint1[0] - canvasPoint2[0]) + proximity,\n                height: Math.abs(canvasPoint1[1] - canvasPoint2[1]) + proximity,\n            };\n            const pointInMinorEllipse = this._pointInEllipseCanvas(minorEllipse, canvasCoords);\n            const pointInMajorEllipse = this._pointInEllipseCanvas(majorEllipse, canvasCoords);\n            if (pointInMajorEllipse && !pointInMinorEllipse) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            hideElementCursor(element);\n            this._activateModify(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation, handle) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { data } = annotation;\n            annotation.highlighted = true;\n            let movingTextBox = false;\n            let handleIndex;\n            let centerCanvas;\n            let centerWorld;\n            let canvasWidth;\n            let canvasHeight;\n            let originalHandleCanvas;\n            if (handle.worldPosition) {\n                movingTextBox = true;\n            }\n            else {\n                const { points } = data.handles;\n                const { viewport } = getEnabledElement(element);\n                const { worldToCanvas, canvasToWorld } = viewport;\n                handleIndex = points.findIndex((p) => p === handle);\n                const pointsCanvas = points.map(worldToCanvas);\n                originalHandleCanvas = pointsCanvas[handleIndex];\n                canvasWidth = Math.abs(pointsCanvas[2][0] - pointsCanvas[3][0]);\n                canvasHeight = Math.abs(pointsCanvas[0][1] - pointsCanvas[1][1]);\n                centerCanvas = [\n                    (pointsCanvas[2][0] + pointsCanvas[3][0]) / 2,\n                    (pointsCanvas[0][1] + pointsCanvas[1][1]) / 2,\n                ];\n                centerWorld = canvasToWorld(centerCanvas);\n            }\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex,\n                canvasWidth,\n                canvasHeight,\n                centerWorld,\n                originalHandleCanvas,\n                movingTextBox,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            annotation.highlighted = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const { renderingEngine } = getEnabledElement(element);\n            this.editData = null;\n            this.isDrawing = false;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this._dragDrawCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const { canvasToWorld } = viewport;\n            const { annotation, viewportIdsToRender, centerWorld } = this.editData;\n            const centerCanvas = viewport.worldToCanvas(centerWorld);\n            const { data } = annotation;\n            const dX = Math.abs(currentCanvasPoints[0] - centerCanvas[0]);\n            const dY = Math.abs(currentCanvasPoints[1] - centerCanvas[1]);\n            const bottomCanvas = [centerCanvas[0], centerCanvas[1] - dY];\n            const topCanvas = [centerCanvas[0], centerCanvas[1] + dY];\n            const leftCanvas = [centerCanvas[0] - dX, centerCanvas[1]];\n            const rightCanvas = [centerCanvas[0] + dX, centerCanvas[1]];\n            data.handles.points = [\n                canvasToWorld(bottomCanvas),\n                canvasToWorld(topCanvas),\n                canvasToWorld(leftCanvas),\n                canvasToWorld(rightCanvas),\n            ];\n            annotation.invalidated = true;\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragModifyCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                this._dragHandle(evt);\n                annotation.invalidated = true;\n            }\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragHandle = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { viewport } = getEnabledElement(element);\n            const { canvasToWorld, worldToCanvas } = viewport;\n            const { annotation, canvasWidth, canvasHeight, handleIndex, centerWorld, originalHandleCanvas, } = this.editData;\n            const centerCanvas = viewport.worldToCanvas(centerWorld);\n            const { data } = annotation;\n            const { points } = data.handles;\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            if (handleIndex === 0 || handleIndex === 1) {\n                const dYCanvas = Math.abs(currentCanvasPoints[1] - centerCanvas[1]);\n                const canvasBottom = [\n                    centerCanvas[0],\n                    centerCanvas[1] - dYCanvas,\n                ];\n                const canvasTop = [\n                    centerCanvas[0],\n                    centerCanvas[1] + dYCanvas,\n                ];\n                points[0] = canvasToWorld(canvasBottom);\n                points[1] = canvasToWorld(canvasTop);\n                const dXCanvas = currentCanvasPoints[0] - originalHandleCanvas[0];\n                const newHalfCanvasWidth = canvasWidth / 2 + dXCanvas;\n                const canvasLeft = [\n                    centerCanvas[0] - newHalfCanvasWidth,\n                    centerCanvas[1],\n                ];\n                const canvasRight = [\n                    centerCanvas[0] + newHalfCanvasWidth,\n                    centerCanvas[1],\n                ];\n                points[2] = canvasToWorld(canvasLeft);\n                points[3] = canvasToWorld(canvasRight);\n            }\n            else {\n                const dXCanvas = Math.abs(currentCanvasPoints[0] - centerCanvas[0]);\n                const canvasLeft = [\n                    centerCanvas[0] - dXCanvas,\n                    centerCanvas[1],\n                ];\n                const canvasRight = [\n                    centerCanvas[0] + dXCanvas,\n                    centerCanvas[1],\n                ];\n                points[2] = canvasToWorld(canvasLeft);\n                points[3] = canvasToWorld(canvasRight);\n                const dYCanvas = currentCanvasPoints[1] - originalHandleCanvas[1];\n                const newHalfCanvasHeight = canvasHeight / 2 + dYCanvas;\n                const canvasBottom = [\n                    centerCanvas[0],\n                    centerCanvas[1] - newHalfCanvasHeight,\n                ];\n                const canvasTop = [\n                    centerCanvas[0],\n                    centerCanvas[1] + newHalfCanvasHeight,\n                ];\n                points[0] = canvasToWorld(canvasBottom);\n                points[1] = canvasToWorld(canvasTop);\n            }\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { handles } = data;\n                const { points, activeHandleIndex } = handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                const canvasCorners = (getCanvasEllipseCorners(canvasCoordinates));\n                const { centerPointRadius } = this.configuration;\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].areaUnit == null) {\n                    data.cachedStats[targetId] = {\n                        Modality: null,\n                        area: null,\n                        max: null,\n                        mean: null,\n                        stdDev: null,\n                        areaUnit: null,\n                    };\n                    this._calculateCachedStats(annotation, viewport, renderingEngine);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, viewport, renderingEngine, enabledElement);\n                    if (viewport instanceof VolumeViewport) {\n                        const { referencedImageId } = annotation.metadata;\n                        for (const targetId in data.cachedStats) {\n                            if (targetId.startsWith('imageId')) {\n                                const viewports = renderingEngine.getStackViewports();\n                                const invalidatedStack = viewports.find((vp) => {\n                                    const referencedImageURI = csUtils.imageIdToURI(referencedImageId);\n                                    const hasImageURI = vp.hasImageURI(referencedImageURI);\n                                    const currentImageURI = csUtils.imageIdToURI(vp.getCurrentImageId());\n                                    return hasImageURI && currentImageURI !== referencedImageURI;\n                                });\n                                if (invalidatedStack) {\n                                    delete data.cachedStats[targetId];\n                                }\n                            }\n                        }\n                    }\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                const dataId = `${annotationUID}-ellipse`;\n                const ellipseUID = '0';\n                drawEllipseSvg(svgDrawingHelper, annotationUID, ellipseUID, canvasCoordinates, {\n                    color,\n                    lineDash,\n                    lineWidth,\n                }, dataId);\n                if (centerPointRadius > 0) {\n                    const minRadius = Math.min(Math.abs(canvasCorners[0][0] - canvasCorners[1][0]) / 2, Math.abs(canvasCorners[0][1] - canvasCorners[1][1]) / 2);\n                    if (minRadius > 3 * centerPointRadius) {\n                        const centerPoint = this._getCanvasEllipseCenter(canvasCoordinates);\n                        drawCircleSvg(svgDrawingHelper, annotationUID, `${ellipseUID}-center`, centerPoint, centerPointRadius, {\n                            color,\n                            lineDash,\n                            lineWidth,\n                        });\n                    }\n                }\n                renderStatus = true;\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!textLines || textLines.length === 0) {\n                    continue;\n                }\n                let canvasTextBoxCoords;\n                if (!data.handles.textBox.hasMoved) {\n                    canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCorners);\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n        this._calculateCachedStats = (annotation, viewport, renderingEngine) => {\n            const data = annotation.data;\n            const { element } = viewport;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const { viewPlaneNormal, viewUp } = viewport.getCamera();\n            const [topLeftCanvas, bottomRightCanvas] = (getCanvasEllipseCorners(canvasCoordinates));\n            const topLeftWorld = viewport.canvasToWorld(topLeftCanvas);\n            const bottomRightWorld = viewport.canvasToWorld(bottomRightCanvas);\n            const { cachedStats } = data;\n            const targetIds = Object.keys(cachedStats);\n            const worldPos1 = topLeftWorld;\n            const worldPos2 = bottomRightWorld;\n            for (let i = 0; i < targetIds.length; i++) {\n                const targetId = targetIds[i];\n                const image = this.getTargetImageData(targetId);\n                if (!image) {\n                    continue;\n                }\n                const { dimensions, imageData, metadata, voxelManager } = image;\n                const pos1Index = transformWorldToIndex(imageData, worldPos1);\n                pos1Index[0] = Math.floor(pos1Index[0]);\n                pos1Index[1] = Math.floor(pos1Index[1]);\n                pos1Index[2] = Math.floor(pos1Index[2]);\n                const post2Index = transformWorldToIndex(imageData, worldPos2);\n                post2Index[0] = Math.floor(post2Index[0]);\n                post2Index[1] = Math.floor(post2Index[1]);\n                post2Index[2] = Math.floor(post2Index[2]);\n                this.isHandleOutsideImage = !this._isInsideVolume(pos1Index, post2Index, dimensions);\n                const iMin = Math.min(pos1Index[0], post2Index[0]);\n                const iMax = Math.max(pos1Index[0], post2Index[0]);\n                const jMin = Math.min(pos1Index[1], post2Index[1]);\n                const jMax = Math.max(pos1Index[1], post2Index[1]);\n                const kMin = Math.min(pos1Index[2], post2Index[2]);\n                const kMax = Math.max(pos1Index[2], post2Index[2]);\n                const boundsIJK = [\n                    [iMin, iMax],\n                    [jMin, jMax],\n                    [kMin, kMax],\n                ];\n                const center = [\n                    (topLeftWorld[0] + bottomRightWorld[0]) / 2,\n                    (topLeftWorld[1] + bottomRightWorld[1]) / 2,\n                    (topLeftWorld[2] + bottomRightWorld[2]) / 2,\n                ];\n                const ellipseObj = {\n                    center,\n                    xRadius: Math.abs(topLeftWorld[0] - bottomRightWorld[0]) / 2,\n                    yRadius: Math.abs(topLeftWorld[1] - bottomRightWorld[1]) / 2,\n                    zRadius: Math.abs(topLeftWorld[2] - bottomRightWorld[2]) / 2,\n                };\n                const { worldWidth, worldHeight } = getWorldWidthAndHeightFromTwoPoints(viewPlaneNormal, viewUp, worldPos1, worldPos2);\n                const isEmptyArea = worldWidth === 0 && worldHeight === 0;\n                const handles = [pos1Index, post2Index];\n                const { scale, areaUnit } = getCalibratedLengthUnitsAndScale(image, handles);\n                const area = Math.abs(Math.PI * (worldWidth / 2) * (worldHeight / 2)) /\n                    scale /\n                    scale;\n                const pixelUnitsOptions = {\n                    isPreScaled: isViewportPreScaled(viewport, targetId),\n                    isSuvScaled: this.isSuvScaled(viewport, targetId, annotation.metadata.referencedImageId),\n                };\n                const modalityUnit = getPixelValueUnits(metadata.Modality, annotation.metadata.referencedImageId, pixelUnitsOptions);\n                const pointsInShape = voxelManager.forEach(this.configuration.statsCalculator.statsCallback, {\n                    boundsIJK,\n                    imageData,\n                    isInObject: (pointLPS) => pointInEllipse(ellipseObj, pointLPS, { fast: true }),\n                    returnPoints: this.configuration.storePointData,\n                });\n                const stats = this.configuration.statsCalculator.getStatistics();\n                cachedStats[targetId] = {\n                    Modality: metadata.Modality,\n                    area,\n                    mean: stats.mean?.value,\n                    max: stats.max?.value,\n                    stdDev: stats.stdDev?.value,\n                    statsArray: stats.array,\n                    pointsInShape,\n                    isEmptyArea,\n                    areaUnit,\n                    modalityUnit,\n                };\n            }\n            annotation.invalidated = false;\n            triggerAnnotationModified(annotation, element);\n            return cachedStats;\n        };\n        this._isInsideVolume = (index1, index2, dimensions) => {\n            return (csUtils.indexWithinDimensions(index1, dimensions) &&\n                csUtils.indexWithinDimensions(index2, dimensions));\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    _pointInEllipseCanvas(ellipse, location) {\n        const xRadius = ellipse.width / 2;\n        const yRadius = ellipse.height / 2;\n        if (xRadius <= 0.0 || yRadius <= 0.0) {\n            return false;\n        }\n        const center = [ellipse.left + xRadius, ellipse.top + yRadius];\n        const normalized = [location[0] - center[0], location[1] - center[1]];\n        const inEllipse = (normalized[0] * normalized[0]) / (xRadius * xRadius) +\n            (normalized[1] * normalized[1]) / (yRadius * yRadius) <=\n            1.0;\n        return inEllipse;\n    }\n    _getCanvasEllipseCenter(ellipseCanvasPoints) {\n        const [bottom, top, left, right] = ellipseCanvasPoints;\n        const topLeft = [left[0], top[1]];\n        const bottomRight = [right[0], bottom[1]];\n        return [\n            (topLeft[0] + bottomRight[0]) / 2,\n            (topLeft[1] + bottomRight[1]) / 2,\n        ];\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { area, mean, stdDev, max, isEmptyArea, areaUnit, modalityUnit } = cachedVolumeStats;\n    const textLines = [];\n    if (area) {\n        const areaLine = isEmptyArea\n            ? `Area: Oblique not supported`\n            : `Area: ${csUtils.roundNumber(area)} ${areaUnit}`;\n        textLines.push(areaLine);\n    }\n    if (mean) {\n        textLines.push(`Mean: ${csUtils.roundNumber(mean)} ${modalityUnit}`);\n    }\n    if (max) {\n        textLines.push(`Max: ${csUtils.roundNumber(max)} ${modalityUnit}`);\n    }\n    if (stdDev) {\n        textLines.push(`Std Dev: ${csUtils.roundNumber(stdDev)} ${modalityUnit}`);\n    }\n    return textLines;\n}\nEllipticalROITool.toolName = 'EllipticalROI';\nexport default EllipticalROITool;\n","import { AnnotationTool } from '../base';\nimport { getEnabledElement, VolumeViewport, utilities as csUtils, } from '@cornerstonejs/core';\nimport { getCalibratedAspect, getCalibratedLengthUnitsAndScale, } from '../../utilities/getCalibratedUnits';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { drawCircle as drawCircleSvg, drawHandles as drawHandlesSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { Events } from '../../enums';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport getWorldWidthAndHeightFromTwoPoints from '../../utilities/planar/getWorldWidthAndHeightFromTwoPoints';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { getPixelValueUnits } from '../../utilities/getPixelValueUnits';\nimport { isViewportPreScaled } from '../../utilities/viewport/isViewportPreScaled';\nimport { getCanvasCircleCorners, getCanvasCircleRadius, } from '../../utilities/math/circle';\nimport { pointInEllipse } from '../../utilities/math/ellipse';\nimport { BasicStatsCalculator } from '../../utilities/math/basic';\nconst { transformWorldToIndex } = csUtils;\nclass CircleROITool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            storePointData: false,\n            centerPointRadius: 0,\n            getTextLines: defaultGetTextLines,\n            statsCalculator: BasicStatsCalculator,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isHandleOutsideImage = false;\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                },\n                data: {\n                    label: '',\n                    handles: {\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                    },\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const radius = getCanvasCircleRadius(canvasCoordinates);\n            const radiusPoint = getCanvasCircleRadius([\n                canvasCoordinates[0],\n                canvasCoords,\n            ]);\n            if (Math.abs(radiusPoint - radius) < proximity / 2) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            hideElementCursor(element);\n            this._activateModify(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation, handle) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { data } = annotation;\n            annotation.highlighted = true;\n            let movingTextBox = false;\n            let handleIndex;\n            if (handle.worldPosition) {\n                movingTextBox = true;\n            }\n            else {\n                const { points } = data.handles;\n                handleIndex = points.findIndex((p) => p === handle);\n            }\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex,\n                movingTextBox,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            annotation.highlighted = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const { renderingEngine } = getEnabledElement(element);\n            this.editData = null;\n            this.isDrawing = false;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this._dragDrawCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const { canvasToWorld } = viewport;\n            const { annotation, viewportIdsToRender } = this.editData;\n            const { data } = annotation;\n            data.handles.points = [\n                data.handles.points[0],\n                canvasToWorld(currentCanvasPoints),\n            ];\n            annotation.invalidated = true;\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragModifyCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                this._dragHandle(evt);\n                annotation.invalidated = true;\n            }\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragHandle = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { canvasToWorld, worldToCanvas } = enabledElement.viewport;\n            const { annotation, handleIndex } = this.editData;\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => worldToCanvas(p));\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            if (handleIndex === 0) {\n                const dXCanvas = currentCanvasPoints[0] - canvasCoordinates[0][0];\n                const dYCanvas = currentCanvasPoints[1] - canvasCoordinates[0][1];\n                const canvasCenter = currentCanvasPoints;\n                const canvasEnd = [\n                    canvasCoordinates[1][0] + dXCanvas,\n                    canvasCoordinates[1][1] + dYCanvas,\n                ];\n                points[0] = canvasToWorld(canvasCenter);\n                points[1] = canvasToWorld(canvasEnd);\n            }\n            else {\n                points[1] = canvasToWorld(currentCanvasPoints);\n            }\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { handles } = data;\n                const { points, activeHandleIndex } = handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                const center = canvasCoordinates[0];\n                const radius = getCanvasCircleRadius(canvasCoordinates);\n                const canvasCorners = getCanvasCircleCorners(canvasCoordinates);\n                const { centerPointRadius } = this.configuration;\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].areaUnit == null) {\n                    data.cachedStats[targetId] = {\n                        Modality: null,\n                        area: null,\n                        max: null,\n                        mean: null,\n                        stdDev: null,\n                        areaUnit: null,\n                        radius: null,\n                        radiusUnit: null,\n                        perimeter: null,\n                    };\n                    this._calculateCachedStats(annotation, viewport, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, viewport, renderingEngine, enabledElement);\n                    if (viewport instanceof VolumeViewport) {\n                        const { referencedImageId } = annotation.metadata;\n                        for (const targetId in data.cachedStats) {\n                            if (targetId.startsWith('imageId')) {\n                                const viewports = renderingEngine.getStackViewports();\n                                const invalidatedStack = viewports.find((vp) => {\n                                    const referencedImageURI = csUtils.imageIdToURI(referencedImageId);\n                                    const hasImageURI = vp.hasImageURI(referencedImageURI);\n                                    const currentImageURI = csUtils.imageIdToURI(vp.getCurrentImageId());\n                                    return hasImageURI && currentImageURI !== referencedImageURI;\n                                });\n                                if (invalidatedStack) {\n                                    delete data.cachedStats[targetId];\n                                }\n                            }\n                        }\n                    }\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                const dataId = `${annotationUID}-circle`;\n                const circleUID = '0';\n                drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, center, radius, {\n                    color,\n                    lineDash,\n                    lineWidth,\n                }, dataId);\n                if (centerPointRadius > 0) {\n                    if (radius > 3 * centerPointRadius) {\n                        drawCircleSvg(svgDrawingHelper, annotationUID, `${circleUID}-center`, center, centerPointRadius, {\n                            color,\n                            lineDash,\n                            lineWidth,\n                        });\n                    }\n                }\n                renderStatus = true;\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!textLines || textLines.length === 0) {\n                    continue;\n                }\n                let canvasTextBoxCoords;\n                if (!data.handles.textBox.hasMoved) {\n                    canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCorners);\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n        this._calculateCachedStats = (annotation, viewport, renderingEngine, enabledElement) => {\n            const data = annotation.data;\n            const { element } = viewport;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const { viewPlaneNormal, viewUp } = viewport.getCamera();\n            const [topLeftCanvas, bottomRightCanvas] = (getCanvasCircleCorners(canvasCoordinates));\n            const topLeftWorld = viewport.canvasToWorld(topLeftCanvas);\n            const bottomRightWorld = viewport.canvasToWorld(bottomRightCanvas);\n            const { cachedStats } = data;\n            const targetIds = Object.keys(cachedStats);\n            const worldPos1 = topLeftWorld;\n            const worldPos2 = bottomRightWorld;\n            for (let i = 0; i < targetIds.length; i++) {\n                const targetId = targetIds[i];\n                const image = this.getTargetImageData(targetId);\n                if (!image) {\n                    continue;\n                }\n                const { dimensions, imageData, metadata, voxelManager } = image;\n                const pos1Index = transformWorldToIndex(imageData, worldPos1);\n                pos1Index[0] = Math.floor(pos1Index[0]);\n                pos1Index[1] = Math.floor(pos1Index[1]);\n                pos1Index[2] = Math.floor(pos1Index[2]);\n                const pos2Index = transformWorldToIndex(imageData, worldPos2);\n                pos2Index[0] = Math.floor(pos2Index[0]);\n                pos2Index[1] = Math.floor(pos2Index[1]);\n                pos2Index[2] = Math.floor(pos2Index[2]);\n                if (this._isInsideVolume(pos1Index, pos2Index, dimensions)) {\n                    const iMin = Math.min(pos1Index[0], pos2Index[0]);\n                    const iMax = Math.max(pos1Index[0], pos2Index[0]);\n                    const jMin = Math.min(pos1Index[1], pos2Index[1]);\n                    const jMax = Math.max(pos1Index[1], pos2Index[1]);\n                    const kMin = Math.min(pos1Index[2], pos2Index[2]);\n                    const kMax = Math.max(pos1Index[2], pos2Index[2]);\n                    const boundsIJK = [\n                        [iMin, iMax],\n                        [jMin, jMax],\n                        [kMin, kMax],\n                    ];\n                    const center = [\n                        (topLeftWorld[0] + bottomRightWorld[0]) / 2,\n                        (topLeftWorld[1] + bottomRightWorld[1]) / 2,\n                        (topLeftWorld[2] + bottomRightWorld[2]) / 2,\n                    ];\n                    const ellipseObj = {\n                        center,\n                        xRadius: Math.abs(topLeftWorld[0] - bottomRightWorld[0]) / 2,\n                        yRadius: Math.abs(topLeftWorld[1] - bottomRightWorld[1]) / 2,\n                        zRadius: Math.abs(topLeftWorld[2] - bottomRightWorld[2]) / 2,\n                    };\n                    const { worldWidth, worldHeight } = getWorldWidthAndHeightFromTwoPoints(viewPlaneNormal, viewUp, worldPos1, worldPos2);\n                    const isEmptyArea = worldWidth === 0 && worldHeight === 0;\n                    const handles = [pos1Index, pos2Index];\n                    const { scale, unit, areaUnit } = getCalibratedLengthUnitsAndScale(image, handles);\n                    const aspect = getCalibratedAspect(image);\n                    const area = Math.abs(Math.PI *\n                        (worldWidth / scale / 2) *\n                        (worldHeight / aspect / scale / 2));\n                    const pixelUnitsOptions = {\n                        isPreScaled: isViewportPreScaled(viewport, targetId),\n                        isSuvScaled: this.isSuvScaled(viewport, targetId, annotation.metadata.referencedImageId),\n                    };\n                    const modalityUnit = getPixelValueUnits(metadata.Modality, annotation.metadata.referencedImageId, pixelUnitsOptions);\n                    const pointsInShape = voxelManager.forEach(this.configuration.statsCalculator.statsCallback, {\n                        isInObject: (pointLPS) => pointInEllipse(ellipseObj, pointLPS, { fast: true }),\n                        boundsIJK,\n                        imageData,\n                        returnPoints: this.configuration.storePointData,\n                    });\n                    const stats = this.configuration.statsCalculator.getStatistics();\n                    cachedStats[targetId] = {\n                        Modality: metadata.Modality,\n                        area,\n                        mean: stats.mean?.value,\n                        max: stats.max?.value,\n                        stdDev: stats.stdDev?.value,\n                        statsArray: stats.array,\n                        pointsInShape: pointsInShape,\n                        isEmptyArea,\n                        areaUnit,\n                        radius: worldWidth / 2 / scale,\n                        radiusUnit: unit,\n                        perimeter: (2 * Math.PI * (worldWidth / 2)) / scale,\n                        modalityUnit,\n                    };\n                }\n                else {\n                    this.isHandleOutsideImage = true;\n                    cachedStats[targetId] = {\n                        Modality: metadata.Modality,\n                    };\n                }\n            }\n            annotation.invalidated = false;\n            triggerAnnotationModified(annotation, element);\n            return cachedStats;\n        };\n        this._isInsideVolume = (index1, index2, dimensions) => {\n            return (csUtils.indexWithinDimensions(index1, dimensions) &&\n                csUtils.indexWithinDimensions(index2, dimensions));\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { radius, radiusUnit, area, mean, stdDev, max, isEmptyArea, areaUnit, modalityUnit, } = cachedVolumeStats;\n    const textLines = [];\n    if (radius) {\n        const radiusLine = isEmptyArea\n            ? `Radius: Oblique not supported`\n            : `Radius: ${csUtils.roundNumber(radius)} ${radiusUnit}`;\n        textLines.push(radiusLine);\n    }\n    if (area) {\n        const areaLine = isEmptyArea\n            ? `Area: Oblique not supported`\n            : `Area: ${csUtils.roundNumber(area)} ${areaUnit}`;\n        textLines.push(areaLine);\n    }\n    if (mean) {\n        textLines.push(`Mean: ${csUtils.roundNumber(mean)} ${modalityUnit}`);\n    }\n    if (max) {\n        textLines.push(`Max: ${csUtils.roundNumber(max)} ${modalityUnit}`);\n    }\n    if (stdDev) {\n        textLines.push(`Std Dev: ${csUtils.roundNumber(stdDev)} ${modalityUnit}`);\n    }\n    return textLines;\n}\nCircleROITool.toolName = 'CircleROI';\nexport default CircleROITool;\n","import { AnnotationTool } from '../base';\nimport { getEnabledElement } from '@cornerstonejs/core';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationCompleted } from '../../stateManagement/annotation/helpers/state';\nimport { drawCircle as drawCircleSvg, drawLine } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { Events } from '../../enums';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { getCanvasCircleRadius } from '../../utilities/math/circle';\nimport { vec3 } from 'gl-matrix';\nconst CROSSHAIR_SIZE = 5;\nclass ETDRSGridTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            degrees: [45, 135, 225, 315],\n            diameters: [10, 30, 60],\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isHandleOutsideImage = false;\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                },\n                data: {\n                    label: '',\n                    handles: {\n                        points: [[...worldPos]],\n                    },\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                newAnnotation: true,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { points } = data.handles;\n            const center = viewport.worldToCanvas(points[0]);\n            const radius = getCanvasCircleRadius([center, canvasCoords]);\n            if (Math.abs(radius) < proximity) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n            };\n            hideElementCursor(element);\n            this._activateModify(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            annotation.highlighted = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const { renderingEngine } = getEnabledElement(element);\n            this.editData = null;\n            this.isDrawing = false;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this._dragDrawCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const { canvasToWorld } = viewport;\n            const { annotation, viewportIdsToRender } = this.editData;\n            const { data } = annotation;\n            data.handles.points = [\n                canvasToWorld(currentCanvasPoints),\n                canvasToWorld(currentCanvasPoints),\n            ];\n            annotation.invalidated = true;\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragModifyCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender } = this.editData;\n            const { data } = annotation;\n            const { deltaPoints } = eventDetail;\n            const worldPosDelta = deltaPoints.world;\n            const points = data.handles.points;\n            points.forEach((point) => {\n                point[0] += worldPosDelta[0];\n                point[1] += worldPosDelta[1];\n                point[2] += worldPosDelta[2];\n            });\n            annotation.invalidated = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragHandle = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { canvasToWorld, worldToCanvas } = enabledElement.viewport;\n            const { annotation } = this.editData;\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => worldToCanvas(p));\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            const dXCanvas = currentCanvasPoints[0] - canvasCoordinates[0][0];\n            const dYCanvas = currentCanvasPoints[1] - canvasCoordinates[0][1];\n            const canvasCenter = currentCanvasPoints;\n            const canvasEnd = [\n                canvasCoordinates[1][0] + dXCanvas,\n                canvasCoordinates[1][1] + dYCanvas,\n            ];\n            points[0] = canvasToWorld(canvasCenter);\n            points[1] = canvasToWorld(canvasEnd);\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                const { renderingEngine } = getEnabledElement(element);\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { handles } = data;\n                const { points } = handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                const center = canvasCoordinates[0];\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                let lineUID = `${annotationUID}-crosshair-vertical`;\n                let start = [center[0], center[1] + CROSSHAIR_SIZE];\n                let end = [center[0], center[1] - CROSSHAIR_SIZE];\n                drawLine(svgDrawingHelper, annotationUID, lineUID, start, end, {\n                    color,\n                    lineDash,\n                    lineWidth,\n                });\n                lineUID = `${annotationUID}-crosshair-horizontal`;\n                start = [center[0] + CROSSHAIR_SIZE, center[1]];\n                end = [center[0] - CROSSHAIR_SIZE, center[1]];\n                drawLine(svgDrawingHelper, annotationUID, lineUID, start, end, {\n                    color,\n                    lineDash,\n                    lineWidth,\n                });\n                const diametersCanvas = this.configuration.diameters.map((diameter) => this.worldMeasureToCanvas(diameter, viewport));\n                for (let i = 0; i < diametersCanvas.length; i++) {\n                    const dataId = `${annotationUID}-circle-${i}`;\n                    const circleUID = `${annotationUID}-circle-${i}`;\n                    drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, center, diametersCanvas[i] / 2, {\n                        color,\n                        lineDash,\n                        lineWidth,\n                    }, dataId);\n                }\n                const degreesRad = (x) => (x * Math.PI) / 180;\n                const angleRadians = this.configuration.degrees.map((degree) => degreesRad(degree));\n                for (let i = 0; i < angleRadians.length; i++) {\n                    const lineUID = `${annotationUID}-line-${i}`;\n                    const start = [\n                        (Math.cos(angleRadians[i]) * diametersCanvas[0]) / 2 + center[0],\n                        (Math.sin(angleRadians[i]) * diametersCanvas[0]) / 2 + center[1],\n                    ];\n                    const end = [\n                        (Math.cos(angleRadians[i]) * diametersCanvas[2]) / 2 + center[0],\n                        (Math.sin(angleRadians[i]) * diametersCanvas[2]) / 2 + center[1],\n                    ];\n                    drawLine(svgDrawingHelper, annotationUID, lineUID, start, end, {\n                        color,\n                        lineDash,\n                        lineWidth,\n                    });\n                }\n                renderStatus = true;\n            }\n            return renderStatus;\n        };\n    }\n    worldMeasureToCanvas(measurement, viewport) {\n        const p1 = viewport.canvasToWorld([\n            viewport.canvas.width / 2,\n            viewport.canvas.height / 2,\n        ]);\n        const { viewUp } = viewport.getCamera();\n        const p2 = vec3.scaleAndAdd(vec3.create(), p1, viewUp, measurement);\n        const p1Canvas = viewport.worldToCanvas(p1);\n        const p2Canvas = viewport.worldToCanvas(p2);\n        const distance = Math.sqrt(Math.pow(p2Canvas[0] - p1Canvas[0], 2) +\n            Math.pow(p2Canvas[1] - p1Canvas[1], 2));\n        return distance;\n    }\n}\nETDRSGridTool.toolName = 'ETDRSGrid';\nexport default ETDRSGridTool;\n","import { getEnabledElement, eventTarget, triggerEvent, utilities, } from '@cornerstonejs/core';\nimport { vec3 } from 'gl-matrix';\nimport { getChildAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { drawHandles as drawHandlesSvg, drawPolyline as drawPolylineSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { Events, MouseBindings, KeyboardBindings, ChangeTypes, } from '../../enums';\nimport { resetElementCursor } from '../../cursors/elementCursor';\nimport * as math from '../../utilities/math';\nimport throttle from '../../utilities/throttle';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport { getCalibratedLengthUnitsAndScale } from '../../utilities/getCalibratedUnits';\nimport getMouseModifierKey from '../../eventDispatchers/shared/getMouseModifier';\nimport { ContourWindingDirection } from '../../types/ContourAnnotation';\nimport { CardinalSpline } from './splines/CardinalSpline';\nimport { LinearSpline } from './splines/LinearSpline';\nimport { CatmullRomSpline } from './splines/CatmullRomSpline';\nimport { BSpline } from './splines/BSpline';\nimport ContourSegmentationBaseTool from '../base/ContourSegmentationBaseTool';\nimport { triggerAnnotationRenderForViewportIds } from '../../utilities';\nconst SPLINE_MIN_POINTS = 3;\nconst SPLINE_CLICK_CLOSE_CURVE_DIST = 10;\nconst DEFAULT_SPLINE_CONFIG = {\n    resolution: 20,\n    controlPointAdditionDistance: 6,\n    controlPointDeletionDistance: 6,\n    showControlPointsConnectors: false,\n    controlPointAdditionEnabled: true,\n    controlPointDeletionEnabled: true,\n};\nvar SplineTypesEnum;\n(function (SplineTypesEnum) {\n    SplineTypesEnum[\"Cardinal\"] = \"CARDINAL\";\n    SplineTypesEnum[\"Linear\"] = \"LINEAR\";\n    SplineTypesEnum[\"CatmullRom\"] = \"CATMULLROM\";\n    SplineTypesEnum[\"BSpline\"] = \"BSPLINE\";\n})(SplineTypesEnum || (SplineTypesEnum = {}));\nvar SplineToolActions;\n(function (SplineToolActions) {\n    SplineToolActions[\"AddControlPoint\"] = \"addControlPoint\";\n    SplineToolActions[\"DeleteControlPoint\"] = \"deleteControlPoint\";\n})(SplineToolActions || (SplineToolActions = {}));\nclass SplineROITool extends ContourSegmentationBaseTool {\n    static { this.SplineTypes = SplineTypesEnum; }\n    static { this.Actions = SplineToolActions; }\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            preventHandleOutsideImage: false,\n            calculateStats: true,\n            getTextLines: defaultGetTextLines,\n            contourHoleAdditionModifierKey: KeyboardBindings.Shift,\n            decimate: {\n                enabled: false,\n                epsilon: 0.1,\n            },\n            spline: {\n                configuration: {\n                    [SplineTypesEnum.Cardinal]: {\n                        Class: CardinalSpline,\n                        scale: 0.5,\n                    },\n                    [SplineTypesEnum.CatmullRom]: {\n                        Class: CatmullRomSpline,\n                    },\n                    [SplineTypesEnum.Linear]: {\n                        Class: LinearSpline,\n                    },\n                    [SplineTypesEnum.BSpline]: {\n                        Class: BSpline,\n                        controlPointAdditionEnabled: false,\n                        controlPointDeletionEnabled: false,\n                        showControlPointsConnectors: true,\n                    },\n                },\n                type: SplineTypesEnum.CatmullRom,\n                drawPreviewEnabled: true,\n                lastControlPointDeletionKeys: ['Backspace', 'Delete'],\n            },\n            actions: {\n                [SplineToolActions.AddControlPoint]: {\n                    method: 'addControlPointCallback',\n                    bindings: [\n                        {\n                            mouseButton: MouseBindings.Primary,\n                            modifierKey: KeyboardBindings.Shift,\n                        },\n                    ],\n                },\n                [SplineToolActions.DeleteControlPoint]: {\n                    method: 'deleteControlPointCallback',\n                    bindings: [\n                        {\n                            mouseButton: MouseBindings.Primary,\n                            modifierKey: KeyboardBindings.Ctrl,\n                        },\n                    ],\n                },\n            },\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isHandleOutsideImage = false;\n        this.fireChangeOnUpdate = null;\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const { instance: spline } = annotation.data.spline;\n            return spline.isPointNearCurve(canvasCoords, proximity);\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            this._activateModify(element);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation, handle) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { data } = annotation;\n            annotation.highlighted = true;\n            let movingTextBox = false;\n            let handleIndex;\n            if (handle.worldPosition) {\n                movingTextBox = true;\n            }\n            else {\n                const { points } = data.handles;\n                handleIndex = points.findIndex((p) => p === handle);\n            }\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex,\n                movingTextBox,\n            };\n            this._activateModify(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, contourHoleProcessingEnabled, } = this.editData;\n            const { data } = annotation;\n            annotation.autoGenerated = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const image = this.getTargetImageData(this.getTargetId(enabledElement.viewport));\n            const { imageData, dimensions } = image;\n            this.isHandleOutsideImage = data.handles.points\n                .map((p) => utilities.transformWorldToIndex(imageData, p))\n                .some((index) => !utilities.indexWithinDimensions(index, dimensions));\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            const changeType = newAnnotation\n                ? ChangeTypes.Completed\n                : ChangeTypes.HandlesUpdated;\n            if (!this.fireChangeOnUpdate) {\n                this.fireChangeOnUpdate = {\n                    annotationUID: annotation.annotationUID,\n                    changeType,\n                    contourHoleProcessingEnabled,\n                };\n            }\n            else {\n                this.fireChangeOnUpdate.annotationUID = annotation.annotationUID;\n                this.fireChangeOnUpdate.changeType = changeType;\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._keyDownCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const key = eventDetail.key ?? '';\n            const { lastControlPointDeletionKeys } = this.configuration.spline;\n            const deleteLastPoint = lastControlPointDeletionKeys.includes(key);\n            if (!deleteLastPoint) {\n                return;\n            }\n            const { annotation } = this.editData;\n            const { data } = annotation;\n            if (data.handles.points.length === SPLINE_MIN_POINTS) {\n                this.cancel(element);\n                return;\n            }\n            else {\n                const controlPointIndex = data.handles.points.length - 1;\n                this._deleteControlPointByIndex(element, annotation, controlPointIndex);\n            }\n            evt.preventDefault();\n        };\n        this._mouseMoveCallback = (evt) => {\n            const { drawPreviewEnabled } = this.configuration.spline;\n            if (!drawPreviewEnabled) {\n                return;\n            }\n            const { element } = evt.detail;\n            const { renderingEngine } = getEnabledElement(element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData.lastCanvasPoint = evt.detail.currentPoints.canvas;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._mouseDownCallback = (evt) => {\n            const doubleClick = evt.type === Events.MOUSE_DOUBLE_CLICK;\n            const { annotation, viewportIdsToRender } = this.editData;\n            const { data } = annotation;\n            if (data.contour.closed) {\n                return;\n            }\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { currentPoints } = eventDetail;\n            const { canvas: canvasPoint, world: worldPoint } = currentPoints;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            let closeContour = data.handles.points.length >= 2 && doubleClick;\n            let addNewPoint = true;\n            if (data.handles.points.length >= 3) {\n                const { instance: spline } = data.spline;\n                const closestControlPoint = spline.getClosestControlPointWithinDistance(canvasPoint, SPLINE_CLICK_CLOSE_CURVE_DIST);\n                if (closestControlPoint?.index === 0) {\n                    addNewPoint = false;\n                    closeContour = true;\n                }\n            }\n            if (addNewPoint) {\n                data.handles.points.push(worldPoint);\n            }\n            data.contour.closed = data.contour.closed || closeContour;\n            annotation.invalidated = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (data.contour.closed) {\n                this._endCallback(evt);\n            }\n            evt.preventDefault();\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                this.moveAnnotation(annotation, worldPosDelta);\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                data.handles.points[handleIndex] = [...worldPos];\n                annotation.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.triggerAnnotationCompleted = (annotation, contourHoleProcessingEnabled) => {\n            const eventType = Events.ANNOTATION_COMPLETED;\n            const eventDetail = {\n                annotation,\n                changeType: ChangeTypes.Completed,\n                contourHoleProcessingEnabled,\n            };\n            triggerEvent(eventTarget, eventType, eventDetail);\n        };\n        this.triggerAnnotationModified = (annotation, enabledElement, changeType = ChangeTypes.StatsUpdated) => {\n            const { viewportId, renderingEngineId } = enabledElement;\n            const eventType = Events.ANNOTATION_MODIFIED;\n            const eventDetail = {\n                annotation,\n                viewportId,\n                renderingEngineId,\n                changeType,\n            };\n            triggerEvent(eventTarget, eventType, eventDetail);\n        };\n        this.triggerChangeEvent = (annotation, enabledElement, changeType = ChangeTypes.StatsUpdated, contourHoleProcessingEnabled) => {\n            if (changeType === ChangeTypes.Completed) {\n                this.triggerAnnotationCompleted(annotation, contourHoleProcessingEnabled);\n            }\n            else {\n                this.triggerAnnotationModified(annotation, enabledElement, changeType);\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.KEY_DOWN, this._keyDownCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._mouseMoveCallback);\n            element.addEventListener(Events.MOUSE_DOWN, this._mouseDownCallback);\n            element.addEventListener(Events.MOUSE_DOUBLE_CLICK, this._mouseDownCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._mouseDownCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.KEY_DOWN, this._keyDownCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._mouseMoveCallback);\n            element.removeEventListener(Events.MOUSE_DOWN, this._mouseDownCallback);\n            element.removeEventListener(Events.MOUSE_DOUBLE_CLICK, this._mouseDownCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._mouseDownCallback);\n        };\n        this._renderStats = (annotation, viewport, svgDrawingHelper, textboxStyle) => {\n            const data = annotation.data;\n            const targetId = this.getTargetId(viewport);\n            if (!data.spline.instance.closed || !textboxStyle.visibility) {\n                return;\n            }\n            const textLines = this.configuration.getTextLines(data, targetId);\n            if (!textLines || textLines.length === 0) {\n                return;\n            }\n            const canvasCoordinates = data.handles.points.map((p) => viewport.worldToCanvas(p));\n            if (!data.handles.textBox.hasMoved) {\n                const canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                data.handles.textBox.worldPosition =\n                    viewport.canvasToWorld(canvasTextBoxCoords);\n            }\n            const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n            const textBoxUID = 'textBox';\n            const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotation.annotationUID ?? '', textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, textboxStyle);\n            const { x: left, y: top, width, height } = boundingBox;\n            data.handles.textBox.worldBoundingBox = {\n                topLeft: viewport.canvasToWorld([left, top]),\n                topRight: viewport.canvasToWorld([left + width, top]),\n                bottomLeft: viewport.canvasToWorld([left, top + height]),\n                bottomRight: viewport.canvasToWorld([left + width, top + height]),\n            };\n        };\n        this.addControlPointCallback = (evt, annotation) => {\n            const { data } = annotation;\n            const splineType = data.spline.type;\n            const splineConfig = this._getSplineConfig(splineType);\n            const maxDist = splineConfig.controlPointAdditionDistance;\n            if (splineConfig.controlPointAdditionEnabled === false) {\n                return;\n            }\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const { canvasToWorld } = viewport;\n            const { instance: spline } = data.spline;\n            const canvasPos = evt.detail.currentPoints.canvas;\n            const closestPointInfo = spline.getClosestPoint(canvasPos);\n            if (closestPointInfo.distance > maxDist) {\n                return;\n            }\n            const { index, point: canvasPoint } = spline.addControlPointAtU(closestPointInfo.uValue);\n            data.handles.points.splice(index, 0, canvasToWorld(canvasPoint));\n            annotation.invalidated = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.deleteControlPointCallback = (evt, annotation) => {\n            const splineType = annotation.data.spline.type;\n            const splineConfig = this._getSplineConfig(splineType);\n            const maxDist = splineConfig.controlPointDeletionDistance;\n            if (splineConfig.controlPointDeletionEnabled === false) {\n                return;\n            }\n            const eventDetail = evt.detail;\n            const { element, currentPoints } = eventDetail;\n            const { canvas: canvasPos } = currentPoints;\n            const { instance: spline } = annotation.data.spline;\n            const closestControlPoint = spline.getClosestControlPointWithinDistance(canvasPos, maxDist);\n            if (!closestControlPoint) {\n                return;\n            }\n            this._deleteControlPointByIndex(element, annotation, closestControlPoint.index);\n        };\n        this._calculateCachedStats = (annotation, element) => {\n            if (!this.configuration.calculateStats) {\n                return;\n            }\n            const data = annotation.data;\n            if (!data.contour.closed) {\n                return;\n            }\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { cachedStats } = data;\n            const { polyline: points } = data.contour;\n            const targetIds = Object.keys(cachedStats);\n            for (let i = 0; i < targetIds.length; i++) {\n                const targetId = targetIds[i];\n                const image = this.getTargetImageData(targetId);\n                if (!image) {\n                    continue;\n                }\n                const { metadata } = image;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                const canvasPoint = canvasCoordinates[0];\n                const originalWorldPoint = viewport.canvasToWorld(canvasPoint);\n                const deltaXPoint = viewport.canvasToWorld([\n                    canvasPoint[0] + 1,\n                    canvasPoint[1],\n                ]);\n                const deltaYPoint = viewport.canvasToWorld([\n                    canvasPoint[0],\n                    canvasPoint[1] + 1,\n                ]);\n                const deltaInX = vec3.distance(originalWorldPoint, deltaXPoint);\n                const deltaInY = vec3.distance(originalWorldPoint, deltaYPoint);\n                const { imageData } = image;\n                const { scale, areaUnit } = getCalibratedLengthUnitsAndScale(image, () => {\n                    const { maxX: canvasMaxX, maxY: canvasMaxY, minX: canvasMinX, minY: canvasMinY, } = math.polyline.getAABB(canvasCoordinates);\n                    const topLeftBBWorld = viewport.canvasToWorld([\n                        canvasMinX,\n                        canvasMinY,\n                    ]);\n                    const topLeftBBIndex = utilities.transformWorldToIndex(imageData, topLeftBBWorld);\n                    const bottomRightBBWorld = viewport.canvasToWorld([\n                        canvasMaxX,\n                        canvasMaxY,\n                    ]);\n                    const bottomRightBBIndex = utilities.transformWorldToIndex(imageData, bottomRightBBWorld);\n                    return [topLeftBBIndex, bottomRightBBIndex];\n                });\n                let area = math.polyline.getArea(canvasCoordinates) / scale / scale;\n                area *= deltaInX * deltaInY;\n                cachedStats[targetId] = {\n                    Modality: metadata.Modality,\n                    area,\n                    areaUnit,\n                };\n            }\n            this.triggerAnnotationModified(annotation, enabledElement, ChangeTypes.StatsUpdated);\n            return cachedStats;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    addNewAnnotation(evt) {\n        const eventDetail = evt.detail;\n        const { currentPoints, element } = eventDetail;\n        const { canvas: canvasPos } = currentPoints;\n        const contourHoleProcessingEnabled = getMouseModifierKey(evt.detail.event) ===\n            this.configuration.contourHoleAdditionModifierKey;\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        const annotation = this.createAnnotation(evt);\n        this.isDrawing = true;\n        this.addAnnotation(annotation, element);\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            movingTextBox: false,\n            newAnnotation: true,\n            hasMoved: false,\n            lastCanvasPoint: canvasPos,\n            contourHoleProcessingEnabled,\n        };\n        this._activateDraw(element);\n        evt.preventDefault();\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        return annotation;\n    }\n    cancel(element) {\n        if (!this.isDrawing) {\n            return;\n        }\n        this.isDrawing = false;\n        this._deactivateDraw(element);\n        this._deactivateModify(element);\n        resetElementCursor(element);\n        const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n        if (newAnnotation) {\n            removeAnnotation(annotation.annotationUID);\n        }\n        super.cancelAnnotation(annotation);\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        this.editData = null;\n        return annotation.annotationUID;\n    }\n    isContourSegmentationTool() {\n        return false;\n    }\n    renderAnnotationInstance(renderContext) {\n        const { enabledElement, targetId, svgDrawingHelper, annotationStyle } = renderContext;\n        const { viewport } = enabledElement;\n        const { worldToCanvas } = viewport;\n        const { element } = viewport;\n        const annotation = renderContext.annotation;\n        const { annotationUID, data, highlighted } = annotation;\n        const { handles } = data;\n        const { points: controlPoints, activeHandleIndex } = handles;\n        const newAnnotation = this.editData?.newAnnotation;\n        const { lineWidth, lineDash, color, locked: annotationLocked, } = annotationStyle;\n        const canvasCoordinates = controlPoints.map((p) => worldToCanvas(p));\n        const { drawPreviewEnabled } = this.configuration.spline;\n        const splineType = annotation.data.spline.type;\n        const splineConfig = this._getSplineConfig(splineType);\n        const spline = annotation.data.spline.instance;\n        const childAnnotations = getChildAnnotations(annotation);\n        const missingAnnotation = childAnnotations.findIndex((it) => !it);\n        if (missingAnnotation !== -1) {\n            throw new Error(`Can't find annotation for child ${annotation.childAnnotationUIDs.join()}`);\n        }\n        const splineAnnotationsGroup = [annotation, ...childAnnotations].filter((annotation) => this._isSplineROIAnnotation(annotation));\n        splineAnnotationsGroup.forEach((annotation) => {\n            const spline = this._updateSplineInstance(element, annotation);\n            const splinePolylineCanvas = spline.getPolylinePoints();\n            this.updateContourPolyline(annotation, {\n                points: splinePolylineCanvas,\n                closed: data.contour.closed,\n                targetWindingDirection: ContourWindingDirection.Clockwise,\n            }, viewport, { updateWindingDirection: data.contour.closed });\n        });\n        super.renderAnnotationInstance(renderContext);\n        if (!data.cachedStats[targetId] ||\n            data.cachedStats[targetId].areaUnit == null) {\n            data.cachedStats[targetId] = {\n                Modality: null,\n                area: null,\n                areaUnit: null,\n            };\n            this._calculateCachedStats(annotation, element);\n        }\n        else if (annotation.invalidated) {\n            this._throttledCalculateCachedStats(annotation, element);\n        }\n        let activeHandleCanvasCoords;\n        if (!annotationLocked && !this.editData && activeHandleIndex !== null) {\n            activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n        }\n        if (activeHandleCanvasCoords || newAnnotation || highlighted) {\n            const handleGroupUID = '0';\n            drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates, {\n                color,\n                lineWidth,\n                handleRadius: '3',\n            });\n        }\n        if (drawPreviewEnabled &&\n            spline.numControlPoints > 1 &&\n            this.editData?.lastCanvasPoint &&\n            !spline.closed) {\n            const { lastCanvasPoint } = this.editData;\n            const previewPolylinePoints = spline.getPreviewPolylinePoints(lastCanvasPoint, SPLINE_CLICK_CLOSE_CURVE_DIST);\n            drawPolylineSvg(svgDrawingHelper, annotationUID, 'previewSplineChange', previewPolylinePoints, {\n                color: '#9EA0CA',\n                lineDash: lineDash,\n                lineWidth: 1,\n            });\n        }\n        if (splineConfig.showControlPointsConnectors) {\n            const controlPointsConnectors = [...canvasCoordinates];\n            if (spline.closed) {\n                controlPointsConnectors.push(canvasCoordinates[0]);\n            }\n            drawPolylineSvg(svgDrawingHelper, annotationUID, 'controlPointsConnectors', controlPointsConnectors, {\n                color: 'rgba(255, 255, 255, 0.5)',\n                lineWidth: 1,\n            });\n        }\n        this._renderStats(annotation, viewport, svgDrawingHelper, annotationStyle.textbox);\n        if (this.fireChangeOnUpdate?.annotationUID === annotationUID) {\n            this.triggerChangeEvent(annotation, enabledElement, this.fireChangeOnUpdate.changeType, this.fireChangeOnUpdate.contourHoleProcessingEnabled);\n            this.fireChangeOnUpdate = null;\n        }\n        annotation.invalidated = false;\n        return true;\n    }\n    createInterpolatedSplineControl(annotation) {\n        if (annotation.data.handles.points?.length) {\n            return;\n        }\n        const { polyline } = annotation.data.contour;\n        if (!polyline || !polyline.length) {\n            return;\n        }\n        annotation.data.handles.points = [];\n        const { points } = annotation.data.handles;\n        const increment = Math.max(10, Math.floor(polyline.length / 20));\n        for (let i = 0; i < polyline.length - increment; i += increment) {\n            points.push(polyline[i]);\n        }\n        points.push(polyline[polyline.length - 1]);\n    }\n    createAnnotation(evt) {\n        const contourAnnotation = super.createAnnotation(evt);\n        const { world: worldPos } = evt.detail.currentPoints;\n        const { type: splineType } = this.configuration.spline;\n        const splineConfig = this._getSplineConfig(splineType);\n        const spline = new splineConfig.Class();\n        const createSpline = () => ({\n            type: splineConfig.type,\n            instance: spline,\n            resolution: splineConfig.resolution,\n        });\n        let onInterpolationComplete;\n        if (this.configuration.interpolation?.enabled) {\n            onInterpolationComplete = (annotation) => {\n                annotation.data.spline ||= createSpline();\n                this.createInterpolatedSplineControl(annotation);\n            };\n        }\n        return utilities.deepMerge(contourAnnotation, {\n            data: {\n                handles: {\n                    points: [[...worldPos]],\n                },\n                spline: createSpline(),\n                cachedStats: {},\n            },\n            onInterpolationComplete,\n        });\n    }\n    _deleteControlPointByIndex(element, annotation, controlPointIndex) {\n        const enabledElement = getEnabledElement(element);\n        const { points: controlPoints } = annotation.data.handles;\n        if (controlPoints.length === 3) {\n            removeAnnotation(annotation.annotationUID);\n        }\n        else {\n            controlPoints.splice(controlPointIndex, 1);\n        }\n        const { renderingEngine } = enabledElement;\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        annotation.invalidated = true;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n    }\n    _isSplineROIAnnotation(annotation) {\n        return !!annotation.data?.spline;\n    }\n    _getSplineConfig(type) {\n        const { configuration: config } = this;\n        const splineConfigs = config.spline.configuration;\n        return Object.assign({ type }, DEFAULT_SPLINE_CONFIG, splineConfigs[type]);\n    }\n    _updateSplineInstance(element, annotation) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const { worldToCanvas } = viewport;\n        const { data } = annotation;\n        const { type: splineType, instance: spline } = annotation.data.spline;\n        const splineConfig = this._getSplineConfig(splineType);\n        const worldPoints = data.handles.points;\n        const canvasPoints = worldPoints.map(worldToCanvas);\n        const resolution = splineConfig.resolution !== undefined\n            ? parseInt(splineConfig.resolution)\n            : undefined;\n        const scale = splineConfig.scale !== undefined\n            ? parseFloat(splineConfig.scale)\n            : undefined;\n        spline.setControlPoints(canvasPoints);\n        spline.closed = !!data.contour.closed;\n        if (!spline.fixedResolution &&\n            resolution !== undefined &&\n            spline.resolution !== resolution) {\n            spline.resolution = resolution;\n            annotation.invalidated = true;\n        }\n        if (spline instanceof CardinalSpline &&\n            !spline.fixedScale &&\n            scale !== undefined &&\n            spline.scale !== scale) {\n            spline.scale = scale;\n            annotation.invalidated = true;\n        }\n        return spline;\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { area, isEmptyArea, areaUnit } = cachedVolumeStats;\n    const textLines = [];\n    if (area) {\n        const areaLine = isEmptyArea\n            ? `Area: Oblique not supported`\n            : `Area: ${utilities.roundNumber(area)} ${areaUnit}`;\n        textLines.push(areaLine);\n    }\n    return textLines;\n}\nSplineROITool.toolName = 'SplineROI';\nexport default SplineROITool;\n","import { utilities } from '@cornerstonejs/core';\nimport SplineROITool from './SplineROITool';\nclass SplineContourSegmentationTool extends SplineROITool {\n    constructor(toolProps) {\n        const initialProps = utilities.deepMerge({\n            configuration: {\n                calculateStats: false,\n            },\n        }, toolProps);\n        super(initialProps);\n    }\n    isContourSegmentationTool() {\n        return true;\n    }\n}\nSplineContourSegmentationTool.toolName = 'SplineContourSegmentationTool';\nexport default SplineContourSegmentationTool;\n","import { vec3 } from 'gl-matrix';\nimport { getEnabledElement, utilities as csUtils, VolumeViewport, utilities, triggerEvent, eventTarget, } from '@cornerstonejs/core';\nimport { removeAnnotation } from '../../stateManagement/annotation/annotationState';\nimport { drawHandles as drawHandlesSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { Events, KeyboardBindings, ChangeTypes } from '../../enums';\nimport { resetElementCursor } from '../../cursors/elementCursor';\nimport getMouseModifierKey from '../../eventDispatchers/shared/getMouseModifier';\nimport * as math from '../../utilities/math';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport findHandlePolylineIndex from '../../utilities/contours/findHandlePolylineIndex';\nimport { ContourWindingDirection } from '../../types/ContourAnnotation';\nimport { triggerAnnotationModified, triggerContourAnnotationCompleted, } from '../../stateManagement/annotation/helpers/state';\nimport { LivewireScissors } from '../../utilities/livewire/LivewireScissors';\nimport { LivewirePath } from '../../utilities/livewire/LiveWirePath';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport ContourSegmentationBaseTool from '../base/ContourSegmentationBaseTool';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport { getCalibratedLengthUnitsAndScale, throttle } from '../../utilities';\nconst CLICK_CLOSE_CURVE_SQR_DIST = 10 ** 2;\nclass LivewireContourTool extends ContourSegmentationBaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            getTextLines: defaultGetTextLines,\n            calculateStats: true,\n            preventHandleOutsideImage: false,\n            contourHoleAdditionModifierKey: KeyboardBindings.Shift,\n            snapHandleNearby: 2,\n            interpolation: {\n                enabled: false,\n                nearestEdge: 2,\n                showInterpolationPolyline: false,\n            },\n            decimate: {\n                enabled: false,\n                epsilon: 0.1,\n            },\n            actions: {\n                undo: {\n                    method: 'undo',\n                    bindings: [\n                        {\n                            key: 'Escape',\n                        },\n                    ],\n                },\n            },\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isHandleOutsideImage = false;\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const proximitySquared = proximity * proximity;\n            const canvasPoints = annotation.data.contour.polyline.map((p) => viewport.worldToCanvas(p));\n            let startPoint = canvasPoints[canvasPoints.length - 1];\n            for (let i = 0; i < canvasPoints.length; i++) {\n                const endPoint = canvasPoints[i];\n                const distanceToPointSquared = math.lineSegment.distanceToPointSquared(startPoint, endPoint, canvasCoords);\n                if (distanceToPointSquared <= proximitySquared) {\n                    return true;\n                }\n                startPoint = endPoint;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            this._activateModify(element);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation, handle) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { data } = annotation;\n            annotation.highlighted = true;\n            let movingTextBox = false;\n            let handleIndex;\n            if (handle.worldPosition) {\n                movingTextBox = true;\n            }\n            else {\n                const { points } = data.handles;\n                handleIndex = points.findIndex((p) => p === handle);\n            }\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex,\n                movingTextBox,\n            };\n            this._activateModify(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt, clearAnnotation = false) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, contourHoleProcessingEnabled, } = this.editData;\n            const { data } = annotation;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            if ((this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) ||\n                clearAnnotation) {\n                removeAnnotation(annotation.annotationUID);\n                this.clearEditData();\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                return;\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            const changeType = newAnnotation\n                ? ChangeTypes.Completed\n                : ChangeTypes.HandlesUpdated;\n            this.triggerChangeEvent(annotation, enabledElement, changeType, contourHoleProcessingEnabled);\n            this.clearEditData();\n        };\n        this.triggerChangeEvent = (annotation, enabledElement, changeType = ChangeTypes.StatsUpdated, contourHoleProcessingEnabled = false) => {\n            if (changeType === ChangeTypes.Completed) {\n                triggerContourAnnotationCompleted(annotation, contourHoleProcessingEnabled);\n            }\n            else {\n                triggerAnnotationModified(annotation, enabledElement.viewport.element, changeType);\n            }\n        };\n        this._mouseDownCallback = (evt) => {\n            const doubleClick = evt.type === Events.MOUSE_DOUBLE_CLICK;\n            const { annotation, viewportIdsToRender, worldToSlice, sliceToWorld } = this.editData;\n            if (this.editData.closed) {\n                return;\n            }\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { currentPoints } = eventDetail;\n            const { canvas: canvasPos, world: worldPosOriginal } = currentPoints;\n            let worldPos = worldPosOriginal;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            const controlPoints = this.editData.currentPath.getControlPoints();\n            let closePath = controlPoints.length >= 2 && doubleClick;\n            if (controlPoints.length >= 2) {\n                const closestHandlePoint = {\n                    index: -1,\n                    distSquared: Infinity,\n                };\n                for (let i = 0, len = controlPoints.length; i < len; i++) {\n                    const controlPoint = controlPoints[i];\n                    const worldControlPoint = sliceToWorld(controlPoint);\n                    const canvasControlPoint = viewport.worldToCanvas(worldControlPoint);\n                    const distSquared = math.point.distanceToPointSquared(canvasPos, canvasControlPoint);\n                    if (distSquared <= CLICK_CLOSE_CURVE_SQR_DIST &&\n                        distSquared < closestHandlePoint.distSquared) {\n                        closestHandlePoint.distSquared = distSquared;\n                        closestHandlePoint.index = i;\n                    }\n                }\n                if (closestHandlePoint.index === 0) {\n                    closePath = true;\n                }\n            }\n            const { snapHandleNearby } = this.configuration;\n            if (snapHandleNearby && !this.editData.closed) {\n                const currentPath = new LivewirePath();\n                const snapPoint = this.scissors.findMinNearby(worldToSlice(worldPosOriginal), 1);\n                const pathPoints = this.scissors.findPathToPoint(snapPoint);\n                currentPath.addPoints(pathPoints);\n                currentPath.prependPath(this.editData.confirmedPath);\n                worldPos = sliceToWorld(snapPoint);\n                this.editData.currentPath = currentPath;\n            }\n            this.editData.closed = this.editData.closed || closePath;\n            this.editData.confirmedPath = this.editData.currentPath;\n            const lastPoint = this.editData.currentPath.getLastPoint();\n            this.editData.confirmedPath.addControlPoint(lastPoint);\n            annotation.data.handles.points.push(sliceToWorld(lastPoint));\n            this.scissors.startSearch(worldToSlice(worldPos));\n            annotation.invalidated = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (this.editData.closed) {\n                this.updateAnnotation(this.editData.confirmedPath);\n                this._endCallback(evt);\n            }\n            evt.preventDefault();\n        };\n        this._mouseMoveCallback = (evt) => {\n            const { element, currentPoints } = evt.detail;\n            const { world: worldPos, canvas: canvasPos } = currentPoints;\n            const { renderingEngine } = getEnabledElement(element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData.lastCanvasPoint = canvasPos;\n            const { width: imgWidth, height: imgHeight } = this.scissors;\n            const { worldToSlice } = this.editData;\n            const slicePoint = worldToSlice(worldPos);\n            if (slicePoint[0] < 0 ||\n                slicePoint[1] < 0 ||\n                slicePoint[0] >= imgWidth ||\n                slicePoint[1] >= imgHeight) {\n                return;\n            }\n            const pathPoints = this.scissors.findPathToPoint(slicePoint);\n            const currentPath = new LivewirePath();\n            currentPath.addPoints(pathPoints);\n            currentPath.prependPath(this.editData.confirmedPath);\n            this.editData.currentPath = currentPath;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                console.warn('Drag annotation not implemented');\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                this.editHandle(worldPos, element, annotation, handleIndex);\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.cancel = (element) => {\n            if (!this.isDrawing) {\n                return;\n            }\n            this.isDrawing = false;\n            this._deactivateDraw(element);\n            this._deactivateModify(element);\n            resetElementCursor(element);\n            const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n            if (newAnnotation) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            this.editData = null;\n            this.scissors = null;\n            return annotation.annotationUID;\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_MOVE, this._mouseMoveCallback);\n            element.addEventListener(Events.MOUSE_DOWN, this._mouseDownCallback);\n            element.addEventListener(Events.MOUSE_DOUBLE_CLICK, this._mouseDownCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._mouseDownCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_MOVE, this._mouseMoveCallback);\n            element.removeEventListener(Events.MOUSE_DOWN, this._mouseDownCallback);\n            element.removeEventListener(Events.MOUSE_DOUBLE_CLICK, this._mouseDownCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._mouseDownCallback);\n        };\n        this._calculateCachedStats = (annotation, element) => {\n            if (!this.configuration.calculateStats) {\n                return;\n            }\n            const data = annotation.data;\n            if (!data.contour.closed) {\n                return;\n            }\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            const { cachedStats } = data;\n            const { polyline: points } = data.contour;\n            const targetIds = Object.keys(cachedStats);\n            for (let i = 0; i < targetIds.length; i++) {\n                const targetId = targetIds[i];\n                const image = this.getTargetImageData(targetId);\n                if (!image) {\n                    continue;\n                }\n                const { metadata } = image;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                const canvasPoint = canvasCoordinates[0];\n                const originalWorldPoint = viewport.canvasToWorld(canvasPoint);\n                const deltaXPoint = viewport.canvasToWorld([\n                    canvasPoint[0] + 1,\n                    canvasPoint[1],\n                ]);\n                const deltaYPoint = viewport.canvasToWorld([\n                    canvasPoint[0],\n                    canvasPoint[1] + 1,\n                ]);\n                const deltaInX = vec3.distance(originalWorldPoint, deltaXPoint);\n                const deltaInY = vec3.distance(originalWorldPoint, deltaYPoint);\n                const { imageData } = image;\n                const { scale, areaUnit } = getCalibratedLengthUnitsAndScale(image, () => {\n                    const { maxX: canvasMaxX, maxY: canvasMaxY, minX: canvasMinX, minY: canvasMinY, } = math.polyline.getAABB(canvasCoordinates);\n                    const topLeftBBWorld = viewport.canvasToWorld([\n                        canvasMinX,\n                        canvasMinY,\n                    ]);\n                    const topLeftBBIndex = utilities.transformWorldToIndex(imageData, topLeftBBWorld);\n                    const bottomRightBBWorld = viewport.canvasToWorld([\n                        canvasMaxX,\n                        canvasMaxY,\n                    ]);\n                    const bottomRightBBIndex = utilities.transformWorldToIndex(imageData, bottomRightBBWorld);\n                    return [topLeftBBIndex, bottomRightBBIndex];\n                });\n                let area = math.polyline.getArea(canvasCoordinates) / scale / scale;\n                area *= deltaInX * deltaInY;\n                cachedStats[targetId] = {\n                    Modality: metadata.Modality,\n                    area,\n                    areaUnit: areaUnit,\n                };\n            }\n            this.triggerAnnotationModified(annotation, enabledElement, ChangeTypes.StatsUpdated);\n            return cachedStats;\n        };\n        this._renderStats = (annotation, viewport, svgDrawingHelper, textboxStyle) => {\n            const data = annotation.data;\n            const targetId = this.getTargetId(viewport);\n            if (!data.contour.closed || !textboxStyle.visibility) {\n                return;\n            }\n            const textLines = this.configuration.getTextLines(data, targetId);\n            if (!textLines || textLines.length === 0) {\n                return;\n            }\n            const canvasCoordinates = data.handles.points.map((p) => viewport.worldToCanvas(p));\n            if (!data.handles.textBox.hasMoved) {\n                const canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                data.handles.textBox.worldPosition =\n                    viewport.canvasToWorld(canvasTextBoxCoords);\n            }\n            const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n            const textBoxUID = 'textBox';\n            const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotation.annotationUID ?? '', textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, textboxStyle);\n            const { x: left, y: top, width, height } = boundingBox;\n            data.handles.textBox.worldBoundingBox = {\n                topLeft: viewport.canvasToWorld([left, top]),\n                topRight: viewport.canvasToWorld([left + width, top]),\n                bottomLeft: viewport.canvasToWorld([left, top + height]),\n                bottomRight: viewport.canvasToWorld([left + width, top + height]),\n            };\n        };\n        this.triggerAnnotationModified = (annotation, enabledElement, changeType = ChangeTypes.StatsUpdated) => {\n            const { viewportId, renderingEngineId } = enabledElement;\n            const eventType = Events.ANNOTATION_MODIFIED;\n            const eventDetail = {\n                annotation,\n                viewportId,\n                renderingEngineId,\n                changeType,\n            };\n            triggerEvent(eventTarget, eventType, eventDetail);\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    setupBaseEditData(worldPos, element, annotation, nextPos, contourHoleProcessingEnabled) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        this.isDrawing = true;\n        const viewportImageData = viewport.getImageData();\n        const { imageData: vtkImageData } = viewportImageData;\n        let worldToSlice;\n        let sliceToWorld;\n        let width;\n        let height;\n        let scalarData;\n        if (!(viewport instanceof VolumeViewport)) {\n            width = viewportImageData.dimensions[0];\n            height = viewportImageData.dimensions[1];\n            worldToSlice = (point) => {\n                const ijkPoint = csUtils.transformWorldToIndex(vtkImageData, point);\n                return [ijkPoint[0], ijkPoint[1]];\n            };\n            sliceToWorld = (point) => csUtils.transformIndexToWorld(vtkImageData, [point[0], point[1], 0]);\n            scalarData = viewportImageData.scalarData;\n        }\n        else if (viewport instanceof VolumeViewport) {\n            const sliceImageData = csUtils.getCurrentVolumeViewportSlice(viewport);\n            const { sliceToIndexMatrix, indexToSliceMatrix } = sliceImageData;\n            worldToSlice = (point) => {\n                const ijkPoint = csUtils.transformWorldToIndex(vtkImageData, point);\n                const slicePoint = vec3.transformMat4([0, 0, 0], ijkPoint, indexToSliceMatrix);\n                return [slicePoint[0], slicePoint[1]];\n            };\n            sliceToWorld = (point) => {\n                const ijkPoint = vec3.transformMat4([0, 0, 0], [point[0], point[1], 0], sliceToIndexMatrix);\n                return csUtils.transformIndexToWorld(vtkImageData, ijkPoint);\n            };\n            scalarData = sliceImageData.scalarData;\n            width = sliceImageData.width;\n            height = sliceImageData.height;\n        }\n        else {\n            throw new Error('Viewport not supported');\n        }\n        scalarData = csUtils.convertToGrayscale(scalarData, width, height);\n        const { voiRange } = viewport.getProperties();\n        const startPos = worldToSlice(worldPos);\n        this.scissors = LivewireScissors.createInstanceFromRawPixelData(scalarData, width, height, voiRange);\n        if (nextPos) {\n            this.scissorsNext = LivewireScissors.createInstanceFromRawPixelData(scalarData, width, height, voiRange);\n            this.scissorsNext.startSearch(worldToSlice(nextPos));\n        }\n        this.scissors.startSearch(startPos);\n        const newAnnotation = !nextPos;\n        const confirmedPath = new LivewirePath();\n        const currentPath = new LivewirePath();\n        const currentPathNext = newAnnotation ? undefined : new LivewirePath();\n        confirmedPath.addPoint(startPos);\n        confirmedPath.addControlPoint(startPos);\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        const lastCanvasPoint = viewport.worldToCanvas(worldPos);\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            newAnnotation,\n            hasMoved: false,\n            lastCanvasPoint,\n            confirmedPath,\n            currentPath,\n            confirmedPathNext: currentPathNext,\n            closed: false,\n            handleIndex: this.editData?.handleIndex ?? annotation.handles?.activeHandleIndex,\n            worldToSlice,\n            sliceToWorld,\n            contourHoleProcessingEnabled,\n        };\n    }\n    addNewAnnotation(evt) {\n        const eventDetail = evt.detail;\n        const { currentPoints, element } = eventDetail;\n        const { world: worldPos } = currentPoints;\n        const annotation = this.createAnnotation(evt);\n        const contourHoleProcessingEnabled = getMouseModifierKey(evt.detail.event) ===\n            this.configuration.contourHoleAdditionModifierKey;\n        this.setupBaseEditData(worldPos, element, annotation, undefined, contourHoleProcessingEnabled);\n        this.addAnnotation(annotation, element);\n        this._activateDraw(element);\n        evt.preventDefault();\n        triggerAnnotationRenderForViewportIds(this.editData.viewportIdsToRender);\n        return annotation;\n    }\n    clearEditData() {\n        this.editData = null;\n        this.scissors = null;\n        this.scissorsNext = null;\n        this.isDrawing = false;\n    }\n    editHandle(worldPos, element, annotation, handleIndex) {\n        const { data } = annotation;\n        const { points: handlePoints } = data.handles;\n        const { length: numHandles } = handlePoints;\n        const previousHandle = handlePoints[(handleIndex - 1 + numHandles) % numHandles];\n        const nextHandle = handlePoints[(handleIndex + 1) % numHandles];\n        if (!this.editData?.confirmedPathNext) {\n            this.setupBaseEditData(previousHandle, element, annotation, nextHandle);\n            const { polyline } = data.contour;\n            const confirmedPath = new LivewirePath();\n            const confirmedPathNext = new LivewirePath();\n            const { worldToSlice } = this.editData;\n            const previousIndex = findHandlePolylineIndex(annotation, handleIndex - 1);\n            const nextIndex = findHandlePolylineIndex(annotation, handleIndex + 1);\n            if (nextIndex === -1 || previousIndex === -1) {\n                throw new Error(`Can't find handle index ${nextIndex === -1 && nextHandle} ${previousIndex === -1 && previousHandle}`);\n            }\n            if (handleIndex === 0) {\n                confirmedPathNext.addPoints(polyline.slice(nextIndex + 1, previousIndex).map(worldToSlice));\n            }\n            else {\n                confirmedPath.addPoints(polyline.slice(0, previousIndex + 1).map(worldToSlice));\n                confirmedPathNext.addPoints(polyline.slice(nextIndex, polyline.length).map(worldToSlice));\n            }\n            this.editData.confirmedPath = confirmedPath;\n            this.editData.confirmedPathNext = confirmedPathNext;\n        }\n        const { editData, scissors } = this;\n        const { worldToSlice, sliceToWorld } = editData;\n        const { activeHandleIndex } = data.handles;\n        if (activeHandleIndex === null || activeHandleIndex === undefined) {\n            data.handles.activeHandleIndex = handleIndex;\n        }\n        else if (activeHandleIndex !== handleIndex) {\n            throw new Error(`Trying to edit a different handle than the one currently being edited ${handleIndex}!==${data.handles.activeHandleIndex}`);\n        }\n        const slicePos = worldToSlice(worldPos);\n        if (slicePos[0] < 0 ||\n            slicePos[0] >= scissors.width ||\n            slicePos[1] < 0 ||\n            slicePos[1] >= scissors.height) {\n            return;\n        }\n        handlePoints[handleIndex] = sliceToWorld(slicePos);\n        const pathPointsLeft = scissors.findPathToPoint(slicePos);\n        const pathPointsRight = this.scissorsNext.findPathToPoint(slicePos);\n        const currentPath = new LivewirePath();\n        currentPath.prependPath(editData.confirmedPath);\n        if (handleIndex !== 0) {\n            currentPath.addPoints(pathPointsLeft);\n        }\n        currentPath.addPoints(pathPointsRight.reverse());\n        currentPath.appendPath(editData.confirmedPathNext);\n        if (handleIndex === 0) {\n            currentPath.addPoints(pathPointsLeft);\n        }\n        editData.currentPath = currentPath;\n        annotation.invalidated = true;\n        editData.hasMoved = true;\n        editData.closed = true;\n    }\n    renderAnnotation(enabledElement, svgDrawingHelper) {\n        this.updateAnnotation(this.editData?.currentPath);\n        return super.renderAnnotation(enabledElement, svgDrawingHelper);\n    }\n    isContourSegmentationTool() {\n        return false;\n    }\n    createAnnotation(evt) {\n        const contourSegmentationAnnotation = super.createAnnotation(evt);\n        const { world: worldPos } = evt.detail.currentPoints;\n        const annotation = csUtils.deepMerge(contourSegmentationAnnotation, {\n            data: {\n                handles: {\n                    points: [[...worldPos]],\n                },\n            },\n        });\n        return annotation;\n    }\n    undo(element, config, evt) {\n        if (!this.editData) {\n            return;\n        }\n        this._endCallback(evt, true);\n    }\n    renderAnnotationInstance(renderContext) {\n        const { annotation, enabledElement, svgDrawingHelper, annotationStyle, targetId, } = renderContext;\n        const { viewport } = enabledElement;\n        const { element } = viewport;\n        const { worldToCanvas } = viewport;\n        const { annotationUID, data, highlighted } = annotation;\n        const { handles } = data;\n        const newAnnotation = this.editData?.newAnnotation;\n        const { lineWidth, lineDash, color } = annotationStyle;\n        if (highlighted ||\n            (newAnnotation &&\n                annotation.annotationUID === this.editData?.annotation?.annotationUID)) {\n            const handleGroupUID = '0';\n            const canvasHandles = handles.points.map(worldToCanvas);\n            drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasHandles, {\n                color,\n                lineDash,\n                lineWidth,\n            });\n        }\n        super.renderAnnotationInstance(renderContext);\n        if (!data.cachedStats[targetId] ||\n            data.cachedStats[targetId].areaUnit == null) {\n            data.cachedStats[targetId] = {\n                Modality: null,\n                area: null,\n                areaUnit: null,\n            };\n            this._calculateCachedStats(annotation, element);\n        }\n        else if (annotation.invalidated) {\n            this._throttledCalculateCachedStats(annotation, element);\n        }\n        this._renderStats(annotation, viewport, svgDrawingHelper, annotationStyle.textbox);\n        return true;\n    }\n    updateAnnotation(livewirePath) {\n        if (!this.editData || !livewirePath) {\n            return;\n        }\n        const { annotation, sliceToWorld, worldToSlice, closed, newAnnotation } = this.editData;\n        let { pointArray: imagePoints } = livewirePath;\n        if (imagePoints.length > 1) {\n            imagePoints = [...imagePoints, imagePoints[0]];\n        }\n        const targetWindingDirection = newAnnotation && closed ? ContourWindingDirection.Clockwise : undefined;\n        this.updateContourPolyline(annotation, {\n            points: imagePoints,\n            closed,\n            targetWindingDirection,\n        }, {\n            canvasToWorld: sliceToWorld,\n            worldToCanvas: worldToSlice,\n        });\n    }\n}\nLivewireContourTool.toolName = 'LivewireContour';\nexport default LivewireContourTool;\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { area, areaUnit } = cachedVolumeStats;\n    const textLines = [];\n    if (area) {\n        const areaLine = `Area: ${csUtils.roundNumber(area)} ${areaUnit}`;\n        textLines.push(areaLine);\n    }\n    return textLines;\n}\n","import { utilities as csUtils } from '@cornerstonejs/core';\nimport LivewireContourTool from './LivewireContourTool';\nimport { LivewirePath } from '../../utilities/livewire/LiveWirePath';\nimport { triggerAnnotationModified } from '../../stateManagement/annotation/helpers/state';\nimport { ChangeTypes } from '../../enums';\nimport { drawPolyline as drawPolylineSvg } from '../../drawingSvg';\nclass LivewireContourSegmentationTool extends LivewireContourTool {\n    updateInterpolatedAnnotation(annotation, enabledElement) {\n        if (this.editData ||\n            !annotation.invalidated ||\n            !annotation.data.handles.interpolationSources) {\n            return;\n        }\n        annotation.data.contour.originalPolyline = annotation.data.contour.polyline;\n        queueMicrotask(() => {\n            if (!annotation.data.handles.interpolationSources) {\n                return;\n            }\n            const { points } = annotation.data.handles;\n            const { element } = enabledElement.viewport;\n            this.setupBaseEditData(points[0], element, annotation);\n            const { length: count } = points;\n            const { scissors } = this;\n            const { nearestEdge, repeatInterpolation } = this.configuration.interpolation;\n            annotation.data.handles.originalPoints = points;\n            const { worldToSlice, sliceToWorld } = this.editData;\n            const handleSmoothing = [];\n            if (nearestEdge) {\n                let lastPoint = worldToSlice(points[points.length - 1]);\n                points.forEach((point, hIndex) => {\n                    const testPoint = worldToSlice(point);\n                    lastPoint = testPoint;\n                    handleSmoothing.push(testPoint);\n                    scissors.startSearch(lastPoint);\n                    scissors.findPathToPoint(testPoint);\n                    scissors.findPathToPoint(worldToSlice(points[(hIndex + 3) % points.length]));\n                    const minPoint = scissors.findMinNearby(testPoint, nearestEdge);\n                    if (!csUtils.isEqual(testPoint, minPoint)) {\n                        handleSmoothing[hIndex] = minPoint;\n                        lastPoint = minPoint;\n                        points[hIndex] = sliceToWorld(minPoint);\n                    }\n                });\n            }\n            const acceptedPath = new LivewirePath();\n            for (let i = 0; i < count; i++) {\n                scissors.startSearch(worldToSlice(points[i]));\n                const path = scissors.findPathToPoint(worldToSlice(points[(i + 1) % count]));\n                acceptedPath.addPoints(path);\n            }\n            this.updateAnnotation(acceptedPath);\n            this.scissors = null;\n            this.scissorsNext = null;\n            this.editData = null;\n            annotation.data.handles.interpolationSources = null;\n            if (repeatInterpolation) {\n                triggerAnnotationModified(annotation, enabledElement.viewport.element, ChangeTypes.InterpolationUpdated);\n            }\n        });\n    }\n    renderAnnotationInstance(renderContext) {\n        const { enabledElement, svgDrawingHelper } = renderContext;\n        const annotation = renderContext.annotation;\n        const { annotationUID } = annotation;\n        const { viewport } = enabledElement;\n        const { worldToCanvas } = viewport;\n        const { showInterpolationPolyline } = this.configuration.interpolation || {};\n        this.updateInterpolatedAnnotation?.(annotation, enabledElement);\n        const { originalPolyline } = annotation.data.contour;\n        const rendered = super.renderAnnotationInstance(renderContext);\n        if (showInterpolationPolyline &&\n            originalPolyline &&\n            annotation.autoGenerated) {\n            const polylineCanvasPoints = originalPolyline.map(worldToCanvas);\n            polylineCanvasPoints.push(polylineCanvasPoints[0]);\n            drawPolylineSvg(svgDrawingHelper, annotationUID, 'interpolationContour-0', polylineCanvasPoints, {\n                color: '#70ffff',\n                lineWidth: 1,\n                fillOpacity: 0,\n            });\n        }\n        return rendered;\n    }\n    isContourSegmentationTool() {\n        return true;\n    }\n}\nLivewireContourSegmentationTool.toolName = 'LivewireContourSegmentationTool';\nexport default LivewireContourSegmentationTool;\n","import { Events } from '../../enums';\nimport { getEnabledElement, utilities as csUtils } from '@cornerstonejs/core';\nimport { AnnotationTool } from '../base';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport * as lineSegment from '../../utilities/math/line';\nimport { drawHandles as drawHandlesSvg, drawArrow as drawArrowSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nclass ArrowAnnotateTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            getTextCallback,\n            changeTextCallback,\n            preventHandleOutsideImage: false,\n            arrowFirst: true,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            hideElementCursor(element);\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const { arrowFirst } = this.configuration;\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                },\n                data: {\n                    text: '',\n                    handles: {\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                        arrowFirst,\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                    },\n                    label: '',\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 1,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const [point1, point2] = data.handles.points;\n            const canvasPoint1 = viewport.worldToCanvas(point1);\n            const canvasPoint2 = viewport.worldToCanvas(point2);\n            const line = {\n                start: {\n                    x: canvasPoint1[0],\n                    y: canvasPoint1[1],\n                },\n                end: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n            };\n            const distanceToPoint = lineSegment.distanceToPoint([line.start.x, line.start.y], [line.end.x, line.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            if (newAnnotation) {\n                this.configuration.getTextCallback((text) => {\n                    if (!text) {\n                        removeAnnotation(annotation.annotationUID);\n                        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                        this.editData = null;\n                        this.isDrawing = false;\n                        return;\n                    }\n                    annotation.data.text = text;\n                    triggerAnnotationCompleted(annotation);\n                    triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                });\n            }\n            else {\n                triggerAnnotationModified(annotation, element);\n            }\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                data.handles.points[handleIndex] = [...worldPos];\n                annotation.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.touchTapCallback = (evt) => {\n            if (evt.detail.taps == 2) {\n                this.doubleClickCallback(evt);\n            }\n        };\n        this.doubleClickCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            let annotations = getAnnotations(this.getToolName(), element);\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return;\n            }\n            const clickedAnnotation = annotations.find((annotation) => this.isPointNearTool(element, annotation, eventDetail.currentPoints.canvas, 6));\n            if (!clickedAnnotation) {\n                return;\n            }\n            const annotation = clickedAnnotation;\n            this.configuration.changeTextCallback(clickedAnnotation, evt.detail, this._doneChangingTextCallback.bind(this, element, annotation));\n            this.editData = null;\n            this.isDrawing = false;\n            evt.stopImmediatePropagation();\n            evt.preventDefault();\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { handles, text } = data;\n                const { points, activeHandleIndex } = handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                let activeHandleCanvasCoords;\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates, {\n                        color,\n                        lineWidth,\n                    });\n                }\n                const arrowUID = '1';\n                if (this.configuration.arrowFirst) {\n                    drawArrowSvg(svgDrawingHelper, annotationUID, arrowUID, canvasCoordinates[1], canvasCoordinates[0], {\n                        color,\n                        width: lineWidth,\n                        lineDash: lineDash,\n                    });\n                }\n                else {\n                    drawArrowSvg(svgDrawingHelper, annotationUID, arrowUID, canvasCoordinates[0], canvasCoordinates[1], {\n                        color,\n                        width: lineWidth,\n                        lineDash: lineDash,\n                    });\n                }\n                renderStatus = true;\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                if (!text) {\n                    continue;\n                }\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                if (!data.handles.textBox.hasMoved) {\n                    const canvasTextBoxCoords = canvasCoordinates[1];\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, [text], textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n    }\n    handleSelectedCallback(evt, annotation, handle) {\n        const eventDetail = evt.detail;\n        const { element } = eventDetail;\n        const { data } = annotation;\n        annotation.highlighted = true;\n        let movingTextBox = false;\n        let handleIndex;\n        if (handle.worldPosition) {\n            movingTextBox = true;\n        }\n        else {\n            handleIndex = data.handles.points.findIndex((p) => p === handle);\n        }\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            handleIndex,\n            movingTextBox,\n        };\n        this._activateModify(element);\n        hideElementCursor(element);\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        evt.preventDefault();\n    }\n    _doneChangingTextCallback(element, annotation, updatedText) {\n        annotation.data.text = updatedText;\n        const enabledElement = getEnabledElement(element);\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        triggerAnnotationModified(annotation, element);\n    }\n    _isInsideVolume(index1, index2, dimensions) {\n        return (csUtils.indexWithinDimensions(index1, dimensions) &&\n            csUtils.indexWithinDimensions(index2, dimensions));\n    }\n}\nfunction getTextCallback(doneChangingTextCallback) {\n    return doneChangingTextCallback(prompt('Enter your annotation:'));\n}\nfunction changeTextCallback(data, eventData, doneChangingTextCallback) {\n    return doneChangingTextCallback(prompt('Enter your annotation:'));\n}\nArrowAnnotateTool.toolName = 'ArrowAnnotate';\nexport default ArrowAnnotateTool;\n","import { Events } from '../../enums';\nimport { getEnabledElement, utilities as csUtils } from '@cornerstonejs/core';\nimport { AnnotationTool } from '../base';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport * as lineSegment from '../../utilities/math/line';\nimport angleBetweenLines from '../../utilities/math/angle/angleBetweenLines';\nimport { drawHandles as drawHandlesSvg, drawLine as drawLineSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nclass AngleTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            if (this.angleStartedNotYetCompleted) {\n                return;\n            }\n            this.angleStartedNotYetCompleted = true;\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            hideElementCursor(element);\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                },\n                data: {\n                    handles: {\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                    },\n                    label: '',\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 1,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const [point1, point2, point3] = data.handles.points;\n            const canvasPoint1 = viewport.worldToCanvas(point1);\n            const canvasPoint2 = viewport.worldToCanvas(point2);\n            const line1 = {\n                start: {\n                    x: canvasPoint1[0],\n                    y: canvasPoint1[1],\n                },\n                end: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n            };\n            const distanceToPoint = lineSegment.distanceToPoint([line1.start.x, line1.start.y], [line1.end.x, line1.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n            if (!point3) {\n                return false;\n            }\n            const canvasPoint3 = viewport.worldToCanvas(point3);\n            const line2 = {\n                start: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n                end: {\n                    x: canvasPoint3[0],\n                    y: canvasPoint3[1],\n                },\n            };\n            const distanceToPoint2 = lineSegment.distanceToPoint([line2.start.x, line2.start.y], [line2.end.x, line2.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint2 <= proximity) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            if (this.angleStartedNotYetCompleted && data.handles.points.length === 2) {\n                this.editData.handleIndex = 2;\n                return;\n            }\n            this.angleStartedNotYetCompleted = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                data.handles.points[handleIndex] = [...worldPos];\n                annotation.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                this.angleStartedNotYetCompleted = false;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points, activeHandleIndex } = data.handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].angle == null) {\n                    data.cachedStats[targetId] = {\n                        angle: null,\n                    };\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationLocked(annotation.annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates, {\n                        color,\n                        lineDash,\n                        lineWidth,\n                    });\n                }\n                let lineUID = '1';\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], canvasCoordinates[1], {\n                    color,\n                    width: lineWidth,\n                    lineDash,\n                });\n                renderStatus = true;\n                if (canvasCoordinates.length !== 3) {\n                    return renderStatus;\n                }\n                lineUID = '2';\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[1], canvasCoordinates[2], {\n                    color,\n                    width: lineWidth,\n                    lineDash,\n                });\n                if (!data.cachedStats[targetId]?.angle) {\n                    continue;\n                }\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!data.handles.textBox.hasMoved) {\n                    const canvasTextBoxCoords = canvasCoordinates[1];\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    handleSelectedCallback(evt, annotation, handle) {\n        const eventDetail = evt.detail;\n        const { element } = eventDetail;\n        const { data } = annotation;\n        annotation.highlighted = true;\n        let movingTextBox = false;\n        let handleIndex;\n        if (handle.worldPosition) {\n            movingTextBox = true;\n        }\n        else {\n            handleIndex = data.handles.points.findIndex((p) => p === handle);\n        }\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            handleIndex,\n            movingTextBox,\n        };\n        this._activateModify(element);\n        hideElementCursor(element);\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        evt.preventDefault();\n    }\n    _calculateCachedStats(annotation, renderingEngine, enabledElement) {\n        const data = annotation.data;\n        const { element } = enabledElement.viewport;\n        if (data.handles.points.length !== 3) {\n            return;\n        }\n        const worldPos1 = data.handles.points[0];\n        const worldPos2 = data.handles.points[1];\n        const worldPos3 = data.handles.points[2];\n        const { cachedStats } = data;\n        const targetIds = Object.keys(cachedStats);\n        for (let i = 0; i < targetIds.length; i++) {\n            const targetId = targetIds[i];\n            const angle = angleBetweenLines([worldPos1, worldPos2], [worldPos2, worldPos3]);\n            const { dimensions, imageData } = this.getTargetImageData(targetId);\n            this.isHandleOutsideImage = [worldPos1, worldPos2, worldPos3]\n                .map((worldPos) => csUtils.transformWorldToIndex(imageData, worldPos))\n                .some((index) => !csUtils.indexWithinDimensions(index, dimensions));\n            cachedStats[targetId] = {\n                angle: isNaN(angle) ? 'Incomplete Angle' : angle,\n            };\n        }\n        annotation.invalidated = false;\n        triggerAnnotationModified(annotation, element);\n        return cachedStats;\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { angle } = cachedVolumeStats;\n    if (angle === undefined) {\n        return;\n    }\n    if (isNaN(angle)) {\n        return [`${angle}`];\n    }\n    const textLines = [\n        `${csUtils.roundNumber(angle)} ${String.fromCharCode(176)}`,\n    ];\n    return textLines;\n}\nAngleTool.toolName = 'Angle';\nexport default AngleTool;\n","import { vec3 } from 'gl-matrix';\nimport { Events } from '../../enums';\nimport { getEnabledElement } from '@cornerstonejs/core';\nimport { AnnotationTool } from '../base';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport * as lineSegment from '../../utilities/math/line';\nimport angleBetweenLines from '../../utilities/math/angle/angleBetweenLines';\nimport { midPoint2 } from '../../utilities/math/midPoint';\nimport { drawHandles as drawHandlesSvg, drawLine as drawLineSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, drawTextBox as drawTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nclass CobbAngleTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n            showArcLines: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            if (this.angleStartedNotYetCompleted) {\n                return;\n            }\n            this.angleStartedNotYetCompleted = true;\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            hideElementCursor(element);\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                },\n                data: {\n                    handles: {\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                    },\n                    label: '',\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 1,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { distanceToPoint, distanceToPoint2 } = this.distanceToLines({\n                viewport,\n                points: data.handles.points,\n                canvasCoords,\n                proximity,\n            });\n            if (distanceToPoint <= proximity || distanceToPoint2 <= proximity) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation, interactionType, canvasCoords, proximity = 6) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const { isNearFirstLine, isNearSecondLine } = this.distanceToLines({\n                viewport,\n                points: annotation.data.handles.points,\n                canvasCoords,\n                proximity,\n            });\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n                isNearFirstLine,\n                isNearSecondLine,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._mouseUpCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            if (this.angleStartedNotYetCompleted && data.handles.points.length < 4) {\n                resetElementCursor(element);\n                this.editData.handleIndex = data.handles.points.length;\n                return;\n            }\n            this.angleStartedNotYetCompleted = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._mouseDownCallback = (evt) => {\n            const { annotation, handleIndex } = this.editData;\n            const eventDetail = evt.detail;\n            const { element, currentPoints } = eventDetail;\n            const worldPos = currentPoints.world;\n            const { data } = annotation;\n            if (handleIndex === 1) {\n                data.handles.points[1] = worldPos;\n                this.editData.hasMoved =\n                    data.handles.points[1][0] !== data.handles.points[0][0] ||\n                        data.handles.points[1][1] !== data.handles.points[0][0];\n                return;\n            }\n            if (handleIndex === 3) {\n                data.handles.points[3] = worldPos;\n                this.editData.hasMoved =\n                    data.handles.points[3][0] !== data.handles.points[2][0] ||\n                        data.handles.points[3][1] !== data.handles.points[2][0];\n                this.angleStartedNotYetCompleted = false;\n                return;\n            }\n            this.editData.hasMoved = false;\n            hideElementCursor(element);\n            data.handles.points[2] = data.handles.points[3] = worldPos;\n            this.editData.handleIndex = data.handles.points.length - 1;\n        };\n        this._mouseDragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox, isNearFirstLine, isNearSecondLine, } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined &&\n                (isNearFirstLine || isNearSecondLine)) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                if (isNearFirstLine) {\n                    const firstLinePoints = [points[0], points[1]];\n                    firstLinePoints.forEach((point) => {\n                        point[0] += worldPosDelta[0];\n                        point[1] += worldPosDelta[1];\n                        point[2] += worldPosDelta[2];\n                    });\n                }\n                else if (isNearSecondLine) {\n                    const secondLinePoints = [points[2], points[3]];\n                    secondLinePoints.forEach((point) => {\n                        point[0] += worldPosDelta[0];\n                        point[1] += worldPosDelta[1];\n                        point[2] += worldPosDelta[2];\n                    });\n                }\n                annotation.invalidated = true;\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                data.handles.points[handleIndex] = [...worldPos];\n                annotation.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.cancel = (element) => {\n            if (!this.isDrawing) {\n                return;\n            }\n            this.isDrawing = false;\n            this._deactivateDraw(element);\n            this._deactivateModify(element);\n            resetElementCursor(element);\n            const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n            const { data } = annotation;\n            if (data.handles.points.length < 4) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            annotation.highlighted = false;\n            data.handles.activeHandleIndex = null;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            this.angleStartedNotYetCompleted = false;\n            return annotation.annotationUID;\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._mouseUpCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._mouseDragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._mouseUpCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._mouseUpCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._mouseDragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._mouseUpCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._mouseUpCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._mouseDragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._mouseDragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._mouseUpCallback);\n            element.addEventListener(Events.MOUSE_DOWN, this._mouseDownCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._mouseUpCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._mouseDragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._mouseDragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._mouseUpCallback);\n            element.removeEventListener(Events.MOUSE_DOWN, this._mouseDownCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points, activeHandleIndex } = data.handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].angle == null) {\n                    data.cachedStats[targetId] = {\n                        angle: null,\n                        arc1Angle: null,\n                        arc2Angle: null,\n                        points: {\n                            world: {\n                                arc1Start: null,\n                                arc1End: null,\n                                arc2Start: null,\n                                arc2End: null,\n                                arc1Angle: null,\n                                arc2Angle: null,\n                            },\n                            canvas: {\n                                arc1Start: null,\n                                arc1End: null,\n                                arc2Start: null,\n                                arc2End: null,\n                                arc1Angle: null,\n                                arc2Angle: null,\n                            },\n                        },\n                    };\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates, {\n                        color,\n                        lineDash,\n                        lineWidth,\n                    });\n                }\n                const firstLine = [canvasCoordinates[0], canvasCoordinates[1]];\n                const secondLine = [canvasCoordinates[2], canvasCoordinates[3]];\n                let lineUID = 'line1';\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, firstLine[0], firstLine[1], {\n                    color,\n                    width: lineWidth,\n                    lineDash,\n                });\n                renderStatus = true;\n                if (canvasCoordinates.length < 4) {\n                    return renderStatus;\n                }\n                lineUID = 'line2';\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, secondLine[0], secondLine[1], {\n                    color,\n                    width: lineWidth,\n                    lineDash,\n                });\n                lineUID = 'linkLine';\n                const mid1 = midPoint2(firstLine[0], firstLine[1]);\n                const mid2 = midPoint2(secondLine[0], secondLine[1]);\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, mid1, mid2, {\n                    color,\n                    lineWidth: '1',\n                    lineDash: '1,4',\n                });\n                const { arc1Start, arc1End, arc2End, arc2Start } = data.cachedStats[targetId].points.canvas;\n                const { arc1Angle, arc2Angle } = data.cachedStats[targetId];\n                if (this.configuration.showArcLines) {\n                    lineUID = 'arc1';\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, arc1Start, arc1End, {\n                        color,\n                        lineWidth: '1',\n                    });\n                    lineUID = 'arc2';\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, arc2Start, arc2End, {\n                        color,\n                        lineWidth: '1',\n                    });\n                }\n                if (!data.cachedStats[targetId]?.angle) {\n                    continue;\n                }\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!data.handles.textBox.hasMoved) {\n                    const canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = 'cobbAngleText';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n                if (this.configuration.showArcLines) {\n                    const arc1TextBoxUID = 'arcAngle1';\n                    const arc1TextLine = [\n                        `${arc1Angle.toFixed(2)} ${String.fromCharCode(176)}`,\n                    ];\n                    const arch1TextPosCanvas = midPoint2(arc1Start, arc1End);\n                    drawTextBoxSvg(svgDrawingHelper, annotationUID, arc1TextBoxUID, arc1TextLine, arch1TextPosCanvas, {\n                        ...options,\n                        padding: 3,\n                    });\n                    const arc2TextBoxUID = 'arcAngle2';\n                    const arc2TextLine = [\n                        `${arc2Angle.toFixed(2)} ${String.fromCharCode(176)}`,\n                    ];\n                    const arch2TextPosCanvas = midPoint2(arc2Start, arc2End);\n                    drawTextBoxSvg(svgDrawingHelper, annotationUID, arc2TextBoxUID, arc2TextLine, arch2TextPosCanvas, {\n                        ...options,\n                        padding: 3,\n                    });\n                }\n            }\n            return renderStatus;\n        };\n        this.distanceToLines = ({ viewport, points, canvasCoords, proximity }) => {\n            const [point1, point2, point3, point4] = points;\n            const canvasPoint1 = viewport.worldToCanvas(point1);\n            const canvasPoint2 = viewport.worldToCanvas(point2);\n            const canvasPoint3 = viewport.worldToCanvas(point3);\n            const canvasPoint4 = viewport.worldToCanvas(point4);\n            const line1 = {\n                start: {\n                    x: canvasPoint1[0],\n                    y: canvasPoint1[1],\n                },\n                end: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n            };\n            const line2 = {\n                start: {\n                    x: canvasPoint3[0],\n                    y: canvasPoint3[1],\n                },\n                end: {\n                    x: canvasPoint4[0],\n                    y: canvasPoint4[1],\n                },\n            };\n            const distanceToPoint = lineSegment.distanceToPoint([line1.start.x, line1.start.y], [line1.end.x, line1.end.y], [canvasCoords[0], canvasCoords[1]]);\n            const distanceToPoint2 = lineSegment.distanceToPoint([line2.start.x, line2.start.y], [line2.end.x, line2.end.y], [canvasCoords[0], canvasCoords[1]]);\n            let isNearFirstLine = false;\n            let isNearSecondLine = false;\n            if (distanceToPoint <= proximity) {\n                isNearFirstLine = true;\n            }\n            else if (distanceToPoint2 <= proximity) {\n                isNearSecondLine = true;\n            }\n            return {\n                distanceToPoint,\n                distanceToPoint2,\n                isNearFirstLine,\n                isNearSecondLine,\n            };\n        };\n        this.getArcsStartEndPoints = ({ firstLine, secondLine, mid1, mid2, }) => {\n            const linkLine = [mid1, mid2];\n            const arc1Angle = angleBetweenLines(firstLine, linkLine);\n            const arc2Angle = angleBetweenLines(secondLine, linkLine);\n            const arc1Side = arc1Angle > 90 ? 1 : 0;\n            const arc2Side = arc2Angle > 90 ? 0 : 1;\n            const midLinkLine = midPoint2(linkLine[0], linkLine[1]);\n            const linkLineLength = Math.sqrt((linkLine[1][0] - linkLine[0][0]) ** 2 +\n                (linkLine[1][1] - linkLine[0][1]) ** 2);\n            const ratio = 0.1;\n            const midFirstLine = midPoint2(firstLine[0], firstLine[1]);\n            const midSecondLine = midPoint2(secondLine[0], secondLine[1]);\n            const directionVectorStartArc1 = [\n                firstLine[arc1Side][0] - midFirstLine[0],\n                firstLine[arc1Side][1] - midFirstLine[1],\n            ];\n            const magnitudeStartArc1 = Math.sqrt(directionVectorStartArc1[0] ** 2 + directionVectorStartArc1[1] ** 2);\n            const normalizedDirectionStartArc1 = [\n                directionVectorStartArc1[0] / magnitudeStartArc1,\n                directionVectorStartArc1[1] / magnitudeStartArc1,\n            ];\n            const arc1Start = [\n                midFirstLine[0] +\n                    normalizedDirectionStartArc1[0] * linkLineLength * ratio,\n                midFirstLine[1] +\n                    normalizedDirectionStartArc1[1] * linkLineLength * ratio,\n            ];\n            const directionVectorEndArc1 = [\n                midLinkLine[0] - mid1[0],\n                midLinkLine[1] - mid1[1],\n            ];\n            const magnitudeEndArc1 = Math.sqrt(directionVectorEndArc1[0] ** 2 + directionVectorEndArc1[1] ** 2);\n            const normalizedDirectionEndArc1 = [\n                directionVectorEndArc1[0] / magnitudeEndArc1,\n                directionVectorEndArc1[1] / magnitudeEndArc1,\n            ];\n            const arc1End = [\n                mid1[0] + normalizedDirectionEndArc1[0] * linkLineLength * ratio,\n                mid1[1] + normalizedDirectionEndArc1[1] * linkLineLength * ratio,\n            ];\n            const directionVectorStartArc2 = [\n                secondLine[arc2Side][0] - midSecondLine[0],\n                secondLine[arc2Side][1] - midSecondLine[1],\n            ];\n            const magnitudeStartArc2 = Math.sqrt(directionVectorStartArc2[0] ** 2 + directionVectorStartArc2[1] ** 2);\n            const normalizedDirectionStartArc2 = [\n                directionVectorStartArc2[0] / magnitudeStartArc2,\n                directionVectorStartArc2[1] / magnitudeStartArc2,\n            ];\n            const arc2Start = [\n                midSecondLine[0] +\n                    normalizedDirectionStartArc2[0] * linkLineLength * ratio,\n                midSecondLine[1] +\n                    normalizedDirectionStartArc2[1] * linkLineLength * ratio,\n            ];\n            const directionVectorEndArc2 = [\n                midLinkLine[0] - mid2[0],\n                midLinkLine[1] - mid2[1],\n            ];\n            const magnitudeEndArc2 = Math.sqrt(directionVectorEndArc2[0] ** 2 + directionVectorEndArc2[1] ** 2);\n            const normalizedDirectionEndArc2 = [\n                directionVectorEndArc2[0] / magnitudeEndArc2,\n                directionVectorEndArc2[1] / magnitudeEndArc2,\n            ];\n            const arc2End = [\n                mid2[0] + normalizedDirectionEndArc2[0] * linkLineLength * ratio,\n                mid2[1] + normalizedDirectionEndArc2[1] * linkLineLength * ratio,\n            ];\n            return {\n                arc1Start,\n                arc1End,\n                arc2Start,\n                arc2End,\n                arc1Angle: arc1Angle > 90 ? 180 - arc1Angle : arc1Angle,\n                arc2Angle: arc2Angle > 90 ? 180 - arc2Angle : arc2Angle,\n            };\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 25, { trailing: true });\n    }\n    handleSelectedCallback(evt, annotation, handle, interactionType = 'mouse') {\n        const eventDetail = evt.detail;\n        const { element } = eventDetail;\n        const { data } = annotation;\n        annotation.highlighted = true;\n        let movingTextBox = false;\n        let handleIndex;\n        if (handle.worldPosition) {\n            movingTextBox = true;\n        }\n        else {\n            handleIndex = data.handles.points.findIndex((p) => p === handle);\n        }\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            handleIndex,\n            movingTextBox,\n        };\n        this._activateModify(element);\n        hideElementCursor(element);\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        evt.preventDefault();\n    }\n    _calculateCachedStats(annotation, renderingEngine, enabledElement) {\n        const data = annotation.data;\n        if (data.handles.points.length !== 4) {\n            return;\n        }\n        const seg1 = [null, null];\n        const seg2 = [null, null];\n        let minDist = Number.MAX_VALUE;\n        for (let i = 0; i < 2; i += 1) {\n            for (let j = 2; j < 4; j += 1) {\n                const dist = vec3.distance(data.handles.points[i], data.handles.points[j]);\n                if (dist < minDist) {\n                    minDist = dist;\n                    seg1[1] = data.handles.points[i];\n                    seg1[0] = data.handles.points[(i + 1) % 2];\n                    seg2[0] = data.handles.points[j];\n                    seg2[1] = data.handles.points[2 + ((j - 1) % 2)];\n                }\n            }\n        }\n        const { viewport } = enabledElement;\n        const { element } = viewport;\n        const canvasPoints = data.handles.points.map((p) => viewport.worldToCanvas(p));\n        const firstLine = [canvasPoints[0], canvasPoints[1]];\n        const secondLine = [canvasPoints[2], canvasPoints[3]];\n        const mid1 = midPoint2(firstLine[0], firstLine[1]);\n        const mid2 = midPoint2(secondLine[0], secondLine[1]);\n        const { arc1Start, arc1End, arc2End, arc2Start, arc1Angle, arc2Angle } = this.getArcsStartEndPoints({\n            firstLine,\n            secondLine,\n            mid1,\n            mid2,\n        });\n        const { cachedStats } = data;\n        const targetIds = Object.keys(cachedStats);\n        for (let i = 0; i < targetIds.length; i++) {\n            const targetId = targetIds[i];\n            cachedStats[targetId] = {\n                angle: angleBetweenLines(seg1, seg2),\n                arc1Angle,\n                arc2Angle,\n                points: {\n                    canvas: {\n                        arc1Start,\n                        arc1End,\n                        arc2End,\n                        arc2Start,\n                    },\n                    world: {\n                        arc1Start: viewport.canvasToWorld(arc1Start),\n                        arc1End: viewport.canvasToWorld(arc1End),\n                        arc2End: viewport.canvasToWorld(arc2End),\n                        arc2Start: viewport.canvasToWorld(arc2Start),\n                    },\n                },\n            };\n        }\n        annotation.invalidated = false;\n        triggerAnnotationModified(annotation, element);\n        return cachedStats;\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { angle } = cachedVolumeStats;\n    if (angle === undefined) {\n        return;\n    }\n    const textLines = [`${angle.toFixed(2)} ${String.fromCharCode(176)}`];\n    return textLines;\n}\nCobbAngleTool.toolName = 'CobbAngle';\nexport default CobbAngleTool;\n","import { Events } from '../../enums';\nimport { getEnabledElement, utilities as csUtils, StackViewport, } from '@cornerstonejs/core';\nimport { AnnotationTool } from '../base';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { drawHandle as drawHandleSvg, drawLine as drawLineSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { distanceToPoint } from '../../utilities/math/point';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport { getCalibratedProbeUnitsAndValue } from '../../utilities/getCalibratedUnits';\nconst { transformWorldToIndex } = csUtils;\nclass UltrasoundDirectionalTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n            displayBothAxesDistances: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            if (this.startedDrawing) {\n                return;\n            }\n            this.startedDrawing = true;\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            if (!(viewport instanceof StackViewport)) {\n                throw new Error('UltrasoundDirectionalTool can only be used on a StackViewport');\n            }\n            hideElementCursor(element);\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                },\n                data: {\n                    handles: {\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                    },\n                    label: '',\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 1,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            return false;\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            if (this.startedDrawing && data.handles.points.length === 1) {\n                this.editData.handleIndex = 1;\n                return;\n            }\n            this.startedDrawing = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const worldPos = currentPoints.world;\n                data.handles.points[handleIndex] = [...worldPos];\n                annotation.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                this.startedDrawing = false;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points } = data.handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].xValues == null) {\n                    data.cachedStats[targetId] = {\n                        xValues: [0, 0],\n                        yValues: [0, 0],\n                        isHorizontal: false,\n                        units: [''],\n                        isUnitless: false,\n                    };\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let handleGroupUID = '0';\n                drawHandleSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates[0], {\n                    color,\n                }, 0);\n                renderStatus = true;\n                if (canvasCoordinates.length !== 2) {\n                    return renderStatus;\n                }\n                handleGroupUID = '1';\n                drawHandleSvg(svgDrawingHelper, annotationUID, handleGroupUID, canvasCoordinates[1], {\n                    color,\n                }, 1);\n                const isUnitless = data.cachedStats[targetId].isUnitless;\n                if (!isUnitless) {\n                    const canvasPoint1 = canvasCoordinates[0];\n                    const canvasPoint2 = canvasCoordinates[1];\n                    const canvasDeltaY = canvasPoint2[1] - canvasPoint1[1];\n                    const canvasDeltaX = canvasPoint2[0] - canvasPoint1[0];\n                    const isHorizontal = data.cachedStats[targetId].isHorizontal;\n                    let projectedPointCanvas = [0, 0];\n                    if (isHorizontal) {\n                        projectedPointCanvas = [\n                            canvasPoint1[0] + canvasDeltaX,\n                            canvasPoint1[1],\n                        ];\n                    }\n                    else {\n                        projectedPointCanvas = [\n                            canvasPoint1[0],\n                            canvasPoint1[1] + canvasDeltaY,\n                        ];\n                    }\n                    let dataId = `${annotationUID}-line-1`;\n                    let lineUID = '1';\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], projectedPointCanvas, {\n                        color,\n                        width: 1,\n                        shadow: this.configuration.shadow,\n                    }, dataId);\n                    dataId = `${annotationUID}-line-2`;\n                    lineUID = '2';\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[1], projectedPointCanvas, {\n                        color,\n                        width: 1,\n                        lineDash: [1, 1],\n                        shadow: this.configuration.shadow,\n                    }, dataId);\n                }\n                else {\n                    const dataId = `${annotationUID}-line-1`;\n                    const lineUID = '1';\n                    drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], canvasCoordinates[1], {\n                        color,\n                        width: 1,\n                        shadow: this.configuration.shadow,\n                    }, dataId);\n                }\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId, this.configuration);\n                if (!data.handles.textBox.hasMoved) {\n                    const canvasTextBoxCoords = canvasCoordinates[1];\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    toolSelectedCallback(evt, annotation, interactionType, canvasCoords) {\n        return;\n    }\n    handleSelectedCallback(evt, annotation, handle) {\n        const eventDetail = evt.detail;\n        const { element } = eventDetail;\n        const { data } = annotation;\n        annotation.highlighted = true;\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        let movingTextBox = false;\n        let handleIndex;\n        if (handle.worldPosition) {\n            movingTextBox = true;\n        }\n        else {\n            handleIndex = data.handles.points.findIndex((p) => p === handle);\n        }\n        this.editData = {\n            handleIndex,\n            annotation,\n            viewportIdsToRender,\n        };\n        this._activateModify(element);\n        hideElementCursor(element);\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        evt.preventDefault();\n    }\n    _calculateCachedStats(annotation, renderingEngine, enabledElement) {\n        const data = annotation.data;\n        const { element } = enabledElement.viewport;\n        if (data.handles.points.length !== 2) {\n            return;\n        }\n        const { cachedStats } = data;\n        const targetIds = Object.keys(cachedStats);\n        for (let i = 0; i < targetIds.length; i++) {\n            const targetId = targetIds[i];\n            const image = this.getTargetImageData(targetId);\n            if (!image) {\n                continue;\n            }\n            const { imageData } = image;\n            const worldPos1 = data.handles.points[0];\n            const worldPos2 = data.handles.points[1];\n            const imageIndex1 = transformWorldToIndex(imageData, worldPos1);\n            const imageIndex2 = transformWorldToIndex(imageData, worldPos2);\n            const { values: values1, units: units1 } = getCalibratedProbeUnitsAndValue(image, [imageIndex1]);\n            const { values: values2, units: units2 } = getCalibratedProbeUnitsAndValue(image, [imageIndex2]);\n            let xValues, yValues, units, isHorizontal;\n            let isUnitless = false;\n            if (units1[0] !== units2[0] ||\n                units1[1] !== units2[1] ||\n                (units1[0] === 'raw' && units2[0] === 'raw')) {\n                const value = distanceToPoint(worldPos1, worldPos2);\n                xValues = [value, 0];\n                yValues = [value, 0];\n                units = ['px'];\n                isUnitless = true;\n            }\n            else {\n                const canvasPoint1 = enabledElement.viewport.worldToCanvas(worldPos1);\n                const canvasPoint2 = enabledElement.viewport.worldToCanvas(worldPos2);\n                const canvasDeltaY = canvasPoint2[1] - canvasPoint1[1];\n                const canvasDeltaX = canvasPoint2[0] - canvasPoint1[0];\n                isHorizontal = Math.abs(canvasDeltaX) > Math.abs(canvasDeltaY);\n                xValues = [values1[0], values2[0]];\n                yValues = [values1[1], values2[1]];\n                units = [units1[0], units1[1]];\n            }\n            cachedStats[targetId] = {\n                xValues,\n                yValues,\n                isHorizontal,\n                units,\n                isUnitless,\n            };\n        }\n        annotation.invalidated = false;\n        triggerAnnotationModified(annotation, element);\n        return cachedStats;\n    }\n}\nfunction defaultGetTextLines(data, targetId, configuration) {\n    const cachedStats = data.cachedStats[targetId];\n    const { xValues, yValues, units, isUnitless, isHorizontal } = cachedStats;\n    if (isUnitless) {\n        return [`${csUtils.roundNumber(xValues[0])} px`];\n    }\n    if (configuration.displayBothAxesDistances) {\n        const dist1 = Math.abs(xValues[1] - xValues[0]);\n        const dist2 = Math.abs(yValues[1] - yValues[0]);\n        return [\n            `${csUtils.roundNumber(dist1)} ${units[0]}`,\n            `${csUtils.roundNumber(dist2)} ${units[1]}`,\n        ];\n    }\n    if (isHorizontal) {\n        const dist = Math.abs(xValues[1] - xValues[0]);\n        return [`${csUtils.roundNumber(dist)} ${units[0]}`];\n    }\n    else {\n        const dist = Math.abs(yValues[1] - yValues[0]);\n        return [`${csUtils.roundNumber(dist)} ${units[1]}`];\n    }\n}\nUltrasoundDirectionalTool.toolName = 'UltrasoundDirectionalTool';\nexport default UltrasoundDirectionalTool;\n","import { Events } from '../../enums';\nimport { getEnabledElement, utilities as csUtils } from '@cornerstonejs/core';\nimport { AnnotationTool } from '../base';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { drawArrow as drawArrowSvg } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { resetElementCursor } from '../../cursors/elementCursor';\nclass KeyImageTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            getTextCallback,\n            changeTextCallback,\n            canvasPosition: [10, 10],\n            canvasSize: 10,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const annotation = KeyImageTool.createAnnotation({\n                metadata: { ...viewport.getViewReference(), referencedImageId },\n            });\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            this.configuration.getTextCallback((text) => {\n                if (!text) {\n                    removeAnnotation(annotation.annotationUID);\n                    triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                    this.isDrawing = false;\n                    return;\n                }\n                annotation.data.text = text;\n                triggerAnnotationCompleted(annotation);\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            });\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { canvasPosition, canvasSize } = this.configuration;\n            if (!canvasPosition?.length) {\n                return false;\n            }\n            if (Math.abs(canvasCoords[0] - canvasPosition[0] + canvasSize / 2) <=\n                canvasSize / 2 &&\n                Math.abs(canvasCoords[1] - canvasPosition[1] + canvasSize / 2) <=\n                    canvasSize / 2) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            annotation.highlighted = true;\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            this._deactivateModify(element);\n            resetElementCursor(element);\n        };\n        this.doubleClickCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            let annotations = getAnnotations(this.getToolName(), element);\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return;\n            }\n            const clickedAnnotation = annotations.find((annotation) => this.isPointNearTool(element, annotation, eventDetail.currentPoints.canvas, 6));\n            if (!clickedAnnotation) {\n                return;\n            }\n            const annotation = clickedAnnotation;\n            this.configuration.changeTextCallback(clickedAnnotation, evt.detail, this._doneChangingTextCallback.bind(this, element, annotation));\n            this.isDrawing = false;\n            evt.stopImmediatePropagation();\n            evt.preventDefault();\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID } = annotation;\n                styleSpecifier.annotationUID = annotationUID;\n                const { color } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const { canvasPosition, canvasSize } = this.configuration;\n                if (canvasPosition?.length) {\n                    const arrowUID = '1';\n                    drawArrowSvg(svgDrawingHelper, annotationUID, arrowUID, canvasPosition.map((it) => it + canvasSize), canvasPosition, {\n                        color,\n                        width: 1,\n                    });\n                }\n                renderStatus = true;\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n            }\n            return renderStatus;\n        };\n    }\n    cancel() {\n    }\n    handleSelectedCallback(evt, annotation, handle) {\n    }\n    _doneChangingTextCallback(element, annotation, updatedText) {\n        annotation.data.text = updatedText;\n        const enabledElement = getEnabledElement(element);\n        const { renderingEngine } = enabledElement;\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        triggerAnnotationModified(annotation, element);\n    }\n    _isInsideVolume(index1, index2, dimensions) {\n        return (csUtils.indexWithinDimensions(index1, dimensions) &&\n            csUtils.indexWithinDimensions(index2, dimensions));\n    }\n}\nfunction getTextCallback(doneChangingTextCallback) {\n    return doneChangingTextCallback(prompt('Enter your annotation:'));\n}\nfunction changeTextCallback(data, eventData, doneChangingTextCallback) {\n    return doneChangingTextCallback(prompt('Enter your annotation:'));\n}\nKeyImageTool.toolName = 'KeyImage';\nexport default KeyImageTool;\n","import { BaseTool } from './base';\nimport { getAnnotations, removeAnnotation, } from '../stateManagement/annotation/annotationState';\nimport { setAnnotationSelected } from '../stateManagement/annotation/annotationSelection';\nimport { getToolGroupForViewport } from '../store/ToolGroupManager';\nclass AnnotationEraserTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n    }) {\n        super(toolProps, defaultToolProps);\n        this.preMouseDownCallback = (evt) => {\n            return this._deleteNearbyAnnotations(evt, 'mouse');\n        };\n        this.preTouchStartCallback = (evt) => {\n            return this._deleteNearbyAnnotations(evt, 'touch');\n        };\n    }\n    _deleteNearbyAnnotations(evt, interactionType) {\n        const { renderingEngineId, viewportId, element, currentPoints } = evt.detail;\n        const toolGroup = getToolGroupForViewport(viewportId, renderingEngineId);\n        if (!toolGroup) {\n            return false;\n        }\n        const tools = toolGroup._toolInstances;\n        const annotationsToRemove = [];\n        for (const toolName in tools) {\n            const toolInstance = tools[toolName];\n            if (typeof toolInstance.isPointNearTool !== 'function' ||\n                typeof toolInstance.filterInteractableAnnotationsForElement !==\n                    'function') {\n                continue;\n            }\n            const annotations = getAnnotations(toolName, element);\n            if (!annotations.length) {\n                continue;\n            }\n            const interactableAnnotations = toolInstance.filterInteractableAnnotationsForElement(element, annotations) || [];\n            for (const annotation of interactableAnnotations) {\n                if (toolInstance.isPointNearTool(element, annotation, currentPoints.canvas, 10, interactionType)) {\n                    annotationsToRemove.push(annotation.annotationUID);\n                }\n            }\n        }\n        for (const annotationUID of annotationsToRemove) {\n            setAnnotationSelected(annotationUID);\n            removeAnnotation(annotationUID);\n        }\n        evt.preventDefault();\n        return true;\n    }\n}\nAnnotationEraserTool.toolName = 'Eraser';\nexport default AnnotationEraserTool;\n","import { BaseVolumeViewport, cache, getEnabledElement, } from '@cornerstonejs/core';\nimport { BaseTool } from '../base';\nimport { fillInsideRectangle } from './strategies/fillRectangle';\nimport { eraseInsideRectangle } from './strategies/eraseRectangle';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { Events, SegmentationRepresentations } from '../../enums';\nimport { drawRect as drawRectSvg } from '../../drawingSvg';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { config as segmentationConfig, segmentLocking, segmentIndex as segmentIndexController, activeSegmentation, } from '../../stateManagement/segmentation';\nimport { getCurrentLabelmapImageIdForViewport, getSegmentation, getStackSegmentationImageIdsForViewport, } from '../../stateManagement/segmentation/segmentationState';\nclass RectangleScissorsTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            strategies: {\n                FILL_INSIDE: fillInsideRectangle,\n                ERASE_INSIDE: eraseInsideRectangle,\n            },\n            defaultStrategy: 'FILL_INSIDE',\n            activeStrategy: 'FILL_INSIDE',\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.preMouseDownCallback = (evt) => {\n            if (this.isDrawing === true) {\n                return;\n            }\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const activeLabelmapSegmentation = activeSegmentation.getActiveSegmentation(viewport.id);\n            if (!activeLabelmapSegmentation) {\n                throw new Error('No active segmentation detected, create one before using scissors tool');\n            }\n            const { segmentationId } = activeLabelmapSegmentation;\n            const segmentIndex = segmentIndexController.getActiveSegmentIndex(segmentationId);\n            const segmentsLocked = segmentLocking.getLockedSegmentIndices(segmentationId);\n            const segmentColor = segmentationConfig.color.getSegmentIndexColor(viewport.id, segmentationId, segmentIndex);\n            const { representationData } = getSegmentation(segmentationId);\n            const labelmapData = representationData[SegmentationRepresentations.Labelmap];\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID: viewport.getFrameOfReferenceUID(),\n                    referencedImageId: '',\n                    toolName: this.getToolName(),\n                    segmentColor,\n                },\n                data: {\n                    handles: {\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                        activeHandleIndex: null,\n                    },\n                },\n            };\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                segmentIndex,\n                segmentationId,\n                segmentsLocked,\n                segmentColor,\n                viewportIdsToRender,\n                handleIndex: 3,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n                volumeId: null,\n                referencedVolumeId: null,\n                imageId: null,\n            };\n            if (viewport instanceof BaseVolumeViewport) {\n                const { volumeId } = labelmapData;\n                const segmentation = cache.getVolume(volumeId);\n                this.editData = {\n                    ...this.editData,\n                    volumeId,\n                    referencedVolumeId: segmentation.referencedVolumeId,\n                };\n            }\n            else {\n                const segmentationImageId = getCurrentLabelmapImageIdForViewport(viewport.id, segmentationId);\n                this.editData = {\n                    ...this.editData,\n                    imageId: segmentationImageId,\n                };\n            }\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return true;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex } = this.editData;\n            const { data } = annotation;\n            const { currentPoints } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { worldToCanvas, canvasToWorld } = enabledElement.viewport;\n            const worldPos = currentPoints.world;\n            const { points } = data.handles;\n            points[handleIndex] = [...worldPos];\n            let bottomLeftCanvas;\n            let bottomRightCanvas;\n            let topLeftCanvas;\n            let topRightCanvas;\n            let bottomLeftWorld;\n            let bottomRightWorld;\n            let topLeftWorld;\n            let topRightWorld;\n            switch (handleIndex) {\n                case 0:\n                case 3:\n                    bottomLeftCanvas = worldToCanvas(points[0]);\n                    topRightCanvas = worldToCanvas(points[3]);\n                    bottomRightCanvas = [topRightCanvas[0], bottomLeftCanvas[1]];\n                    topLeftCanvas = [bottomLeftCanvas[0], topRightCanvas[1]];\n                    bottomRightWorld = canvasToWorld(bottomRightCanvas);\n                    topLeftWorld = canvasToWorld(topLeftCanvas);\n                    points[1] = bottomRightWorld;\n                    points[2] = topLeftWorld;\n                    break;\n                case 1:\n                case 2:\n                    bottomRightCanvas = worldToCanvas(points[1]);\n                    topLeftCanvas = worldToCanvas(points[2]);\n                    bottomLeftCanvas = [\n                        topLeftCanvas[0],\n                        bottomRightCanvas[1],\n                    ];\n                    topRightCanvas = [bottomRightCanvas[0], topLeftCanvas[1]];\n                    bottomLeftWorld = canvasToWorld(bottomLeftCanvas);\n                    topRightWorld = canvasToWorld(topRightCanvas);\n                    points[0] = bottomLeftWorld;\n                    points[3] = topRightWorld;\n                    break;\n            }\n            annotation.invalidated = true;\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.handles.activeHandleIndex = null;\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const operationData = {\n                ...this.editData,\n                points: data.handles.points,\n            };\n            this.editData = null;\n            this.isDrawing = false;\n            this.applyActiveStrategy(enabledElement, operationData);\n        };\n        this._activateDraw = (element) => {\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            if (!this.editData) {\n                return renderStatus;\n            }\n            const { viewport } = enabledElement;\n            const { annotation } = this.editData;\n            const toolMetadata = annotation.metadata;\n            const annotationUID = annotation.annotationUID;\n            const data = annotation.data;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const color = `rgb(${toolMetadata.segmentColor.slice(0, 3)})`;\n            if (!viewport.getRenderingEngine()) {\n                console.warn('Rendering Engine has been destroyed');\n                return renderStatus;\n            }\n            const rectangleUID = '0';\n            drawRectSvg(svgDrawingHelper, annotationUID, rectangleUID, canvasCoordinates[0], canvasCoordinates[3], {\n                color,\n            });\n            renderStatus = true;\n            return renderStatus;\n        };\n    }\n}\nRectangleScissorsTool.toolName = 'RectangleScissor';\nexport default RectangleScissorsTool;\n","import { BaseVolumeViewport, cache, getEnabledElement, } from '@cornerstonejs/core';\nimport { BaseTool } from '../base';\nimport { fillInsideCircle } from './strategies/fillCircle';\nimport { eraseInsideCircle } from './strategies/eraseCircle';\nimport { Events } from '../../enums';\nimport { drawCircle as drawCircleSvg } from '../../drawingSvg';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { segmentLocking, activeSegmentation, segmentIndex as segmentIndexController, config as segmentationConfig, } from '../../stateManagement/segmentation';\nimport { getCurrentLabelmapImageIdForViewport, getSegmentation, } from '../../stateManagement/segmentation/segmentationState';\nclass CircleScissorsTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            strategies: {\n                FILL_INSIDE: fillInsideCircle,\n                ERASE_INSIDE: eraseInsideCircle,\n            },\n            defaultStrategy: 'FILL_INSIDE',\n            activeStrategy: 'FILL_INSIDE',\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.preMouseDownCallback = (evt) => {\n            if (this.isDrawing === true) {\n                return;\n            }\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const canvasPos = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const activeLabelmapSegmentation = activeSegmentation.getActiveSegmentation(viewport.id);\n            if (!activeLabelmapSegmentation) {\n                throw new Error('No active segmentation detected, create one before using scissors tool');\n            }\n            const { segmentationId } = activeLabelmapSegmentation;\n            const segmentIndex = segmentIndexController.getActiveSegmentIndex(segmentationId);\n            const segmentsLocked = segmentLocking.getLockedSegmentIndices(segmentationId);\n            const segmentColor = segmentationConfig.color.getSegmentIndexColor(viewport.id, segmentationId, segmentIndex);\n            const { representationData } = getSegmentation(segmentationId);\n            const labelmapData = representationData.Labelmap;\n            if (!labelmapData) {\n                throw new Error('No labelmap data found for the active segmentation, create one before using scissors tool');\n            }\n            const annotation = {\n                invalidated: true,\n                highlighted: true,\n                metadata: {\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID: viewport.getFrameOfReferenceUID(),\n                    referencedImageId: '',\n                    toolName: this.getToolName(),\n                    segmentColor,\n                },\n                data: {\n                    handles: {\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                        activeHandleIndex: null,\n                    },\n                    isDrawing: true,\n                    cachedStats: {},\n                },\n            };\n            const viewportIdsToRender = [viewport.id];\n            this.editData = {\n                annotation,\n                centerCanvas: canvasPos,\n                segmentIndex,\n                segmentationId,\n                segmentsLocked,\n                segmentColor,\n                viewportIdsToRender,\n                handleIndex: 3,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n                volumeId: null,\n                referencedVolumeId: null,\n                imageId: null,\n            };\n            if (viewport instanceof BaseVolumeViewport) {\n                const { volumeId } = labelmapData;\n                const segmentation = cache.getVolume(volumeId);\n                this.editData = {\n                    ...this.editData,\n                    volumeId,\n                    referencedVolumeId: segmentation.referencedVolumeId,\n                };\n            }\n            else {\n                const segmentationImageId = getCurrentLabelmapImageIdForViewport(viewport.id, segmentationId);\n                this.editData = {\n                    ...this.editData,\n                    imageId: segmentationImageId,\n                };\n            }\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return true;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const { canvasToWorld } = viewport;\n            const { annotation, viewportIdsToRender, centerCanvas } = this.editData;\n            const { data } = annotation;\n            const dX = Math.abs(currentCanvasPoints[0] - centerCanvas[0]);\n            const dY = Math.abs(currentCanvasPoints[1] - centerCanvas[1]);\n            const radius = Math.sqrt(dX * dX + dY * dY);\n            const bottomCanvas = [\n                centerCanvas[0],\n                centerCanvas[1] + radius,\n            ];\n            const topCanvas = [centerCanvas[0], centerCanvas[1] - radius];\n            const leftCanvas = [\n                centerCanvas[0] - radius,\n                centerCanvas[1],\n            ];\n            const rightCanvas = [\n                centerCanvas[0] + radius,\n                centerCanvas[1],\n            ];\n            data.handles.points = [\n                canvasToWorld(bottomCanvas),\n                canvasToWorld(topCanvas),\n                canvasToWorld(leftCanvas),\n                canvasToWorld(rightCanvas),\n            ];\n            annotation.invalidated = true;\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            const { viewPlaneNormal, viewUp } = annotation.metadata;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.handles.activeHandleIndex = null;\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const operationData = {\n                ...this.editData,\n                points: data.handles.points,\n                viewPlaneNormal,\n                viewUp,\n                strategySpecificConfiguration: {},\n            };\n            this.editData = null;\n            this.isDrawing = false;\n            this.applyActiveStrategy(enabledElement, operationData);\n        };\n        this._activateDraw = (element) => {\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            if (!this.editData) {\n                return renderStatus;\n            }\n            const { viewport } = enabledElement;\n            const { viewportIdsToRender } = this.editData;\n            if (!viewportIdsToRender.includes(viewport.id)) {\n                return renderStatus;\n            }\n            const { annotation } = this.editData;\n            const toolMetadata = annotation.metadata;\n            const annotationUID = annotation.annotationUID;\n            const data = annotation.data;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const bottom = canvasCoordinates[0];\n            const top = canvasCoordinates[1];\n            const center = [\n                Math.floor((bottom[0] + top[0]) / 2),\n                Math.floor((bottom[1] + top[1]) / 2),\n            ];\n            const radius = Math.abs(bottom[1] - Math.floor((bottom[1] + top[1]) / 2));\n            const color = `rgb(${toolMetadata.segmentColor.slice(0, 3)})`;\n            if (!viewport.getRenderingEngine()) {\n                console.warn('Rendering Engine has been destroyed');\n                return renderStatus;\n            }\n            const circleUID = '0';\n            drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, center, radius, {\n                color,\n            });\n            renderStatus = true;\n            return renderStatus;\n        };\n    }\n}\nCircleScissorsTool.toolName = 'CircleScissor';\nexport default CircleScissorsTool;\n","import { BaseVolumeViewport, cache, getEnabledElement, } from '@cornerstonejs/core';\nimport { BaseTool } from '../base';\nimport { fillInsideSphere } from './strategies/fillSphere';\nimport { eraseInsideSphere } from './strategies/eraseSphere';\nimport { Events, SegmentationRepresentations } from '../../enums';\nimport { drawCircle as drawCircleSvg } from '../../drawingSvg';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { config as segmentationConfig, segmentLocking, segmentIndex as segmentIndexController, activeSegmentation, } from '../../stateManagement/segmentation';\nimport { getSegmentation } from '../../stateManagement/segmentation/segmentationState';\nclass SphereScissorsTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            strategies: {\n                FILL_INSIDE: fillInsideSphere,\n                ERASE_INSIDE: eraseInsideSphere,\n            },\n            defaultStrategy: 'FILL_INSIDE',\n            activeStrategy: 'FILL_INSIDE',\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.preMouseDownCallback = (evt) => {\n            if (this.isDrawing === true) {\n                return;\n            }\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const canvasPos = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const activeSegmentationRepresentation = activeSegmentation.getActiveSegmentation(viewport.id);\n            if (!activeSegmentationRepresentation) {\n                throw new Error('No active segmentation detected, create one before using scissors tool');\n            }\n            const { segmentationId } = activeSegmentationRepresentation;\n            const segmentIndex = segmentIndexController.getActiveSegmentIndex(segmentationId);\n            const segmentsLocked = segmentLocking.getLockedSegmentIndices(segmentationId);\n            const segmentColor = segmentationConfig.color.getSegmentIndexColor(viewport.id, segmentationId, segmentIndex);\n            this.isDrawing = true;\n            const annotation = {\n                metadata: {\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID: viewport.getFrameOfReferenceUID(),\n                    referencedImageId: '',\n                    toolName: this.getToolName(),\n                    segmentColor,\n                },\n                data: {\n                    invalidated: true,\n                    handles: {\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                        activeHandleIndex: null,\n                    },\n                    cachedStats: {},\n                    highlighted: true,\n                },\n            };\n            const viewportIdsToRender = [viewport.id];\n            this.editData = {\n                annotation,\n                centerCanvas: canvasPos,\n                segmentIndex,\n                segmentationId,\n                segmentsLocked,\n                segmentColor,\n                toolGroupId: this.toolGroupId,\n                viewportIdsToRender,\n                handleIndex: 3,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n                volumeId: null,\n                referencedVolumeId: null,\n                imageId: null,\n            };\n            const { representationData } = getSegmentation(segmentationId);\n            const labelmapData = representationData[SegmentationRepresentations.Labelmap];\n            if (viewport instanceof BaseVolumeViewport) {\n                const { volumeId } = labelmapData;\n                const segmentation = cache.getVolume(volumeId);\n                this.editData = {\n                    ...this.editData,\n                    volumeId,\n                    referencedVolumeId: segmentation.referencedVolumeId,\n                };\n            }\n            else {\n                this.editData = {\n                    ...this.editData,\n                };\n            }\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return true;\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { currentPoints } = eventDetail;\n            const currentCanvasPoints = currentPoints.canvas;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const { canvasToWorld } = viewport;\n            const { annotation, viewportIdsToRender, centerCanvas } = this.editData;\n            const { data } = annotation;\n            const dX = Math.abs(currentCanvasPoints[0] - centerCanvas[0]);\n            const dY = Math.abs(currentCanvasPoints[1] - centerCanvas[1]);\n            const radius = Math.sqrt(dX * dX + dY * dY);\n            const bottomCanvas = [\n                centerCanvas[0],\n                centerCanvas[1] + radius,\n            ];\n            const topCanvas = [centerCanvas[0], centerCanvas[1] - radius];\n            const leftCanvas = [\n                centerCanvas[0] - radius,\n                centerCanvas[1],\n            ];\n            const rightCanvas = [\n                centerCanvas[0] + radius,\n                centerCanvas[1],\n            ];\n            data.handles.points = [\n                canvasToWorld(bottomCanvas),\n                canvasToWorld(topCanvas),\n                canvasToWorld(leftCanvas),\n                canvasToWorld(rightCanvas),\n            ];\n            annotation.invalidated = true;\n            this.editData.hasMoved = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, newAnnotation, hasMoved, segmentIndex, segmentsLocked, } = this.editData;\n            const { data } = annotation;\n            const { viewPlaneNormal, viewUp } = annotation.metadata;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            annotation.highlighted = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const operationData = {\n                ...this.editData,\n                points: data.handles.points,\n                segmentIndex,\n                segmentsLocked,\n                viewPlaneNormal,\n                viewUp,\n            };\n            this.editData = null;\n            this.isDrawing = false;\n            this.applyActiveStrategy(enabledElement, operationData);\n        };\n        this._activateDraw = (element) => {\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n        };\n        this._deactivateDraw = (element) => {\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            if (!this.editData) {\n                return renderStatus;\n            }\n            const { viewport } = enabledElement;\n            const { viewportIdsToRender } = this.editData;\n            if (!viewportIdsToRender.includes(viewport.id)) {\n                return renderStatus;\n            }\n            const { annotation } = this.editData;\n            const toolMetadata = annotation.metadata;\n            const annotationUID = annotation.annotationUID;\n            const data = annotation.data;\n            const { points } = data.handles;\n            const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n            const bottom = canvasCoordinates[0];\n            const top = canvasCoordinates[1];\n            const center = [\n                Math.floor((bottom[0] + top[0]) / 2),\n                Math.floor((bottom[1] + top[1]) / 2),\n            ];\n            const radius = Math.abs(bottom[1] - Math.floor((bottom[1] + top[1]) / 2));\n            const color = `rgb(${toolMetadata.segmentColor.slice(0, 3)})`;\n            if (!viewport.getRenderingEngine()) {\n                console.warn('Rendering Engine has been destroyed');\n                return renderStatus;\n            }\n            const circleUID = '0';\n            drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, center, radius, {\n                color,\n            });\n            renderStatus = true;\n            return renderStatus;\n        };\n    }\n}\nSphereScissorsTool.toolName = 'SphereScissor';\nexport default SphereScissorsTool;\n","import { StackViewport, cache, getEnabledElement, utilities as csUtils, utilities as coreUtils, } from '@cornerstonejs/core';\nimport { vec3 } from 'gl-matrix';\nimport { addAnnotation, removeAnnotation, getAnnotations, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { drawCircle as drawCircleSvg, drawHandles as drawHandlesSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport getWorldWidthAndHeightFromTwoPoints from '../../utilities/planar/getWorldWidthAndHeightFromTwoPoints';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport throttle from '../../utilities/throttle';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { hideElementCursor, resetElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport CircleROITool from '../annotation/CircleROITool';\nimport { getCanvasCircleCorners, getCanvasCircleRadius, } from '../../utilities/math/circle';\nimport { getCalibratedLengthUnitsAndScale, getCalibratedAspect, } from '../../utilities/getCalibratedUnits';\nimport { isViewportPreScaled } from '../../utilities/viewport/isViewportPreScaled';\nimport { pointInEllipse } from '../../utilities/math/ellipse';\nimport { BasicStatsCalculator } from '../../utilities/math/basic';\nimport { filterAnnotationsWithinSamePlane } from '../../utilities/planar';\nimport { getPixelValueUnits } from '../../utilities/getPixelValueUnits';\nconst { transformWorldToIndex } = csUtils;\nclass CircleROIStartEndThresholdTool extends CircleROITool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            storePointData: false,\n            numSlicesToPropagate: 10,\n            calculatePointsInsideVolume: false,\n            getTextLines: defaultGetTextLines,\n            statsCalculator: BasicStatsCalculator,\n            showTextBox: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isHandleOutsideImage = false;\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            let referencedImageId, imageVolume, volumeId;\n            if (viewport instanceof StackViewport) {\n                throw new Error('Stack Viewport Not implemented');\n            }\n            else {\n                const targetId = this.getTargetId(viewport);\n                volumeId = csUtils.getVolumeId(targetId);\n                imageVolume = cache.getVolume(volumeId);\n                referencedImageId = csUtils.getClosestImageId(imageVolume, worldPos, viewPlaneNormal);\n            }\n            const spacingInNormal = csUtils.getSpacingInNormalDirection(imageVolume, viewPlaneNormal);\n            const startCoord = this._getStartCoordinate(worldPos, spacingInNormal, viewPlaneNormal);\n            const endCoord = this._getEndCoordinate(worldPos, spacingInNormal, viewPlaneNormal);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    volumeId,\n                    spacingInNormal,\n                    enabledElement,\n                },\n                data: {\n                    label: '',\n                    startCoordinate: startCoord,\n                    endCoordinate: endCoord,\n                    handles: {\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                        points: [[...worldPos], [...worldPos]],\n                        activeHandleIndex: null,\n                    },\n                    cachedStats: {\n                        pointsInVolume: [],\n                        projectionPoints: [],\n                        statistics: [],\n                    },\n                    labelmapUID: null,\n                },\n            };\n            this._computeProjectionPoints(annotation, imageVolume);\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            annotation.highlighted = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            this.editData = null;\n            this.isDrawing = false;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            const targetId = this.getTargetId(enabledElement.viewport);\n            const imageVolume = cache.getVolume(targetId.split(/volumeId:|\\?/)[1]);\n            if (this.configuration.calculatePointsInsideVolume) {\n                this._computePointsInsideVolume(annotation, imageVolume, targetId, enabledElement);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            let annotations = getAnnotations(this.getToolName(), viewport.element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = filterAnnotationsWithinSamePlane(annotations, viewport.getCamera());\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { startCoordinate, endCoordinate } = data;\n                const { points, activeHandleIndex } = data.handles;\n                styleSpecifier.annotationUID = annotationUID;\n                const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n                const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                const center = canvasCoordinates[0];\n                const radius = getCanvasCircleRadius(canvasCoordinates);\n                const { centerPointRadius } = this.configuration;\n                const canvasCorners = getCanvasCircleCorners(canvasCoordinates);\n                const focalPoint = viewport.getCamera().focalPoint;\n                const viewplaneNormal = viewport.getCamera().viewPlaneNormal;\n                let tempStartCoordinate = startCoordinate;\n                let tempEndCoordinate = endCoordinate;\n                if (Array.isArray(startCoordinate)) {\n                    tempStartCoordinate = this._getCoordinateForViewplaneNormal(tempStartCoordinate, viewplaneNormal);\n                    data.startCoordinate = tempStartCoordinate;\n                }\n                if (Array.isArray(endCoordinate)) {\n                    tempEndCoordinate = this._getCoordinateForViewplaneNormal(tempEndCoordinate, viewplaneNormal);\n                    data.endCoordinate = tempEndCoordinate;\n                }\n                const roundedStartCoordinate = coreUtils.roundToPrecision(data.startCoordinate);\n                const roundedEndCoordinate = coreUtils.roundToPrecision(data.endCoordinate);\n                const cameraCoordinate = this._getCoordinateForViewplaneNormal(focalPoint, viewplaneNormal);\n                const roundedCameraCoordinate = coreUtils.roundToPrecision(cameraCoordinate);\n                if (roundedCameraCoordinate <\n                    Math.min(roundedStartCoordinate, roundedEndCoordinate) ||\n                    roundedCameraCoordinate >\n                        Math.max(roundedStartCoordinate, roundedEndCoordinate)) {\n                    continue;\n                }\n                const middleCoordinate = coreUtils.roundToPrecision((data.startCoordinate + data.endCoordinate) / 2);\n                let isMiddleSlice = false;\n                if (roundedCameraCoordinate === middleCoordinate) {\n                    isMiddleSlice = true;\n                }\n                data.handles.points[0][this._getIndexOfCoordinatesForViewplaneNormal(viewplaneNormal)] = middleCoordinate;\n                if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, enabledElement);\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null &&\n                    isMiddleSlice) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                let lineWidthToUse = lineWidth;\n                let lineDashToUse = lineDash;\n                if (isMiddleSlice) {\n                    lineWidthToUse = lineWidth;\n                    lineDashToUse = [];\n                }\n                else {\n                    lineDashToUse = [5, 5];\n                }\n                const circleUID = '0';\n                drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, center, radius, {\n                    color,\n                    lineDash: lineDashToUse,\n                    lineWidth: lineWidthToUse,\n                });\n                if (centerPointRadius > 0) {\n                    if (radius > 3 * centerPointRadius) {\n                        drawCircleSvg(svgDrawingHelper, annotationUID, `${circleUID}-center`, center, centerPointRadius, {\n                            color,\n                            lineDash,\n                            lineWidth,\n                        });\n                    }\n                }\n                renderStatus = true;\n                if (this.configuration.showTextBox == true &&\n                    this.configuration.calculatePointsInsideVolume == true) {\n                    const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                    if (!options.visibility) {\n                        data.handles.textBox = {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        };\n                        continue;\n                    }\n                    const textLines = this.configuration.getTextLines(data);\n                    if (!textLines || textLines.length === 0) {\n                        continue;\n                    }\n                    let canvasTextBoxCoords;\n                    if (!data.handles.textBox.hasMoved) {\n                        canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCorners);\n                        data.handles.textBox.worldPosition =\n                            viewport.canvasToWorld(canvasTextBoxCoords);\n                    }\n                    const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                    const textBoxUID = '1';\n                    const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                    const { x: left, y: top, width, height } = boundingBox;\n                    data.handles.textBox.worldBoundingBox = {\n                        topLeft: viewport.canvasToWorld([left, top]),\n                        topRight: viewport.canvasToWorld([left + width, top]),\n                        bottomLeft: viewport.canvasToWorld([left, top + height]),\n                        bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                    };\n                }\n            }\n            return renderStatus;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStatsTool, 100, { trailing: true });\n    }\n    _computeProjectionPoints(annotation, imageVolume) {\n        const { data, metadata } = annotation;\n        const { viewPlaneNormal, spacingInNormal } = metadata;\n        const { imageData } = imageVolume;\n        const { startCoordinate, endCoordinate } = data;\n        const { points } = data.handles;\n        const startIJK = transformWorldToIndex(imageData, points[0]);\n        const endIJK = transformWorldToIndex(imageData, points[0]);\n        const handlesToStart = csUtils.deepClone(points);\n        const startWorld = vec3.create();\n        imageData.indexToWorldVec3(startIJK, startWorld);\n        const endWorld = vec3.create();\n        imageData.indexToWorldVec3(endIJK, endWorld);\n        if (this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) == 2) {\n            startWorld[2] = startCoordinate;\n            endWorld[2] = endCoordinate;\n            handlesToStart[0][2] = startCoordinate;\n            handlesToStart[1][2] = startCoordinate;\n        }\n        else if (this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) == 0) {\n            startWorld[0] = startCoordinate;\n            endWorld[0] = endCoordinate;\n            handlesToStart[0][0] = startCoordinate;\n            handlesToStart[1][0] = startCoordinate;\n        }\n        else if (this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) == 1) {\n            startWorld[1] = startCoordinate;\n            endWorld[1] = endCoordinate;\n            handlesToStart[0][1] = startCoordinate;\n            handlesToStart[1][1] = startCoordinate;\n        }\n        const distance = vec3.distance(startWorld, endWorld);\n        const newProjectionPoints = [];\n        for (let dist = 0; dist < distance; dist += spacingInNormal) {\n            newProjectionPoints.push(handlesToStart.map((point) => {\n                const newPoint = vec3.create();\n                vec3.scaleAndAdd(newPoint, point, viewPlaneNormal, dist);\n                return Array.from(newPoint);\n            }));\n        }\n        data.cachedStats.projectionPoints = newProjectionPoints;\n    }\n    _computePointsInsideVolume(annotation, imageVolume, targetId, enabledElement) {\n        const { data, metadata } = annotation;\n        const { viewPlaneNormal, viewUp } = metadata;\n        const { viewport } = enabledElement;\n        const projectionPoints = data.cachedStats.projectionPoints;\n        const pointsInsideVolume = [[]];\n        const image = this.getTargetImageData(targetId);\n        const canvasCoordinates = data.handles.points.map((p) => viewport.worldToCanvas(p));\n        const [topLeftCanvas, bottomRightCanvas] = (getCanvasCircleCorners(canvasCoordinates));\n        const pos1 = viewport.canvasToWorld(topLeftCanvas);\n        const pos2 = viewport.canvasToWorld(bottomRightCanvas);\n        const { worldWidth, worldHeight } = getWorldWidthAndHeightFromTwoPoints(viewPlaneNormal, viewUp, pos1, pos2);\n        const measureInfo = getCalibratedLengthUnitsAndScale(image, data.handles);\n        const aspect = getCalibratedAspect(image);\n        const area = Math.abs(Math.PI *\n            (worldWidth / measureInfo.scale / 2) *\n            (worldHeight / aspect / measureInfo.scale / 2));\n        const modalityUnitOptions = {\n            isPreScaled: isViewportPreScaled(viewport, targetId),\n            isSuvScaled: this.isSuvScaled(viewport, targetId, annotation.metadata.referencedImageId),\n        };\n        const modalityUnit = getPixelValueUnits(metadata.Modality, annotation.metadata.referencedImageId, modalityUnitOptions);\n        for (let i = 0; i < projectionPoints.length; i++) {\n            if (!imageVolume) {\n                continue;\n            }\n            const centerWorld = projectionPoints[i][0];\n            const canvasCoordinates = projectionPoints[i].map((p) => viewport.worldToCanvas(p));\n            const [topLeftCanvas, bottomRightCanvas] = (getCanvasCircleCorners(canvasCoordinates));\n            const topLeftWorld = viewport.canvasToWorld(topLeftCanvas);\n            const bottomRightWorld = viewport.canvasToWorld(bottomRightCanvas);\n            const worldPos1 = topLeftWorld;\n            const worldPos2 = bottomRightWorld;\n            const { dimensions, imageData, voxelManager } = imageVolume;\n            const worldPos1Index = transformWorldToIndex(imageData, worldPos1);\n            const worldProjectionPointIndex = transformWorldToIndex(imageData, centerWorld);\n            const indexOfProjection = this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal);\n            worldPos1Index[0] = Math.floor(worldPos1Index[0]);\n            worldPos1Index[1] = Math.floor(worldPos1Index[1]);\n            worldPos1Index[2] = Math.floor(worldPos1Index[2]);\n            worldPos1Index[indexOfProjection] =\n                worldProjectionPointIndex[indexOfProjection];\n            const worldPos2Index = transformWorldToIndex(imageData, worldPos2);\n            worldPos2Index[0] = Math.floor(worldPos2Index[0]);\n            worldPos2Index[1] = Math.floor(worldPos2Index[1]);\n            worldPos2Index[2] = Math.floor(worldPos2Index[2]);\n            worldPos2Index[indexOfProjection] =\n                worldProjectionPointIndex[indexOfProjection];\n            if (this._isInsideVolume(worldPos1Index, worldPos2Index, dimensions)) {\n                const iMin = Math.min(worldPos1Index[0], worldPos2Index[0]);\n                const iMax = Math.max(worldPos1Index[0], worldPos2Index[0]);\n                const jMin = Math.min(worldPos1Index[1], worldPos2Index[1]);\n                const jMax = Math.max(worldPos1Index[1], worldPos2Index[1]);\n                const kMin = Math.min(worldPos1Index[2], worldPos2Index[2]);\n                const kMax = Math.max(worldPos1Index[2], worldPos2Index[2]);\n                const boundsIJK = [\n                    [iMin, iMax],\n                    [jMin, jMax],\n                    [kMin, kMax],\n                ];\n                const center = centerWorld;\n                const ellipseObj = {\n                    center,\n                    xRadius: Math.abs(topLeftWorld[0] - bottomRightWorld[0]) / 2,\n                    yRadius: Math.abs(topLeftWorld[1] - bottomRightWorld[1]) / 2,\n                    zRadius: Math.abs(topLeftWorld[2] - bottomRightWorld[2]) / 2,\n                };\n                const pointsInShape = voxelManager.forEach(this.configuration.statsCalculator.statsCallback, {\n                    isInObject: (pointLPS) => pointInEllipse(ellipseObj, pointLPS),\n                    boundsIJK,\n                    imageData,\n                    returnPoints: this.configuration.storePointData,\n                });\n                pointsInsideVolume.push(pointsInShape);\n            }\n        }\n        const stats = this.configuration.statsCalculator.getStatistics();\n        data.cachedStats.pointsInVolume = pointsInsideVolume;\n        data.cachedStats.statistics = {\n            Modality: metadata.Modality,\n            area,\n            mean: stats.mean?.value,\n            stdDev: stats.stdDev?.value,\n            max: stats.max?.value,\n            statsArray: stats.array,\n            areaUnit: measureInfo.areaUnit,\n            modalityUnit,\n        };\n    }\n    _calculateCachedStatsTool(annotation, enabledElement) {\n        const data = annotation.data;\n        const { viewport } = enabledElement;\n        const { cachedStats } = data;\n        const targetId = this.getTargetId(viewport);\n        const imageVolume = cache.getVolume(targetId.split(/volumeId:|\\?/)[1]);\n        this._computeProjectionPoints(annotation, imageVolume);\n        if (this.configuration.calculatePointsInsideVolume) {\n            this._computePointsInsideVolume(annotation, imageVolume, targetId, enabledElement);\n        }\n        annotation.invalidated = false;\n        triggerAnnotationModified(annotation, viewport.element);\n        return cachedStats;\n    }\n    _getStartCoordinate(worldPos, spacingInNormal, viewPlaneNormal) {\n        const numSlicesToPropagate = this.configuration.numSlicesToPropagate;\n        const numSlicesToPropagateFromStart = Math.round(numSlicesToPropagate / 2);\n        const startPos = vec3.create();\n        vec3.scaleAndAdd(startPos, worldPos, viewPlaneNormal, numSlicesToPropagateFromStart * -spacingInNormal);\n        const startCoord = this._getCoordinateForViewplaneNormal(startPos, viewPlaneNormal);\n        return startCoord;\n    }\n    _getEndCoordinate(worldPos, spacingInNormal, viewPlaneNormal) {\n        const numSlicesToPropagate = this.configuration.numSlicesToPropagate;\n        const numSlicesToPropagateToEnd = numSlicesToPropagate - Math.round(numSlicesToPropagate / 2);\n        const endPos = vec3.create();\n        vec3.scaleAndAdd(endPos, worldPos, viewPlaneNormal, numSlicesToPropagateToEnd * spacingInNormal);\n        const endCoord = this._getCoordinateForViewplaneNormal(endPos, viewPlaneNormal);\n        return endCoord;\n    }\n    _getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) {\n        const viewplaneNormalAbs = [\n            Math.abs(viewPlaneNormal[0]),\n            Math.abs(viewPlaneNormal[1]),\n            Math.abs(viewPlaneNormal[2]),\n        ];\n        const indexOfDirection = viewplaneNormalAbs.indexOf(Math.max(...viewplaneNormalAbs));\n        return indexOfDirection;\n    }\n    _getCoordinateForViewplaneNormal(pos, viewPlaneNormal) {\n        const indexOfDirection = this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal);\n        return pos[indexOfDirection];\n    }\n}\nfunction defaultGetTextLines(data) {\n    const cachedVolumeStats = data.cachedStats.statistics;\n    const { area, mean, max, stdDev, areaUnit, modalityUnit } = cachedVolumeStats;\n    if (mean === undefined) {\n        return;\n    }\n    const textLines = [];\n    textLines.push(`Area: ${csUtils.roundNumber(area)} ${areaUnit}`);\n    textLines.push(`Mean: ${csUtils.roundNumber(mean)} ${modalityUnit}`);\n    textLines.push(`Max: ${csUtils.roundNumber(max)} ${modalityUnit}`);\n    textLines.push(`Std Dev: ${csUtils.roundNumber(stdDev)} ${modalityUnit}`);\n    return textLines;\n}\nCircleROIStartEndThresholdTool.toolName = 'CircleROIStartEndThreshold';\nexport default CircleROIStartEndThresholdTool;\n","import { cache, getEnabledElement, utilities as csUtils, BaseVolumeViewport, } from '@cornerstonejs/core';\nimport { BaseTool } from '../base';\nimport { SegmentationRepresentations } from '../../enums';\nimport { triggerSegmentationDataModified } from '../../stateManagement/segmentation/triggerSegmentationEvents';\nimport { segmentLocking, activeSegmentation, segmentIndex as segmentIndexController, } from '../../stateManagement/segmentation';\nimport floodFill from '../../utilities/segmentation/floodFill';\nimport { getCurrentLabelmapImageIdForViewport, getSegmentation, } from '../../stateManagement/segmentation/segmentationState';\nconst { transformWorldToIndex, isEqual } = csUtils;\nclass PaintFillTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n    }) {\n        super(toolProps, defaultToolProps);\n        this.preMouseDownCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal } = camera;\n            const activeSegmentationRepresentation = activeSegmentation.getActiveSegmentation(viewport.id);\n            if (!activeSegmentationRepresentation) {\n                throw new Error('No active segmentation detected, create one before using scissors tool');\n            }\n            const { segmentationId } = activeSegmentationRepresentation;\n            const segmentIndex = segmentIndexController.getActiveSegmentIndex(segmentationId);\n            const segmentsLocked = segmentLocking.getLockedSegmentIndices(segmentationId);\n            const { representationData } = getSegmentation(segmentationId);\n            let dimensions;\n            let direction;\n            let scalarData;\n            let index;\n            let voxelManager;\n            if (viewport instanceof BaseVolumeViewport) {\n                const { volumeId } = representationData[SegmentationRepresentations.Labelmap];\n                const segmentation = cache.getVolume(volumeId);\n                ({ dimensions, direction } = segmentation);\n                voxelManager = segmentation.voxelManager;\n                index = transformWorldToIndex(segmentation.imageData, worldPos);\n            }\n            else {\n                const currentSegmentationImageId = getCurrentLabelmapImageIdForViewport(viewport.id, segmentationId);\n                if (!currentSegmentationImageId) {\n                    throw new Error('No active segmentation imageId detected, create one before using scissors tool');\n                }\n                const { imageData } = viewport.getImageData();\n                dimensions = imageData.getDimensions();\n                direction = imageData.getDirection();\n                const image = cache.getImage(currentSegmentationImageId);\n                voxelManager = image.voxelManager;\n                index = transformWorldToIndex(imageData, worldPos);\n            }\n            const fixedDimension = this.getFixedDimension(viewPlaneNormal, direction);\n            if (fixedDimension === undefined) {\n                console.warn('Oblique paint fill not yet supported');\n                return;\n            }\n            const { floodFillGetter, getLabelValue, getScalarDataPositionFromPlane, inPlaneSeedPoint, fixedDimensionValue, } = this.generateHelpers(voxelManager, dimensions, index, fixedDimension);\n            if (index[0] < 0 ||\n                index[0] >= dimensions[0] ||\n                index[1] < 0 ||\n                index[1] >= dimensions[1] ||\n                index[2] < 0 ||\n                index[2] >= dimensions[2]) {\n                return;\n            }\n            const clickedLabelValue = getLabelValue(index[0], index[1], index[2]);\n            if (segmentsLocked.includes(clickedLabelValue)) {\n                return;\n            }\n            const floodFillResult = floodFill(floodFillGetter, inPlaneSeedPoint);\n            const { flooded } = floodFillResult;\n            flooded.forEach((index) => {\n                const scalarDataIndex = getScalarDataPositionFromPlane(index[0], index[1]);\n                voxelManager.setAtIndex(scalarDataIndex, segmentIndex);\n            });\n            const framesModified = this.getFramesModified(fixedDimension, fixedDimensionValue, floodFillResult);\n            triggerSegmentationDataModified(segmentationId, framesModified);\n            return true;\n        };\n        this.getFramesModified = (fixedDimension, fixedDimensionValue, floodFillResult) => {\n            const { boundaries } = floodFillResult;\n            if (fixedDimension === 2) {\n                return [fixedDimensionValue];\n            }\n            let minJ = Infinity;\n            let maxJ = -Infinity;\n            for (let b = 0; b < boundaries.length; b++) {\n                const j = boundaries[b][1];\n                if (j < minJ) {\n                    minJ = j;\n                }\n                if (j > maxJ) {\n                    maxJ = j;\n                }\n            }\n            const framesModified = [];\n            for (let frame = minJ; frame <= maxJ; frame++) {\n                framesModified.push(frame);\n            }\n            return framesModified;\n        };\n        this.generateHelpers = (voxelManager, dimensions, seedIndex3D, fixedDimension = 2) => {\n            let fixedDimensionValue;\n            let inPlaneSeedPoint;\n            switch (fixedDimension) {\n                case 0:\n                    fixedDimensionValue = seedIndex3D[0];\n                    inPlaneSeedPoint = [seedIndex3D[1], seedIndex3D[2]];\n                    break;\n                case 1:\n                    fixedDimensionValue = seedIndex3D[1];\n                    inPlaneSeedPoint = [seedIndex3D[0], seedIndex3D[2]];\n                    break;\n                case 2:\n                    fixedDimensionValue = seedIndex3D[2];\n                    inPlaneSeedPoint = [seedIndex3D[0], seedIndex3D[1]];\n                    break;\n                default:\n                    throw new Error(`Invalid fixedDimension: ${fixedDimension}`);\n            }\n            const getScalarDataPosition = (x, y, z) => {\n                return voxelManager.toIndex([x, y, z]);\n            };\n            const getLabelValue = (x, y, z) => {\n                return voxelManager.getAtIJK(x, y, z);\n            };\n            const floodFillGetter = this.generateFloodFillGetter(dimensions, fixedDimension, fixedDimensionValue, getLabelValue);\n            const getScalarDataPositionFromPlane = this.generateGetScalarDataPositionFromPlane(getScalarDataPosition, fixedDimension, fixedDimensionValue);\n            return {\n                getScalarDataPositionFromPlane,\n                getLabelValue,\n                floodFillGetter,\n                inPlaneSeedPoint,\n                fixedDimensionValue,\n            };\n        };\n        this.generateFloodFillGetter = (dimensions, fixedDimension, fixedDimensionValue, getLabelValue) => {\n            let floodFillGetter;\n            switch (fixedDimension) {\n                case 0:\n                    floodFillGetter = (y, z) => {\n                        if (y >= dimensions[1] || y < 0 || z >= dimensions[2] || z < 0) {\n                            return;\n                        }\n                        return getLabelValue(fixedDimensionValue, y, z);\n                    };\n                    break;\n                case 1:\n                    floodFillGetter = (x, z) => {\n                        if (x >= dimensions[0] || x < 0 || z >= dimensions[2] || z < 0) {\n                            return;\n                        }\n                        return getLabelValue(x, fixedDimensionValue, z);\n                    };\n                    break;\n                case 2:\n                    floodFillGetter = (x, y) => {\n                        if (x >= dimensions[0] || x < 0 || y >= dimensions[1] || y < 0) {\n                            return;\n                        }\n                        return getLabelValue(x, y, fixedDimensionValue);\n                    };\n                    break;\n                default:\n                    throw new Error(`Invalid fixedDimension: ${fixedDimension}`);\n            }\n            return floodFillGetter;\n        };\n        this.generateGetScalarDataPositionFromPlane = (getScalarDataPosition, fixedDimension, fixedDimensionValue) => {\n            let getScalarDataPositionFromPlane;\n            switch (fixedDimension) {\n                case 0:\n                    getScalarDataPositionFromPlane = (y, z) => {\n                        return getScalarDataPosition(fixedDimensionValue, y, z);\n                    };\n                    break;\n                case 1:\n                    getScalarDataPositionFromPlane = (x, z) => {\n                        return getScalarDataPosition(x, fixedDimensionValue, z);\n                    };\n                    break;\n                case 2:\n                    getScalarDataPositionFromPlane = (x, y) => {\n                        return getScalarDataPosition(x, y, fixedDimensionValue);\n                    };\n                    break;\n                default:\n                    throw new Error(`Invalid fixedDimension: ${fixedDimension}`);\n            }\n            return getScalarDataPositionFromPlane;\n        };\n    }\n    getFixedDimension(viewPlaneNormal, direction) {\n        const xDirection = direction.slice(0, 3);\n        const yDirection = direction.slice(3, 6);\n        const zDirection = direction.slice(6, 9);\n        const absoluteOfViewPlaneNormal = [\n            Math.abs(viewPlaneNormal[0]),\n            Math.abs(viewPlaneNormal[1]),\n            Math.abs(viewPlaneNormal[2]),\n        ];\n        const absoluteOfXDirection = [\n            Math.abs(xDirection[0]),\n            Math.abs(xDirection[1]),\n            Math.abs(xDirection[2]),\n        ];\n        if (isEqual(absoluteOfViewPlaneNormal, absoluteOfXDirection)) {\n            return 0;\n        }\n        const absoluteOfYDirection = [\n            Math.abs(yDirection[0]),\n            Math.abs(yDirection[1]),\n            Math.abs(yDirection[2]),\n        ];\n        if (isEqual(absoluteOfViewPlaneNormal, absoluteOfYDirection)) {\n            return 1;\n        }\n        const absoluteOfZDirection = [\n            Math.abs(zDirection[0]),\n            Math.abs(zDirection[1]),\n            Math.abs(zDirection[2]),\n        ];\n        if (isEqual(absoluteOfViewPlaneNormal, absoluteOfZDirection)) {\n            return 2;\n        }\n    }\n}\nPaintFillTool.toolName = 'PaintFill';\nexport default PaintFillTool;\n","import vtkOrientationMarkerWidget from '@kitware/vtk.js/Interaction/Widgets/OrientationMarkerWidget';\nimport vtkAnnotatedCubeActor from '@kitware/vtk.js/Rendering/Core/AnnotatedCubeActor';\nimport vtkAxesActor from '@kitware/vtk.js/Rendering/Core/AxesActor';\nimport vtkActor from '@kitware/vtk.js/Rendering/Core/Actor';\nimport vtkMapper from '@kitware/vtk.js/Rendering/Core/Mapper';\nimport vtkXMLPolyDataReader from '@kitware/vtk.js/IO/XML/XMLPolyDataReader';\nimport vtkPolyData from '@kitware/vtk.js/Common/DataModel/PolyData';\nimport { BaseTool } from './base';\nimport { Enums, eventTarget, getEnabledElementByIds, getRenderingEngines, } from '@cornerstonejs/core';\nimport { filterViewportsWithToolEnabled } from '../utilities/viewportFilters';\nimport { getToolGroup } from '../store/ToolGroupManager';\nimport { Events } from '../enums';\nvar OverlayMarkerType;\n(function (OverlayMarkerType) {\n    OverlayMarkerType[OverlayMarkerType[\"ANNOTATED_CUBE\"] = 1] = \"ANNOTATED_CUBE\";\n    OverlayMarkerType[OverlayMarkerType[\"AXES\"] = 2] = \"AXES\";\n    OverlayMarkerType[OverlayMarkerType[\"CUSTOM\"] = 3] = \"CUSTOM\";\n})(OverlayMarkerType || (OverlayMarkerType = {}));\nclass OrientationMarkerTool extends BaseTool {\n    static { this.CUBE = 1; }\n    static { this.AXIS = 2; }\n    static { this.VTPFILE = 3; }\n    static { this.OVERLAY_MARKER_TYPES = OverlayMarkerType; }\n    constructor(toolProps = {}, defaultToolProps = {\n        configuration: {\n            orientationWidget: {\n                enabled: true,\n                viewportCorner: vtkOrientationMarkerWidget.Corners.BOTTOM_RIGHT,\n                viewportSize: 0.15,\n                minPixelSize: 100,\n                maxPixelSize: 300,\n            },\n            overlayMarkerType: OrientationMarkerTool.OVERLAY_MARKER_TYPES.ANNOTATED_CUBE,\n            overlayConfiguration: {\n                [OrientationMarkerTool.OVERLAY_MARKER_TYPES.ANNOTATED_CUBE]: {\n                    faceProperties: {\n                        xPlus: { text: 'L', faceColor: '#ffff00', faceRotation: 90 },\n                        xMinus: { text: 'R', faceColor: '#ffff00', faceRotation: 270 },\n                        yPlus: {\n                            text: 'P',\n                            faceColor: '#00ffff',\n                            fontColor: 'white',\n                            faceRotation: 180,\n                        },\n                        yMinus: { text: 'A', faceColor: '#00ffff', fontColor: 'white' },\n                        zPlus: { text: 'S' },\n                        zMinus: { text: 'I' },\n                    },\n                    defaultStyle: {\n                        fontStyle: 'bold',\n                        fontFamily: 'Arial',\n                        fontColor: 'black',\n                        fontSizeScale: (res) => res / 2,\n                        faceColor: '#0000ff',\n                        edgeThickness: 0.1,\n                        edgeColor: 'black',\n                        resolution: 400,\n                    },\n                },\n                [OrientationMarkerTool.OVERLAY_MARKER_TYPES.AXES]: {},\n                [OrientationMarkerTool.OVERLAY_MARKER_TYPES.CUSTOM]: {\n                    polyDataURL: 'https://raw.githubusercontent.com/Slicer/Slicer/80ad0a04dacf134754459557bf2638c63f3d1d1b/Base/Logic/Resources/OrientationMarkers/Human.vtp',\n                },\n            },\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this._resizeObservers = new Map();\n        this.onSetToolEnabled = () => {\n            this.initViewports();\n            this._subscribeToViewportEvents();\n        };\n        this.onSetToolActive = () => {\n            this.initViewports();\n            this._subscribeToViewportEvents();\n        };\n        this.onSetToolDisabled = () => {\n            this.cleanUpData();\n            this._unsubscribeToViewportNewVolumeSet();\n        };\n        this._getViewportsInfo = () => {\n            const viewports = getToolGroup(this.toolGroupId).viewportsInfo;\n            return viewports;\n        };\n        this.resize = (viewportId) => {\n            const orientationMarker = this.orientationMarkers[viewportId];\n            if (!orientationMarker) {\n                return;\n            }\n            const { orientationWidget } = orientationMarker;\n            orientationWidget.updateViewport();\n        };\n        this.orientationMarkers = {};\n        this.updatingOrientationMarker = {};\n    }\n    _unsubscribeToViewportNewVolumeSet() {\n        const unsubscribe = () => {\n            const viewportsInfo = this._getViewportsInfo();\n            viewportsInfo.forEach(({ viewportId, renderingEngineId }) => {\n                const { viewport } = getEnabledElementByIds(viewportId, renderingEngineId);\n                const { element } = viewport;\n                element.removeEventListener(Enums.Events.VOLUME_VIEWPORT_NEW_VOLUME, this.initViewports.bind(this));\n                const resizeObserver = this._resizeObservers.get(viewportId);\n                resizeObserver.unobserve(element);\n            });\n        };\n        eventTarget.removeEventListener(Events.TOOLGROUP_VIEWPORT_ADDED, (evt) => {\n            if (evt.detail.toolGroupId !== this.toolGroupId) {\n                return;\n            }\n            unsubscribe();\n            this.initViewports();\n        });\n    }\n    _subscribeToViewportEvents() {\n        const subscribeToElementResize = () => {\n            const viewportsInfo = this._getViewportsInfo();\n            viewportsInfo.forEach(({ viewportId, renderingEngineId }) => {\n                const { viewport } = getEnabledElementByIds(viewportId, renderingEngineId);\n                const { element } = viewport;\n                this.initViewports();\n                element.addEventListener(Enums.Events.VOLUME_VIEWPORT_NEW_VOLUME, this.initViewports.bind(this));\n                const resizeObserver = new ResizeObserver(() => {\n                    setTimeout(() => {\n                        const element = getEnabledElementByIds(viewportId, renderingEngineId);\n                        if (!element) {\n                            return;\n                        }\n                        const { viewport } = element;\n                        this.resize(viewportId);\n                        viewport.render();\n                    }, 100);\n                });\n                resizeObserver.observe(element);\n                this._resizeObservers.set(viewportId, resizeObserver);\n            });\n        };\n        subscribeToElementResize();\n        eventTarget.addEventListener(Events.TOOLGROUP_VIEWPORT_ADDED, (evt) => {\n            if (evt.detail.toolGroupId !== this.toolGroupId) {\n                return;\n            }\n            subscribeToElementResize();\n            this.initViewports();\n        });\n    }\n    cleanUpData() {\n        const renderingEngines = getRenderingEngines();\n        const renderingEngine = renderingEngines[0];\n        const viewports = renderingEngine.getViewports();\n        viewports.forEach((viewport) => {\n            const orientationMarker = this.orientationMarkers[viewport.id];\n            if (!orientationMarker) {\n                return;\n            }\n            const { actor, orientationWidget } = orientationMarker;\n            orientationWidget?.setEnabled(false);\n            orientationWidget?.delete();\n            actor?.delete();\n            const renderWindow = viewport\n                .getRenderingEngine()\n                .offscreenMultiRenderWindow.getRenderWindow();\n            renderWindow.render();\n            viewport.getRenderingEngine().render();\n            delete this.orientationMarkers[viewport.id];\n        });\n    }\n    initViewports() {\n        const renderingEngines = getRenderingEngines();\n        const renderingEngine = renderingEngines[0];\n        if (!renderingEngine) {\n            return;\n        }\n        let viewports = renderingEngine.getViewports();\n        viewports = filterViewportsWithToolEnabled(viewports, this.getToolName());\n        viewports.forEach((viewport) => {\n            const widget = viewport.getWidget(this.getToolName());\n            if (!widget || widget.isDeleted()) {\n                this.addAxisActorInViewport(viewport);\n            }\n        });\n    }\n    async addAxisActorInViewport(viewport) {\n        const viewportId = viewport.id;\n        if (!this.updatingOrientationMarker[viewportId]) {\n            this.updatingOrientationMarker[viewportId] = true;\n            const type = this.configuration.overlayMarkerType;\n            const overlayConfiguration = this.configuration.overlayConfiguration[type];\n            if (this.orientationMarkers[viewportId]) {\n                const { actor, orientationWidget } = this.orientationMarkers[viewportId];\n                viewport.getRenderer().removeActor(actor);\n                orientationWidget.setEnabled(false);\n            }\n            let actor;\n            if (type === 1) {\n                actor = this.createAnnotationCube(overlayConfiguration);\n            }\n            else if (type === 2) {\n                actor = vtkAxesActor.newInstance();\n            }\n            else if (type === 3) {\n                actor = await this.createCustomActor();\n            }\n            const renderer = viewport.getRenderer();\n            const renderWindow = viewport\n                .getRenderingEngine()\n                .offscreenMultiRenderWindow.getRenderWindow();\n            const { enabled, viewportCorner, viewportSize, minPixelSize, maxPixelSize, } = this.configuration.orientationWidget;\n            const orientationWidget = vtkOrientationMarkerWidget.newInstance({\n                actor,\n                interactor: renderWindow.getInteractor(),\n                parentRenderer: renderer,\n            });\n            orientationWidget.setEnabled(enabled);\n            orientationWidget.setViewportCorner(viewportCorner);\n            orientationWidget.setViewportSize(viewportSize);\n            orientationWidget.setMinPixelSize(minPixelSize);\n            orientationWidget.setMaxPixelSize(maxPixelSize);\n            orientationWidget.updateMarkerOrientation();\n            this.orientationMarkers[viewportId] = {\n                orientationWidget,\n                actor,\n            };\n            viewport.addWidget(this.getToolName(), orientationWidget);\n            renderWindow.render();\n            viewport.getRenderingEngine().render();\n            this.updatingOrientationMarker[viewportId] = false;\n        }\n    }\n    async createCustomActor() {\n        const url = this.configuration.overlayConfiguration[OverlayMarkerType.CUSTOM]\n            .polyDataURL;\n        const response = await fetch(url);\n        const arrayBuffer = await response.arrayBuffer();\n        const vtpReader = vtkXMLPolyDataReader.newInstance();\n        vtpReader.parseAsArrayBuffer(arrayBuffer);\n        vtpReader.update();\n        const polyData = vtkPolyData.newInstance();\n        polyData.shallowCopy(vtpReader.getOutputData());\n        polyData.getPointData().setActiveScalars('Color');\n        const mapper = vtkMapper.newInstance();\n        mapper.setInputData(polyData);\n        mapper.setColorModeToDirectScalars();\n        const actor = vtkActor.newInstance();\n        actor.setMapper(mapper);\n        actor.rotateZ(180);\n        return actor;\n    }\n    createAnnotationCube(overlayConfiguration) {\n        const actor = vtkAnnotatedCubeActor.newInstance();\n        actor.setDefaultStyle({ ...overlayConfiguration.defaultStyle });\n        actor.setXPlusFaceProperty({\n            ...overlayConfiguration.faceProperties.xPlus,\n        });\n        actor.setXMinusFaceProperty({\n            ...overlayConfiguration.faceProperties.xMinus,\n        });\n        actor.setYPlusFaceProperty({\n            ...overlayConfiguration.faceProperties.yPlus,\n        });\n        actor.setYMinusFaceProperty({\n            ...overlayConfiguration.faceProperties.yMinus,\n        });\n        actor.setZPlusFaceProperty({\n            ...overlayConfiguration.faceProperties.zPlus,\n        });\n        actor.setZMinusFaceProperty({\n            ...overlayConfiguration.faceProperties.zMinus,\n        });\n        return actor;\n    }\n    async createAnnotatedCubeActor() {\n        const axes = vtkAnnotatedCubeActor.newInstance();\n        const { faceProperties, defaultStyle } = this.configuration.annotatedCube;\n        axes.setDefaultStyle(defaultStyle);\n        Object.keys(faceProperties).forEach((key) => {\n            const methodName = `set${key.charAt(0).toUpperCase() + key.slice(1)}FaceProperty`;\n            axes[methodName](faceProperties[key]);\n        });\n        return axes;\n    }\n}\nOrientationMarkerTool.toolName = 'OrientationMarker';\nexport default OrientationMarkerTool;\n","import { getEnabledElement } from '@cornerstonejs/core';\nimport { BaseTool } from '../base';\nimport { triggerSegmentationModified } from '../../stateManagement/segmentation/triggerSegmentationEvents';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { getActiveSegmentation } from '../../stateManagement/segmentation/activeSegmentation';\nimport RepresentationTypes from '../../enums/SegmentationRepresentations';\nimport { setActiveSegmentIndex } from '../../stateManagement/segmentation/segmentIndex';\nimport { getHoveredContourSegmentationAnnotation, getSegmentIndexAtLabelmapBorder, getSegmentIndexAtWorldPoint, } from '../../utilities/segmentation';\nimport { state } from '../../store/state';\nimport SegmentationRepresentations from '../../enums/SegmentationRepresentations';\nclass SegmentSelectTool extends BaseTool {\n    static { this.SelectMode = {\n        Inside: 'Inside',\n        Border: 'Border',\n    }; }\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            hoverTimeout: 100,\n            mode: SegmentSelectTool.SelectMode.Border,\n            searchRadius: 6,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.mouseMoveCallback = (evt) => {\n            if (this.hoverTimer) {\n                clearTimeout(this.hoverTimer);\n            }\n            this.hoverTimer = setTimeout(() => {\n                this._setActiveSegment(evt);\n                this.hoverTimer = null;\n            }, this.configuration.hoverTimeout);\n            return true;\n        };\n        this.onSetToolEnabled = () => {\n            this.onSetToolActive();\n        };\n        this.onSetToolActive = () => {\n            this.hoverTimer = null;\n        };\n        this.onSetToolDisabled = () => {\n            this.hoverTimer = null;\n        };\n        this.hoverTimer = null;\n    }\n    _setActiveSegment(evt = {}) {\n        if (state.isInteractingWithTool) {\n            return;\n        }\n        const { element, currentPoints } = evt.detail;\n        const worldPoint = currentPoints.world;\n        const enabledElement = getEnabledElement(element);\n        if (!enabledElement) {\n            return;\n        }\n        const { viewport } = enabledElement;\n        const activeSegmentation = getActiveSegmentation(viewport.id);\n        if (!activeSegmentation) {\n            return;\n        }\n        this._setActiveSegmentForType(activeSegmentation, worldPoint, viewport);\n    }\n    _setActiveSegmentForType(activeSegmentation, worldPoint, viewport) {\n        const imageDataInfo = viewport.getImageData();\n        if (!imageDataInfo) {\n            return;\n        }\n        const { segmentationId, representationData } = activeSegmentation;\n        let hoveredSegmentIndex;\n        if (this.configuration.mode === SegmentSelectTool.SelectMode.Inside) {\n            hoveredSegmentIndex = getSegmentIndexAtWorldPoint(segmentationId, worldPoint, {\n                viewport,\n            });\n        }\n        else {\n            if (representationData.Labelmap) {\n                hoveredSegmentIndex = getSegmentIndexAtLabelmapBorder(segmentationId, worldPoint, {\n                    viewport,\n                    searchRadius: this.configuration.searchRadius,\n                });\n            }\n            else if (representationData.Contour) {\n                hoveredSegmentIndex =\n                    getHoveredContourSegmentationAnnotation(segmentationId);\n            }\n            else if (representationData.Surface) {\n            }\n        }\n        if (!hoveredSegmentIndex || hoveredSegmentIndex === 0) {\n            return;\n        }\n        setActiveSegmentIndex(segmentationId, hoveredSegmentIndex);\n        const renderingEngine = viewport.getRenderingEngine();\n        const viewportIds = renderingEngine.getViewports().map((v) => v.id);\n        triggerSegmentationModified(segmentationId);\n        triggerAnnotationRenderForViewportIds(viewportIds);\n    }\n}\nSegmentSelectTool.toolName = 'SegmentSelectTool';\nexport default SegmentSelectTool;\n","import { vec3, vec2 } from 'gl-matrix';\nimport { getEnabledElement, triggerEvent, eventTarget, utilities as csUtils, cache, } from '@cornerstonejs/core';\nimport { AnnotationTool } from '../base';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement';\nimport { drawHandles as drawHandlesSvg, drawRedactionRect as drawRedactionRectSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { Events } from '../../enums';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport * as rectangle from '../../utilities/math/rectangle';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport getWorldWidthAndHeightFromTwoPoints from '../../utilities/planar/getWorldWidthAndHeightFromTwoPoints';\nclass VideoRedactionTool extends AnnotationTool {\n    constructor(toolConfiguration = {}) {\n        super(toolConfiguration, {\n            supportedInteractionTypes: ['Mouse', 'Touch'],\n            configuration: { shadow: true, preventHandleOutsideImage: false },\n        });\n        this.addNewAnnotation = (evt) => {\n            const eventData = evt.detail;\n            const { currentPoints, element } = eventData;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const annotation = {\n                metadata: {\n                    viewPlaneNormal: [0, 0, 1],\n                    viewUp: [0, 1, 0],\n                    FrameOfReferenceUID: viewport.getFrameOfReferenceUID(),\n                    referencedImageId,\n                    toolName: this.getToolName(),\n                },\n                data: {\n                    invalidated: true,\n                    handles: {\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                        activeHandleIndex: null,\n                    },\n                    cachedStats: {},\n                    active: true,\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportUIDsToRender = getViewportIdsWithToolToRender(element, this.getToolName(), false);\n            this.editData = {\n                annotation,\n                viewportUIDsToRender,\n                handleIndex: 3,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportUIDsToRender);\n            return annotation;\n        };\n        this.getHandleNearImagePoint = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { points } = data.handles;\n            for (let i = 0; i < points.length; i++) {\n                const point = points[i];\n                const toolDataCanvasCoordinate = viewport.worldToCanvas(point);\n                const near = vec2.distance(canvasCoords, toolDataCanvasCoordinate) < proximity;\n                if (near === true) {\n                    data.handles.activeHandleIndex = i;\n                    return point;\n                }\n            }\n            data.handles.activeHandleIndex = null;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasPoint1 = viewport.worldToCanvas(points[0]);\n            const canvasPoint2 = viewport.worldToCanvas(points[3]);\n            const rect = this._getRectangleImageCoordinates([\n                canvasPoint1,\n                canvasPoint2,\n            ]);\n            const point = [canvasCoords[0], canvasCoords[1]];\n            const { left, top, width, height } = rect;\n            const distanceToPoint = rectangle.distanceToPoint([left, top, width, height], point);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n        };\n        this.toolSelectedCallback = (evt, annotation, interactionType = 'mouse') => {\n            const eventData = evt.detail;\n            const { element } = eventData;\n            const { data } = annotation;\n            data.active = true;\n            const viewportUIDsToRender = getViewportIdsWithToolToRender(element, this.getToolName(), false);\n            this.editData = {\n                annotation,\n                viewportUIDsToRender,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            triggerAnnotationRenderForViewportIds(viewportUIDsToRender);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation, handle, interactionType = 'mouse') => {\n            const eventData = evt.detail;\n            const { element } = eventData;\n            const { data } = annotation;\n            data.active = true;\n            let movingTextBox = false;\n            let handleIndex;\n            if (handle.worldPosition) {\n                movingTextBox = true;\n            }\n            else {\n                handleIndex = data.handles.points.findIndex((p) => p === handle);\n            }\n            const viewportUIDsToRender = getViewportIdsWithToolToRender(element, this.getToolName(), false);\n            this.editData = {\n                annotation,\n                viewportUIDsToRender,\n                handleIndex,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            triggerAnnotationRenderForViewportIds(viewportUIDsToRender);\n            evt.preventDefault();\n        };\n        this._mouseUpCallback = (evt) => {\n            const eventData = evt.detail;\n            const { element } = eventData;\n            const { annotation, viewportUIDsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.active = false;\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            this.editData = null;\n            this.isDrawing = false;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportUIDsToRender);\n        };\n        this._mouseDragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventData = evt.detail;\n            const { element } = eventData;\n            const { annotation, viewportUIDsToRender, handleIndex } = this.editData;\n            const { data } = annotation;\n            if (handleIndex === undefined) {\n                const { deltaPoints } = eventData;\n                const worldPosDelta = deltaPoints.world;\n                const { points } = data.handles;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                data.invalidated = true;\n            }\n            else {\n                const { currentPoints } = eventData;\n                const enabledElement = getEnabledElement(element);\n                const { worldToCanvas, canvasToWorld } = enabledElement.viewport;\n                const worldPos = currentPoints.world;\n                const { points } = data.handles;\n                points[handleIndex] = [...worldPos];\n                let bottomLeftCanvas;\n                let bottomRightCanvas;\n                let topLeftCanvas;\n                let topRightCanvas;\n                let bottomLeftWorld;\n                let bottomRightWorld;\n                let topLeftWorld;\n                let topRightWorld;\n                switch (handleIndex) {\n                    case 0:\n                    case 3:\n                        bottomLeftCanvas = worldToCanvas(points[0]);\n                        topRightCanvas = worldToCanvas(points[3]);\n                        bottomRightCanvas = [topRightCanvas[0], bottomLeftCanvas[1]];\n                        topLeftCanvas = [bottomLeftCanvas[0], topRightCanvas[1]];\n                        bottomRightWorld = canvasToWorld(bottomRightCanvas);\n                        topLeftWorld = canvasToWorld(topLeftCanvas);\n                        points[1] = bottomRightWorld;\n                        points[2] = topLeftWorld;\n                        break;\n                    case 1:\n                    case 2:\n                        bottomRightCanvas = worldToCanvas(points[1]);\n                        topLeftCanvas = worldToCanvas(points[2]);\n                        bottomLeftCanvas = [\n                            topLeftCanvas[0],\n                            bottomRightCanvas[1],\n                        ];\n                        topRightCanvas = [\n                            bottomRightCanvas[0],\n                            topLeftCanvas[1],\n                        ];\n                        bottomLeftWorld = canvasToWorld(bottomLeftCanvas);\n                        topRightWorld = canvasToWorld(topRightCanvas);\n                        points[0] = bottomLeftWorld;\n                        points[3] = topRightWorld;\n                        break;\n                }\n                data.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            triggerAnnotationRenderForViewportIds(viewportUIDsToRender);\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._mouseUpCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._mouseDragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._mouseDragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._mouseUpCallback);\n            element.addEventListener(Events.TOUCH_END, this._mouseUpCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._mouseDragCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._mouseUpCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._mouseDragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._mouseDragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._mouseUpCallback);\n            element.removeEventListener(Events.TOUCH_END, this._mouseUpCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._mouseDragCallback);\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._mouseUpCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._mouseDragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._mouseUpCallback);\n            element.addEventListener(Events.TOUCH_END, this._mouseUpCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._mouseDragCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._mouseUpCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._mouseDragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._mouseUpCallback);\n            element.removeEventListener(Events.TOUCH_END, this._mouseUpCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._mouseDragCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            const renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID } = annotation;\n                const toolMetadata = annotation.metadata;\n                const data = annotation.data;\n                const { points, activeHandleIndex } = data.handles;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n                const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return;\n                }\n                let activeHandleCanvasCoords;\n                if (!this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                const rectangleUID = '0';\n                drawRedactionRectSvg(svgDrawingHelper, annotationUID, rectangleUID, canvasCoordinates[0], canvasCoordinates[3], {\n                    color: 'black',\n                    lineDash,\n                    lineWidth,\n                });\n            }\n        };\n        this._getRectangleImageCoordinates = (points) => {\n            const [point0, point1] = points;\n            return {\n                left: Math.min(point0[0], point1[0]),\n                top: Math.min(point0[1], point1[1]),\n                width: Math.abs(point0[0] - point1[0]),\n                height: Math.abs(point0[1] - point1[1]),\n            };\n        };\n        this._calculateCachedStats = (annotation, viewPlaneNormal, viewUp, renderingEngine, enabledElement) => {\n            const { data } = annotation;\n            const { viewportUID, renderingEngineUID, sceneUID } = enabledElement;\n            const worldPos1 = data.handles.points[0];\n            const worldPos2 = data.handles.points[3];\n            const { cachedStats } = data;\n            const targetUIDs = Object.keys(cachedStats);\n            for (let i = 0; i < targetUIDs.length; i++) {\n                const targetUID = targetUIDs[i];\n                const { imageVolume } = this._getImageVolumeFromTargetUID(targetUID, renderingEngine);\n                const { dimensions, scalarData, vtkImageData: imageData, metadata, } = imageVolume;\n                const worldPos1Index = vec3.fromValues(0, 0, 0);\n                const worldPos2Index = vec3.fromValues(0, 0, 0);\n                imageData.worldToIndexVec3(worldPos1, worldPos1Index);\n                worldPos1Index[0] = Math.floor(worldPos1Index[0]);\n                worldPos1Index[1] = Math.floor(worldPos1Index[1]);\n                worldPos1Index[2] = Math.floor(worldPos1Index[2]);\n                imageData.worldToIndexVec3(worldPos2, worldPos2Index);\n                worldPos2Index[0] = Math.floor(worldPos2Index[0]);\n                worldPos2Index[1] = Math.floor(worldPos2Index[1]);\n                worldPos2Index[2] = Math.floor(worldPos2Index[2]);\n                if (this._isInsideVolume(worldPos1Index, worldPos2Index, dimensions)) {\n                    this.isHandleOutsideImage = false;\n                    const iMin = Math.min(worldPos1Index[0], worldPos2Index[0]);\n                    const iMax = Math.max(worldPos1Index[0], worldPos2Index[0]);\n                    const jMin = Math.min(worldPos1Index[1], worldPos2Index[1]);\n                    const jMax = Math.max(worldPos1Index[1], worldPos2Index[1]);\n                    const kMin = Math.min(worldPos1Index[2], worldPos2Index[2]);\n                    const kMax = Math.max(worldPos1Index[2], worldPos2Index[2]);\n                    const { worldWidth, worldHeight } = getWorldWidthAndHeightFromTwoPoints(viewPlaneNormal, viewUp, worldPos1, worldPos2);\n                    const area = worldWidth * worldHeight;\n                    let count = 0;\n                    let mean = 0;\n                    let stdDev = 0;\n                    const yMultiple = dimensions[0];\n                    const zMultiple = dimensions[0] * dimensions[1];\n                    for (let k = kMin; k <= kMax; k++) {\n                        for (let j = jMin; j <= jMax; j++) {\n                            for (let i = iMin; i <= iMax; i++) {\n                                const value = scalarData[k * zMultiple + j * yMultiple + i];\n                                count++;\n                                mean += value;\n                            }\n                        }\n                    }\n                    mean /= count;\n                    for (let k = kMin; k <= kMax; k++) {\n                        for (let j = jMin; j <= jMax; j++) {\n                            for (let i = iMin; i <= iMax; i++) {\n                                const value = scalarData[k * zMultiple + j * yMultiple + i];\n                                const valueMinusMean = value - mean;\n                                stdDev += valueMinusMean * valueMinusMean;\n                            }\n                        }\n                    }\n                    stdDev /= count;\n                    stdDev = Math.sqrt(stdDev);\n                    cachedStats[targetUID] = {\n                        Modality: metadata.Modality,\n                        area,\n                        mean,\n                        stdDev,\n                    };\n                }\n                else {\n                    this.isHandleOutsideImage = true;\n                    cachedStats[targetUID] = {\n                        Modality: metadata.Modality,\n                    };\n                }\n            }\n            data.invalidated = false;\n            const eventType = Events.ANNOTATION_MODIFIED;\n            const eventDetail = {\n                annotation,\n                viewportUID,\n                renderingEngineUID,\n                sceneUID: sceneUID,\n            };\n            triggerEvent(eventTarget, eventType, eventDetail);\n            return cachedStats;\n        };\n        this._isInsideVolume = (index1, index2, dimensions) => {\n            return (csUtils.indexWithinDimensions(index1, dimensions) &&\n                csUtils.indexWithinDimensions(index2, dimensions));\n        };\n        this._getTargetVolumeUID = (scene) => {\n            if (this.configuration.volumeUID) {\n                return this.configuration.volumeUID;\n            }\n            const volumeActors = scene.getVolumeActors();\n            if (!volumeActors && !volumeActors.length) {\n                return;\n            }\n            return volumeActors[0].uid;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    cancel(element) {\n        if (!this.isDrawing) {\n            return;\n        }\n        this.isDrawing = false;\n        this._deactivateDraw(element);\n        this._deactivateModify(element);\n        resetElementCursor(element);\n        const { annotation, viewportUIDsToRender } = this.editData;\n        const { data } = annotation;\n        data.active = false;\n        data.handles.activeHandleIndex = null;\n        triggerAnnotationRenderForViewportIds(viewportUIDsToRender);\n        this.editData = null;\n        return annotation.metadata.annotationUID;\n    }\n    _getImageVolumeFromTargetUID(targetUID, renderingEngine) {\n        let imageVolume, viewport;\n        if (targetUID.startsWith('stackTarget')) {\n            const coloneIndex = targetUID.indexOf(':');\n            const viewportUID = targetUID.substring(coloneIndex + 1);\n            const viewport = renderingEngine.getViewport(viewportUID);\n            imageVolume = viewport.getImageData();\n        }\n        else {\n            imageVolume = cache.getVolume(targetUID);\n        }\n        return { imageVolume, viewport };\n    }\n    _getTargetStackUID(viewport) {\n        return `stackTarget:${viewport.uid}`;\n    }\n}\nVideoRedactionTool.toolName = 'VideoRedaction';\nexport default VideoRedactionTool;\n","import { getEnabledElement, triggerEvent, getRenderingEngine, } from '@cornerstonejs/core';\nimport { Events, ToolModes } from '../../enums';\nimport { draw as drawSvg } from '../../drawingSvg';\nimport getToolsWithModesForElement from '../../utilities/getToolsWithModesForElement';\nconst { Active, Passive, Enabled } = ToolModes;\nclass AnnotationRenderingEngine {\n    constructor() {\n        this._needsRender = new Set();\n        this._animationFrameSet = false;\n        this._animationFrameHandle = null;\n        this._renderFlaggedViewports = () => {\n            this._throwIfDestroyed();\n            const elements = Array.from(this._viewportElements.values());\n            for (let i = 0; i < elements.length; i++) {\n                const element = elements[i];\n                if (this._needsRender.has(element)) {\n                    this._triggerRender(element);\n                    this._needsRender.delete(element);\n                    if (this._needsRender.size === 0) {\n                        break;\n                    }\n                }\n            }\n            this._animationFrameSet = false;\n            this._animationFrameHandle = null;\n            this._render();\n        };\n        this._viewportElements = new Map();\n    }\n    addViewportElement(viewportId, element) {\n        this._viewportElements.set(viewportId, element);\n    }\n    removeViewportElement(viewportId, element) {\n        this._viewportElements.delete(viewportId);\n        this._needsRender.delete(element);\n        this._reset();\n    }\n    renderViewport(element) {\n        this._setViewportsToBeRenderedNextFrame([element]);\n    }\n    _throwIfDestroyed() {\n        if (this.hasBeenDestroyed) {\n            throw new Error('this.destroy() has been manually called to free up memory, can not longer use this instance. Instead make a new one.');\n        }\n    }\n    _setAllViewportsToBeRenderedNextFrame() {\n        const elements = [...this._viewportElements.values()];\n        elements.forEach((element) => {\n            this._needsRender.add(element);\n        });\n        this._renderFlaggedViewports();\n    }\n    _setViewportsToBeRenderedNextFrame(elements) {\n        const elementsEnabled = [...this._viewportElements.values()];\n        elements.forEach((element) => {\n            if (elementsEnabled.indexOf(element) !== -1) {\n                this._needsRender.add(element);\n            }\n        });\n        this._render();\n    }\n    _render() {\n        if (this._needsRender.size > 0 && this._animationFrameSet === false) {\n            this._animationFrameHandle = window.requestAnimationFrame(this._renderFlaggedViewports);\n            this._animationFrameSet = true;\n        }\n    }\n    _triggerRender(element) {\n        const enabledElement = getEnabledElement(element);\n        if (!enabledElement) {\n            return;\n        }\n        const renderingEngine = getRenderingEngine(enabledElement.renderingEngineId);\n        if (!renderingEngine) {\n            console.warn('rendering Engine has been destroyed');\n            return;\n        }\n        const enabledTools = getToolsWithModesForElement(element, [\n            Active,\n            Passive,\n            Enabled,\n        ]);\n        const { renderingEngineId, viewportId } = enabledElement;\n        const eventDetail = {\n            element,\n            renderingEngineId,\n            viewportId,\n        };\n        drawSvg(element, (svgDrawingHelper) => {\n            let anyRendered = false;\n            const handleDrawSvg = (tool) => {\n                if (tool.renderAnnotation) {\n                    const rendered = tool.renderAnnotation(enabledElement, svgDrawingHelper);\n                    anyRendered = anyRendered || rendered;\n                }\n            };\n            enabledTools.forEach(handleDrawSvg);\n            if (anyRendered) {\n                triggerEvent(element, Events.ANNOTATION_RENDERED, { ...eventDetail });\n            }\n        });\n    }\n    _reset() {\n        window.cancelAnimationFrame(this._animationFrameHandle);\n        this._needsRender.clear();\n        this._animationFrameSet = false;\n        this._animationFrameHandle = null;\n        this._setAllViewportsToBeRenderedNextFrame();\n    }\n}\nconst annotationRenderingEngine = new AnnotationRenderingEngine();\nexport { annotationRenderingEngine };\n","import { Enums, eventTarget, getEnabledElement, utilities, } from '@cornerstonejs/core';\nclass FrameOfReferenceSpecificAnnotationManager {\n    constructor(uid) {\n        this.getGroupKey = (annotationGroupSelector) => {\n            if (typeof annotationGroupSelector === 'string') {\n                return annotationGroupSelector;\n            }\n            const element = annotationGroupSelector;\n            const enabledElement = getEnabledElement(element);\n            if (!enabledElement) {\n                throw new Error('Element not enabled, you must have an enabled element if you are not providing a FrameOfReferenceUID');\n            }\n            return enabledElement.FrameOfReferenceUID;\n        };\n        this._imageVolumeModifiedHandler = (evt) => {\n            const eventDetail = evt.detail;\n            const { FrameOfReferenceUID } = eventDetail;\n            const annotations = this.annotations;\n            const frameOfReferenceSpecificAnnotations = annotations[FrameOfReferenceUID];\n            if (!frameOfReferenceSpecificAnnotations) {\n                return;\n            }\n            Object.keys(frameOfReferenceSpecificAnnotations).forEach((toolName) => {\n                const toolSpecificAnnotations = frameOfReferenceSpecificAnnotations[toolName];\n                toolSpecificAnnotations.forEach((annotation) => {\n                    const invalidated = annotation.invalidated;\n                    if (invalidated !== undefined) {\n                        annotation.invalidated = true;\n                    }\n                });\n            });\n        };\n        this.getFramesOfReference = () => {\n            return Object.keys(this.annotations);\n        };\n        this.getAnnotations = (groupKey, toolName) => {\n            const annotations = this.annotations;\n            if (!annotations[groupKey]) {\n                return [];\n            }\n            if (toolName) {\n                return annotations[groupKey][toolName]\n                    ? annotations[groupKey][toolName]\n                    : [];\n            }\n            return annotations[groupKey];\n        };\n        this.getAnnotation = (annotationUID) => {\n            const annotations = this.annotations;\n            for (const frameOfReferenceUID in annotations) {\n                const frameOfReferenceAnnotations = annotations[frameOfReferenceUID];\n                for (const toolName in frameOfReferenceAnnotations) {\n                    const toolSpecificAnnotations = frameOfReferenceAnnotations[toolName];\n                    for (const annotation of toolSpecificAnnotations) {\n                        if (annotationUID === annotation.annotationUID) {\n                            return annotation;\n                        }\n                    }\n                }\n            }\n        };\n        this.getNumberOfAnnotations = (groupKey, toolName) => {\n            const annotations = this.getAnnotations(groupKey, toolName);\n            if (!annotations.length) {\n                return 0;\n            }\n            if (toolName) {\n                return annotations.length;\n            }\n            let total = 0;\n            for (const toolName in annotations) {\n                total += annotations[toolName].length;\n            }\n            return total;\n        };\n        this.addAnnotation = (annotation, groupKey) => {\n            const { metadata } = annotation;\n            const { FrameOfReferenceUID, toolName } = metadata;\n            groupKey = groupKey || FrameOfReferenceUID;\n            const annotations = this.annotations;\n            let frameOfReferenceSpecificAnnotations = annotations[groupKey];\n            if (!frameOfReferenceSpecificAnnotations) {\n                annotations[groupKey] = {};\n                frameOfReferenceSpecificAnnotations = annotations[groupKey];\n            }\n            let toolSpecificAnnotations = frameOfReferenceSpecificAnnotations[toolName];\n            if (!toolSpecificAnnotations) {\n                frameOfReferenceSpecificAnnotations[toolName] = [];\n                toolSpecificAnnotations = frameOfReferenceSpecificAnnotations[toolName];\n            }\n            if (this.preprocessingFn) {\n                annotation = this.preprocessingFn(annotation);\n            }\n            toolSpecificAnnotations.push(annotation);\n        };\n        this.removeAnnotation = (annotationUID) => {\n            const { annotations } = this;\n            for (const groupKey in annotations) {\n                const groupAnnotations = annotations[groupKey];\n                for (const toolName in groupAnnotations) {\n                    const toolAnnotations = groupAnnotations[toolName];\n                    const index = toolAnnotations.findIndex((annotation) => annotation.annotationUID === annotationUID);\n                    if (index !== -1) {\n                        toolAnnotations.splice(index, 1);\n                        if (toolAnnotations.length === 0) {\n                            delete groupAnnotations[toolName];\n                        }\n                    }\n                }\n                if (Object.keys(groupAnnotations).length === 0) {\n                    delete annotations[groupKey];\n                }\n            }\n        };\n        this.removeAnnotations = (groupKey, toolName) => {\n            const annotations = this.annotations;\n            const removedAnnotations = [];\n            if (!annotations[groupKey]) {\n                return removedAnnotations;\n            }\n            if (toolName) {\n                const annotationsForTool = annotations[groupKey][toolName];\n                for (const annotation of annotationsForTool) {\n                    this.removeAnnotation(annotation.annotationUID);\n                    removedAnnotations.push(annotation);\n                }\n            }\n            else {\n                for (const toolName in annotations[groupKey]) {\n                    const annotationsForTool = annotations[groupKey][toolName];\n                    for (const annotation of annotationsForTool) {\n                        this.removeAnnotation(annotation.annotationUID);\n                        removedAnnotations.push(annotation);\n                    }\n                }\n            }\n            return removedAnnotations;\n        };\n        this.saveAnnotations = (groupKey, toolName) => {\n            const annotations = this.annotations;\n            if (groupKey && toolName) {\n                const frameOfReferenceSpecificAnnotations = annotations[groupKey];\n                if (!frameOfReferenceSpecificAnnotations) {\n                    return;\n                }\n                const toolSpecificAnnotations = frameOfReferenceSpecificAnnotations[toolName];\n                return structuredClone(toolSpecificAnnotations);\n            }\n            else if (groupKey) {\n                const frameOfReferenceSpecificAnnotations = annotations[groupKey];\n                return structuredClone(frameOfReferenceSpecificAnnotations);\n            }\n            return structuredClone(annotations);\n        };\n        this.restoreAnnotations = (state, groupKey, toolName) => {\n            const annotations = this.annotations;\n            if (groupKey && toolName) {\n                let frameOfReferenceSpecificAnnotations = annotations[groupKey];\n                if (!frameOfReferenceSpecificAnnotations) {\n                    annotations[groupKey] = {};\n                    frameOfReferenceSpecificAnnotations = annotations[groupKey];\n                }\n                frameOfReferenceSpecificAnnotations[toolName] = state;\n            }\n            else if (groupKey) {\n                annotations[groupKey] = state;\n            }\n            else {\n                this.annotations = structuredClone(state);\n            }\n        };\n        this.getAllAnnotations = () => {\n            return Object.values(this.annotations)\n                .map((frameOfReferenceSpecificAnnotations) => Object.values(frameOfReferenceSpecificAnnotations))\n                .flat(2);\n        };\n        this.getNumberOfAllAnnotations = () => {\n            let count = 0;\n            const annotations = this.annotations;\n            for (const groupKey in annotations) {\n                const frameOfReferenceSpecificAnnotations = annotations[groupKey];\n                for (const toolName in frameOfReferenceSpecificAnnotations) {\n                    const toolSpecificAnnotations = frameOfReferenceSpecificAnnotations[toolName];\n                    count += toolSpecificAnnotations.length;\n                }\n            }\n            return count;\n        };\n        this.removeAllAnnotations = () => {\n            const removedAnnotations = [];\n            for (const annotation of this.getAllAnnotations()) {\n                this.removeAnnotation(annotation.annotationUID);\n                removedAnnotations.push(annotation);\n            }\n            return removedAnnotations;\n        };\n        if (!uid) {\n            uid = utilities.uuidv4();\n        }\n        this.annotations = {};\n        this.uid = uid;\n        eventTarget.addEventListener(Enums.Events.IMAGE_VOLUME_MODIFIED, this._imageVolumeModifiedHandler);\n    }\n    setPreprocessingFn(preprocessingFn) {\n        this.preprocessingFn = preprocessingFn;\n    }\n}\nconst defaultFrameOfReferenceSpecificAnnotationManager = new FrameOfReferenceSpecificAnnotationManager('DEFAULT');\nexport { defaultFrameOfReferenceSpecificAnnotationManager };\nexport default FrameOfReferenceSpecificAnnotationManager;\n","import { eventTarget, triggerEvent } from '@cornerstonejs/core';\nimport { Events } from '../../enums';\nimport { getAnnotation } from './getAnnotation';\nconst globalLockedAnnotationUIDsSet = new Set();\nfunction setAnnotationLocked(annotationUID, locked = true) {\n    const detail = makeEventDetail();\n    if (annotationUID) {\n        if (locked) {\n            lock(annotationUID, globalLockedAnnotationUIDsSet, detail);\n        }\n        else {\n            unlock(annotationUID, globalLockedAnnotationUIDsSet, detail);\n        }\n    }\n    publish(detail, globalLockedAnnotationUIDsSet);\n}\nfunction unlockAllAnnotations() {\n    const detail = makeEventDetail();\n    clearLockedAnnotationsSet(globalLockedAnnotationUIDsSet, detail);\n    publish(detail, globalLockedAnnotationUIDsSet);\n}\nfunction getAnnotationsLocked() {\n    return Array.from(globalLockedAnnotationUIDsSet);\n}\nfunction isAnnotationLocked(annotationUID) {\n    return globalLockedAnnotationUIDsSet.has(annotationUID);\n}\nfunction getAnnotationsLockedCount() {\n    return globalLockedAnnotationUIDsSet.size;\n}\nfunction checkAndSetAnnotationLocked(annotationUID) {\n    const isLocked = isAnnotationLocked(annotationUID);\n    setAnnotationLocked(annotationUID, isLocked);\n    return isLocked;\n}\nfunction makeEventDetail() {\n    return Object.freeze({\n        added: [],\n        removed: [],\n        locked: [],\n    });\n}\nfunction lock(annotationUID, lockedAnnotationUIDsSet, detail) {\n    if (!lockedAnnotationUIDsSet.has(annotationUID)) {\n        lockedAnnotationUIDsSet.add(annotationUID);\n        detail.added.push(annotationUID);\n        const annotation = getAnnotation(annotationUID);\n        if (annotation) {\n            annotation.isLocked = true;\n        }\n    }\n}\nfunction unlock(annotationUID, lockedAnnotationUIDsSet, detail) {\n    if (lockedAnnotationUIDsSet.delete(annotationUID)) {\n        detail.removed.push(annotationUID);\n        const annotation = getAnnotation(annotationUID);\n        if (annotation) {\n            annotation.isLocked = false;\n        }\n    }\n}\nfunction clearLockedAnnotationsSet(lockedAnnotationUIDsSet, detail) {\n    lockedAnnotationUIDsSet.forEach((annotationUID) => {\n        unlock(annotationUID, lockedAnnotationUIDsSet, detail);\n    });\n}\nfunction publish(detail, lockedAnnotationUIDsSet) {\n    if (detail.added.length > 0 || detail.removed.length > 0) {\n        lockedAnnotationUIDsSet.forEach((item) => void detail.locked.push(item));\n        triggerEvent(eventTarget, Events.ANNOTATION_LOCK_CHANGE, detail);\n    }\n}\nexport { setAnnotationLocked, getAnnotationsLocked, getAnnotationsLockedCount, unlockAllAnnotations, isAnnotationLocked, checkAndSetAnnotationLocked, };\n","import { eventTarget, triggerEvent } from '@cornerstonejs/core';\nimport { Events } from '../../enums';\nimport { getAnnotation } from './getAnnotation';\nconst selectedAnnotationUIDs = new Set();\nfunction setAnnotationSelected(annotationUID, selected = true, preserveSelected = false) {\n    if (selected) {\n        selectAnnotation(annotationUID, preserveSelected);\n    }\n    else {\n        deselectAnnotation(annotationUID);\n    }\n}\nfunction selectAnnotation(annotationUID, preserveSelected = false) {\n    const detail = makeEventDetail();\n    if (!preserveSelected) {\n        clearSelectionSet(selectedAnnotationUIDs, detail);\n        const annotation = getAnnotation(annotationUID);\n        if (annotation) {\n            annotation.isSelected = true;\n        }\n    }\n    if (annotationUID && !selectedAnnotationUIDs.has(annotationUID)) {\n        selectedAnnotationUIDs.add(annotationUID);\n        detail.added.push(annotationUID);\n        const annotation = getAnnotation(annotationUID);\n        if (annotation) {\n            annotation.isSelected = true;\n        }\n    }\n    publish(detail, selectedAnnotationUIDs);\n}\nfunction deselectAnnotation(annotationUID) {\n    const detail = makeEventDetail();\n    if (annotationUID) {\n        if (selectedAnnotationUIDs.delete(annotationUID)) {\n            detail.removed.push(annotationUID);\n            const annotation = getAnnotation(annotationUID);\n            annotation.isSelected = false;\n        }\n    }\n    else {\n        clearSelectionSet(selectedAnnotationUIDs, detail);\n    }\n    publish(detail, selectedAnnotationUIDs);\n}\nfunction getAnnotationsSelected() {\n    return Array.from(selectedAnnotationUIDs);\n}\nfunction getAnnotationsSelectedByToolName(toolName) {\n    return getAnnotationsSelected().filter((annotationUID) => {\n        const annotation = getAnnotation(annotationUID);\n        return annotation?.metadata?.toolName === toolName;\n    });\n}\nfunction isAnnotationSelected(annotationUID) {\n    return selectedAnnotationUIDs.has(annotationUID);\n}\nfunction getAnnotationsSelectedCount() {\n    return selectedAnnotationUIDs.size;\n}\nfunction makeEventDetail() {\n    return Object.freeze({\n        added: [],\n        removed: [],\n        selection: [],\n    });\n}\nfunction clearSelectionSet(selectionSet, detail) {\n    selectionSet.forEach((value) => {\n        if (selectionSet.delete(value)) {\n            detail.removed.push(value);\n            const annotation = getAnnotation(value);\n            if (annotation) {\n                annotation.isSelected = false;\n            }\n        }\n    });\n}\nfunction publish(detail, selectionSet) {\n    if (detail.added.length > 0 || detail.removed.length > 0) {\n        selectionSet.forEach((item) => void detail.selection.push(item));\n        triggerEvent(eventTarget, Events.ANNOTATION_SELECTION_CHANGE, detail);\n    }\n}\nexport { setAnnotationSelected, getAnnotationsSelected, getAnnotationsSelectedByToolName, getAnnotationsSelectedCount, deselectAnnotation, isAnnotationSelected, };\n","import { utilities as csUtils } from '@cornerstonejs/core';\nimport { defaultFrameOfReferenceSpecificAnnotationManager } from './FrameOfReferenceSpecificAnnotationManager';\nimport { getAnnotation } from './getAnnotation';\nimport { triggerAnnotationAddedForElement, triggerAnnotationAddedForFOR, triggerAnnotationRemoved, } from './helpers/state';\nimport { checkAndSetAnnotationLocked } from './annotationLocking';\nimport { checkAndDefineCachedStatsProperty, checkAndDefineTextBoxProperty, } from './utilities/defineProperties';\nimport { checkAndSetAnnotationVisibility } from './annotationVisibility';\nlet defaultManager = defaultFrameOfReferenceSpecificAnnotationManager;\nconst preprocessingFn = (annotation) => {\n    annotation = checkAndDefineTextBoxProperty(annotation);\n    annotation = checkAndDefineCachedStatsProperty(annotation);\n    const uid = annotation.annotationUID;\n    const isLocked = checkAndSetAnnotationLocked(uid);\n    annotation.isLocked = isLocked;\n    const isVisible = checkAndSetAnnotationVisibility(uid);\n    annotation.isVisible = isVisible;\n    return annotation;\n};\ndefaultManager.setPreprocessingFn(preprocessingFn);\nfunction getAnnotationManager() {\n    return defaultManager;\n}\nfunction setAnnotationManager(annotationManager) {\n    defaultManager = annotationManager;\n}\nfunction resetAnnotationManager() {\n    defaultManager = defaultFrameOfReferenceSpecificAnnotationManager;\n}\nfunction getAnnotations(toolName, annotationGroupSelector) {\n    const manager = getAnnotationManager();\n    const groupKey = manager.getGroupKey(annotationGroupSelector);\n    return manager.getAnnotations(groupKey, toolName);\n}\nfunction getAllAnnotations() {\n    const manager = getAnnotationManager();\n    return manager.getAllAnnotations();\n}\nfunction clearParentAnnotation(annotation) {\n    const { annotationUID: childUID, parentAnnotationUID } = annotation;\n    if (!parentAnnotationUID) {\n        return;\n    }\n    const parentAnnotation = getAnnotation(parentAnnotationUID);\n    const childUIDIndex = parentAnnotation.childAnnotationUIDs.indexOf(childUID);\n    parentAnnotation.childAnnotationUIDs.splice(childUIDIndex, 1);\n    annotation.parentAnnotationUID = undefined;\n}\nfunction addChildAnnotation(parentAnnotation, childAnnotation) {\n    const { annotationUID: parentUID } = parentAnnotation;\n    const { annotationUID: childUID } = childAnnotation;\n    clearParentAnnotation(childAnnotation);\n    if (!parentAnnotation.childAnnotationUIDs) {\n        parentAnnotation.childAnnotationUIDs = [];\n    }\n    if (parentAnnotation.childAnnotationUIDs.includes(childUID)) {\n        return;\n    }\n    parentAnnotation.childAnnotationUIDs.push(childUID);\n    childAnnotation.parentAnnotationUID = parentUID;\n}\nfunction getParentAnnotation(annotation) {\n    return annotation.parentAnnotationUID\n        ? getAnnotation(annotation.parentAnnotationUID)\n        : undefined;\n}\nfunction getChildAnnotations(annotation) {\n    return (annotation.childAnnotationUIDs?.map((childAnnotationUID) => getAnnotation(childAnnotationUID)) ?? []);\n}\nfunction addAnnotation(annotation, annotationGroupSelector) {\n    if (!annotation.annotationUID) {\n        annotation.annotationUID = csUtils.uuidv4();\n    }\n    const manager = getAnnotationManager();\n    if (annotationGroupSelector instanceof HTMLDivElement) {\n        const groupKey = manager.getGroupKey(annotationGroupSelector);\n        manager.addAnnotation(annotation, groupKey);\n        triggerAnnotationAddedForElement(annotation, annotationGroupSelector);\n    }\n    else {\n        manager.addAnnotation(annotation, undefined);\n        triggerAnnotationAddedForFOR(annotation);\n    }\n    return annotation.annotationUID;\n}\nfunction getNumberOfAnnotations(toolName, annotationGroupSelector) {\n    const manager = getAnnotationManager();\n    const groupKey = manager.getGroupKey(annotationGroupSelector);\n    return manager.getNumberOfAnnotations(groupKey, toolName);\n}\nfunction removeAnnotation(annotationUID) {\n    if (!annotationUID) {\n        return;\n    }\n    const manager = getAnnotationManager();\n    const annotation = manager.getAnnotation(annotationUID);\n    if (!annotation) {\n        return;\n    }\n    annotation.childAnnotationUIDs?.forEach((childAnnotationUID) => removeAnnotation(childAnnotationUID));\n    manager.removeAnnotation(annotationUID);\n    triggerAnnotationRemoved({ annotation, annotationManagerUID: manager.uid });\n}\nfunction removeAllAnnotations() {\n    const manager = getAnnotationManager();\n    const removedAnnotations = manager.removeAllAnnotations();\n    for (const annotation of removedAnnotations) {\n        triggerAnnotationRemoved({\n            annotation,\n            annotationManagerUID: manager.uid,\n        });\n    }\n}\nfunction removeAnnotations(toolName, annotationGroupSelector) {\n    const manager = getAnnotationManager();\n    const groupKey = manager.getGroupKey(annotationGroupSelector);\n    const removedAnnotations = manager.removeAnnotations(groupKey, toolName);\n    for (const annotation of removedAnnotations) {\n        triggerAnnotationRemoved({\n            annotation,\n            annotationManagerUID: manager.uid,\n        });\n    }\n}\nfunction invalidateAnnotation(annotation) {\n    let currAnnotation = annotation;\n    while (currAnnotation) {\n        currAnnotation.invalidated = true;\n        currAnnotation = currAnnotation.parentAnnotationUID\n            ? getAnnotation(currAnnotation.parentAnnotationUID)\n            : undefined;\n    }\n}\nexport { getAllAnnotations, getAnnotations, getParentAnnotation, getChildAnnotations, clearParentAnnotation, addChildAnnotation, getNumberOfAnnotations, addAnnotation, removeAnnotation, removeAnnotations, removeAllAnnotations, setAnnotationManager, getAnnotationManager, resetAnnotationManager, invalidateAnnotation, getAnnotation, };\n","import { eventTarget, triggerEvent } from '@cornerstonejs/core';\nimport { Events } from '../../enums';\nimport { isAnnotationSelected, deselectAnnotation, } from './annotationSelection';\nimport { getAnnotation } from './getAnnotation';\nconst globalHiddenAnnotationUIDsSet = new Set();\nfunction setAnnotationVisibility(annotationUID, visible = true) {\n    const detail = makeEventDetail();\n    if (annotationUID) {\n        if (visible) {\n            show(annotationUID, globalHiddenAnnotationUIDsSet, detail);\n        }\n        else {\n            hide(annotationUID, globalHiddenAnnotationUIDsSet, detail);\n        }\n    }\n    publish(detail);\n}\nfunction showAllAnnotations() {\n    const detail = makeEventDetail();\n    globalHiddenAnnotationUIDsSet.forEach((annotationUID) => {\n        show(annotationUID, globalHiddenAnnotationUIDsSet, detail);\n    });\n    publish(detail);\n}\nfunction isAnnotationVisible(annotationUID) {\n    const annotation = getAnnotation(annotationUID);\n    if (annotation) {\n        return !globalHiddenAnnotationUIDsSet.has(annotationUID);\n    }\n}\nfunction makeEventDetail() {\n    return Object.freeze({\n        lastVisible: [],\n        lastHidden: [],\n        hidden: [],\n    });\n}\nfunction show(annotationUID, annotationUIDsSet, detail) {\n    if (annotationUIDsSet.delete(annotationUID)) {\n        detail.lastVisible.push(annotationUID);\n        const annotation = getAnnotation(annotationUID);\n        annotation.isVisible = true;\n    }\n}\nfunction hide(annotationUID, annotationUIDsSet, detail) {\n    if (!annotationUIDsSet.has(annotationUID)) {\n        annotationUIDsSet.add(annotationUID);\n        if (isAnnotationSelected(annotationUID)) {\n            deselectAnnotation(annotationUID);\n        }\n        detail.lastHidden.push(annotationUID);\n    }\n}\nfunction publish(detail) {\n    if (detail.lastHidden.length > 0 || detail.lastVisible.length > 0) {\n        globalHiddenAnnotationUIDsSet.forEach((item) => void detail.hidden.push(item));\n        triggerEvent(eventTarget, Events.ANNOTATION_VISIBILITY_CHANGE, detail);\n    }\n}\nfunction checkAndSetAnnotationVisibility(annotationUID) {\n    const isVisible = !globalHiddenAnnotationUIDsSet.has(annotationUID);\n    setAnnotationVisibility(annotationUID, isVisible);\n    return isVisible;\n}\nexport { setAnnotationVisibility, showAllAnnotations, isAnnotationVisible, checkAndSetAnnotationVisibility, };\n","class ToolStyle {\n    constructor() {\n        const defaultConfig = {\n            color: 'rgb(255, 255, 0)',\n            colorHighlighted: 'rgb(0, 255, 0)',\n            colorSelected: 'rgb(0, 220, 0)',\n            colorLocked: 'rgb(209, 193, 90)',\n            lineWidth: '1',\n            lineDash: '',\n            shadow: true,\n            textBoxVisibility: true,\n            textBoxFontFamily: 'Helvetica Neue, Helvetica, Arial, sans-serif',\n            textBoxFontSize: '14px',\n            textBoxColor: 'rgb(255, 255, 0)',\n            textBoxColorHighlighted: 'rgb(0, 255, 0)',\n            textBoxColorSelected: 'rgb(0, 255, 0)',\n            textBoxColorLocked: 'rgb(209, 193, 90)',\n            textBoxBackground: '',\n            textBoxLinkLineWidth: '1',\n            textBoxLinkLineDash: '2,3',\n            textBoxShadow: true,\n        };\n        this._initializeConfig(defaultConfig);\n    }\n    getAnnotationToolStyles(annotationUID) {\n        return this.config.annotations && this.config.annotations[annotationUID];\n    }\n    getViewportToolStyles(viewportId) {\n        return this.config.viewports && this.config.viewports[viewportId];\n    }\n    getToolGroupToolStyles(toolGroupId) {\n        return this.config.toolGroups && this.config.toolGroups[toolGroupId];\n    }\n    getDefaultToolStyles() {\n        return this.config.default;\n    }\n    setAnnotationStyles(annotationUID, styles) {\n        let annotationSpecificStyles = this.config.annotations;\n        if (!annotationSpecificStyles) {\n            this.config = {\n                ...this.config,\n                annotations: {},\n            };\n            annotationSpecificStyles = this.config.annotations;\n        }\n        annotationSpecificStyles[annotationUID] = styles;\n    }\n    setViewportToolStyles(viewportId, styles) {\n        let viewportSpecificStyles = this.config.viewports;\n        if (!viewportSpecificStyles) {\n            this.config = {\n                ...this.config,\n                viewports: {},\n            };\n            viewportSpecificStyles = this.config.viewports;\n        }\n        viewportSpecificStyles[viewportId] = styles;\n    }\n    setToolGroupToolStyles(toolGroupId, styles) {\n        let toolGroupSpecificStyles = this.config.toolGroups;\n        if (!toolGroupSpecificStyles) {\n            this.config = {\n                ...this.config,\n                toolGroups: {},\n            };\n            toolGroupSpecificStyles = this.config.toolGroups;\n        }\n        toolGroupSpecificStyles[toolGroupId] = styles;\n    }\n    setDefaultToolStyles(styles) {\n        this.config.default = styles;\n    }\n    getStyleProperty(toolStyle, specifications) {\n        const { annotationUID, viewportId, toolGroupId, toolName } = specifications;\n        return this._getToolStyle(toolStyle, annotationUID, viewportId, toolGroupId, toolName);\n    }\n    _getToolStyle(property, annotationUID, viewportId, toolGroupId, toolName) {\n        if (annotationUID) {\n            const annotationToolStyles = this.getAnnotationToolStyles(annotationUID);\n            if (annotationToolStyles) {\n                if (annotationToolStyles[property] !== undefined) {\n                    return annotationToolStyles[property];\n                }\n            }\n        }\n        if (viewportId) {\n            const viewportToolStyles = this.getViewportToolStyles(viewportId);\n            if (viewportToolStyles) {\n                if (viewportToolStyles[toolName] &&\n                    viewportToolStyles[toolName][property] !== undefined) {\n                    return viewportToolStyles[toolName][property];\n                }\n                if (viewportToolStyles.global &&\n                    viewportToolStyles.global[property] !== undefined) {\n                    return viewportToolStyles.global[property];\n                }\n            }\n        }\n        if (toolGroupId) {\n            const toolGroupToolStyles = this.getToolGroupToolStyles(toolGroupId);\n            if (toolGroupToolStyles) {\n                if (toolGroupToolStyles[toolName] &&\n                    toolGroupToolStyles[toolName][property] !== undefined) {\n                    return toolGroupToolStyles[toolName][property];\n                }\n                if (toolGroupToolStyles.global &&\n                    toolGroupToolStyles.global[property] !== undefined) {\n                    return toolGroupToolStyles.global[property];\n                }\n            }\n        }\n        const globalStyles = this.getDefaultToolStyles();\n        if (globalStyles[toolName] &&\n            globalStyles[toolName][property] !== undefined) {\n            return globalStyles[toolName][property];\n        }\n        if (globalStyles.global && globalStyles.global[property] !== undefined) {\n            return globalStyles.global[property];\n        }\n    }\n    _initializeConfig(config) {\n        const toolStyles = {};\n        for (const name in config) {\n            toolStyles[name] = config[name];\n        }\n        this.config = {\n            default: {\n                global: toolStyles,\n            },\n        };\n    }\n}\nconst toolStyle = new ToolStyle();\nexport default toolStyle;\n","import toolStyle from './ToolStyle';\nfunction getHierarchalPropertyStyles(property, state, mode) {\n    const list = [`${property}`];\n    if (state) {\n        list.push(`${list[0]}${state}`);\n    }\n    if (mode) {\n        list.push(`${list[list.length - 1]}${mode}`);\n    }\n    return list;\n}\nfunction getStyleProperty(property, styleSpecifier, state, mode) {\n    const alternatives = getHierarchalPropertyStyles(property, state, mode);\n    for (let i = alternatives.length - 1; i >= 0; --i) {\n        const style = toolStyle.getStyleProperty(alternatives[i], styleSpecifier);\n        if (style !== undefined) {\n            return style;\n        }\n    }\n}\nexport { getStyleProperty };\n","import { isAnnotationLocked } from '../annotationLocking';\nimport { isAnnotationSelected } from '../annotationSelection';\nimport { AnnotationStyleStates } from '../../../enums';\nfunction getState(annotation) {\n    if (annotation) {\n        if (annotation.data && annotation.highlighted) {\n            return AnnotationStyleStates.Highlighted;\n        }\n        if (isAnnotationSelected(annotation.annotationUID)) {\n            return AnnotationStyleStates.Selected;\n        }\n        if (isAnnotationLocked(annotation.annotationUID)) {\n            return AnnotationStyleStates.Locked;\n        }\n        if (annotation.data && annotation.autoGenerated) {\n            return AnnotationStyleStates.AutoGenerated;\n        }\n    }\n    return AnnotationStyleStates.Default;\n}\nexport default getState;\n","import { getStyleProperty } from './helpers';\nfunction getFont(styleSpecifier, state, mode) {\n    const fontSize = getStyleProperty('textBoxFontSize', styleSpecifier, state, mode);\n    const fontFamily = getStyleProperty('textBoxFontFamily', styleSpecifier, state, mode);\n    return `${fontSize}px ${fontFamily}`;\n}\nexport default getFont;\n","import { defaultFrameOfReferenceSpecificAnnotationManager } from './FrameOfReferenceSpecificAnnotationManager';\nexport function getAnnotation(annotationUID) {\n    const manager = defaultFrameOfReferenceSpecificAnnotationManager;\n    const annotation = manager.getAnnotation(annotationUID);\n    return annotation;\n}\n","import { getEnabledElement, triggerEvent, eventTarget, getEnabledElementByIds, } from '@cornerstonejs/core';\nimport { Events, ChangeTypes } from '../../../enums';\nimport { getToolGroupsWithToolName } from '../../../store/ToolGroupManager';\nfunction triggerAnnotationAddedForElement(annotation, element) {\n    const enabledElement = getEnabledElement(element);\n    const { renderingEngine, viewportId } = enabledElement;\n    const eventType = Events.ANNOTATION_ADDED;\n    const eventDetail = {\n        annotation,\n        viewportId,\n        renderingEngineId: renderingEngine.id,\n    };\n    triggerEvent(eventTarget, eventType, eventDetail);\n}\nfunction triggerAnnotationAddedForFOR(annotation) {\n    const { toolName } = annotation.metadata;\n    const toolGroups = getToolGroupsWithToolName(toolName);\n    if (!toolGroups.length) {\n        return;\n    }\n    const viewportsToRender = [];\n    toolGroups.forEach((toolGroup) => {\n        toolGroup.viewportsInfo.forEach((viewportInfo) => {\n            const { renderingEngineId, viewportId } = viewportInfo;\n            const { FrameOfReferenceUID } = getEnabledElementByIds(viewportId, renderingEngineId);\n            if (annotation.metadata.FrameOfReferenceUID === FrameOfReferenceUID) {\n                viewportsToRender.push(viewportInfo);\n            }\n        });\n    });\n    const eventType = Events.ANNOTATION_ADDED;\n    const eventDetail = { annotation };\n    if (!viewportsToRender.length) {\n        triggerEvent(eventTarget, eventType, eventDetail);\n        return;\n    }\n    viewportsToRender.forEach(({ renderingEngineId, viewportId }) => {\n        eventDetail.viewportId = viewportId;\n        eventDetail.renderingEngineId = renderingEngineId;\n        triggerEvent(eventTarget, eventType, eventDetail);\n    });\n}\nfunction triggerAnnotationRemoved(eventDetail) {\n    const eventType = Events.ANNOTATION_REMOVED;\n    triggerEvent(eventTarget, eventType, eventDetail);\n}\nfunction triggerAnnotationModified(annotation, element, changeType = ChangeTypes.HandlesUpdated) {\n    const enabledElement = getEnabledElement(element);\n    const { viewportId, renderingEngineId } = enabledElement;\n    const eventType = Events.ANNOTATION_MODIFIED;\n    const eventDetail = {\n        annotation,\n        viewportId,\n        renderingEngineId,\n        changeType,\n    };\n    triggerEvent(eventTarget, eventType, eventDetail);\n}\nfunction triggerAnnotationCompleted(annotation) {\n    const eventDetail = {\n        annotation,\n    };\n    _triggerAnnotationCompleted(eventDetail);\n}\nfunction triggerContourAnnotationCompleted(annotation, contourHoleProcessingEnabled = false) {\n    const eventDetail = {\n        annotation,\n        contourHoleProcessingEnabled,\n    };\n    _triggerAnnotationCompleted(eventDetail);\n}\nfunction _triggerAnnotationCompleted(eventDetail) {\n    const eventType = Events.ANNOTATION_COMPLETED;\n    triggerEvent(eventTarget, eventType, eventDetail);\n}\nexport { triggerAnnotationAddedForElement, triggerAnnotationAddedForFOR, triggerAnnotationRemoved, triggerAnnotationModified, triggerAnnotationCompleted, triggerContourAnnotationCompleted, };\n","import { eventTarget, triggerEvent } from '@cornerstonejs/core';\nimport Events from '../../enums/Events';\nimport { getAnnotation } from './annotationState';\nexport default class AnnotationGroup {\n    constructor() {\n        this.annotationUIDs = new Set();\n        this._isVisible = true;\n        this.visibleFilter = this.unboundVisibleFilter.bind(this);\n    }\n    unboundVisibleFilter(uid) {\n        return !this._isVisible || !this.annotationUIDs.has(uid);\n    }\n    has(uid) {\n        return this.annotationUIDs.has(uid);\n    }\n    setVisible(isVisible = true, baseEvent, filter) {\n        if (this._isVisible === isVisible) {\n            return;\n        }\n        this._isVisible = isVisible;\n        this.annotationUIDs.forEach((uid) => {\n            const annotation = getAnnotation(uid);\n            if (!annotation) {\n                this.annotationUIDs.delete(uid);\n                return;\n            }\n            if (annotation.isVisible === isVisible) {\n                return;\n            }\n            if (!isVisible && filter?.(uid) === false) {\n                return;\n            }\n            annotation.isVisible = isVisible;\n            const eventDetail = {\n                ...baseEvent,\n                annotation,\n            };\n            triggerEvent(eventTarget, Events.ANNOTATION_MODIFIED, eventDetail);\n        });\n    }\n    get isVisible() {\n        return this._isVisible;\n    }\n    findNearby(uid, direction) {\n        const uids = [...this.annotationUIDs];\n        if (uids.length === 0) {\n            return null;\n        }\n        if (!uid) {\n            return uids[direction === 1 ? 0 : uids.length - 1];\n        }\n        const index = uids.indexOf(uid);\n        if (index === -1 ||\n            index + direction < 0 ||\n            index + direction >= uids.length) {\n            return null;\n        }\n        return uids[index + direction];\n    }\n    add(...annotationUIDs) {\n        annotationUIDs.forEach((annotationUID) => this.annotationUIDs.add(annotationUID));\n    }\n    remove(...annotationUIDs) {\n        annotationUIDs.forEach((annotationUID) => this.annotationUIDs.delete(annotationUID));\n    }\n    clear() {\n        this.annotationUIDs.clear();\n    }\n}\n","import { triggerEvent, eventTarget, Enums, getRenderingEngines, getEnabledElementByViewportId, } from '@cornerstonejs/core';\nimport { SegmentationRepresentations, Events as csToolsEvents, } from '../../enums';\nimport Representations from '../../enums/SegmentationRepresentations';\nimport { getSegmentationRepresentations } from './getSegmentationRepresentation';\nimport surfaceDisplay from '../../tools/displayTools/Surface/surfaceDisplay';\nimport contourDisplay from '../../tools/displayTools/Contour/contourDisplay';\nimport labelmapDisplay from '../../tools/displayTools/Labelmap/labelmapDisplay';\nimport { addTool } from '../../store/addTool';\nimport { state } from '../../store/state';\nimport PlanarFreehandContourSegmentationTool from '../../tools/annotation/PlanarFreehandContourSegmentationTool';\nimport { getToolGroupForViewport } from '../../store/ToolGroupManager';\nconst renderers = {\n    [Representations.Labelmap]: labelmapDisplay,\n    [Representations.Contour]: contourDisplay,\n    [Representations.Surface]: surfaceDisplay,\n};\nconst planarContourToolName = PlanarFreehandContourSegmentationTool.toolName;\nclass SegmentationRenderingEngine {\n    constructor() {\n        this._needsRender = new Set();\n        this._animationFrameSet = false;\n        this._animationFrameHandle = null;\n        this._getAllViewports = () => {\n            const renderingEngine = getRenderingEngines();\n            return renderingEngine.flatMap((renderingEngine) => renderingEngine.getViewports());\n        };\n        this._renderFlaggedSegmentations = () => {\n            this._throwIfDestroyed();\n            const viewportIds = Array.from(this._needsRender);\n            viewportIds.forEach((viewportId) => {\n                this._triggerRender(viewportId);\n            });\n            this._needsRender.clear();\n            this._animationFrameSet = false;\n            this._animationFrameHandle = null;\n        };\n    }\n    renderSegmentationsForViewport(viewportId) {\n        const viewportIds = viewportId\n            ? [viewportId]\n            : this._getViewportIdsForSegmentation();\n        this._setViewportsToBeRenderedNextFrame(viewportIds);\n    }\n    renderSegmentation(segmentationId) {\n        const viewportIds = this._getViewportIdsForSegmentation(segmentationId);\n        this._setViewportsToBeRenderedNextFrame(viewportIds);\n    }\n    _getViewportIdsForSegmentation(segmentationId) {\n        const viewports = this._getAllViewports();\n        const viewportIds = [];\n        for (const viewport of viewports) {\n            const viewportId = viewport.id;\n            if (segmentationId) {\n                const segmentationRepresentations = getSegmentationRepresentations(viewportId, { segmentationId });\n                if (segmentationRepresentations?.length > 0) {\n                    viewportIds.push(viewportId);\n                }\n            }\n            else {\n                const segmentationRepresentations = getSegmentationRepresentations(viewportId);\n                if (segmentationRepresentations?.length > 0) {\n                    viewportIds.push(viewportId);\n                }\n            }\n        }\n        return viewportIds;\n    }\n    _throwIfDestroyed() {\n        if (this.hasBeenDestroyed) {\n            throw new Error('this.destroy() has been manually called to free up memory, can not longer use this instance. Instead make a new one.');\n        }\n    }\n    _setViewportsToBeRenderedNextFrame(viewportIds) {\n        viewportIds.forEach((viewportId) => {\n            this._needsRender.add(viewportId);\n        });\n        this._render();\n    }\n    _render() {\n        if (this._needsRender.size > 0 && this._animationFrameSet === false) {\n            this._animationFrameHandle = window.requestAnimationFrame(this._renderFlaggedSegmentations);\n            this._animationFrameSet = true;\n        }\n    }\n    _triggerRender(viewportId) {\n        const segmentationRepresentations = getSegmentationRepresentations(viewportId);\n        if (!segmentationRepresentations?.length) {\n            return;\n        }\n        const { viewport } = getEnabledElementByViewportId(viewportId) || {};\n        if (!viewport) {\n            return;\n        }\n        const viewportRenderList = [];\n        const segmentationRenderList = segmentationRepresentations.map((representation) => {\n            if (representation.type === SegmentationRepresentations.Contour) {\n                this._addPlanarFreeHandToolIfAbsent(viewport);\n            }\n            const display = renderers[representation.type];\n            try {\n                const viewportId = display.render(viewport, representation);\n                viewportRenderList.push(viewportId);\n            }\n            catch (error) {\n                console.error(error);\n            }\n            return Promise.resolve({\n                segmentationId: representation.segmentationId,\n                type: representation.type,\n            });\n        });\n        Promise.allSettled(segmentationRenderList).then((results) => {\n            const segmentationDetails = results\n                .filter((r) => r.status === 'fulfilled')\n                .map((r) => r.value);\n            function onSegmentationRender(evt) {\n                const { element, viewportId } = evt.detail;\n                element.removeEventListener(Enums.Events.IMAGE_RENDERED, onSegmentationRender);\n                segmentationDetails.forEach((detail) => {\n                    const eventDetail = {\n                        viewportId,\n                        segmentationId: detail.segmentationId,\n                        type: detail.type,\n                    };\n                    triggerEvent(eventTarget, csToolsEvents.SEGMENTATION_RENDERED, {\n                        ...eventDetail,\n                    });\n                });\n            }\n            const element = viewport.element;\n            element.addEventListener(Enums.Events.IMAGE_RENDERED, onSegmentationRender);\n            viewport.render();\n        });\n    }\n    _addPlanarFreeHandToolIfAbsent(viewport) {\n        if (!(planarContourToolName in state.tools)) {\n            addTool(PlanarFreehandContourSegmentationTool);\n        }\n        const toolGroup = getToolGroupForViewport(viewport.id);\n        if (!toolGroup.hasTool(planarContourToolName)) {\n            toolGroup.addTool(planarContourToolName);\n            toolGroup.setToolPassive(planarContourToolName);\n        }\n    }\n}\nfunction triggerSegmentationRender(viewportId) {\n    segmentationRenderingEngine.renderSegmentationsForViewport(viewportId);\n}\nfunction triggerSegmentationRenderBySegmentationId(segmentationId) {\n    segmentationRenderingEngine.renderSegmentation(segmentationId);\n}\nconst segmentationRenderingEngine = new SegmentationRenderingEngine();\nexport { triggerSegmentationRender, triggerSegmentationRenderBySegmentationId, segmentationRenderingEngine, };\n","import { BaseVolumeViewport, cache, utilities as csUtils, getEnabledElementByViewportId, volumeLoader, } from '@cornerstonejs/core';\nimport { SegmentationRepresentations } from '../../enums';\nimport vtkColorTransferFunction from '@kitware/vtk.js/Rendering/Core/ColorTransferFunction';\nimport vtkPiecewiseFunction from '@kitware/vtk.js/Common/DataModel/PiecewiseFunction';\nimport { triggerSegmentationModified, triggerSegmentationRemoved, triggerSegmentationRepresentationModified, triggerSegmentationRepresentationRemoved, } from './triggerSegmentationEvents';\nimport { segmentationStyle } from './SegmentationStyle';\nimport { triggerSegmentationAdded } from './events/triggerSegmentationAdded';\nconst initialDefaultState = {\n    colorLUT: [],\n    segmentations: [],\n    viewportSegRepresentations: {},\n};\nexport default class SegmentationStateManager {\n    constructor(uid) {\n        this._stackLabelmapImageIdReferenceMap = new Map();\n        uid ||= csUtils.uuidv4();\n        this.state = Object.freeze(csUtils.deepClone(initialDefaultState));\n        this.uid = uid;\n    }\n    getState() {\n        return this.state;\n    }\n    updateState(updater) {\n        const newState = csUtils.deepClone(this.state);\n        updater(newState);\n        this.state = Object.freeze(newState);\n    }\n    getColorLUT(lutIndex) {\n        return this.state.colorLUT[lutIndex];\n    }\n    getNextColorLUTIndex() {\n        return this.state.colorLUT.length;\n    }\n    resetState() {\n        this.state = Object.freeze(csUtils.deepClone(initialDefaultState));\n    }\n    getSegmentation(segmentationId) {\n        return this.state.segmentations.find((segmentation) => segmentation.segmentationId === segmentationId);\n    }\n    updateSegmentation(segmentationId, payload) {\n        this.updateState((draftState) => {\n            const segmentation = draftState.segmentations.find((segmentation) => segmentation.segmentationId === segmentationId);\n            if (!segmentation) {\n                console.warn(`Segmentation with id ${segmentationId} not found. Update aborted.`);\n                return;\n            }\n            Object.assign(segmentation, payload);\n        });\n        triggerSegmentationModified(segmentationId);\n    }\n    addSegmentation(segmentation) {\n        if (this.getSegmentation(segmentation.segmentationId)) {\n            throw new Error(`Segmentation with id ${segmentation.segmentationId} already exists`);\n        }\n        this.updateState((state) => {\n            const newSegmentation = csUtils.deepClone(segmentation);\n            if (newSegmentation.representationData.Labelmap &&\n                'volumeId' in newSegmentation.representationData.Labelmap &&\n                !('imageIds' in newSegmentation.representationData.Labelmap)) {\n                const imageIds = this.getLabelmapImageIds(newSegmentation.representationData);\n                newSegmentation.representationData\n                    .Labelmap.imageIds = imageIds;\n            }\n            state.segmentations.push(newSegmentation);\n        });\n        triggerSegmentationAdded(segmentation.segmentationId);\n    }\n    removeSegmentation(segmentationId) {\n        this.updateState((state) => {\n            const filteredSegmentations = state.segmentations.filter((segmentation) => segmentation.segmentationId !== segmentationId);\n            state.segmentations.splice(0, state.segmentations.length, ...filteredSegmentations);\n        });\n        triggerSegmentationRemoved(segmentationId);\n    }\n    addSegmentationRepresentation(viewportId, segmentationId, type, renderingConfig) {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        const existingRepresentations = this.getSegmentationRepresentations(viewportId, {\n            type: type,\n            segmentationId,\n        });\n        if (existingRepresentations.length > 0) {\n            console.debug('A segmentation representation of type', type, 'already exists in viewport', viewportId, 'for segmentation', segmentationId);\n            return;\n        }\n        this.updateState((state) => {\n            if (!state.viewportSegRepresentations[viewportId]) {\n                state.viewportSegRepresentations[viewportId] = [];\n                segmentationStyle.setRenderInactiveSegmentations(viewportId, true);\n            }\n            if (type !== SegmentationRepresentations.Labelmap) {\n                this.addDefaultSegmentationRepresentation(state, viewportId, segmentationId, type, renderingConfig);\n            }\n            else {\n                this.addLabelmapRepresentation(state, viewportId, segmentationId, renderingConfig);\n            }\n        });\n        triggerSegmentationRepresentationModified(viewportId, segmentationId, type);\n    }\n    addDefaultSegmentationRepresentation(state, viewportId, segmentationId, type, renderingConfig) {\n        const segmentation = state.segmentations.find((segmentation) => segmentation.segmentationId === segmentationId);\n        if (!segmentation) {\n            return;\n        }\n        const segmentReps = {};\n        Object.keys(segmentation.segments).forEach((segmentIndex) => {\n            segmentReps[Number(segmentIndex)] = {\n                visible: true,\n            };\n        });\n        state.viewportSegRepresentations[viewportId].push({\n            segmentationId,\n            type,\n            active: true,\n            visible: true,\n            colorLUTIndex: renderingConfig?.colorLUTIndex || 0,\n            segments: segmentReps,\n            config: {\n                ...getDefaultRenderingConfig(type),\n                ...renderingConfig,\n            },\n        });\n        this._setActiveSegmentation(state, viewportId, segmentationId);\n    }\n    addLabelmapRepresentation(state, viewportId, segmentationId, renderingConfig = getDefaultRenderingConfig(SegmentationRepresentations.Labelmap)) {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        const segmentation = this.getSegmentation(segmentationId);\n        if (!segmentation) {\n            return;\n        }\n        const { representationData } = segmentation;\n        if (!representationData.Labelmap) {\n            return this.addDefaultSegmentationRepresentation(state, viewportId, segmentationId, SegmentationRepresentations.Labelmap, renderingConfig);\n        }\n        this.processLabelmapRepresentationAddition(viewportId, segmentationId);\n        this.addDefaultSegmentationRepresentation(state, viewportId, segmentationId, SegmentationRepresentations.Labelmap, renderingConfig);\n    }\n    async processLabelmapRepresentationAddition(viewportId, segmentationId) {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        const segmentation = this.getSegmentation(segmentationId);\n        if (!segmentation) {\n            return;\n        }\n        const volumeViewport = enabledElement.viewport instanceof BaseVolumeViewport;\n        const { representationData } = segmentation;\n        const isBaseVolumeSegmentation = 'volumeId' in representationData.Labelmap;\n        const viewport = enabledElement.viewport;\n        if (!volumeViewport && !isBaseVolumeSegmentation) {\n            !this.updateLabelmapSegmentationImageReferences(viewportId, segmentation.segmentationId);\n        }\n    }\n    _updateLabelmapSegmentationReferences(segmentationId, viewport, labelmapImageIds, updateCallback) {\n        const currentImageId = viewport.getCurrentImageId();\n        let viewableLabelmapImageIdFound = false;\n        for (const labelmapImageId of labelmapImageIds) {\n            const viewableImageId = viewport.isReferenceViewable({ referencedImageId: labelmapImageId }, { asOverlay: true });\n            if (viewableImageId) {\n                viewableLabelmapImageIdFound = true;\n                this._stackLabelmapImageIdReferenceMap\n                    .get(segmentationId)\n                    .set(currentImageId, labelmapImageId);\n            }\n        }\n        if (updateCallback) {\n            updateCallback(viewport, segmentationId, labelmapImageIds);\n        }\n        return viewableLabelmapImageIdFound\n            ? this._stackLabelmapImageIdReferenceMap\n                .get(segmentationId)\n                .get(currentImageId)\n            : undefined;\n    }\n    updateLabelmapSegmentationImageReferences(viewportId, segmentationId) {\n        const segmentation = this.getSegmentation(segmentationId);\n        if (!segmentation) {\n            return;\n        }\n        if (!this._stackLabelmapImageIdReferenceMap.has(segmentationId)) {\n            this._stackLabelmapImageIdReferenceMap.set(segmentationId, new Map());\n        }\n        const { representationData } = segmentation;\n        if (!representationData.Labelmap) {\n            return;\n        }\n        const labelmapImageIds = this.getLabelmapImageIds(representationData);\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        const stackViewport = enabledElement.viewport;\n        return this._updateLabelmapSegmentationReferences(segmentationId, stackViewport, labelmapImageIds, null);\n    }\n    _updateAllLabelmapSegmentationImageReferences(viewportId, segmentationId) {\n        const segmentation = this.getSegmentation(segmentationId);\n        if (!segmentation) {\n            return;\n        }\n        if (!this._stackLabelmapImageIdReferenceMap.has(segmentationId)) {\n            this._stackLabelmapImageIdReferenceMap.set(segmentationId, new Map());\n        }\n        const { representationData } = segmentation;\n        if (!representationData.Labelmap) {\n            return;\n        }\n        const labelmapImageIds = this.getLabelmapImageIds(representationData);\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        const stackViewport = enabledElement.viewport;\n        this._updateLabelmapSegmentationReferences(segmentationId, stackViewport, labelmapImageIds, (stackViewport, segmentationId, labelmapImageIds) => {\n            const imageIds = stackViewport.getImageIds();\n            imageIds.forEach((imageId, index) => {\n                for (const labelmapImageId of labelmapImageIds) {\n                    const viewableImageId = stackViewport.isReferenceViewable({ referencedImageId: labelmapImageId, sliceIndex: index }, { asOverlay: true, withNavigation: true });\n                    if (viewableImageId) {\n                        this._stackLabelmapImageIdReferenceMap\n                            .get(segmentationId)\n                            .set(imageId, labelmapImageId);\n                    }\n                }\n            });\n        });\n    }\n    getLabelmapImageIds(representationData) {\n        const labelmapData = representationData.Labelmap;\n        let labelmapImageIds;\n        if (labelmapData.imageIds) {\n            labelmapImageIds = labelmapData\n                .imageIds;\n        }\n        else if (!labelmapImageIds &&\n            labelmapData.volumeId) {\n            const volumeId = labelmapData\n                .volumeId;\n            const volume = cache.getVolume(volumeId);\n            labelmapImageIds = volume.imageIds;\n        }\n        return labelmapImageIds;\n    }\n    getCurrentLabelmapImageIdForViewport(viewportId, segmentationId) {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            return;\n        }\n        if (!this._stackLabelmapImageIdReferenceMap.has(segmentationId)) {\n            return;\n        }\n        const stackViewport = enabledElement.viewport;\n        const currentImageId = stackViewport.getCurrentImageId();\n        const imageIdReferenceMap = this._stackLabelmapImageIdReferenceMap.get(segmentationId);\n        return imageIdReferenceMap.get(currentImageId);\n    }\n    getStackSegmentationImageIdsForViewport(viewportId, segmentationId) {\n        const segmentation = this.getSegmentation(segmentationId);\n        if (!segmentation) {\n            return [];\n        }\n        this._updateAllLabelmapSegmentationImageReferences(viewportId, segmentationId);\n        const { viewport } = getEnabledElementByViewportId(viewportId);\n        const imageIds = viewport.getImageIds();\n        const associatedReferenceImageAndLabelmapImageIds = this._stackLabelmapImageIdReferenceMap.get(segmentationId);\n        return imageIds.map((imageId) => {\n            return associatedReferenceImageAndLabelmapImageIds.get(imageId);\n        });\n    }\n    removeSegmentationRepresentationsInternal(viewportId, specifier) {\n        const removedRepresentations = [];\n        this.updateState((state) => {\n            if (!state.viewportSegRepresentations[viewportId]) {\n                return;\n            }\n            const currentRepresentations = state.viewportSegRepresentations[viewportId];\n            let activeRepresentationRemoved = false;\n            if (!specifier ||\n                Object.values(specifier).every((value) => value === undefined)) {\n                removedRepresentations.push(...currentRepresentations);\n                delete state.viewportSegRepresentations[viewportId];\n            }\n            else {\n                const { segmentationId, type } = specifier;\n                state.viewportSegRepresentations[viewportId] =\n                    currentRepresentations.filter((representation) => {\n                        const shouldRemove = (segmentationId &&\n                            type &&\n                            representation.segmentationId === segmentationId &&\n                            representation.type === type) ||\n                            (segmentationId &&\n                                !type &&\n                                representation.segmentationId === segmentationId) ||\n                            (!segmentationId && type && representation.type === type);\n                        if (shouldRemove) {\n                            removedRepresentations.push(representation);\n                            if (representation.active) {\n                                activeRepresentationRemoved = true;\n                            }\n                        }\n                        return !shouldRemove;\n                    });\n                if (state.viewportSegRepresentations[viewportId].length === 0) {\n                    delete state.viewportSegRepresentations[viewportId];\n                }\n                else if (activeRepresentationRemoved) {\n                    state.viewportSegRepresentations[viewportId][0].active = true;\n                }\n            }\n        });\n        return removedRepresentations;\n    }\n    removeSegmentationRepresentations(viewportId, specifier) {\n        const removedRepresentations = this.removeSegmentationRepresentationsInternal(viewportId, specifier);\n        removedRepresentations.forEach((representation) => {\n            triggerSegmentationRepresentationRemoved(viewportId, representation.segmentationId, representation.type);\n        });\n        const remainingRepresentations = this.getSegmentationRepresentations(viewportId);\n        if (remainingRepresentations.length > 0 &&\n            remainingRepresentations[0].active) {\n            triggerSegmentationRepresentationModified(viewportId, remainingRepresentations[0].segmentationId, remainingRepresentations[0].type);\n        }\n        return removedRepresentations;\n    }\n    removeSegmentationRepresentation(viewportId, specifier, suppressEvent) {\n        const removedRepresentations = this.removeSegmentationRepresentationsInternal(viewportId, specifier);\n        if (!suppressEvent) {\n            removedRepresentations.forEach(({ segmentationId, type }) => {\n                triggerSegmentationRepresentationRemoved(viewportId, segmentationId, type);\n            });\n        }\n        return removedRepresentations;\n    }\n    _setActiveSegmentation(state, viewportId, segmentationId) {\n        const viewport = state.viewportSegRepresentations[viewportId];\n        if (!viewport) {\n            return;\n        }\n        viewport.forEach((value) => {\n            value.active = value.segmentationId === segmentationId;\n        });\n    }\n    setActiveSegmentation(viewportId, segmentationId) {\n        this.updateState((state) => {\n            const viewport = state.viewportSegRepresentations[viewportId];\n            if (!viewport) {\n                return;\n            }\n            viewport.forEach((value) => {\n                value.active = value.segmentationId === segmentationId;\n            });\n        });\n        triggerSegmentationRepresentationModified(viewportId, segmentationId);\n    }\n    getActiveSegmentation(viewportId) {\n        if (!this.state.viewportSegRepresentations[viewportId]) {\n            return;\n        }\n        const activeSegRep = this.state.viewportSegRepresentations[viewportId].find((segRep) => segRep.active);\n        if (!activeSegRep) {\n            return;\n        }\n        return this.getSegmentation(activeSegRep.segmentationId);\n    }\n    getSegmentationRepresentations(viewportId, specifier = {}) {\n        const viewportRepresentations = this.state.viewportSegRepresentations[viewportId];\n        if (!viewportRepresentations) {\n            return [];\n        }\n        if (!specifier.type && !specifier.segmentationId) {\n            return viewportRepresentations;\n        }\n        return viewportRepresentations.filter((representation) => {\n            const typeMatch = specifier.type\n                ? representation.type === specifier.type\n                : true;\n            const idMatch = specifier.segmentationId\n                ? representation.segmentationId === specifier.segmentationId\n                : true;\n            return typeMatch && idMatch;\n        });\n    }\n    getSegmentationRepresentation(viewportId, specifier) {\n        return this.getSegmentationRepresentations(viewportId, specifier)[0];\n    }\n    getSegmentationRepresentationVisibility(viewportId, specifier) {\n        const viewportRepresentation = this.getSegmentationRepresentation(viewportId, specifier);\n        return viewportRepresentation?.visible;\n    }\n    setSegmentationRepresentationVisibility(viewportId, specifier, visible) {\n        this.updateState((state) => {\n            const viewportRepresentations = this.getSegmentationRepresentations(viewportId, specifier);\n            if (!viewportRepresentations) {\n                return;\n            }\n            viewportRepresentations.forEach((representation) => {\n                representation.visible = visible;\n                Object.entries(representation.segments).forEach(([segmentIndex, segment]) => {\n                    segment.visible = visible;\n                });\n            });\n        });\n        triggerSegmentationRepresentationModified(viewportId, specifier.segmentationId, specifier.type);\n    }\n    addColorLUT(colorLUT, lutIndex) {\n        this.updateState((state) => {\n            if (state.colorLUT[lutIndex]) {\n                console.warn('Color LUT table already exists, overwriting');\n            }\n            state.colorLUT[lutIndex] = csUtils.deepClone(colorLUT);\n        });\n    }\n    removeColorLUT(colorLUTIndex) {\n        this.updateState((state) => {\n            delete state.colorLUT[colorLUTIndex];\n        });\n    }\n    _getStackIdForImageIds(imageIds) {\n        return imageIds\n            .map((imageId) => imageId.slice(-Math.round(imageId.length * 0.15)))\n            .join('_');\n    }\n    getAllViewportSegmentationRepresentations() {\n        return Object.entries(this.state.viewportSegRepresentations).map(([viewportId, representations]) => ({\n            viewportId,\n            representations,\n        }));\n    }\n    getSegmentationRepresentationsBySegmentationId(segmentationId) {\n        const result = [];\n        Object.entries(this.state.viewportSegRepresentations).forEach(([viewportId, viewportReps]) => {\n            const filteredReps = viewportReps.filter((representation) => representation.segmentationId === segmentationId);\n            if (filteredReps.length > 0) {\n                result.push({ viewportId, representations: filteredReps });\n            }\n        });\n        return result;\n    }\n}\nasync function internalComputeVolumeLabelmapFromStack({ imageIds, options, }) {\n    const segmentationImageIds = imageIds;\n    const volumeId = options?.volumeId || csUtils.uuidv4();\n    await volumeLoader.createAndCacheVolumeFromImages(volumeId, segmentationImageIds);\n    return { volumeId };\n}\nasync function internalConvertStackToVolumeLabelmap({ segmentationId, options, }) {\n    const segmentation = defaultSegmentationStateManager.getSegmentation(segmentationId);\n    const data = segmentation.representationData\n        .Labelmap;\n    const { volumeId } = await internalComputeVolumeLabelmapFromStack({\n        imageIds: data.imageIds,\n        options,\n    });\n    segmentation.representationData.Labelmap.volumeId = volumeId;\n}\nfunction getDefaultRenderingConfig(type) {\n    const cfun = vtkColorTransferFunction.newInstance();\n    const ofun = vtkPiecewiseFunction.newInstance();\n    ofun.addPoint(0, 0);\n    if (type === SegmentationRepresentations.Labelmap) {\n        return {\n            cfun,\n            ofun,\n        };\n    }\n    else {\n        return {};\n    }\n}\nconst defaultSegmentationStateManager = new SegmentationStateManager('DEFAULT');\nexport { internalConvertStackToVolumeLabelmap, internalComputeVolumeLabelmapFromStack, defaultSegmentationStateManager, };\n","import getDefaultContourConfig from '../../tools/displayTools/Contour/contourConfig';\nimport getDefaultLabelmapConfig from '../../tools/displayTools/Labelmap/labelmapConfig';\nimport * as Enums from '../../enums';\nimport { utilities } from '@cornerstonejs/core';\nclass SegmentationStyle {\n    constructor() {\n        this.config = {\n            global: {},\n            segmentations: {},\n            viewportsStyle: {},\n        };\n    }\n    setStyle(specifier, styles) {\n        const { viewportId, segmentationId, type, segmentIndex } = specifier;\n        const currentStyles = this.getStyle(specifier);\n        let updatedStyles;\n        if (!viewportId && !segmentationId) {\n            updatedStyles = {\n                ...currentStyles,\n                ...styles,\n            };\n        }\n        else {\n            updatedStyles = this.copyActiveToInactiveIfNotProvided({\n                ...currentStyles,\n                ...styles,\n            }, type);\n        }\n        if (!type) {\n            throw new Error('Type is required to set a style');\n        }\n        if (viewportId) {\n            if (!this.config.viewportsStyle[viewportId]) {\n                this.config.viewportsStyle[viewportId] = {\n                    renderInactiveSegmentations: false,\n                    representations: {},\n                };\n            }\n            const representations = this.config.viewportsStyle[viewportId].representations;\n            if (segmentationId) {\n                if (!representations[segmentationId]) {\n                    representations[segmentationId] = {};\n                }\n                if (!representations[segmentationId][type]) {\n                    representations[segmentationId][type] = {};\n                }\n                const repConfig = representations[segmentationId][type];\n                if (segmentIndex !== undefined) {\n                    if (!repConfig.perSegment) {\n                        repConfig.perSegment = {};\n                    }\n                    repConfig.perSegment[segmentIndex] = updatedStyles;\n                }\n                else {\n                    repConfig.allSegments = updatedStyles;\n                }\n            }\n            else {\n                const ALL_SEGMENTATIONS_KEY = '__allSegmentations__';\n                if (!representations[ALL_SEGMENTATIONS_KEY]) {\n                    representations[ALL_SEGMENTATIONS_KEY] = {};\n                }\n                if (!representations[ALL_SEGMENTATIONS_KEY][type]) {\n                    representations[ALL_SEGMENTATIONS_KEY][type] = {};\n                }\n                representations[ALL_SEGMENTATIONS_KEY][type].allSegments =\n                    updatedStyles;\n            }\n        }\n        else if (segmentationId) {\n            if (!this.config.segmentations[segmentationId]) {\n                this.config.segmentations[segmentationId] = {};\n            }\n            if (!this.config.segmentations[segmentationId][type]) {\n                this.config.segmentations[segmentationId][type] = {};\n            }\n            const segConfig = this.config.segmentations[segmentationId][type];\n            if (segmentIndex !== undefined) {\n                if (!segConfig.perSegment) {\n                    segConfig.perSegment = {};\n                }\n                segConfig.perSegment[segmentIndex] = updatedStyles;\n            }\n            else {\n                segConfig.allSegments = updatedStyles;\n            }\n        }\n        else {\n            this.config.global[type] = updatedStyles;\n        }\n    }\n    copyActiveToInactiveIfNotProvided(styles, type) {\n        const processedStyles = { ...styles };\n        if (type === Enums.SegmentationRepresentations.Labelmap) {\n            const labelmapStyles = processedStyles;\n            labelmapStyles.renderOutlineInactive = labelmapStyles.renderOutline;\n            labelmapStyles.outlineWidthInactive = labelmapStyles.outlineWidth;\n            labelmapStyles.renderFillInactive = labelmapStyles.renderFill;\n            labelmapStyles.fillAlphaInactive = labelmapStyles.fillAlpha;\n            labelmapStyles.outlineOpacityInactive = labelmapStyles.outlineOpacity;\n        }\n        else if (type === Enums.SegmentationRepresentations.Contour) {\n            const contourStyles = processedStyles;\n            contourStyles.outlineWidthInactive = contourStyles.outlineWidth;\n            contourStyles.outlineOpacityInactive = contourStyles.outlineOpacity;\n            contourStyles.outlineDashInactive = contourStyles.outlineDash;\n            contourStyles.renderOutlineInactive = contourStyles.renderOutline;\n            contourStyles.renderFillInactive = contourStyles.renderFill;\n            contourStyles.fillAlphaInactive = contourStyles.fillAlpha;\n        }\n        return processedStyles;\n    }\n    getStyle(specifier) {\n        const { viewportId, segmentationId, type, segmentIndex } = specifier;\n        let combinedStyle = this.getDefaultStyle(type);\n        let renderInactiveSegmentations = false;\n        if (this.config.global[type]) {\n            combinedStyle = {\n                ...combinedStyle,\n                ...this.config.global[type],\n            };\n        }\n        if (this.config.segmentations[segmentationId]?.[type]) {\n            combinedStyle = {\n                ...combinedStyle,\n                ...this.config.segmentations[segmentationId][type].allSegments,\n            };\n            if (segmentIndex !== undefined &&\n                this.config.segmentations[segmentationId][type].perSegment?.[segmentIndex]) {\n                combinedStyle = {\n                    ...combinedStyle,\n                    ...this.config.segmentations[segmentationId][type].perSegment[segmentIndex],\n                };\n            }\n        }\n        if (viewportId && this.config.viewportsStyle[viewportId]) {\n            renderInactiveSegmentations =\n                this.config.viewportsStyle[viewportId].renderInactiveSegmentations;\n            const allSegmentationsKey = '__allSegmentations__';\n            if (this.config.viewportsStyle[viewportId].representations[allSegmentationsKey]?.[type]) {\n                combinedStyle = {\n                    ...combinedStyle,\n                    ...this.config.viewportsStyle[viewportId].representations[allSegmentationsKey][type].allSegments,\n                };\n            }\n            if (segmentationId &&\n                this.config.viewportsStyle[viewportId].representations[segmentationId]?.[type]) {\n                combinedStyle = {\n                    ...combinedStyle,\n                    ...this.config.viewportsStyle[viewportId].representations[segmentationId][type].allSegments,\n                };\n                if (segmentIndex !== undefined &&\n                    this.config.viewportsStyle[viewportId].representations[segmentationId][type].perSegment?.[segmentIndex]) {\n                    combinedStyle = {\n                        ...combinedStyle,\n                        ...this.config.viewportsStyle[viewportId].representations[segmentationId][type].perSegment[segmentIndex],\n                    };\n                }\n            }\n        }\n        return combinedStyle;\n    }\n    getRenderInactiveSegmentations(viewportId) {\n        return this.config.viewportsStyle[viewportId]?.renderInactiveSegmentations;\n    }\n    setRenderInactiveSegmentations(viewportId, renderInactiveSegmentations) {\n        if (!this.config.viewportsStyle[viewportId]) {\n            this.config.viewportsStyle[viewportId] = {\n                renderInactiveSegmentations: false,\n                representations: {},\n            };\n        }\n        this.config.viewportsStyle[viewportId].renderInactiveSegmentations =\n            renderInactiveSegmentations;\n    }\n    getDefaultStyle(type) {\n        switch (type) {\n            case Enums.SegmentationRepresentations.Labelmap:\n                return getDefaultLabelmapConfig();\n            case Enums.SegmentationRepresentations.Contour:\n                return getDefaultContourConfig();\n            case Enums.SegmentationRepresentations.Surface:\n                return {};\n            default:\n                throw new Error(`Unknown representation type: ${type}`);\n        }\n    }\n    clearSegmentationStyle(segmentationId) {\n        if (this.config.segmentations[segmentationId]) {\n            delete this.config.segmentations[segmentationId];\n        }\n    }\n    clearAllSegmentationStyles() {\n        this.config.segmentations = {};\n    }\n    clearViewportStyle(viewportId) {\n        if (this.config.viewportsStyle[viewportId]) {\n            delete this.config.viewportsStyle[viewportId];\n        }\n    }\n    clearAllViewportStyles() {\n        for (const viewportId in this.config.viewportsStyle) {\n            const viewportStyle = this.config.viewportsStyle[viewportId];\n            const renderInactiveSegmentations = viewportStyle.renderInactiveSegmentations;\n            this.config.viewportsStyle[viewportId] = {\n                renderInactiveSegmentations,\n                representations: {},\n            };\n        }\n    }\n    resetToGlobalStyle() {\n        this.clearAllSegmentationStyles();\n        this.clearAllViewportStyles();\n    }\n    hasCustomStyle(specifier) {\n        const { type } = specifier;\n        const style = this.getStyle(specifier);\n        const defaultStyle = this.getDefaultStyle(type);\n        return !utilities.deepEqual(style, defaultStyle);\n    }\n}\nconst segmentationStyle = new SegmentationStyle();\nexport { segmentationStyle };\n","import { getActiveSegmentation as _getActiveSegmentation } from './getActiveSegmentation';\nimport { setActiveSegmentation as _setActiveSegmentation } from './setActiveSegmentation';\nfunction getActiveSegmentation(viewportId) {\n    return _getActiveSegmentation(viewportId);\n}\nfunction setActiveSegmentation(viewportId, segmentationId, suppressEvent = false) {\n    _setActiveSegmentation(viewportId, segmentationId);\n}\nexport { getActiveSegmentation, setActiveSegmentation, };\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function setActiveSegmentation(viewportId, segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    segmentationStateManager.setActiveSegmentation(viewportId, segmentationId);\n}\n","import { utilities } from '@cornerstonejs/core';\nimport { defaultSegmentationStateManager } from './SegmentationStateManager';\nimport { getNextColorLUTIndex } from './getNextColorLUTIndex';\nimport CORNERSTONE_COLOR_LUT from '../../constants/COLOR_LUT';\nexport function addColorLUT(colorLUT, index) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    const indexToUse = index ?? getNextColorLUTIndex();\n    let colorLUTToUse = [...colorLUT];\n    if (!utilities.isEqual(colorLUTToUse[0], [0, 0, 0, 0])) {\n        console.warn('addColorLUT: [0, 0, 0, 0] color is not provided for the background color (segmentIndex =0), automatically adding it');\n        colorLUTToUse = [[0, 0, 0, 0], ...colorLUTToUse];\n    }\n    colorLUTToUse = colorLUTToUse.map((color) => {\n        if (color.length === 3) {\n            return [color[0], color[1], color[2], 255];\n        }\n        return color;\n    });\n    if (colorLUTToUse.length < 255) {\n        const missingColorLUTs = CORNERSTONE_COLOR_LUT.slice(colorLUTToUse.length);\n        colorLUTToUse = [...colorLUTToUse, ...missingColorLUTs];\n    }\n    segmentationStateManager.addColorLUT(colorLUTToUse, indexToUse);\n    return indexToUse;\n}\n","import CORNERSTONE_COLOR_LUT from '../../constants/COLOR_LUT';\nimport { triggerAnnotationRenderForViewportIds } from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { SegmentationRepresentations } from '../../enums';\nimport { triggerSegmentationModified } from './triggerSegmentationEvents';\nimport { addColorLUT } from './addColorLUT';\nimport { getNextColorLUTIndex } from './getNextColorLUTIndex';\nimport { defaultSegmentationStateManager } from './SegmentationStateManager';\nimport { getColorLUT } from './getColorLUT';\nfunction internalAddSegmentationRepresentation(viewportId, representationInput) {\n    const { segmentationId, config } = representationInput;\n    const renderingConfig = {\n        colorLUTIndex: getColorLUTIndex(config),\n    };\n    defaultSegmentationStateManager.addSegmentationRepresentation(viewportId, segmentationId, representationInput.type, renderingConfig);\n    if (representationInput.type === SegmentationRepresentations.Contour) {\n        triggerAnnotationRenderForViewportIds([viewportId]);\n    }\n    triggerSegmentationModified(segmentationId);\n}\nfunction getColorLUTIndex(config) {\n    const { colorLUTOrIndex } = config || {};\n    if (colorLUTOrIndex === undefined) {\n        const index = addColorLUT(CORNERSTONE_COLOR_LUT);\n        return index;\n    }\n    if (typeof colorLUTOrIndex === 'number') {\n        return colorLUTOrIndex;\n    }\n    if (Array.isArray(colorLUTOrIndex) &&\n        colorLUTOrIndex.every((item) => Array.isArray(item) && item.length === 4)) {\n        const index = addColorLUT(colorLUTOrIndex);\n        return index;\n    }\n    const index = addColorLUT(CORNERSTONE_COLOR_LUT);\n    return index;\n}\nexport { internalAddSegmentationRepresentation };\n","import { SegmentationRepresentations } from '../../enums';\nimport { internalAddSegmentationRepresentation } from './internalAddSegmentationRepresentation';\nexport function addSegmentationRepresentations(viewportId, segmentationInputArray) {\n    segmentationInputArray.map((segmentationInput) => {\n        return internalAddSegmentationRepresentation(viewportId, segmentationInput);\n    });\n}\nfunction addContourRepresentationToViewport(viewportId, contourInputArray) {\n    return addSegmentationRepresentations(viewportId, contourInputArray.map((input) => ({\n        ...input,\n        type: SegmentationRepresentations.Contour,\n    })));\n}\nfunction addContourRepresentationToViewportMap(viewportInputMap) {\n    const results = {};\n    for (const [viewportId, inputArray] of Object.entries(viewportInputMap)) {\n        results[viewportId] = addContourRepresentationToViewport(viewportId, inputArray);\n    }\n    return results;\n}\nfunction addLabelmapRepresentationToViewport(viewportId, labelmapInputArray) {\n    return addSegmentationRepresentations(viewportId, labelmapInputArray.map((input) => ({\n        ...input,\n        type: SegmentationRepresentations.Labelmap,\n    })));\n}\nfunction addLabelmapRepresentationToViewportMap(viewportInputMap) {\n    const results = {};\n    for (const [viewportId, inputArray] of Object.entries(viewportInputMap)) {\n        results[viewportId] = addLabelmapRepresentationToViewport(viewportId, inputArray.map((input) => ({\n            ...input,\n            type: SegmentationRepresentations.Labelmap,\n        })));\n    }\n}\nfunction addSurfaceRepresentationToViewport(viewportId, surfaceInputArray) {\n    return addSegmentationRepresentations(viewportId, surfaceInputArray.map((input) => ({\n        ...input,\n        type: SegmentationRepresentations.Surface,\n    })));\n}\nfunction addSurfaceRepresentationToViewportMap(viewportInputMap) {\n    const results = {};\n    for (const [viewportId, inputArray] of Object.entries(viewportInputMap)) {\n        results[viewportId] = addSurfaceRepresentationToViewport(viewportId, inputArray);\n    }\n    return results;\n}\nexport { addContourRepresentationToViewport, addLabelmapRepresentationToViewport, addSurfaceRepresentationToViewport, addContourRepresentationToViewportMap, addLabelmapRepresentationToViewportMap, addSurfaceRepresentationToViewportMap, };\n","import { SegmentationRepresentations } from '../../../enums';\nimport { cache } from '@cornerstonejs/core';\nfunction normalizeSegmentationInput(segmentationInput) {\n    const { segmentationId, representation, config } = segmentationInput;\n    const { type, data: inputData } = representation;\n    const data = inputData ? { ...inputData } : {};\n    if (!data) {\n        throw new Error('Segmentation representation data may not be undefined');\n    }\n    if (type === SegmentationRepresentations.Contour) {\n        normalizeContourData(data);\n    }\n    const normalizedSegments = normalizeSegments(config?.segments, type, data);\n    delete config?.segments;\n    return {\n        segmentationId,\n        label: config?.label ?? null,\n        cachedStats: config?.cachedStats ?? {},\n        segments: normalizedSegments,\n        representationData: {\n            [type]: {\n                ...data,\n            },\n        },\n    };\n}\nfunction normalizeContourData(contourData) {\n    contourData.geometryIds = contourData.geometryIds ?? [];\n    contourData.annotationUIDsMap = contourData.annotationUIDsMap ?? new Map();\n}\nfunction normalizeSegments(segmentsConfig, type, data) {\n    const normalizedSegments = {};\n    if (segmentsConfig) {\n        Object.entries(segmentsConfig).forEach(([segmentIndex, segment]) => {\n            normalizedSegments[segmentIndex] = {\n                segmentIndex: Number(segmentIndex),\n                label: segment.label ?? `Segment ${segmentIndex}`,\n                locked: segment.locked ?? false,\n                cachedStats: segment.cachedStats ?? {},\n                active: segment.active ?? false,\n            };\n        });\n    }\n    else if (type === SegmentationRepresentations.Surface) {\n        normalizeSurfaceSegments(normalizedSegments, data);\n    }\n    else {\n        normalizedSegments[1] = createDefaultSegment();\n    }\n    return normalizedSegments;\n}\nfunction normalizeSurfaceSegments(normalizedSegments, surfaceData) {\n    const { geometryIds } = surfaceData;\n    geometryIds.forEach((geometryId) => {\n        const geometry = cache.getGeometry(geometryId);\n        if (geometry?.data) {\n            const { segmentIndex } = geometry.data;\n            normalizedSegments[segmentIndex] = { segmentIndex };\n        }\n    });\n}\nfunction createDefaultSegment() {\n    return {\n        segmentIndex: 1,\n        label: 'Segment 1',\n        locked: false,\n        cachedStats: {},\n        active: true,\n    };\n}\nexport default normalizeSegmentationInput;\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nimport { triggerSegmentationModified } from './triggerSegmentationEvents';\nimport normalizeSegmentationInput from './helpers/normalizeSegmentationInput';\nexport function addSegmentations(segmentationInputArray, suppressEvents) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    segmentationInputArray.forEach((segmentationInput) => {\n        const segmentation = normalizeSegmentationInput(segmentationInput);\n        segmentationStateManager.addSegmentation(segmentation);\n        if (!suppressEvents) {\n            triggerSegmentationModified(segmentation.segmentationId);\n        }\n    });\n}\nexport default addSegmentations;\n","import { addColorLUT as _addColorLUT } from '../addColorLUT';\nimport { getColorLUT as _getColorLUT } from '../getColorLUT';\nimport { getSegmentationRepresentations } from '../getSegmentationRepresentation';\nimport { triggerSegmentationRepresentationModified } from '../triggerSegmentationEvents';\nfunction addColorLUT(colorLUT, colorLUTIndex) {\n    if (!colorLUT) {\n        throw new Error('addColorLUT: colorLUT is required');\n    }\n    return _addColorLUT(colorLUT, colorLUTIndex);\n}\nfunction setColorLUT(viewportId, segmentationId, colorLUTsIndex) {\n    if (!_getColorLUT(colorLUTsIndex)) {\n        throw new Error(`setColorLUT: could not find colorLUT with index ${colorLUTsIndex}`);\n    }\n    const segmentationRepresentations = getSegmentationRepresentations(viewportId, { segmentationId });\n    if (!segmentationRepresentations) {\n        throw new Error(`viewport specific state for viewport ${viewportId} does not exist`);\n    }\n    segmentationRepresentations.forEach((segmentationRepresentation) => {\n        segmentationRepresentation.colorLUTIndex = colorLUTsIndex;\n    });\n    triggerSegmentationRepresentationModified(viewportId, segmentationId);\n}\nfunction getSegmentIndexColor(viewportId, segmentationId, segmentIndex) {\n    const representations = getSegmentationRepresentations(viewportId, {\n        segmentationId,\n    });\n    if (!representations || representations.length === 0) {\n        return null;\n    }\n    const representation = representations[0];\n    const { colorLUTIndex } = representation;\n    const colorLUT = _getColorLUT(colorLUTIndex);\n    let colorValue = colorLUT[segmentIndex];\n    if (!colorValue) {\n        if (typeof segmentIndex !== 'number') {\n            throw new Error(`Can't create colour for LUT index ${segmentIndex}`);\n        }\n        colorValue = colorLUT[segmentIndex] = [0, 0, 0, 0];\n    }\n    return colorValue;\n}\nfunction setSegmentIndexColor(viewportId, segmentationId, segmentIndex, color) {\n    const colorReference = getSegmentIndexColor(viewportId, segmentationId, segmentIndex);\n    for (let i = 0; i < color.length; i++) {\n        colorReference[i] = color[i];\n    }\n    triggerSegmentationRepresentationModified(viewportId, segmentationId);\n}\nexport { getSegmentIndexColor, addColorLUT, setColorLUT, setSegmentIndexColor };\n","import { triggerEvent, eventTarget } from '@cornerstonejs/core';\nimport { Events } from '../../../enums';\nimport { setSegmentationDirty } from '../../../utilities/segmentation/utilities';\nexport function triggerSegmentationDataModified(segmentationId, modifiedSlicesToUse) {\n    const eventDetail = {\n        segmentationId,\n        modifiedSlicesToUse,\n    };\n    setSegmentationDirty(segmentationId);\n    triggerEvent(eventTarget, Events.SEGMENTATION_DATA_MODIFIED, eventDetail);\n}\n","import { getSegmentation } from './getSegmentation';\nexport function getActiveSegmentIndex(segmentationId) {\n    const segmentation = getSegmentation(segmentationId);\n    if (segmentation) {\n        const activeSegmentIndex = Object.keys(segmentation.segments).find((segmentIndex) => segmentation.segments[segmentIndex].active);\n        return activeSegmentIndex ? Number(activeSegmentIndex) : undefined;\n    }\n    return undefined;\n}\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getActiveSegmentation(viewportId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    return segmentationStateManager.getActiveSegmentation(viewportId);\n}\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getCurrentLabelmapImageIdForViewport(viewportId, segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    return segmentationStateManager.getCurrentLabelmapImageIdForViewport(viewportId, segmentationId);\n}\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getSegmentationRepresentations(viewportId, specifier = {}) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    return segmentationStateManager.getSegmentationRepresentations(viewportId, specifier);\n}\nexport function getSegmentationRepresentation(viewportId, specifier) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    if (!specifier.segmentationId || !specifier.type) {\n        throw new Error('getSegmentationRepresentation: No segmentationId or type provided, you need to provide at least one of them');\n    }\n    const representations = segmentationStateManager.getSegmentationRepresentations(viewportId, specifier);\n    return representations?.[0];\n}\nexport function getSegmentationRepresentationsBySegmentationId(segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    return segmentationStateManager.getSegmentationRepresentationsBySegmentationId(segmentationId);\n}\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getSegmentationRepresentationVisibility(viewportId, specifier) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    return segmentationStateManager.getSegmentationRepresentationVisibility(viewportId, specifier);\n}\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getSegmentations() {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    const state = segmentationStateManager.getState();\n    return state.segmentations;\n}\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getViewportIdsWithSegmentation(segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    const state = segmentationStateManager.getState();\n    const viewportSegRepresentations = state.viewportSegRepresentations;\n    const viewportIdsWithSegmentation = Object.entries(viewportSegRepresentations)\n        .filter(([, viewportSegmentations]) => viewportSegmentations.some((segRep) => segRep.segmentationId === segmentationId))\n        .map(([viewportId]) => viewportId);\n    return viewportIdsWithSegmentation;\n}\n","import { getSegmentation } from './getSegmentation';\nimport { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getViewportSegmentations(viewportId, type) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    const state = segmentationStateManager.getState();\n    const viewportRepresentations = state.viewportSegRepresentations[viewportId];\n    const segmentations = viewportRepresentations.map((representation) => {\n        if (type && representation.type === type) {\n            return getSegmentation(representation.segmentationId);\n        }\n        return getSegmentation(representation.segmentationId);\n    });\n    const filteredSegmentations = segmentations.filter((segmentation) => segmentation !== undefined);\n    return filteredSegmentations;\n}\n","import { internalComputeVolumeLabelmapFromStack } from '../SegmentationStateManager';\nexport async function computeVolumeLabelmapFromStack(args) {\n    return internalComputeVolumeLabelmapFromStack(args);\n}\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nimport { triggerSegmentationModified } from './triggerSegmentationEvents';\nexport function updateSegmentations(segmentationUpdateArray, suppressEvents) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    segmentationUpdateArray.forEach((segmentationUpdate) => {\n        segmentationStateManager.updateSegmentation(segmentationUpdate.segmentationId, segmentationUpdate.payload);\n        if (!suppressEvents) {\n            triggerSegmentationModified(segmentationUpdate.segmentationId);\n        }\n    });\n}\n","import { getSegmentationRepresentation, getSegmentationRepresentations, } from '../getSegmentationRepresentation';\nimport { setSegmentationRepresentationVisibility as _setSegmentationRepresentationVisibility } from '../setSegmentationRepresentationVisibility';\nimport { getSegmentationRepresentationVisibility as _getSegmentationRepresentationVisibility } from '../getSegmentationRepresentationVisibility';\nimport { triggerSegmentationRenderBySegmentationId } from '../SegmentationRenderingEngine';\nimport { triggerSegmentationRepresentationModified } from '../triggerSegmentationEvents';\nfunction setSegmentationRepresentationVisibility(viewportId, specifier, visibility) {\n    const representations = getSegmentationRepresentations(viewportId, specifier);\n    if (!representations) {\n        return;\n    }\n    representations.forEach((representation) => {\n        _setSegmentationRepresentationVisibility(viewportId, {\n            segmentationId: representation.segmentationId,\n            type: representation.type,\n        }, visibility);\n    });\n}\nfunction getSegmentationRepresentationVisibility(viewportId, specifier) {\n    return _getSegmentationRepresentationVisibility(viewportId, specifier);\n}\nfunction setSegmentIndexVisibility(viewportId, specifier, segmentIndex, visibility) {\n    const representations = getSegmentationRepresentations(viewportId, specifier);\n    if (!representations) {\n        return;\n    }\n    representations.forEach((representation) => {\n        representation.segments[segmentIndex].visible = visibility;\n    });\n    triggerSegmentationRenderBySegmentationId(specifier.segmentationId);\n    triggerSegmentationRepresentationModified(viewportId, specifier.segmentationId);\n}\nfunction getSegmentIndexVisibility(viewportId, specifier, segmentIndex) {\n    const hiddenSegments = getHiddenSegmentIndices(viewportId, specifier);\n    return !hiddenSegments.has(segmentIndex);\n}\nfunction getHiddenSegmentIndices(viewportId, specifier) {\n    const representation = getSegmentationRepresentation(viewportId, specifier);\n    if (!representation) {\n        return new Set();\n    }\n    const segmentsHidden = Object.entries(representation.segments).reduce((acc, [segmentIndex, segment]) => {\n        if (!segment.visible) {\n            acc.add(Number(segmentIndex));\n        }\n        return acc;\n    }, new Set());\n    return segmentsHidden;\n}\nexport { setSegmentationRepresentationVisibility, getSegmentationRepresentationVisibility, setSegmentIndexVisibility, getSegmentIndexVisibility, getHiddenSegmentIndices, };\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function setSegmentationRepresentationVisibility(viewportId, specifier, visible) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    segmentationStateManager.setSegmentationRepresentationVisibility(viewportId, specifier, visible);\n}\n","import { getSegmentations } from '../getSegmentations';\nimport { getViewportSegmentations } from '../getViewportSegmentations';\nimport { triggerSegmentationRender } from '../SegmentationRenderingEngine';\nimport { segmentationStyle } from '../SegmentationStyle';\nimport { triggerSegmentationRepresentationModified } from '../triggerSegmentationEvents';\nfunction getStyle(specifier) {\n    return segmentationStyle.getStyle(specifier);\n}\nfunction setStyle(specifier, style) {\n    segmentationStyle.setStyle(specifier, style);\n    if (!specifier.viewportId && !specifier.segmentationId) {\n        const segmentations = getSegmentations();\n        segmentations.forEach((segmentation) => {\n            triggerSegmentationRender(segmentation.segmentationId);\n        });\n    }\n    triggerSegmentationRepresentationModified(specifier.viewportId, specifier.segmentationId, specifier.type);\n}\nfunction setRenderInactiveSegmentations(viewportId, renderInactiveSegmentations) {\n    segmentationStyle.setRenderInactiveSegmentations(viewportId, renderInactiveSegmentations);\n    triggerSegmentationRender(viewportId);\n    const segmentations = getViewportSegmentations(viewportId);\n    segmentations.forEach((segmentation) => {\n        triggerSegmentationRepresentationModified(viewportId, segmentation.segmentationId);\n    });\n}\nfunction getRenderInactiveSegmentations(viewportId) {\n    return segmentationStyle.getRenderInactiveSegmentations(viewportId);\n}\nfunction resetToGlobalStyle() {\n    segmentationStyle.resetToGlobalStyle();\n    triggerSegmentationRender();\n}\nfunction hasCustomStyle(specifier) {\n    return segmentationStyle.hasCustomStyle(specifier);\n}\nexport { getStyle, setStyle, setRenderInactiveSegmentations, getRenderInactiveSegmentations, resetToGlobalStyle, hasCustomStyle, };\n","import { cache } from '@cornerstonejs/core';\nimport { getSegmentation } from '../getSegmentation';\nimport { triggerSegmentationDataModified } from '../triggerSegmentationEvents';\nexport function clearSegmentValue(segmentationId, segmentIndex) {\n    const segmentation = getSegmentation(segmentationId);\n    if (segmentation.representationData.Labelmap) {\n        const { representationData } = segmentation;\n        const labelmapData = representationData.Labelmap;\n        if ('imageIds' in labelmapData || 'volumeId' in labelmapData) {\n            const items = 'imageIds' in labelmapData\n                ? labelmapData.imageIds.map((imageId) => cache.getImage(imageId))\n                : [cache.getVolume(labelmapData.volumeId)];\n            items.forEach((item) => {\n                if (!item) {\n                    return;\n                }\n                const { voxelManager } = item;\n                voxelManager.forEach(({ value, index }) => {\n                    if (value === segmentIndex) {\n                        voxelManager.setAtIndex(index, 0);\n                    }\n                });\n            });\n        }\n        triggerSegmentationDataModified(segmentationId);\n    }\n    else {\n        throw new Error('Invalid segmentation type, only labelmap is supported right now');\n    }\n}\n","import { getActiveSegmentIndex } from './getActiveSegmentIndex';\nimport { getSegmentation } from './getSegmentation';\nimport { getSegmentationRepresentations } from './getSegmentationRepresentation';\nimport { getViewportIdsWithSegmentation } from './getViewportIdsWithSegmentation';\nimport { clearSegmentValue } from './helpers/clearSegmentValue';\nimport { setActiveSegmentIndex } from './segmentIndex';\nimport { updateSegmentations } from './updateSegmentations';\nexport function removeSegment(segmentationId, segmentIndex, options = {\n    setNextSegmentAsActive: true,\n}) {\n    clearSegmentValue(segmentationId, segmentIndex);\n    const isThisSegmentActive = getActiveSegmentIndex(segmentationId) === segmentIndex;\n    const segmentation = getSegmentation(segmentationId);\n    const { segments } = segmentation;\n    delete segments[segmentIndex];\n    const updatedSegments = {\n        ...segments,\n    };\n    updateSegmentations([\n        {\n            segmentationId,\n            payload: {\n                segments: updatedSegments,\n            },\n        },\n    ]);\n    if (isThisSegmentActive && options.setNextSegmentAsActive) {\n        const segmentIndices = Object.keys(segments)\n            .map(Number)\n            .sort((a, b) => a - b);\n        const currentIndex = segmentIndices.indexOf(segmentIndex);\n        const nextSegmentIndex = segmentIndices[currentIndex + 1];\n        const previousSegmentIndex = segmentIndices[currentIndex - 1];\n        if (nextSegmentIndex !== undefined) {\n            setActiveSegmentIndex(segmentationId, nextSegmentIndex);\n        }\n        else if (previousSegmentIndex !== undefined) {\n            setActiveSegmentIndex(segmentationId, previousSegmentIndex);\n        }\n    }\n    const viewportIds = getViewportIdsWithSegmentation(segmentationId);\n    viewportIds.forEach((viewportId) => {\n        const representations = getSegmentationRepresentations(viewportId, {\n            segmentationId,\n        });\n        representations.forEach((representation) => {\n            delete representation.segments[segmentIndex];\n        });\n    });\n}\n","import { getSegmentation } from './getSegmentation';\nimport { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getLabelmapImageIds(segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    const segmentation = getSegmentation(segmentationId);\n    return segmentationStateManager.getLabelmapImageIds(segmentation.representationData);\n}\n","import { removeContourRepresentation, removeLabelmapRepresentation, removeSegmentationRepresentation, removeSurfaceRepresentation, removeSegmentationRepresentations, removeAllSegmentationRepresentations, } from './removeSegmentationRepresentations';\nimport { addContourRepresentationToViewport, addContourRepresentationToViewportMap, addSurfaceRepresentationToViewport, addSurfaceRepresentationToViewportMap, addLabelmapRepresentationToViewport, addLabelmapRepresentationToViewportMap, addSegmentationRepresentations, } from './addSegmentationRepresentationsToViewport';\nimport { addSegmentations } from './addSegmentations';\nimport { updateSegmentations } from './updateSegmentations';\nimport * as activeSegmentation from './activeSegmentation';\nimport * as segmentLocking from './segmentLocking';\nimport * as state from './segmentationState';\nimport * as config from './config';\nimport * as segmentIndex from './segmentIndex';\nimport * as triggerSegmentationEvents from './triggerSegmentationEvents';\nimport { convertStackToVolumeLabelmap } from './helpers/convertStackToVolumeLabelmap';\nimport { computeVolumeLabelmapFromStack } from './helpers/computeVolumeLabelmapFromStack';\nimport * as polySegManager from './polySeg';\nimport { clearSegmentValue } from './helpers/clearSegmentValue';\nimport { convertVolumeToStackLabelmap } from './helpers/computeStackLabelmapFromVolume';\nimport { removeSegment } from './removeSegment';\nimport { getLabelmapImageIds } from './getLabelmapImageIds';\nimport { removeAllSegmentations, removeSegmentation, } from './removeSegmentation';\nconst helpers = {\n    clearSegmentValue,\n    convertStackToVolumeLabelmap,\n    computeVolumeLabelmapFromStack,\n    convertVolumeToStackLabelmap,\n};\nexport { removeSegmentationRepresentation, removeContourRepresentation, removeLabelmapRepresentation, removeSurfaceRepresentation, removeAllSegmentations, removeSegmentation, removeSegmentationRepresentations, addLabelmapRepresentationToViewport, addLabelmapRepresentationToViewportMap, addSegmentationRepresentations, removeAllSegmentationRepresentations, addContourRepresentationToViewport, addContourRepresentationToViewportMap, addSurfaceRepresentationToViewport, addSurfaceRepresentationToViewportMap, addSegmentations, updateSegmentations, state, activeSegmentation, segmentLocking, config, segmentIndex, triggerSegmentationEvents, helpers, polySegManager as polySeg, removeSegment, getLabelmapImageIds, };\n","import { SegmentationRepresentations } from '../../../../enums';\nimport { computeAndAddRepresentation } from '../computeAndAddRepresentation';\nimport { computeContourData } from './contourComputationStrategies';\nexport function computeAndAddContourRepresentation(segmentationId, options = {}) {\n    return computeAndAddRepresentation(segmentationId, SegmentationRepresentations.Contour, () => computeContourData(segmentationId, options), () => undefined);\n}\n","import { SegmentationRepresentations } from '../../../../enums';\nimport { computeAndAddRepresentation } from '../computeAndAddRepresentation';\nimport { computeLabelmapData } from './labelmapComputationStrategies';\nimport { defaultSegmentationStateManager } from '../../SegmentationStateManager';\nimport { triggerSegmentationDataModified } from '../../triggerSegmentationEvents';\nexport async function computeAndAddLabelmapRepresentation(segmentationId, options = {}) {\n    return computeAndAddRepresentation(segmentationId, SegmentationRepresentations.Labelmap, () => computeLabelmapData(segmentationId, options), () => null, () => {\n        defaultSegmentationStateManager.processLabelmapRepresentationAddition(options.viewport.id, segmentationId);\n        setTimeout(() => {\n            triggerSegmentationDataModified(segmentationId);\n        }, 0);\n    });\n}\n","import { SegmentationRepresentations } from '../../../../enums';\nimport { computeAndAddRepresentation } from '../computeAndAddRepresentation';\nimport { computeSurfaceData } from './surfaceComputationStrategies';\nimport { updateSurfaceData } from './updateSurfaceData';\nexport function computeAndAddSurfaceRepresentation(segmentationId, options = {}) {\n    return computeAndAddRepresentation(segmentationId, SegmentationRepresentations.Surface, () => computeSurfaceData(segmentationId, options), () => updateSurfaceData(segmentationId));\n}\n","import { cache } from '@cornerstonejs/core';\nimport { getUniqueSegmentIndices } from '../../../../utilities/segmentation/getUniqueSegmentIndices';\nimport { getViewportIdsWithSegmentation } from '../../getViewportIdsWithSegmentation';\nimport { getSegmentation } from '../../getSegmentation';\nimport { triggerSegmentationModified } from '../../triggerSegmentationEvents';\nimport { getSegmentationRepresentation } from '../../getSegmentationRepresentation';\nimport { SegmentationRepresentations } from '../../../../enums';\nimport { computeSurfaceFromLabelmapSegmentation } from './surfaceComputationStrategies';\nimport { createAndCacheSurfacesFromRaw } from './createAndCacheSurfacesFromRaw';\nexport async function updateSurfaceData(segmentationId) {\n    const surfacesObj = await computeSurfaceFromLabelmapSegmentation(segmentationId);\n    if (!surfacesObj) {\n        return;\n    }\n    const segmentation = getSegmentation(segmentationId);\n    const indices = getUniqueSegmentIndices(segmentationId);\n    if (!indices.length) {\n        const geometryIds = segmentation.representationData.Surface.geometryIds;\n        geometryIds.forEach((geometryId) => {\n            const geometry = cache.getGeometry(geometryId);\n            const surface = geometry.data;\n            surface.points = [];\n            surface.polys = [];\n        });\n        triggerSegmentationModified(segmentationId);\n        return;\n    }\n    const promises = surfacesObj.map(({ data, segmentIndex }) => {\n        const geometryId = `segmentation_${segmentationId}_surface_${segmentIndex}`;\n        const geometry = cache.getGeometry(geometryId);\n        if (!geometry) {\n            const viewportIds = getViewportIdsWithSegmentation(segmentationId);\n            return viewportIds.map((viewportId) => {\n                const surfaceRepresentation = getSegmentationRepresentation(viewportId, {\n                    segmentationId,\n                    type: SegmentationRepresentations.Surface,\n                });\n                return [surfaceRepresentation].map((surfaceRepresentation) => {\n                    segmentation.representationData.Surface.geometryIds.set(segmentIndex, geometryId);\n                    return createAndCacheSurfacesFromRaw(segmentationId, [{ segmentIndex, data }], {\n                        segmentationId: surfaceRepresentation.segmentationId,\n                    });\n                });\n            });\n        }\n        else if (indices.includes(segmentIndex)) {\n            const surface = geometry.data;\n            surface.points = data.points;\n            surface.polys = data.polys;\n        }\n        else {\n            const surface = geometry.data;\n            surface.points = [];\n            surface.polys = [];\n        }\n    });\n    await Promise.all(promises);\n    triggerSegmentationModified(segmentationId);\n}\n","import { Enums, geometryLoader } from '@cornerstonejs/core';\nimport { getSegmentIndexColor } from '../../config/segmentationColor';\nimport { getSegmentation } from '../../getSegmentation';\nexport async function createAndCacheSurfacesFromRaw(segmentationId, rawSurfacesData, options = {}) {\n    const segmentation = getSegmentation(segmentationId);\n    const geometryIds = new Map();\n    const promises = Object.keys(rawSurfacesData).map(async (index) => {\n        const rawSurfaceData = rawSurfacesData[index];\n        const segmentIndex = rawSurfaceData.segmentIndex;\n        const color = getSegmentIndexColor(options.viewport.id, segmentation.segmentationId, segmentIndex).slice(0, 3);\n        if (!color) {\n            throw new Error('No color found for segment index, unable to create surface');\n        }\n        const closedSurface = {\n            id: `segmentation_${segmentation.segmentationId}_surface_${segmentIndex}`,\n            color,\n            frameOfReferenceUID: 'test-frameOfReferenceUID',\n            points: rawSurfaceData.data.points,\n            polys: rawSurfaceData.data.polys,\n            segmentIndex,\n        };\n        const geometryId = closedSurface.id;\n        geometryIds.set(segmentIndex, geometryId);\n        return geometryLoader.createAndCacheGeometry(geometryId, {\n            type: Enums.GeometryType.SURFACE,\n            geometryData: closedSurface,\n        });\n    });\n    await Promise.all(promises);\n    return {\n        geometryIds,\n    };\n}\n","import { Enums, eventTarget, triggerEvent, getWebWorkerManager, } from '@cornerstonejs/core';\nimport { getAnnotation } from '../../../annotation/annotationState';\nimport { WorkerTypes } from '../../../../enums';\nconst workerManager = getWebWorkerManager();\nconst triggerWorkerProgress = (eventTarget, progress, id) => {\n    triggerEvent(eventTarget, Enums.Events.WEB_WORKER_PROGRESS, {\n        progress,\n        type: WorkerTypes.POLYSEG_CONTOUR_TO_SURFACE,\n        id,\n    });\n};\nexport async function convertContourToSurface(contourRepresentationData, segmentIndex) {\n    const { annotationUIDsMap } = contourRepresentationData;\n    const polylines = [];\n    const numPointsArray = [];\n    const annotationUIDs = annotationUIDsMap.get(segmentIndex);\n    for (const annotationUID of annotationUIDs) {\n        const annotation = getAnnotation(annotationUID);\n        const { polyline } = annotation.data\n            .contour;\n        numPointsArray.push(polyline.length);\n        polyline.forEach((polyline) => polylines.push(...polyline));\n    }\n    triggerWorkerProgress(eventTarget, 0, segmentIndex);\n    const results = await workerManager.executeTask('polySeg', 'convertContourToSurface', {\n        polylines,\n        numPointsArray,\n    }, {\n        callbacks: [\n            (progress) => {\n                triggerWorkerProgress(eventTarget, progress, segmentIndex);\n            },\n        ],\n    });\n    triggerWorkerProgress(eventTarget, 100, segmentIndex);\n    return results;\n}\n","import { cache, eventTarget, getWebWorkerManager, triggerEvent, Enums, } from '@cornerstonejs/core';\nimport { computeVolumeLabelmapFromStack } from '../../helpers/computeVolumeLabelmapFromStack';\nimport { WorkerTypes } from '../../../../enums';\nconst workerManager = getWebWorkerManager();\nconst triggerWorkerProgress = (eventTarget, progress, id) => {\n    triggerEvent(eventTarget, Enums.Events.WEB_WORKER_PROGRESS, {\n        progress,\n        type: WorkerTypes.POLYSEG_LABELMAP_TO_SURFACE,\n        id,\n    });\n};\nexport async function convertLabelmapToSurface(labelmapRepresentationData, segmentIndex) {\n    let volumeId;\n    if (labelmapRepresentationData.volumeId) {\n        volumeId = labelmapRepresentationData\n            .volumeId;\n    }\n    else {\n        const { imageIds } = labelmapRepresentationData;\n        ({ volumeId } = await computeVolumeLabelmapFromStack({\n            imageIds,\n        }));\n    }\n    const volume = cache.getVolume(volumeId);\n    const scalarData = volume.voxelManager.getCompleteScalarDataArray();\n    const { dimensions, spacing, origin, direction } = volume;\n    triggerWorkerProgress(eventTarget, 0, segmentIndex);\n    const results = await workerManager.executeTask('polySeg', 'convertLabelmapToSurface', {\n        scalarData,\n        dimensions,\n        spacing,\n        origin,\n        direction,\n        segmentIndex,\n    }, {\n        callbacks: [\n            (progress) => {\n                triggerWorkerProgress(eventTarget, progress, segmentIndex);\n            },\n        ],\n    });\n    triggerWorkerProgress(eventTarget, 100, segmentIndex);\n    return results;\n}\n","import { getUniqueSegmentIndices } from '../../../../utilities/segmentation/getUniqueSegmentIndices';\nimport { getSegmentation } from '../../getSegmentation';\nimport { convertContourToSurface } from './convertContourToSurface';\nimport { createAndCacheSurfacesFromRaw } from './createAndCacheSurfacesFromRaw';\nimport { convertLabelmapToSurface } from './convertLabelmapToSurface';\nexport async function computeSurfaceData(segmentationId, options = {}) {\n    const segmentIndices = options.segmentIndices?.length\n        ? options.segmentIndices\n        : getUniqueSegmentIndices(segmentationId);\n    let rawSurfacesData;\n    const segmentation = getSegmentation(segmentationId);\n    const representationData = segmentation.representationData;\n    try {\n        if (representationData.Contour) {\n            rawSurfacesData = await computeSurfaceFromContourSegmentation(segmentationId, {\n                segmentIndices,\n                ...options,\n            });\n        }\n        else if (representationData.Labelmap) {\n            rawSurfacesData = await computeSurfaceFromLabelmapSegmentation(segmentation.segmentationId, {\n                segmentIndices,\n                ...options,\n            });\n        }\n    }\n    catch (error) {\n        console.error(error);\n        throw error;\n    }\n    if (!rawSurfacesData) {\n        throw new Error('Not enough data to convert to surface, currently only support converting volume labelmap to surface if available');\n    }\n    const surfacesData = await createAndCacheSurfacesFromRaw(segmentationId, rawSurfacesData, options);\n    return surfacesData;\n}\nasync function computeSurfaceFromLabelmapSegmentation(segmentationId, options = {}) {\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation?.representationData?.Labelmap) {\n        console.warn('Only support surface update from labelmaps');\n        return;\n    }\n    const labelmapRepresentationData = segmentation.representationData.Labelmap;\n    const segmentIndices = options.segmentIndices || getUniqueSegmentIndices(segmentationId);\n    const promises = segmentIndices.map((index) => {\n        const surface = convertLabelmapToSurface(labelmapRepresentationData, index);\n        return surface;\n    });\n    const surfaces = await Promise.allSettled(promises);\n    const errors = surfaces.filter((p) => p.status === 'rejected');\n    if (errors.length > 0) {\n        console.error(errors);\n        throw new Error('Failed to convert labelmap to surface');\n    }\n    const rawSurfacesData = surfaces\n        .map((surface, index) => {\n        if (surface.status === 'fulfilled') {\n            return { segmentIndex: segmentIndices[index], data: surface.value };\n        }\n    })\n        .filter(Boolean);\n    return rawSurfacesData;\n}\nasync function computeSurfaceFromContourSegmentation(segmentationId, options = {}) {\n    const segmentation = getSegmentation(segmentationId);\n    const contourRepresentationData = segmentation.representationData.Contour;\n    const segmentIndices = options.segmentIndices || getUniqueSegmentIndices(segmentationId);\n    const promises = segmentIndices.map(async (index) => {\n        const surface = await convertContourToSurface(contourRepresentationData, index);\n        return { segmentIndex: index, data: surface };\n    });\n    const surfaces = await Promise.all(promises);\n    return surfaces;\n}\nexport { computeSurfaceFromContourSegmentation, computeSurfaceFromLabelmapSegmentation, };\n","import { SegmentationRepresentations } from '../../../enums';\nimport { getSegmentation } from '../getSegmentation';\nimport { validate as validateLabelmap } from '../../../tools/displayTools/Labelmap/validateLabelmap';\nconst conversionPaths = new Map([\n    [\n        SegmentationRepresentations.Labelmap,\n        new Set([\n            SegmentationRepresentations.Surface,\n            SegmentationRepresentations.Contour,\n        ]),\n    ],\n    [\n        SegmentationRepresentations.Contour,\n        new Set([\n            SegmentationRepresentations.Labelmap,\n            SegmentationRepresentations.Surface,\n        ]),\n    ],\n    [\n        SegmentationRepresentations.Surface,\n        new Set([SegmentationRepresentations.Labelmap]),\n    ],\n]);\nfunction canComputeRequestedRepresentation(segmentationId, type) {\n    const { representationData } = getSegmentation(segmentationId);\n    const existingRepresentationTypes = getExistingRepresentationTypes(representationData);\n    return existingRepresentationTypes.some((existingRepresentationType) => canConvertFromTo(existingRepresentationType, type));\n}\nfunction getExistingRepresentationTypes(representationData) {\n    const supportedTypes = [];\n    Object.keys(representationData).forEach((representationType) => {\n        const representationTypeData = representationData[representationType];\n        let validateFn;\n        switch (representationType) {\n            case SegmentationRepresentations.Labelmap:\n                validateFn = validateLabelmap;\n                break;\n        }\n        if (validateFn) {\n            try {\n                validateFn(representationTypeData);\n                supportedTypes.push(representationType);\n            }\n            catch (error) {\n                console.warn(`Validation failed for labelmap of type ${representationType}`);\n            }\n        }\n        else {\n            supportedTypes.push(representationType);\n        }\n    });\n    return supportedTypes;\n}\nasync function canConvertFromTo(fromRepresentationType, toRepresentationType) {\n    return (conversionPaths.get(fromRepresentationType)?.has(toRepresentationType) ||\n        false);\n}\nexport { canComputeRequestedRepresentation };\n","import { eventTarget } from '@cornerstonejs/core';\nimport { Events } from '../../../enums';\nimport addRepresentationData from '../internalAddRepresentationData';\nimport { triggerSegmentationModified } from '../triggerSegmentationEvents';\nimport debounce from '../../../utilities/debounce';\nimport { registerPolySegWorker } from './registerPolySegWorker';\nconst computedRepresentations = new Map();\nasync function computeAndAddRepresentation(segmentationId, type, computeFunction, updateFunction, onComputationComplete) {\n    registerPolySegWorker();\n    const data = await computeFunction();\n    addRepresentationData({\n        segmentationId,\n        type,\n        data,\n    });\n    onComputationComplete?.();\n    if (!computedRepresentations.has(segmentationId)) {\n        computedRepresentations.set(segmentationId, []);\n    }\n    const representations = computedRepresentations.get(segmentationId);\n    if (!representations.includes(type)) {\n        representations.push(type);\n    }\n    subscribeToSegmentationChanges(updateFunction);\n    triggerSegmentationModified(segmentationId);\n    return data;\n}\nfunction subscribeToSegmentationChanges(updateFunction) {\n    const debouncedUpdateFunction = (event) => {\n        _debouncedSegmentationModified(event, updateFunction);\n    };\n    updateFunction._debouncedUpdateFunction = debouncedUpdateFunction;\n    eventTarget.removeEventListener(Events.SEGMENTATION_DATA_MODIFIED, updateFunction._debouncedUpdateFunction);\n    eventTarget.addEventListener(Events.SEGMENTATION_DATA_MODIFIED, updateFunction._debouncedUpdateFunction);\n}\nconst _debouncedSegmentationModified = debounce((event, updateFunction) => {\n    const segmentationId = event.detail.segmentationId;\n    const representations = computedRepresentations.get(segmentationId);\n    if (!representations || !representations.length) {\n        return;\n    }\n    updateFunction(segmentationId);\n    if (representations.length) {\n        triggerSegmentationModified(segmentationId);\n    }\n}, 300);\nexport { computeAndAddRepresentation };\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nimport { triggerSegmentationRemoved } from './triggerSegmentationEvents';\nimport { removeSegmentationRepresentations } from './removeSegmentationRepresentations';\nexport function removeSegmentation(segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    const viewportsWithSegmentation = segmentationStateManager\n        .getAllViewportSegmentationRepresentations()\n        .filter(({ representations }) => representations.some((rep) => rep.segmentationId === segmentationId))\n        .map(({ viewportId }) => viewportId);\n    viewportsWithSegmentation.forEach((viewportId) => {\n        removeSegmentationRepresentations(viewportId, { segmentationId });\n    });\n    segmentationStateManager.removeSegmentation(segmentationId);\n    triggerSegmentationRemoved(segmentationId);\n}\nexport function removeAllSegmentations() {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    const segmentations = segmentationStateManager.getState().segmentations;\n    segmentations.forEach((segmentation) => {\n        removeSegmentation(segmentation.segmentationId);\n    });\n    segmentationStateManager.resetState();\n}\n","import SegmentationRepresentations from '../../enums/SegmentationRepresentations';\nimport labelmapDisplay from '../../tools/displayTools/Labelmap/labelmapDisplay';\nimport contourDisplay from '../../tools/displayTools/Contour/contourDisplay';\nimport { getSegmentationRepresentations } from './getSegmentationRepresentation';\nimport { getEnabledElementByViewportId } from '@cornerstonejs/core';\nimport { defaultSegmentationStateManager } from './SegmentationStateManager';\nimport { surfaceDisplay } from '../../tools/displayTools/Surface';\nfunction removeSegmentationRepresentation(viewportId, specifier, immediate) {\n    return _removeSegmentationRepresentations(viewportId, specifier, immediate);\n}\nfunction removeSegmentationRepresentations(viewportId, specifier, immediate) {\n    return _removeSegmentationRepresentations(viewportId, specifier, immediate);\n}\nfunction _removeSegmentationRepresentations(viewportId, specifier, immediate) {\n    const { segmentationId, type } = specifier;\n    _removeRepresentationObject(viewportId, segmentationId, type, immediate);\n    return defaultSegmentationStateManager.removeSegmentationRepresentations(viewportId, {\n        segmentationId,\n        type,\n    });\n}\nfunction removeAllSegmentationRepresentations() {\n    const state = defaultSegmentationStateManager.getAllViewportSegmentationRepresentations();\n    state.forEach(({ viewportId, representations }) => {\n        representations.forEach(({ segmentationId, type }) => {\n            removeSegmentationRepresentation(viewportId, {\n                segmentationId,\n                type,\n            });\n        });\n    });\n    defaultSegmentationStateManager.resetState();\n}\nfunction removeLabelmapRepresentation(viewportId, segmentationId, immediate) {\n    removeSegmentationRepresentation(viewportId, {\n        segmentationId,\n        type: SegmentationRepresentations.Labelmap,\n    }, immediate);\n}\nfunction removeContourRepresentation(viewportId, segmentationId, immediate) {\n    removeSegmentationRepresentation(viewportId, {\n        segmentationId,\n        type: SegmentationRepresentations.Contour,\n    }, immediate);\n}\nfunction removeSurfaceRepresentation(viewportId, segmentationId, immediate) {\n    removeSegmentationRepresentation(viewportId, {\n        segmentationId,\n        type: SegmentationRepresentations.Surface,\n    }, immediate);\n}\nfunction _removeRepresentationObject(viewportId, segmentationId, type, immediate) {\n    const representations = getSegmentationRepresentations(viewportId, {\n        segmentationId,\n        type,\n    });\n    representations.forEach((representation) => {\n        if (representation.type === SegmentationRepresentations.Labelmap) {\n            labelmapDisplay.removeRepresentation(viewportId, representation.segmentationId, immediate);\n        }\n        else if (representation.type === SegmentationRepresentations.Contour) {\n            contourDisplay.removeRepresentation(viewportId, representation.segmentationId, immediate);\n        }\n        else if (representation.type === SegmentationRepresentations.Surface) {\n            surfaceDisplay.removeRepresentation(viewportId, representation.segmentationId, immediate);\n        }\n    });\n    const { viewport } = getEnabledElementByViewportId(viewportId) || {};\n    if (viewport) {\n        viewport.render();\n    }\n}\nexport { removeSegmentationRepresentation, removeSegmentationRepresentations, removeAllSegmentationRepresentations, removeLabelmapRepresentation, removeContourRepresentation, removeSurfaceRepresentation, };\n","import { getToolGroupForViewport } from '../../store/ToolGroupManager';\nimport { invalidateBrushCursor } from '../../utilities/segmentation/invalidateBrushCursor';\nimport { getSegmentation } from './getSegmentation';\nimport { getViewportIdsWithSegmentation } from './getViewportIdsWithSegmentation';\nimport { triggerSegmentationModified } from './triggerSegmentationEvents';\nimport { getActiveSegmentIndex } from './getActiveSegmentIndex';\nimport { getSegmentationRepresentations } from './getSegmentationRepresentation';\nfunction setActiveSegmentIndex(segmentationId, segmentIndex) {\n    const segmentation = getSegmentation(segmentationId);\n    if (typeof segmentIndex === 'string') {\n        console.warn('segmentIndex is a string, converting to number');\n        segmentIndex = Number(segmentIndex);\n    }\n    Object.values(segmentation.segments).forEach((segment) => {\n        segment.active = false;\n    });\n    if (!segmentation.segments[segmentIndex]) {\n        segmentation.segments[segmentIndex] = {\n            segmentIndex,\n            label: '',\n            locked: false,\n            cachedStats: {},\n            active: false,\n        };\n    }\n    if (segmentation.segments[segmentIndex].active !== true) {\n        segmentation.segments[segmentIndex].active = true;\n        triggerSegmentationModified(segmentationId);\n    }\n    const viewportIds = getViewportIdsWithSegmentation(segmentationId);\n    viewportIds.forEach((viewportId) => {\n        const representations = getSegmentationRepresentations(viewportId, {\n            segmentationId,\n        });\n        representations.forEach((representation) => {\n            if (!representation.segments[segmentIndex]) {\n                representation.segments[segmentIndex] = {\n                    visible: true,\n                };\n            }\n        });\n    });\n    viewportIds.forEach((viewportId) => {\n        const toolGroup = getToolGroupForViewport(viewportId);\n        invalidateBrushCursor(toolGroup.id);\n    });\n}\nexport { setActiveSegmentIndex, getActiveSegmentIndex };\n","import { getSegmentation } from '../../stateManagement/segmentation/getSegmentation';\nimport { triggerSegmentationModified } from './triggerSegmentationEvents';\nfunction isSegmentIndexLocked(segmentationId, segmentIndex) {\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation) {\n        throw new Error(`No segmentation state found for ${segmentationId}`);\n    }\n    const { segments } = segmentation;\n    return segments[segmentIndex].locked;\n}\nfunction setSegmentIndexLocked(segmentationId, segmentIndex, locked = true) {\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation) {\n        throw new Error(`No segmentation state found for ${segmentationId}`);\n    }\n    const { segments } = segmentation;\n    segments[segmentIndex].locked = locked;\n    triggerSegmentationModified(segmentationId);\n}\nfunction getLockedSegmentIndices(segmentationId) {\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation) {\n        throw new Error(`No segmentation state found for ${segmentationId}`);\n    }\n    const { segments } = segmentation;\n    const lockedSegmentIndices = Object.keys(segments).filter((segmentIndex) => segments[segmentIndex].locked);\n    return lockedSegmentIndices.map((segmentIndex) => parseInt(segmentIndex));\n}\nexport { isSegmentIndexLocked, setSegmentIndexLocked, getLockedSegmentIndices };\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function removeColorLUT(colorLUTIndex) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    segmentationStateManager.removeColorLUT(colorLUTIndex);\n}\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function getStackSegmentationImageIdsForViewport(viewportId, segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    return segmentationStateManager.getStackSegmentationImageIdsForViewport(viewportId, segmentationId);\n}\n","import { getSegmentation } from './getSegmentation';\nimport { getSegmentations } from './getSegmentations';\nimport { addSegmentations } from './addSegmentations';\nimport { removeAllSegmentations, removeSegmentation, } from './removeSegmentation';\nimport { removeLabelmapRepresentation, removeContourRepresentation, removeSurfaceRepresentation, removeSegmentationRepresentation, removeAllSegmentationRepresentations, } from './removeSegmentationRepresentations';\nimport { addColorLUT } from './addColorLUT';\nimport { getColorLUT } from './getColorLUT';\nimport { getNextColorLUTIndex } from './getNextColorLUTIndex';\nimport { removeColorLUT } from './removeColorLUT';\nimport { getViewportSegmentations } from './getViewportSegmentations';\nimport { getViewportIdsWithSegmentation } from './getViewportIdsWithSegmentation';\nimport { getCurrentLabelmapImageIdForViewport } from './getCurrentLabelmapImageIdForViewport';\nimport { updateLabelmapSegmentationImageReferences } from './updateLabelmapSegmentationImageReferences';\nimport { getStackSegmentationImageIdsForViewport } from './getStackSegmentationImageIdsForViewport';\nimport { getSegmentationRepresentation, getSegmentationRepresentations, getSegmentationRepresentationsBySegmentationId, } from './getSegmentationRepresentation';\nimport { defaultSegmentationStateManager } from './SegmentationStateManager';\nfunction destroy() {\n    defaultSegmentationStateManager.resetState();\n}\nexport { getColorLUT, getCurrentLabelmapImageIdForViewport, getNextColorLUTIndex, getSegmentation, getSegmentations, getStackSegmentationImageIdsForViewport, getViewportIdsWithSegmentation, getSegmentationRepresentation, getSegmentationRepresentations, removeColorLUT, getViewportSegmentations, removeSegmentation, removeLabelmapRepresentation, removeContourRepresentation, removeSurfaceRepresentation, removeSegmentationRepresentation, removeAllSegmentationRepresentations, removeAllSegmentations, addColorLUT, addSegmentations, updateLabelmapSegmentationImageReferences, getSegmentationRepresentationsBySegmentationId, destroy, };\n","import { defaultSegmentationStateManager } from './SegmentationStateManager';\nexport function updateLabelmapSegmentationImageReferences(viewportId, segmentationId) {\n    const segmentationStateManager = defaultSegmentationStateManager;\n    return segmentationStateManager.updateLabelmapSegmentationImageReferences(viewportId, segmentationId);\n}\n","import { getRenderingEngines } from '@cornerstonejs/core';\nimport { state } from '../state';\nfunction getToolGroupForViewport(viewportId, renderingEngineId) {\n    if (!renderingEngineId) {\n        renderingEngineId = getRenderingEngines().find((re) => re.getViewports().find((vp) => vp.id === viewportId))?.id;\n    }\n    const toolGroupFilteredByIds = state.toolGroups.filter((tg) => tg.viewportsInfo.some((vp) => vp.renderingEngineId === renderingEngineId &&\n        (!vp.viewportId || vp.viewportId === viewportId)));\n    if (!toolGroupFilteredByIds.length) {\n        return;\n    }\n    if (toolGroupFilteredByIds.length > 1) {\n        throw new Error(`Multiple tool groups found for renderingEngineId: ${renderingEngineId} and viewportId: ${viewportId}. You should only\n      have one tool group per viewport in a renderingEngine.`);\n    }\n    return toolGroupFilteredByIds[0];\n}\nexport default getToolGroupForViewport;\n","import { state } from '../state';\nfunction getToolGroup(toolGroupId) {\n    return state.toolGroups.find((s) => s.id === toolGroupId);\n}\nexport default getToolGroup;\n","import { MouseBindings, ToolModes, Events } from '../../enums';\nimport get from 'lodash.get';\nimport { triggerEvent, eventTarget, getRenderingEngine, getRenderingEngines, getEnabledElementByIds, Settings, } from '@cornerstonejs/core';\nimport { utilities } from '@cornerstonejs/core';\nimport { state } from '../state';\nimport { MouseCursor, SVGMouseCursor } from '../../cursors';\nimport { initElementCursor } from '../../cursors/elementCursor';\nimport getToolGroup from './getToolGroup';\nconst { Active, Passive, Enabled, Disabled } = ToolModes;\nconst PRIMARY_BINDINGS = [{ mouseButton: MouseBindings.Primary }];\nexport default class ToolGroup {\n    constructor(id) {\n        this.viewportsInfo = [];\n        this.toolOptions = {};\n        this.currentActivePrimaryToolName = null;\n        this.prevActivePrimaryToolName = null;\n        this.restoreToolOptions = {};\n        this._toolInstances = {};\n        this.id = id;\n    }\n    getViewportIds() {\n        return this.viewportsInfo.map(({ viewportId }) => viewportId);\n    }\n    getViewportsInfo() {\n        return this.viewportsInfo.slice();\n    }\n    getToolInstance(toolInstanceName) {\n        const toolInstance = this._toolInstances[toolInstanceName];\n        if (!toolInstance) {\n            console.warn(`'${toolInstanceName}' is not registered with this toolGroup (${this.id}).`);\n            return;\n        }\n        return toolInstance;\n    }\n    getToolInstances() {\n        return this._toolInstances;\n    }\n    hasTool(toolName) {\n        return !!this._toolInstances[toolName];\n    }\n    addTool(toolName, configuration = {}) {\n        const toolDefinition = state.tools[toolName];\n        const hasToolName = typeof toolName !== 'undefined' && toolName !== '';\n        const localToolInstance = this.toolOptions[toolName];\n        if (!hasToolName) {\n            console.warn('Tool with configuration did not produce a toolName: ', configuration);\n            return;\n        }\n        if (!toolDefinition) {\n            console.warn(`'${toolName}' is not registered with the library. You need to use cornerstoneTools.addTool to register it.`);\n            return;\n        }\n        if (localToolInstance) {\n            console.warn(`'${toolName}' is already registered for ToolGroup ${this.id}.`);\n            return;\n        }\n        const { toolClass: ToolClass } = toolDefinition;\n        const toolProps = {\n            name: toolName,\n            toolGroupId: this.id,\n            configuration,\n        };\n        const instantiatedTool = new ToolClass(toolProps);\n        this._toolInstances[toolName] = instantiatedTool;\n    }\n    addToolInstance(toolName, parentClassName, configuration = {}) {\n        let ToolClassToUse = state.tools[toolName]\n            ?.toolClass;\n        if (!ToolClassToUse) {\n            const ParentClass = state.tools[parentClassName]\n                .toolClass;\n            class ToolInstance extends ParentClass {\n            }\n            ToolInstance.toolName = toolName;\n            ToolClassToUse = ToolInstance;\n            state.tools[toolName] = {\n                toolClass: ToolInstance,\n            };\n        }\n        this.addTool(ToolClassToUse.toolName, configuration);\n    }\n    addViewport(viewportId, renderingEngineId) {\n        if (typeof viewportId !== 'string') {\n            throw new Error('viewportId must be defined and be a string');\n        }\n        const renderingEngineUIDToUse = this._findRenderingEngine(viewportId, renderingEngineId);\n        if (!this.viewportsInfo.some(({ viewportId: vpId }) => vpId === viewportId)) {\n            this.viewportsInfo.push({\n                viewportId,\n                renderingEngineId: renderingEngineUIDToUse,\n            });\n        }\n        const toolName = this.getActivePrimaryMouseButtonTool();\n        const runtimeSettings = Settings.getRuntimeSettings();\n        if (runtimeSettings.get('useCursors')) {\n            this.setViewportsCursorByToolName(toolName);\n        }\n        const eventDetail = {\n            toolGroupId: this.id,\n            viewportId,\n            renderingEngineId: renderingEngineUIDToUse,\n        };\n        triggerEvent(eventTarget, Events.TOOLGROUP_VIEWPORT_ADDED, eventDetail);\n    }\n    removeViewports(renderingEngineId, viewportId) {\n        const indices = [];\n        this.viewportsInfo.forEach((vpInfo, index) => {\n            let match = false;\n            if (vpInfo.renderingEngineId === renderingEngineId) {\n                match = true;\n                if (viewportId && vpInfo.viewportId !== viewportId) {\n                    match = false;\n                }\n            }\n            if (match) {\n                indices.push(index);\n            }\n        });\n        if (indices.length) {\n            for (let i = indices.length - 1; i >= 0; i--) {\n                this.viewportsInfo.splice(indices[i], 1);\n            }\n        }\n        const eventDetail = {\n            toolGroupId: this.id,\n            viewportId,\n            renderingEngineId,\n        };\n        triggerEvent(eventTarget, Events.TOOLGROUP_VIEWPORT_REMOVED, eventDetail);\n    }\n    setActiveStrategy(toolName, strategyName) {\n        const toolInstance = this._toolInstances[toolName];\n        if (toolInstance === undefined) {\n            console.warn(`Tool ${toolName} not added to toolGroup, can't set tool configuration.`);\n            return;\n        }\n        toolInstance.setActiveStrategy(strategyName);\n    }\n    setToolMode(toolName, mode, options = {}) {\n        if (!toolName) {\n            console.warn('setToolMode: toolName must be defined');\n            return;\n        }\n        if (mode === ToolModes.Active) {\n            this.setToolActive(toolName, options || this.restoreToolOptions[toolName]);\n            return;\n        }\n        if (mode === ToolModes.Passive) {\n            this.setToolPassive(toolName);\n            return;\n        }\n        if (mode === ToolModes.Enabled) {\n            this.setToolEnabled(toolName);\n            return;\n        }\n        if (mode === ToolModes.Disabled) {\n            this.setToolDisabled(toolName);\n            return;\n        }\n        console.warn('setToolMode: mode must be defined');\n    }\n    setToolActive(toolName, toolBindingsOptions = {}) {\n        const toolInstance = this._toolInstances[toolName];\n        if (toolInstance === undefined) {\n            console.warn(`Tool ${toolName} not added to toolGroup, can't set tool mode.`);\n            return;\n        }\n        if (!toolInstance) {\n            console.warn(`'${toolName}' instance ${toolInstance} is not registered with this toolGroup, can't set tool mode.`);\n            return;\n        }\n        const prevBindings = this.toolOptions[toolName]\n            ? this.toolOptions[toolName].bindings\n            : [];\n        const newBindings = toolBindingsOptions.bindings\n            ? toolBindingsOptions.bindings\n            : [];\n        const bindingsToUse = [...prevBindings, ...newBindings].reduce((unique, binding) => {\n            const TouchBinding = binding.numTouchPoints !== undefined;\n            const MouseBinding = binding.mouseButton !== undefined;\n            if (!unique.some((obj) => hasSameBinding(obj, binding)) &&\n                (TouchBinding || MouseBinding)) {\n                unique.push(binding);\n            }\n            return unique;\n        }, []);\n        const toolOptions = {\n            bindings: bindingsToUse,\n            mode: Active,\n        };\n        this.toolOptions[toolName] = toolOptions;\n        this._toolInstances[toolName].mode = Active;\n        const runtimeSettings = Settings.getRuntimeSettings();\n        const useCursor = runtimeSettings.get('useCursors');\n        if (this._hasMousePrimaryButtonBinding(toolBindingsOptions) && useCursor) {\n            this.setViewportsCursorByToolName(toolName);\n        }\n        else {\n            const activeToolIdentifier = this.getActivePrimaryMouseButtonTool();\n            if (!activeToolIdentifier && useCursor) {\n                const cursor = MouseCursor.getDefinedCursor('default');\n                this._setCursorForViewports(cursor);\n            }\n        }\n        if (this._hasMousePrimaryButtonBinding(toolBindingsOptions)) {\n            if (this.prevActivePrimaryToolName === null) {\n                this.prevActivePrimaryToolName = toolName;\n            }\n            else {\n                this.prevActivePrimaryToolName = this.currentActivePrimaryToolName;\n            }\n            this.currentActivePrimaryToolName = toolName;\n        }\n        if (typeof toolInstance.onSetToolActive === 'function') {\n            toolInstance.onSetToolActive();\n        }\n        this._renderViewports();\n        const eventDetail = {\n            toolGroupId: this.id,\n            toolName,\n            toolBindingsOptions,\n        };\n        triggerEvent(eventTarget, Events.TOOL_ACTIVATED, eventDetail);\n        this._triggerToolModeChangedEvent(toolName, Active, toolBindingsOptions);\n    }\n    setToolPassive(toolName, options) {\n        const toolInstance = this._toolInstances[toolName];\n        if (toolInstance === undefined) {\n            console.warn(`Tool ${toolName} not added to toolGroup, can't set tool mode.`);\n            return;\n        }\n        const prevToolOptions = this.getToolOptions(toolName);\n        const toolOptions = Object.assign({\n            bindings: prevToolOptions ? prevToolOptions.bindings : [],\n        }, prevToolOptions, {\n            mode: Passive,\n        });\n        const matchBindings = Array.isArray(options?.removeAllBindings)\n            ? options.removeAllBindings\n            : this.getDefaultPrimaryBindings();\n        toolOptions.bindings = toolOptions.bindings.filter((binding) => options?.removeAllBindings !== true &&\n            !matchBindings.some((matchBinding) => hasSameBinding(binding, matchBinding)));\n        let mode = Passive;\n        if (toolOptions.bindings.length !== 0) {\n            mode = Active;\n            toolOptions.mode = mode;\n        }\n        this.toolOptions[toolName] = toolOptions;\n        toolInstance.mode = mode;\n        if (typeof toolInstance.onSetToolPassive === 'function') {\n            toolInstance.onSetToolPassive();\n        }\n        this._renderViewports();\n        this._triggerToolModeChangedEvent(toolName, Passive);\n    }\n    setToolEnabled(toolName) {\n        const toolInstance = this._toolInstances[toolName];\n        if (toolInstance === undefined) {\n            console.warn(`Tool ${toolName} not added to toolGroup, can't set tool mode.`);\n            return;\n        }\n        const toolOptions = {\n            bindings: [],\n            mode: Enabled,\n        };\n        this.toolOptions[toolName] = toolOptions;\n        toolInstance.mode = Enabled;\n        if (typeof toolInstance.onSetToolEnabled === 'function') {\n            toolInstance.onSetToolEnabled();\n        }\n        this._renderViewports();\n        this._triggerToolModeChangedEvent(toolName, Enabled);\n    }\n    setToolDisabled(toolName) {\n        const toolInstance = this._toolInstances[toolName];\n        if (toolInstance === undefined) {\n            console.warn(`Tool ${toolName} not added to toolGroup, can't set tool mode.`);\n            return;\n        }\n        const toolOptions = {\n            bindings: [],\n            mode: Disabled,\n        };\n        this.restoreToolOptions[toolName] = this.toolOptions[toolName];\n        this.toolOptions[toolName] = toolOptions;\n        toolInstance.mode = Disabled;\n        if (typeof toolInstance.onSetToolDisabled === 'function') {\n            toolInstance.onSetToolDisabled();\n        }\n        this._renderViewports();\n        this._triggerToolModeChangedEvent(toolName, Disabled);\n    }\n    getToolOptions(toolName) {\n        const toolOptionsForTool = this.toolOptions[toolName];\n        if (toolOptionsForTool === undefined) {\n            return;\n        }\n        return toolOptionsForTool;\n    }\n    getActivePrimaryMouseButtonTool() {\n        return Object.keys(this.toolOptions).find((toolName) => {\n            const toolOptions = this.toolOptions[toolName];\n            return (toolOptions.mode === Active &&\n                this._hasMousePrimaryButtonBinding(toolOptions));\n        });\n    }\n    setViewportsCursorByToolName(toolName, strategyName) {\n        const cursor = this._getCursor(toolName, strategyName);\n        this._setCursorForViewports(cursor);\n    }\n    _getCursor(toolName, strategyName) {\n        let cursorName;\n        let cursor;\n        if (strategyName) {\n            cursorName = `${toolName}.${strategyName}`;\n            cursor = SVGMouseCursor.getDefinedCursor(cursorName, true);\n            if (cursor) {\n                return cursor;\n            }\n        }\n        cursorName = `${toolName}`;\n        cursor = SVGMouseCursor.getDefinedCursor(cursorName, true);\n        if (cursor) {\n            return cursor;\n        }\n        cursorName = toolName;\n        cursor = SVGMouseCursor.getDefinedCursor(cursorName, true);\n        if (cursor) {\n            return cursor;\n        }\n        return MouseCursor.getDefinedCursor('default');\n    }\n    _setCursorForViewports(cursor) {\n        this.viewportsInfo.forEach(({ renderingEngineId, viewportId }) => {\n            const enabledElement = getEnabledElementByIds(viewportId, renderingEngineId);\n            if (!enabledElement) {\n                return;\n            }\n            const { viewport } = enabledElement;\n            initElementCursor(viewport.element, cursor);\n        });\n    }\n    setToolConfiguration(toolName, configuration, overwrite) {\n        const toolInstance = this._toolInstances[toolName];\n        if (toolInstance === undefined) {\n            console.warn(`Tool ${toolName} not present, can't set tool configuration.`);\n            return false;\n        }\n        let _configuration;\n        if (overwrite) {\n            _configuration = configuration;\n        }\n        else {\n            _configuration = Object.assign(toolInstance.configuration, configuration);\n        }\n        toolInstance.configuration = _configuration;\n        if (typeof toolInstance.onSetToolConfiguration === 'function') {\n            toolInstance.onSetToolConfiguration();\n        }\n        this._renderViewports();\n        return true;\n    }\n    getDefaultMousePrimary() {\n        return MouseBindings.Primary;\n    }\n    getDefaultPrimaryBindings() {\n        return PRIMARY_BINDINGS;\n    }\n    getToolConfiguration(toolName, configurationPath) {\n        if (this._toolInstances[toolName] === undefined) {\n            console.warn(`Tool ${toolName} not present, can't set tool configuration.`);\n            return;\n        }\n        const _configuration = get(this._toolInstances[toolName].configuration, configurationPath) ||\n            this._toolInstances[toolName].configuration;\n        return utilities.deepClone(_configuration);\n    }\n    getPrevActivePrimaryToolName() {\n        return this.prevActivePrimaryToolName;\n    }\n    setActivePrimaryTool(toolName) {\n        const activeToolName = this.getCurrentActivePrimaryToolName();\n        this.setToolDisabled(activeToolName);\n        this.setToolActive(toolName, {\n            bindings: [{ mouseButton: MouseBindings.Primary }],\n        });\n    }\n    getCurrentActivePrimaryToolName() {\n        return this.currentActivePrimaryToolName;\n    }\n    clone(newToolGroupId, fnToolFilter = null) {\n        let toolGroup = getToolGroup(newToolGroupId);\n        if (toolGroup) {\n            console.debug(`ToolGroup ${newToolGroupId} already exists`);\n            return toolGroup;\n        }\n        toolGroup = new ToolGroup(newToolGroupId);\n        state.toolGroups.push(toolGroup);\n        fnToolFilter = fnToolFilter ?? (() => true);\n        Object.keys(this._toolInstances)\n            .filter(fnToolFilter)\n            .forEach((toolName) => {\n            const sourceToolInstance = this._toolInstances[toolName];\n            const sourceToolOptions = this.toolOptions[toolName];\n            const sourceToolMode = sourceToolInstance.mode;\n            toolGroup.addTool(toolName);\n            toolGroup.setToolMode(toolName, sourceToolMode, {\n                bindings: sourceToolOptions.bindings ?? [],\n            });\n        });\n        return toolGroup;\n    }\n    _hasMousePrimaryButtonBinding(toolOptions) {\n        const primaryBindings = this.getDefaultPrimaryBindings();\n        return toolOptions?.bindings?.some((binding) => primaryBindings.some((primary) => hasSameBinding(binding, primary)));\n    }\n    _renderViewports() {\n        this.viewportsInfo.forEach(({ renderingEngineId, viewportId }) => {\n            getRenderingEngine(renderingEngineId).renderViewport(viewportId);\n        });\n    }\n    _triggerToolModeChangedEvent(toolName, mode, toolBindingsOptions) {\n        const eventDetail = {\n            toolGroupId: this.id,\n            toolName,\n            mode,\n            toolBindingsOptions,\n        };\n        triggerEvent(eventTarget, Events.TOOL_MODE_CHANGED, eventDetail);\n    }\n    _findRenderingEngine(viewportId, renderingEngineId) {\n        const renderingEngines = getRenderingEngines();\n        if (renderingEngines?.length === 0) {\n            throw new Error('No rendering engines found.');\n        }\n        if (renderingEngineId) {\n            return renderingEngineId;\n        }\n        const matchingEngines = renderingEngines.filter((engine) => engine.getViewport(viewportId));\n        if (matchingEngines.length === 0) {\n            if (renderingEngines.length === 1) {\n                return renderingEngines[0].id;\n            }\n            throw new Error('No rendering engines found that contain the viewport with the same viewportId, you must specify a renderingEngineId.');\n        }\n        if (matchingEngines.length > 1) {\n            throw new Error('Multiple rendering engines found that contain the viewport with the same viewportId, you must specify a renderingEngineId.');\n        }\n        return matchingEngines[0].id;\n    }\n}\nfunction hasSameBinding(binding1, binding2) {\n    if (binding1.mouseButton !== binding2.mouseButton) {\n        return false;\n    }\n    if (binding1.numTouchPoints !== binding2.numTouchPoints) {\n        return false;\n    }\n    return binding1.modifierKey === binding2.modifierKey;\n}\n","import { state } from '../state';\nimport ToolGroup from './ToolGroup';\nfunction createToolGroup(toolGroupId) {\n    const toolGroupWithIdExists = state.toolGroups.some((tg) => tg.id === toolGroupId);\n    if (toolGroupWithIdExists) {\n        console.warn(`'${toolGroupId}' already exists.`);\n        return;\n    }\n    const toolGroup = new ToolGroup(toolGroupId);\n    state.toolGroups.push(toolGroup);\n    return toolGroup;\n}\nexport default createToolGroup;\n","import { state } from '../state';\nfunction destroyToolGroup(toolGroupId) {\n    const toolGroupIndex = state.toolGroups.findIndex((tg) => tg.id === toolGroupId);\n    if (toolGroupIndex > -1) {\n        state.toolGroups.splice(toolGroupIndex, 1);\n    }\n}\nexport default destroyToolGroup;\n","import { state } from '../state';\nimport destroyToolGroup from './destroyToolGroup';\nfunction destroy() {\n    const toolGroups = [...state.toolGroups];\n    for (const toolGroup of toolGroups) {\n        destroyToolGroup(toolGroup.id);\n    }\n    state.toolGroups = [];\n}\nexport default destroy;\n","import { state } from '../state';\nfunction getAllToolGroups() {\n    return state.toolGroups;\n}\nexport default getAllToolGroups;\n","import { state } from '../state';\nimport { ToolModes } from '../../enums';\nconst MODES = [ToolModes.Active, ToolModes.Passive, ToolModes.Enabled];\nfunction getToolGroupsWithToolName(toolName) {\n    return state.toolGroups.filter(({ toolOptions }) => {\n        const toolGroupToolNames = Object.keys(toolOptions);\n        for (let i = 0; i < toolGroupToolNames.length; i++) {\n            if (toolName !== toolGroupToolNames[i]) {\n                continue;\n            }\n            if (!toolOptions[toolName]) {\n                continue;\n            }\n            if (MODES.includes(toolOptions[toolName].mode)) {\n                return true;\n            }\n        }\n        return false;\n    });\n}\nexport default getToolGroupsWithToolName;\n","import { state } from './state';\nexport function addTool(ToolClass) {\n    const toolName = ToolClass.toolName;\n    const toolAlreadyAdded = state.tools[toolName] !== undefined;\n    if (!toolName) {\n        throw new Error(`No Tool Found for the ToolClass ${ToolClass.name}`);\n    }\n    state.tools[toolName] = {\n        toolClass: ToolClass,\n    };\n}\nexport function hasTool(ToolClass) {\n    const toolName = ToolClass.toolName;\n    return !!(toolName && state.tools[toolName]);\n}\nexport function hasToolByName(toolName) {\n    return !!(toolName && state.tools[toolName]);\n}\nexport function removeTool(ToolClass) {\n    const toolName = ToolClass.toolName;\n    if (!toolName) {\n        throw new Error(`No tool found for: ${ToolClass.name}`);\n    }\n    if (!state.tools[toolName] !== undefined) {\n        delete state.tools[toolName];\n    }\n    else {\n        throw new Error(`${toolName} cannot be removed because it has not been added`);\n    }\n}\nexport default addTool;\n","import svgNodeCache, { resetSvgNodeCache } from './svgNodeCache';\nconst defaultState = {\n    isInteractingWithTool: false,\n    isMultiPartToolActive: false,\n    tools: {},\n    toolGroups: [],\n    synchronizers: [],\n    svgNodeCache: svgNodeCache,\n    enabledElements: [],\n    handleRadius: 6,\n};\nlet state = {\n    isInteractingWithTool: false,\n    isMultiPartToolActive: false,\n    tools: {},\n    toolGroups: [],\n    synchronizers: [],\n    svgNodeCache: svgNodeCache,\n    enabledElements: [],\n    handleRadius: 6,\n};\nfunction resetCornerstoneToolsState() {\n    resetSvgNodeCache();\n    state = {\n        ...structuredClone({\n            ...defaultState,\n            svgNodeCache: {},\n        }),\n        svgNodeCache: {\n            ...defaultState.svgNodeCache,\n        },\n    };\n}\nexport { resetCornerstoneToolsState, state, state as default };\n","let svgNodeCache = {};\nexport function resetSvgNodeCache() {\n    svgNodeCache = {};\n}\nexport default svgNodeCache;\n","import { vec2, vec3 } from 'gl-matrix';\nimport { getEnabledElement, utilities as csUtils } from '@cornerstonejs/core';\nimport { getCalibratedLengthUnitsAndScale } from '../../utilities/getCalibratedUnits';\nimport { AnnotationTool } from '../base';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement/annotation/annotationState';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { drawLine as drawLineSvg, drawHandles as drawHandlesSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { Events } from '../../enums';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport * as lineSegment from '../../utilities/math/line';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nconst { transformWorldToIndex } = csUtils;\nclass BidirectionalTool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { points } = data.handles;\n            let canvasPoint1 = viewport.worldToCanvas(points[0]);\n            let canvasPoint2 = viewport.worldToCanvas(points[1]);\n            let line = {\n                start: {\n                    x: canvasPoint1[0],\n                    y: canvasPoint1[1],\n                },\n                end: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n            };\n            let distanceToPoint = lineSegment.distanceToPoint([line.start.x, line.start.y], [line.end.x, line.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n            canvasPoint1 = viewport.worldToCanvas(points[2]);\n            canvasPoint2 = viewport.worldToCanvas(points[3]);\n            line = {\n                start: {\n                    x: canvasPoint1[0],\n                    y: canvasPoint1[1],\n                },\n                end: {\n                    x: canvasPoint2[0],\n                    y: canvasPoint2[1],\n                },\n            };\n            distanceToPoint = lineSegment.distanceToPoint([line.start.x, line.start.y], [line.end.x, line.end.y], [canvasCoords[0], canvasCoords[1]]);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            this._activateModify(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            hideElementCursor(element);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation, handle) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const data = annotation.data;\n            annotation.highlighted = true;\n            let movingTextBox = false;\n            let handleIndex;\n            if (handle.worldPosition) {\n                movingTextBox = true;\n            }\n            else {\n                handleIndex = data.handles.points.findIndex((p) => p === handle);\n            }\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            hideElementCursor(element);\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex,\n                movingTextBox,\n            };\n            this._activateModify(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const { renderingEngine } = getEnabledElement(element);\n            if (this.editData.handleIndex !== undefined) {\n                const { points } = data.handles;\n                const firstLineSegmentLength = vec3.distance(points[0], points[1]);\n                const secondLineSegmentLength = vec3.distance(points[2], points[3]);\n                if (secondLineSegmentLength > firstLineSegmentLength) {\n                    const longAxis = [[...points[2]], [...points[3]]];\n                    const shortAxisPoint0 = [...points[0]];\n                    const shortAxisPoint1 = [...points[1]];\n                    const longAxisVector = vec2.create();\n                    vec2.set(longAxisVector, longAxis[1][0] - longAxis[0][0], longAxis[1][1] - longAxis[1][0]);\n                    const counterClockWisePerpendicularToLongAxis = vec2.create();\n                    vec2.set(counterClockWisePerpendicularToLongAxis, -longAxisVector[1], longAxisVector[0]);\n                    const currentShortAxisVector = vec2.create();\n                    vec2.set(currentShortAxisVector, shortAxisPoint1[0] - shortAxisPoint0[0], shortAxisPoint1[1] - shortAxisPoint0[0]);\n                    let shortAxis;\n                    if (vec2.dot(currentShortAxisVector, counterClockWisePerpendicularToLongAxis) > 0) {\n                        shortAxis = [shortAxisPoint0, shortAxisPoint1];\n                    }\n                    else {\n                        shortAxis = [shortAxisPoint1, shortAxisPoint0];\n                    }\n                    data.handles.points = [\n                        longAxis[0],\n                        longAxis[1],\n                        shortAxis[0],\n                        shortAxis[1],\n                    ];\n                }\n            }\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n            this.editData = null;\n            this.isDrawing = false;\n        };\n        this._dragDrawCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine, viewport } = enabledElement;\n            const { worldToCanvas } = viewport;\n            const { annotation, viewportIdsToRender, handleIndex } = this.editData;\n            const { data } = annotation;\n            const worldPos = currentPoints.world;\n            data.handles.points[handleIndex] = [...worldPos];\n            const canvasCoordPoints = data.handles.points.map(worldToCanvas);\n            const canvasCoords = {\n                longLineSegment: {\n                    start: {\n                        x: canvasCoordPoints[0][0],\n                        y: canvasCoordPoints[0][1],\n                    },\n                    end: {\n                        x: canvasCoordPoints[1][0],\n                        y: canvasCoordPoints[1][1],\n                    },\n                },\n                shortLineSegment: {\n                    start: {\n                        x: canvasCoordPoints[2][0],\n                        y: canvasCoordPoints[2][1],\n                    },\n                    end: {\n                        x: canvasCoordPoints[3][0],\n                        y: canvasCoordPoints[3][1],\n                    },\n                },\n            };\n            const dist = vec2.distance(canvasCoordPoints[0], canvasCoordPoints[1]);\n            const shortAxisDistFromCenter = dist / 3;\n            const dx = canvasCoords.longLineSegment.start.x - canvasCoords.longLineSegment.end.x;\n            const dy = canvasCoords.longLineSegment.start.y - canvasCoords.longLineSegment.end.y;\n            const length = Math.sqrt(dx * dx + dy * dy);\n            const vectorX = dx / length;\n            const vectorY = dy / length;\n            const xMid = (canvasCoords.longLineSegment.start.x +\n                canvasCoords.longLineSegment.end.x) /\n                2;\n            const yMid = (canvasCoords.longLineSegment.start.y +\n                canvasCoords.longLineSegment.end.y) /\n                2;\n            const startX = xMid + shortAxisDistFromCenter * vectorY;\n            const startY = yMid - shortAxisDistFromCenter * vectorX;\n            const endX = xMid - shortAxisDistFromCenter * vectorY;\n            const endY = yMid + shortAxisDistFromCenter * vectorX;\n            data.handles.points[2] = viewport.canvasToWorld([startX, startY]);\n            data.handles.points[3] = viewport.canvasToWorld([endX, endY]);\n            annotation.invalidated = true;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            this.editData.hasMoved = true;\n        };\n        this._dragModifyCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const points = data.handles.points;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                this._dragModifyHandle(evt);\n                annotation.invalidated = true;\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this._dragModifyHandle = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { annotation, handleIndex: movingHandleIndex } = this.editData;\n            const { data } = annotation;\n            const worldPos = currentPoints.world;\n            const canvasCoordHandlesCurrent = [\n                viewport.worldToCanvas(data.handles.points[0]),\n                viewport.worldToCanvas(data.handles.points[1]),\n                viewport.worldToCanvas(data.handles.points[2]),\n                viewport.worldToCanvas(data.handles.points[3]),\n            ];\n            const firstLineSegment = {\n                start: {\n                    x: canvasCoordHandlesCurrent[0][0],\n                    y: canvasCoordHandlesCurrent[0][1],\n                },\n                end: {\n                    x: canvasCoordHandlesCurrent[1][0],\n                    y: canvasCoordHandlesCurrent[1][1],\n                },\n            };\n            const secondLineSegment = {\n                start: {\n                    x: canvasCoordHandlesCurrent[2][0],\n                    y: canvasCoordHandlesCurrent[2][1],\n                },\n                end: {\n                    x: canvasCoordHandlesCurrent[3][0],\n                    y: canvasCoordHandlesCurrent[3][1],\n                },\n            };\n            const proposedPoint = [...worldPos];\n            const proposedCanvasCoord = viewport.worldToCanvas(proposedPoint);\n            if (movingHandleIndex === 0 || movingHandleIndex === 1) {\n                const fixedHandleIndex = movingHandleIndex === 0 ? 1 : 0;\n                const fixedHandleCanvasCoord = canvasCoordHandlesCurrent[fixedHandleIndex];\n                const fixedHandleToProposedCoordVec = vec2.set(vec2.create(), proposedCanvasCoord[0] - fixedHandleCanvasCoord[0], proposedCanvasCoord[1] - fixedHandleCanvasCoord[1]);\n                const fixedHandleToOldCoordVec = vec2.set(vec2.create(), canvasCoordHandlesCurrent[movingHandleIndex][0] -\n                    fixedHandleCanvasCoord[0], canvasCoordHandlesCurrent[movingHandleIndex][1] -\n                    fixedHandleCanvasCoord[1]);\n                vec2.normalize(fixedHandleToProposedCoordVec, fixedHandleToProposedCoordVec);\n                vec2.normalize(fixedHandleToOldCoordVec, fixedHandleToOldCoordVec);\n                const proposedFirstLineSegment = {\n                    start: {\n                        x: fixedHandleCanvasCoord[0],\n                        y: fixedHandleCanvasCoord[1],\n                    },\n                    end: {\n                        x: proposedCanvasCoord[0],\n                        y: proposedCanvasCoord[1],\n                    },\n                };\n                if (this._movingLongAxisWouldPutItThroughShortAxis(proposedFirstLineSegment, secondLineSegment)) {\n                    return;\n                }\n                const centerOfRotation = fixedHandleCanvasCoord;\n                const angle = this._getSignedAngle(fixedHandleToOldCoordVec, fixedHandleToProposedCoordVec);\n                let firstPointX = canvasCoordHandlesCurrent[2][0];\n                let firstPointY = canvasCoordHandlesCurrent[2][1];\n                let secondPointX = canvasCoordHandlesCurrent[3][0];\n                let secondPointY = canvasCoordHandlesCurrent[3][1];\n                firstPointX -= centerOfRotation[0];\n                firstPointY -= centerOfRotation[1];\n                secondPointX -= centerOfRotation[0];\n                secondPointY -= centerOfRotation[1];\n                const rotatedFirstPoint = firstPointX * Math.cos(angle) - firstPointY * Math.sin(angle);\n                const rotatedFirstPointY = firstPointX * Math.sin(angle) + firstPointY * Math.cos(angle);\n                const rotatedSecondPoint = secondPointX * Math.cos(angle) - secondPointY * Math.sin(angle);\n                const rotatedSecondPointY = secondPointX * Math.sin(angle) + secondPointY * Math.cos(angle);\n                firstPointX = rotatedFirstPoint + centerOfRotation[0];\n                firstPointY = rotatedFirstPointY + centerOfRotation[1];\n                secondPointX = rotatedSecondPoint + centerOfRotation[0];\n                secondPointY = rotatedSecondPointY + centerOfRotation[1];\n                const newFirstPoint = viewport.canvasToWorld([firstPointX, firstPointY]);\n                const newSecondPoint = viewport.canvasToWorld([\n                    secondPointX,\n                    secondPointY,\n                ]);\n                data.handles.points[movingHandleIndex] = proposedPoint;\n                data.handles.points[2] = newFirstPoint;\n                data.handles.points[3] = newSecondPoint;\n            }\n            else {\n                const translateHandleIndex = movingHandleIndex === 2 ? 3 : 2;\n                const canvasCoordsCurrent = {\n                    longLineSegment: {\n                        start: firstLineSegment.start,\n                        end: firstLineSegment.end,\n                    },\n                    shortLineSegment: {\n                        start: secondLineSegment.start,\n                        end: secondLineSegment.end,\n                    },\n                };\n                const longLineSegmentVec = vec2.subtract(vec2.create(), [\n                    canvasCoordsCurrent.longLineSegment.end.x,\n                    canvasCoordsCurrent.longLineSegment.end.y,\n                ], [\n                    canvasCoordsCurrent.longLineSegment.start.x,\n                    canvasCoordsCurrent.longLineSegment.start.y,\n                ]);\n                const longLineSegmentVecNormalized = vec2.normalize(vec2.create(), longLineSegmentVec);\n                const proposedToCurrentVec = vec2.subtract(vec2.create(), [proposedCanvasCoord[0], proposedCanvasCoord[1]], [\n                    canvasCoordHandlesCurrent[movingHandleIndex][0],\n                    canvasCoordHandlesCurrent[movingHandleIndex][1],\n                ]);\n                const movementLength = vec2.length(proposedToCurrentVec);\n                const angle = this._getSignedAngle(longLineSegmentVecNormalized, proposedToCurrentVec);\n                const movementAlongLineSegmentLength = Math.cos(angle) * movementLength;\n                const newTranslatedPoint = vec2.scaleAndAdd(vec2.create(), [\n                    canvasCoordHandlesCurrent[translateHandleIndex][0],\n                    canvasCoordHandlesCurrent[translateHandleIndex][1],\n                ], longLineSegmentVecNormalized, movementAlongLineSegmentLength);\n                if (this._movingLongAxisWouldPutItThroughShortAxis({\n                    start: {\n                        x: proposedCanvasCoord[0],\n                        y: proposedCanvasCoord[1],\n                    },\n                    end: {\n                        x: newTranslatedPoint[0],\n                        y: newTranslatedPoint[1],\n                    },\n                }, {\n                    start: {\n                        x: canvasCoordsCurrent.longLineSegment.start.x,\n                        y: canvasCoordsCurrent.longLineSegment.start.y,\n                    },\n                    end: {\n                        x: canvasCoordsCurrent.longLineSegment.end.x,\n                        y: canvasCoordsCurrent.longLineSegment.end.y,\n                    },\n                })) {\n                    return;\n                }\n                const intersectionPoint = lineSegment.intersectLine([proposedCanvasCoord[0], proposedCanvasCoord[1]], [newTranslatedPoint[0], newTranslatedPoint[1]], [firstLineSegment.start.x, firstLineSegment.start.y], [firstLineSegment.end.x, firstLineSegment.end.y]);\n                if (!intersectionPoint) {\n                    return;\n                }\n                data.handles.points[translateHandleIndex] = viewport.canvasToWorld(newTranslatedPoint);\n                data.handles.points[movingHandleIndex] = proposedPoint;\n            }\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragDrawCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragDrawCallback);\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragModifyCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = true;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points, activeHandleIndex } = data.handles;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash, shadow } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].unit == null) {\n                    data.cachedStats[targetId] = {\n                        length: null,\n                        width: null,\n                        unit: null,\n                    };\n                    this._calculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, renderingEngine, enabledElement);\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                const dataId1 = `${annotationUID}-line-1`;\n                const dataId2 = `${annotationUID}-line-2`;\n                const lineUID = '0';\n                drawLineSvg(svgDrawingHelper, annotationUID, lineUID, canvasCoordinates[0], canvasCoordinates[1], {\n                    color,\n                    lineDash,\n                    lineWidth,\n                    shadow,\n                }, dataId1);\n                const secondLineUID = '1';\n                drawLineSvg(svgDrawingHelper, annotationUID, secondLineUID, canvasCoordinates[2], canvasCoordinates[3], {\n                    color,\n                    lineDash,\n                    lineWidth,\n                    shadow,\n                }, dataId2);\n                renderStatus = true;\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!textLines || textLines.length === 0) {\n                    continue;\n                }\n                let canvasTextBoxCoords;\n                if (!data.handles.textBox.hasMoved) {\n                    canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n        this._movingLongAxisWouldPutItThroughShortAxis = (firstLineSegment, secondLineSegment) => {\n            const vectorInSecondLineDirection = vec2.create();\n            vec2.set(vectorInSecondLineDirection, secondLineSegment.end.x - secondLineSegment.start.x, secondLineSegment.end.y - secondLineSegment.start.y);\n            vec2.normalize(vectorInSecondLineDirection, vectorInSecondLineDirection);\n            const extendedSecondLineSegment = {\n                start: {\n                    x: secondLineSegment.start.x - vectorInSecondLineDirection[0] * 10,\n                    y: secondLineSegment.start.y - vectorInSecondLineDirection[1] * 10,\n                },\n                end: {\n                    x: secondLineSegment.end.x + vectorInSecondLineDirection[0] * 10,\n                    y: secondLineSegment.end.y + vectorInSecondLineDirection[1] * 10,\n                },\n            };\n            const proposedIntersectionPoint = lineSegment.intersectLine([extendedSecondLineSegment.start.x, extendedSecondLineSegment.start.y], [extendedSecondLineSegment.end.x, extendedSecondLineSegment.end.y], [firstLineSegment.start.x, firstLineSegment.start.y], [firstLineSegment.end.x, firstLineSegment.end.y]);\n            const wouldPutThroughShortAxis = !proposedIntersectionPoint;\n            return wouldPutThroughShortAxis;\n        };\n        this._calculateCachedStats = (annotation, renderingEngine, enabledElement) => {\n            const { data } = annotation;\n            const { element } = enabledElement.viewport;\n            const worldPos1 = data.handles.points[0];\n            const worldPos2 = data.handles.points[1];\n            const worldPos3 = data.handles.points[2];\n            const worldPos4 = data.handles.points[3];\n            const { cachedStats } = data;\n            const targetIds = Object.keys(cachedStats);\n            for (let i = 0; i < targetIds.length; i++) {\n                const targetId = targetIds[i];\n                const image = this.getTargetImageData(targetId);\n                if (!image) {\n                    continue;\n                }\n                const { imageData, dimensions } = image;\n                const index1 = transformWorldToIndex(imageData, worldPos1);\n                const index2 = transformWorldToIndex(imageData, worldPos2);\n                const index3 = transformWorldToIndex(imageData, worldPos3);\n                const index4 = transformWorldToIndex(imageData, worldPos4);\n                const handles1 = [index1, index2];\n                const handles2 = [index3, index4];\n                const { scale: scale1, unit: units1 } = getCalibratedLengthUnitsAndScale(image, handles1);\n                const { scale: scale2, unit: units2 } = getCalibratedLengthUnitsAndScale(image, handles2);\n                const dist1 = this._calculateLength(worldPos1, worldPos2) / scale1;\n                const dist2 = this._calculateLength(worldPos3, worldPos4) / scale2;\n                const length = dist1 > dist2 ? dist1 : dist2;\n                const width = dist1 > dist2 ? dist2 : dist1;\n                const unit = dist1 > dist2 ? units1 : units2;\n                const widthUnit = dist1 > dist2 ? units2 : units1;\n                this._isInsideVolume(index1, index2, index3, index4, dimensions)\n                    ? (this.isHandleOutsideImage = false)\n                    : (this.isHandleOutsideImage = true);\n                cachedStats[targetId] = {\n                    length,\n                    width,\n                    unit,\n                    widthUnit,\n                };\n            }\n            annotation.invalidated = false;\n            triggerAnnotationModified(annotation, element);\n            return cachedStats;\n        };\n        this._isInsideVolume = (index1, index2, index3, index4, dimensions) => {\n            return (csUtils.indexWithinDimensions(index1, dimensions) &&\n                csUtils.indexWithinDimensions(index2, dimensions) &&\n                csUtils.indexWithinDimensions(index3, dimensions) &&\n                csUtils.indexWithinDimensions(index4, dimensions));\n        };\n        this._getSignedAngle = (vector1, vector2) => {\n            return Math.atan2(vector1[0] * vector2[1] - vector1[1] * vector2[0], vector1[0] * vector2[0] + vector1[1] * vector2[1]);\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    addNewAnnotation(evt) {\n        const eventDetail = evt.detail;\n        const { currentPoints, element } = eventDetail;\n        const worldPos = currentPoints.world;\n        const enabledElement = getEnabledElement(element);\n        const { viewport, renderingEngine } = enabledElement;\n        this.isDrawing = true;\n        const camera = viewport.getCamera();\n        const { viewPlaneNormal, viewUp } = camera;\n        const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n        const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n        const annotation = {\n            highlighted: true,\n            invalidated: true,\n            metadata: {\n                toolName: this.getToolName(),\n                viewPlaneNormal: [...viewPlaneNormal],\n                viewUp: [...viewUp],\n                FrameOfReferenceUID,\n                referencedImageId,\n                ...viewport.getViewReference({ points: [worldPos] }),\n            },\n            data: {\n                handles: {\n                    points: [\n                        [...worldPos],\n                        [...worldPos],\n                        [...worldPos],\n                        [...worldPos],\n                    ],\n                    textBox: {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    },\n                    activeHandleIndex: null,\n                },\n                label: '',\n                cachedStats: {},\n            },\n        };\n        addAnnotation(annotation, element);\n        const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n        this.editData = {\n            annotation,\n            viewportIdsToRender,\n            handleIndex: 1,\n            movingTextBox: false,\n            newAnnotation: true,\n            hasMoved: false,\n        };\n        this._activateDraw(element);\n        hideElementCursor(element);\n        evt.preventDefault();\n        triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        return annotation;\n    }\n    _calculateLength(pos1, pos2) {\n        const dx = pos1[0] - pos2[0];\n        const dy = pos1[1] - pos2[1];\n        const dz = pos1[2] - pos2[2];\n        return Math.sqrt(dx * dx + dy * dy + dz * dz);\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const { cachedStats, label } = data;\n    const { length, width, unit } = cachedStats[targetId];\n    const textLines = [];\n    if (label) {\n        textLines.push(label);\n    }\n    if (length === undefined) {\n        return textLines;\n    }\n    textLines.push(`L: ${csUtils.roundNumber(length)} ${unit || unit}`, `W: ${csUtils.roundNumber(width)} ${unit}`);\n    return textLines;\n}\nBidirectionalTool.toolName = 'Bidirectional';\nexport default BidirectionalTool;\n","import { utilities } from '@cornerstonejs/core';\nimport { triggerSegmentationDataModified } from '../../stateManagement/segmentation/triggerSegmentationEvents';\nimport PlanarFreehandROITool from './PlanarFreehandROITool';\nclass PlanarFreehandContourSegmentationTool extends PlanarFreehandROITool {\n    constructor(toolProps) {\n        const initialProps = utilities.deepMerge({\n            configuration: {\n                calculateStats: false,\n                allowOpenContours: false,\n            },\n        }, toolProps);\n        super(initialProps);\n    }\n    isContourSegmentationTool() {\n        return true;\n    }\n    renderAnnotationInstance(renderContext) {\n        const annotation = renderContext.annotation;\n        const { invalidated } = annotation;\n        const renderResult = super.renderAnnotationInstance(renderContext);\n        if (invalidated) {\n            const { segmentationId } = annotation.data.segmentation;\n            triggerSegmentationDataModified(segmentationId);\n        }\n        return renderResult;\n    }\n}\nPlanarFreehandContourSegmentationTool.toolName =\n    'PlanarFreehandContourSegmentationTool';\nexport default PlanarFreehandContourSegmentationTool;\n","import { CONSTANTS, getEnabledElement, VolumeViewport, utilities as csUtils, } from '@cornerstonejs/core';\nimport { vec3 } from 'gl-matrix';\nimport { getCalibratedLengthUnitsAndScale } from '../../utilities/getCalibratedUnits';\nimport * as math from '../../utilities/math';\nimport { polyline } from '../../utilities/math';\nimport { filterAnnotationsForDisplay } from '../../utilities/planar';\nimport throttle from '../../utilities/throttle';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport registerDrawLoop from './planarFreehandROITool/drawLoop';\nimport registerEditLoopCommon from './planarFreehandROITool/editLoopCommon';\nimport registerClosedContourEditLoop from './planarFreehandROITool/closedContourEditLoop';\nimport registerOpenContourEditLoop from './planarFreehandROITool/openContourEditLoop';\nimport registerOpenContourEndEditLoop from './planarFreehandROITool/openContourEndEditLoop';\nimport registerRenderMethods from './planarFreehandROITool/renderMethods';\nimport { triggerAnnotationModified } from '../../stateManagement/annotation/helpers/state';\nimport { drawLinkedTextBox } from '../../drawingSvg';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport { getLineSegmentIntersectionsCoordinates } from '../../utilities/math/polyline';\nimport { isViewportPreScaled } from '../../utilities/viewport/isViewportPreScaled';\nimport { BasicStatsCalculator } from '../../utilities/math/basic';\nimport calculatePerimeter from '../../utilities/contours/calculatePerimeter';\nimport ContourSegmentationBaseTool from '../base/ContourSegmentationBaseTool';\nimport { KeyboardBindings, ChangeTypes } from '../../enums';\nimport { getPixelValueUnits } from '../../utilities/getPixelValueUnits';\nconst { pointCanProjectOnLine } = polyline;\nconst { EPSILON } = CONSTANTS;\nconst PARALLEL_THRESHOLD = 1 - EPSILON;\nclass PlanarFreehandROITool extends ContourSegmentationBaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            storePointData: false,\n            shadow: true,\n            preventHandleOutsideImage: false,\n            contourHoleAdditionModifierKey: KeyboardBindings.Shift,\n            alwaysRenderOpenContourHandles: {\n                enabled: false,\n                radius: 2,\n            },\n            allowOpenContours: true,\n            closeContourProximity: 10,\n            checkCanvasEditFallbackProximity: 6,\n            makeClockWise: true,\n            subPixelResolution: 4,\n            smoothing: {\n                smoothOnAdd: false,\n                smoothOnEdit: false,\n                knotsRatioPercentageOnAdd: 40,\n                knotsRatioPercentageOnEdit: 40,\n            },\n            interpolation: {\n                enabled: false,\n                onInterpolationComplete: null,\n            },\n            decimate: {\n                enabled: false,\n                epsilon: 0.1,\n            },\n            displayOnePointAsCrosshairs: false,\n            calculateStats: true,\n            getTextLines: defaultGetTextLines,\n            statsCalculator: BasicStatsCalculator,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.isDrawing = false;\n        this.isEditingClosed = false;\n        this.isEditingOpen = false;\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const annotation = this.createAnnotation(evt);\n            this.addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.activateDraw(evt, annotation, viewportIdsToRender);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.handleSelectedCallback = (evt, annotation, handle) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.activateOpenContourEndEdit(evt, annotation, viewportIdsToRender, handle);\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            if (annotation.data.contour.closed) {\n                this.activateClosedContourEdit(evt, annotation, viewportIdsToRender);\n            }\n            else {\n                this.activateOpenContourEdit(evt, annotation, viewportIdsToRender);\n            }\n            evt.preventDefault();\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { polyline: points } = annotation.data.contour;\n            let previousPoint = viewport.worldToCanvas(points[0]);\n            for (let i = 1; i < points.length; i++) {\n                const p1 = previousPoint;\n                const p2 = viewport.worldToCanvas(points[i]);\n                const canProject = pointCanProjectOnLine(canvasCoords, p1, p2, proximity);\n                if (canProject) {\n                    return true;\n                }\n                previousPoint = p2;\n            }\n            if (!annotation.data.contour.closed) {\n                return false;\n            }\n            const pStart = viewport.worldToCanvas(points[0]);\n            const pEnd = viewport.worldToCanvas(points[points.length - 1]);\n            return pointCanProjectOnLine(canvasCoords, pStart, pEnd, proximity);\n        };\n        this.cancel = (element) => {\n            const isDrawing = this.isDrawing;\n            const isEditingOpen = this.isEditingOpen;\n            const isEditingClosed = this.isEditingClosed;\n            if (isDrawing) {\n                this.cancelDrawing(element);\n            }\n            else if (isEditingOpen) {\n                this.cancelOpenContourEdit(element);\n            }\n            else if (isEditingClosed) {\n                this.cancelClosedContourEdit(element);\n            }\n        };\n        this._calculateCachedStats = (annotation, viewport, renderingEngine, enabledElement) => {\n            const { data } = annotation;\n            const { cachedStats } = data;\n            const { polyline: points, closed } = data.contour;\n            const targetIds = Object.keys(cachedStats);\n            for (let i = 0; i < targetIds.length; i++) {\n                const targetId = targetIds[i];\n                const image = this.getTargetImageData(targetId);\n                if (!image) {\n                    continue;\n                }\n                const { imageData, metadata } = image;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                const modalityUnitOptions = {\n                    isPreScaled: isViewportPreScaled(viewport, targetId),\n                    isSuvScaled: this.isSuvScaled(viewport, targetId, annotation.metadata.referencedImageId),\n                };\n                const modalityUnit = getPixelValueUnits(metadata.Modality, annotation.metadata.referencedImageId, modalityUnitOptions);\n                const calibratedScale = getCalibratedLengthUnitsAndScale(image, () => {\n                    const polyline = data.contour.polyline;\n                    const numPoints = polyline.length;\n                    const projectedPolyline = new Array(numPoints);\n                    for (let i = 0; i < numPoints; i++) {\n                        projectedPolyline[i] = viewport.worldToCanvas(polyline[i]);\n                    }\n                    const { maxX: canvasMaxX, maxY: canvasMaxY, minX: canvasMinX, minY: canvasMinY, } = math.polyline.getAABB(projectedPolyline);\n                    const topLeftBBWorld = viewport.canvasToWorld([canvasMinX, canvasMinY]);\n                    const topLeftBBIndex = csUtils.transformWorldToIndex(imageData, topLeftBBWorld);\n                    const bottomRightBBWorld = viewport.canvasToWorld([\n                        canvasMaxX,\n                        canvasMaxY,\n                    ]);\n                    const bottomRightBBIndex = csUtils.transformWorldToIndex(imageData, bottomRightBBWorld);\n                    return [topLeftBBIndex, bottomRightBBIndex];\n                });\n                if (closed) {\n                    this.updateClosedCachedStats({\n                        targetId,\n                        viewport,\n                        canvasCoordinates,\n                        points,\n                        imageData,\n                        metadata,\n                        cachedStats,\n                        modalityUnit,\n                        calibratedScale,\n                    });\n                }\n                else {\n                    this.updateOpenCachedStats({\n                        metadata,\n                        canvasCoordinates,\n                        targetId,\n                        cachedStats,\n                        modalityUnit,\n                        calibratedScale,\n                    });\n                }\n            }\n            triggerAnnotationModified(annotation, enabledElement.viewport.element, ChangeTypes.StatsUpdated);\n            annotation.invalidated = false;\n            return cachedStats;\n        };\n        this._renderStats = (annotation, viewport, enabledElement, svgDrawingHelper) => {\n            const { data } = annotation;\n            const targetId = this.getTargetId(viewport);\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n            if (!options.visibility) {\n                return;\n            }\n            const textLines = this.configuration.getTextLines(data, targetId);\n            if (!textLines || textLines.length === 0) {\n                return;\n            }\n            const canvasCoordinates = data.contour.polyline.map((p) => viewport.worldToCanvas(p));\n            if (!data.handles.textBox.hasMoved) {\n                const canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                data.handles.textBox.worldPosition =\n                    viewport.canvasToWorld(canvasTextBoxCoords);\n            }\n            const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n            const textBoxUID = '1';\n            const boundingBox = drawLinkedTextBox(svgDrawingHelper, annotation.annotationUID ?? '', textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n            const { x: left, y: top, width, height } = boundingBox;\n            data.handles.textBox.worldBoundingBox = {\n                topLeft: viewport.canvasToWorld([left, top]),\n                topRight: viewport.canvasToWorld([left + width, top]),\n                bottomLeft: viewport.canvasToWorld([left, top + height]),\n                bottomRight: viewport.canvasToWorld([left + width, top + height]),\n            };\n        };\n        registerDrawLoop(this);\n        registerEditLoopCommon(this);\n        registerClosedContourEditLoop(this);\n        registerOpenContourEditLoop(this);\n        registerOpenContourEndEditLoop(this);\n        registerRenderMethods(this);\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n    filterInteractableAnnotationsForElement(element, annotations) {\n        if (!annotations || !annotations.length) {\n            return;\n        }\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        let annotationsToDisplay;\n        if (viewport instanceof VolumeViewport) {\n            const camera = viewport.getCamera();\n            const { spacingInNormalDirection } = csUtils.getTargetVolumeAndSpacingInNormalDir(viewport, camera);\n            annotationsToDisplay = this.filterAnnotationsWithinSlice(annotations, camera, spacingInNormalDirection);\n        }\n        else {\n            annotationsToDisplay = filterAnnotationsForDisplay(viewport, annotations);\n        }\n        return annotationsToDisplay;\n    }\n    filterAnnotationsWithinSlice(annotations, camera, spacingInNormalDirection) {\n        const { viewPlaneNormal } = camera;\n        const annotationsWithParallelNormals = annotations.filter((td) => {\n            const annotationViewPlaneNormal = td.metadata.viewPlaneNormal;\n            const isParallel = Math.abs(vec3.dot(viewPlaneNormal, annotationViewPlaneNormal)) >\n                PARALLEL_THRESHOLD;\n            return annotationViewPlaneNormal && isParallel;\n        });\n        if (!annotationsWithParallelNormals.length) {\n            return [];\n        }\n        const halfSpacingInNormalDirection = spacingInNormalDirection / 2;\n        const { focalPoint } = camera;\n        const annotationsWithinSlice = [];\n        for (const annotation of annotationsWithParallelNormals) {\n            const data = annotation.data;\n            const point = data.contour.polyline[0];\n            if (!annotation.isVisible) {\n                continue;\n            }\n            const dir = vec3.create();\n            vec3.sub(dir, focalPoint, point);\n            const dot = vec3.dot(dir, viewPlaneNormal);\n            if (Math.abs(dot) < halfSpacingInNormalDirection) {\n                annotationsWithinSlice.push(annotation);\n            }\n        }\n        return annotationsWithinSlice;\n    }\n    isContourSegmentationTool() {\n        return false;\n    }\n    createAnnotation(evt) {\n        const worldPos = evt.detail.currentPoints.world;\n        const contourAnnotation = super.createAnnotation(evt);\n        const onInterpolationComplete = (annotation) => {\n            annotation.data.handles.points.length = 0;\n        };\n        const annotation = csUtils.deepMerge(contourAnnotation, {\n            data: {\n                contour: {\n                    polyline: [[...worldPos]],\n                },\n                label: '',\n                cachedStats: {},\n            },\n            onInterpolationComplete,\n        });\n        return annotation;\n    }\n    getAnnotationStyle(context) {\n        return super.getAnnotationStyle(context);\n    }\n    renderAnnotationInstance(renderContext) {\n        const { enabledElement, targetId, svgDrawingHelper } = renderContext;\n        const annotation = renderContext.annotation;\n        let renderStatus = false;\n        const { viewport, renderingEngine } = enabledElement;\n        const isDrawing = this.isDrawing;\n        const isEditingOpen = this.isEditingOpen;\n        const isEditingClosed = this.isEditingClosed;\n        if (!(isDrawing || isEditingOpen || isEditingClosed)) {\n            if (this.configuration.displayOnePointAsCrosshairs &&\n                annotation.data.contour.polyline.length === 1) {\n                this.renderPointContourWithMarker(enabledElement, svgDrawingHelper, annotation);\n            }\n            else {\n                this.renderContour(enabledElement, svgDrawingHelper, annotation);\n            }\n        }\n        else {\n            const activeAnnotationUID = this.commonData.annotation.annotationUID;\n            if (annotation.annotationUID === activeAnnotationUID) {\n                if (isDrawing) {\n                    this.renderContourBeingDrawn(enabledElement, svgDrawingHelper, annotation);\n                }\n                else if (isEditingClosed) {\n                    this.renderClosedContourBeingEdited(enabledElement, svgDrawingHelper, annotation);\n                }\n                else if (isEditingOpen) {\n                    this.renderOpenContourBeingEdited(enabledElement, svgDrawingHelper, annotation);\n                }\n                else {\n                    throw new Error(`Unknown ${this.getToolName()} annotation rendering state`);\n                }\n            }\n            else {\n                if (this.configuration.displayOnePointAsCrosshairs &&\n                    annotation.data.contour.polyline.length === 1) {\n                    this.renderPointContourWithMarker(enabledElement, svgDrawingHelper, annotation);\n                }\n                else {\n                    this.renderContour(enabledElement, svgDrawingHelper, annotation);\n                }\n            }\n            renderStatus = true;\n        }\n        if (!this.configuration.calculateStats) {\n            return;\n        }\n        this._calculateStatsIfActive(annotation, targetId, viewport, renderingEngine, enabledElement);\n        this._renderStats(annotation, viewport, enabledElement, svgDrawingHelper);\n        return renderStatus;\n    }\n    _calculateStatsIfActive(annotation, targetId, viewport, renderingEngine, enabledElement) {\n        const activeAnnotationUID = this.commonData?.annotation.annotationUID;\n        if (annotation.annotationUID === activeAnnotationUID &&\n            !this.commonData?.movingTextBox) {\n            return;\n        }\n        if (!this.commonData?.movingTextBox) {\n            const { data } = annotation;\n            if (!data.cachedStats[targetId] ||\n                data.cachedStats[targetId].areaUnit == null) {\n                data.cachedStats[targetId] = {\n                    Modality: null,\n                    area: null,\n                    max: null,\n                    mean: null,\n                    stdDev: null,\n                    areaUnit: null,\n                };\n                this._calculateCachedStats(annotation, viewport, renderingEngine, enabledElement);\n            }\n            else if (annotation.invalidated) {\n                this._throttledCalculateCachedStats(annotation, viewport, renderingEngine, enabledElement);\n            }\n        }\n    }\n    updateClosedCachedStats({ viewport, points, imageData, metadata, cachedStats, targetId, modalityUnit, canvasCoordinates, calibratedScale, }) {\n        const { scale, areaUnit, units } = calibratedScale;\n        const { voxelManager } = viewport.getImageData();\n        const canvasPoint = canvasCoordinates[0];\n        const originalWorldPoint = viewport.canvasToWorld(canvasPoint);\n        const deltaXPoint = viewport.canvasToWorld([\n            canvasPoint[0] + 1,\n            canvasPoint[1],\n        ]);\n        const deltaYPoint = viewport.canvasToWorld([\n            canvasPoint[0],\n            canvasPoint[1] + 1,\n        ]);\n        const deltaInX = vec3.distance(originalWorldPoint, deltaXPoint);\n        const deltaInY = vec3.distance(originalWorldPoint, deltaYPoint);\n        const worldPosIndex = csUtils.transformWorldToIndex(imageData, points[0]);\n        worldPosIndex[0] = Math.floor(worldPosIndex[0]);\n        worldPosIndex[1] = Math.floor(worldPosIndex[1]);\n        worldPosIndex[2] = Math.floor(worldPosIndex[2]);\n        let iMin = worldPosIndex[0];\n        let iMax = worldPosIndex[0];\n        let jMin = worldPosIndex[1];\n        let jMax = worldPosIndex[1];\n        let kMin = worldPosIndex[2];\n        let kMax = worldPosIndex[2];\n        for (let j = 1; j < points.length; j++) {\n            const worldPosIndex = csUtils.transformWorldToIndex(imageData, points[j]);\n            worldPosIndex[0] = Math.floor(worldPosIndex[0]);\n            worldPosIndex[1] = Math.floor(worldPosIndex[1]);\n            worldPosIndex[2] = Math.floor(worldPosIndex[2]);\n            iMin = Math.min(iMin, worldPosIndex[0]);\n            iMax = Math.max(iMax, worldPosIndex[0]);\n            jMin = Math.min(jMin, worldPosIndex[1]);\n            jMax = Math.max(jMax, worldPosIndex[1]);\n            kMin = Math.min(kMin, worldPosIndex[2]);\n            kMax = Math.max(kMax, worldPosIndex[2]);\n        }\n        const worldPosIndex2 = csUtils.transformWorldToIndex(imageData, points[1]);\n        worldPosIndex2[0] = Math.floor(worldPosIndex2[0]);\n        worldPosIndex2[1] = Math.floor(worldPosIndex2[1]);\n        worldPosIndex2[2] = Math.floor(worldPosIndex2[2]);\n        let area = polyline.getArea(canvasCoordinates) / scale / scale;\n        area *= deltaInX * deltaInY;\n        const iDelta = 0.01 * (iMax - iMin);\n        const jDelta = 0.01 * (jMax - jMin);\n        const kDelta = 0.01 * (kMax - kMin);\n        iMin = Math.floor(iMin - iDelta);\n        iMax = Math.ceil(iMax + iDelta);\n        jMin = Math.floor(jMin - jDelta);\n        jMax = Math.ceil(jMax + jDelta);\n        kMin = Math.floor(kMin - kDelta);\n        kMax = Math.ceil(kMax + kDelta);\n        const boundsIJK = [\n            [iMin, iMax],\n            [jMin, jMax],\n            [kMin, kMax],\n        ];\n        const worldPosEnd = imageData.indexToWorld([iMax, jMax, kMax]);\n        const canvasPosEnd = viewport.worldToCanvas(worldPosEnd);\n        let curRow = 0;\n        let intersections = [];\n        let intersectionCounter = 0;\n        const pointsInShape = voxelManager.forEach(this.configuration.statsCalculator.statsCallback, {\n            imageData,\n            isInObject: (pointLPS, _pointIJK) => {\n                let result = true;\n                const point = viewport.worldToCanvas(pointLPS);\n                if (point[1] != curRow) {\n                    intersectionCounter = 0;\n                    curRow = point[1];\n                    intersections = getLineSegmentIntersectionsCoordinates(canvasCoordinates, point, [canvasPosEnd[0], point[1]]);\n                    intersections.sort((function (index) {\n                        return function (a, b) {\n                            return a[index] === b[index]\n                                ? 0\n                                : a[index] < b[index]\n                                    ? -1\n                                    : 1;\n                        };\n                    })(0));\n                }\n                if (intersections.length && point[0] > intersections[0][0]) {\n                    intersections.shift();\n                    intersectionCounter++;\n                }\n                if (intersectionCounter % 2 === 0) {\n                    result = false;\n                }\n                return result;\n            },\n            boundsIJK,\n            returnPoints: this.configuration.storePointData,\n        });\n        const stats = this.configuration.statsCalculator.getStatistics();\n        cachedStats[targetId] = {\n            Modality: metadata.Modality,\n            area,\n            perimeter: calculatePerimeter(canvasCoordinates, closed) / scale,\n            mean: stats.mean?.value,\n            max: stats.max?.value,\n            stdDev: stats.stdDev?.value,\n            statsArray: stats.array,\n            pointsInShape: pointsInShape,\n            areaUnit,\n            modalityUnit,\n            unit: units,\n        };\n    }\n    updateOpenCachedStats({ targetId, metadata, canvasCoordinates, cachedStats, modalityUnit, calibratedScale, }) {\n        const { scale, units } = calibratedScale;\n        cachedStats[targetId] = {\n            Modality: metadata.Modality,\n            length: calculatePerimeter(canvasCoordinates, false) / scale,\n            modalityUnit,\n            getPixelValueUnitunit: units,\n        };\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { area, mean, stdDev, length, perimeter, max, isEmptyArea, unit, areaUnit, modalityUnit, } = cachedVolumeStats || {};\n    const textLines = [];\n    if (area) {\n        const areaLine = isEmptyArea\n            ? `Area: Oblique not supported`\n            : `Area: ${csUtils.roundNumber(area)} ${areaUnit}`;\n        textLines.push(areaLine);\n    }\n    if (mean) {\n        textLines.push(`Mean: ${csUtils.roundNumber(mean)} ${modalityUnit}`);\n    }\n    if (Number.isFinite(max)) {\n        textLines.push(`Max: ${csUtils.roundNumber(max)} ${modalityUnit}`);\n    }\n    if (stdDev) {\n        textLines.push(`Std Dev: ${csUtils.roundNumber(stdDev)} ${modalityUnit}`);\n    }\n    if (perimeter) {\n        textLines.push(`Perimeter: ${csUtils.roundNumber(perimeter)} ${unit}`);\n    }\n    if (length) {\n        textLines.push(`${csUtils.roundNumber(length)} ${unit}`);\n    }\n    return textLines;\n}\nPlanarFreehandROITool.toolName = 'PlanarFreehandROI';\nexport default PlanarFreehandROITool;\n","import { AnnotationTool } from '../base';\nimport { getEnabledElement, VolumeViewport, utilities as csUtils, } from '@cornerstonejs/core';\nimport { getCalibratedLengthUnitsAndScale } from '../../utilities/getCalibratedUnits';\nimport throttle from '../../utilities/throttle';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport { drawHandles as drawHandlesSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, drawRectByCoordinates as drawRectSvg, } from '../../drawingSvg';\nimport { state } from '../../store/state';\nimport { Events } from '../../enums';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport * as rectangle from '../../utilities/math/rectangle';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport getWorldWidthAndHeightFromCorners from '../../utilities/planar/getWorldWidthAndHeightFromCorners';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { getPixelValueUnits } from '../../utilities/getPixelValueUnits';\nimport { isViewportPreScaled } from '../../utilities/viewport/isViewportPreScaled';\nimport { BasicStatsCalculator } from '../../utilities/math/basic';\nconst { transformWorldToIndex } = csUtils;\nclass RectangleROITool extends AnnotationTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            storePointData: false,\n            shadow: true,\n            preventHandleOutsideImage: false,\n            getTextLines: defaultGetTextLines,\n            statsCalculator: BasicStatsCalculator,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const referencedImageId = this.getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                invalidated: true,\n                highlighted: true,\n                metadata: {\n                    toolName: this.getToolName(),\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    ...viewport.getViewReference({ points: [worldPos] }),\n                },\n                data: {\n                    label: '',\n                    handles: {\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                        activeHandleIndex: null,\n                    },\n                    cachedStats: {},\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 3,\n                movingTextBox: false,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.isPointNearTool = (element, annotation, canvasCoords, proximity) => {\n            const enabledElement = getEnabledElement(element);\n            const { viewport } = enabledElement;\n            const { data } = annotation;\n            const { points } = data.handles;\n            const canvasPoint1 = viewport.worldToCanvas(points[0]);\n            const canvasPoint2 = viewport.worldToCanvas(points[3]);\n            const rect = this._getRectangleImageCoordinates([\n                canvasPoint1,\n                canvasPoint2,\n            ]);\n            const point = [canvasCoords[0], canvasCoords[1]];\n            const { left, top, width, height } = rect;\n            const distanceToPoint = rectangle.distanceToPoint([left, top, width, height], point);\n            if (distanceToPoint <= proximity) {\n                return true;\n            }\n            return false;\n        };\n        this.toolSelectedCallback = (evt, annotation) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            annotation.highlighted = true;\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                movingTextBox: false,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this.handleSelectedCallback = (evt, annotation, handle) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { data } = annotation;\n            annotation.highlighted = true;\n            let movingTextBox = false;\n            let handleIndex;\n            if (handle.worldPosition) {\n                movingTextBox = true;\n            }\n            else {\n                handleIndex = data.handles.points.findIndex((p) => p === handle);\n            }\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex,\n                movingTextBox,\n            };\n            this._activateModify(element);\n            hideElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            evt.preventDefault();\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const { renderingEngine } = getEnabledElement(element);\n            this.editData = null;\n            this.isDrawing = false;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this._dragCallback = (evt) => {\n            this.isDrawing = true;\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, handleIndex, movingTextBox } = this.editData;\n            const { data } = annotation;\n            if (movingTextBox) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { textBox } = data.handles;\n                const { worldPosition } = textBox;\n                worldPosition[0] += worldPosDelta[0];\n                worldPosition[1] += worldPosDelta[1];\n                worldPosition[2] += worldPosDelta[2];\n                textBox.hasMoved = true;\n            }\n            else if (handleIndex === undefined) {\n                const { deltaPoints } = eventDetail;\n                const worldPosDelta = deltaPoints.world;\n                const { points } = data.handles;\n                points.forEach((point) => {\n                    point[0] += worldPosDelta[0];\n                    point[1] += worldPosDelta[1];\n                    point[2] += worldPosDelta[2];\n                });\n                annotation.invalidated = true;\n            }\n            else {\n                const { currentPoints } = eventDetail;\n                const enabledElement = getEnabledElement(element);\n                const { worldToCanvas, canvasToWorld } = enabledElement.viewport;\n                const worldPos = currentPoints.world;\n                const { points } = data.handles;\n                points[handleIndex] = [...worldPos];\n                let bottomLeftCanvas;\n                let bottomRightCanvas;\n                let topLeftCanvas;\n                let topRightCanvas;\n                let bottomLeftWorld;\n                let bottomRightWorld;\n                let topLeftWorld;\n                let topRightWorld;\n                switch (handleIndex) {\n                    case 0:\n                    case 3:\n                        bottomLeftCanvas = worldToCanvas(points[0]);\n                        topRightCanvas = worldToCanvas(points[3]);\n                        bottomRightCanvas = [topRightCanvas[0], bottomLeftCanvas[1]];\n                        topLeftCanvas = [bottomLeftCanvas[0], topRightCanvas[1]];\n                        bottomRightWorld = canvasToWorld(bottomRightCanvas);\n                        topLeftWorld = canvasToWorld(topLeftCanvas);\n                        points[1] = bottomRightWorld;\n                        points[2] = topLeftWorld;\n                        break;\n                    case 1:\n                    case 2:\n                        bottomRightCanvas = worldToCanvas(points[1]);\n                        topLeftCanvas = worldToCanvas(points[2]);\n                        bottomLeftCanvas = [\n                            topLeftCanvas[0],\n                            bottomRightCanvas[1],\n                        ];\n                        topRightCanvas = [\n                            bottomRightCanvas[0],\n                            topLeftCanvas[1],\n                        ];\n                        bottomLeftWorld = canvasToWorld(bottomLeftCanvas);\n                        topRightWorld = canvasToWorld(topRightCanvas);\n                        points[0] = bottomLeftWorld;\n                        points[3] = topRightWorld;\n                        break;\n                }\n                annotation.invalidated = true;\n            }\n            this.editData.hasMoved = true;\n            const enabledElement = getEnabledElement(element);\n            const { renderingEngine } = enabledElement;\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n        };\n        this.cancel = (element) => {\n            if (this.isDrawing) {\n                this.isDrawing = false;\n                this._deactivateDraw(element);\n                this._deactivateModify(element);\n                resetElementCursor(element);\n                const { annotation, viewportIdsToRender, newAnnotation } = this.editData;\n                const { data } = annotation;\n                annotation.highlighted = false;\n                data.handles.activeHandleIndex = null;\n                triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n                if (newAnnotation) {\n                    triggerAnnotationCompleted(annotation);\n                }\n                this.editData = null;\n                return annotation.annotationUID;\n            }\n        };\n        this._activateDraw = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_MOVE, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._activateModify = (element) => {\n            state.isInteractingWithTool = true;\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.addEventListener(Events.TOUCH_END, this._endCallback);\n            element.addEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.addEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this._deactivateModify = (element) => {\n            state.isInteractingWithTool = false;\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n            element.removeEventListener(Events.TOUCH_END, this._endCallback);\n            element.removeEventListener(Events.TOUCH_DRAG, this._dragCallback);\n            element.removeEventListener(Events.TOUCH_TAP, this._endCallback);\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const targetId = this.getTargetId(viewport);\n            const renderingEngine = viewport.getRenderingEngine();\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points, activeHandleIndex } = data.handles;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                styleSpecifier.annotationUID = annotationUID;\n                const { color, lineWidth, lineDash } = this.getAnnotationStyle({\n                    annotation,\n                    styleSpecifier,\n                });\n                const { viewPlaneNormal, viewUp } = viewport.getCamera();\n                if (!data.cachedStats[targetId] ||\n                    data.cachedStats[targetId].areaUnit == null) {\n                    data.cachedStats[targetId] = {\n                        Modality: null,\n                        area: null,\n                        max: null,\n                        mean: null,\n                        stdDev: null,\n                        areaUnit: null,\n                    };\n                    this._calculateCachedStats(annotation, viewPlaneNormal, viewUp, renderingEngine, enabledElement);\n                }\n                else if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, viewPlaneNormal, viewUp, renderingEngine, enabledElement);\n                    if (viewport instanceof VolumeViewport) {\n                        const { referencedImageId } = annotation.metadata;\n                        for (const targetId in data.cachedStats) {\n                            if (targetId.startsWith('imageId')) {\n                                const viewports = renderingEngine.getStackViewports();\n                                const invalidatedStack = viewports.find((vp) => {\n                                    const referencedImageURI = csUtils.imageIdToURI(referencedImageId);\n                                    const hasImageURI = vp.hasImageURI(referencedImageURI);\n                                    const currentImageURI = csUtils.imageIdToURI(vp.getCurrentImageId());\n                                    return hasImageURI && currentImageURI !== referencedImageURI;\n                                });\n                                if (invalidatedStack) {\n                                    delete data.cachedStats[targetId];\n                                }\n                            }\n                        }\n                    }\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                const dataId = `${annotationUID}-rect`;\n                const rectangleUID = '0';\n                drawRectSvg(svgDrawingHelper, annotationUID, rectangleUID, canvasCoordinates, {\n                    color,\n                    lineDash,\n                    lineWidth,\n                }, dataId);\n                renderStatus = true;\n                const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                if (!options.visibility) {\n                    data.handles.textBox = {\n                        hasMoved: false,\n                        worldPosition: [0, 0, 0],\n                        worldBoundingBox: {\n                            topLeft: [0, 0, 0],\n                            topRight: [0, 0, 0],\n                            bottomLeft: [0, 0, 0],\n                            bottomRight: [0, 0, 0],\n                        },\n                    };\n                    continue;\n                }\n                const textLines = this.configuration.getTextLines(data, targetId);\n                if (!textLines || textLines.length === 0) {\n                    continue;\n                }\n                if (!data.handles.textBox.hasMoved) {\n                    const canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                    data.handles.textBox.worldPosition =\n                        viewport.canvasToWorld(canvasTextBoxCoords);\n                }\n                const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                const textBoxUID = '1';\n                const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                const { x: left, y: top, width, height } = boundingBox;\n                data.handles.textBox.worldBoundingBox = {\n                    topLeft: viewport.canvasToWorld([left, top]),\n                    topRight: viewport.canvasToWorld([left + width, top]),\n                    bottomLeft: viewport.canvasToWorld([left, top + height]),\n                    bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                };\n            }\n            return renderStatus;\n        };\n        this._getRectangleImageCoordinates = (points) => {\n            const [point0, point1] = points;\n            return {\n                left: Math.min(point0[0], point1[0]),\n                top: Math.min(point0[1], point1[1]),\n                width: Math.abs(point0[0] - point1[0]),\n                height: Math.abs(point0[1] - point1[1]),\n            };\n        };\n        this._calculateCachedStats = (annotation, viewPlaneNormal, viewUp, renderingEngine, enabledElement) => {\n            const { data } = annotation;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            const worldPos1 = data.handles.points[0];\n            const worldPos2 = data.handles.points[3];\n            const { cachedStats } = data;\n            const targetIds = Object.keys(cachedStats);\n            for (let i = 0; i < targetIds.length; i++) {\n                const targetId = targetIds[i];\n                const image = this.getTargetImageData(targetId);\n                if (!image) {\n                    continue;\n                }\n                const { dimensions, imageData, metadata, voxelManager } = image;\n                const pos1Index = transformWorldToIndex(imageData, worldPos1);\n                pos1Index[0] = Math.floor(pos1Index[0]);\n                pos1Index[1] = Math.floor(pos1Index[1]);\n                pos1Index[2] = Math.floor(pos1Index[2]);\n                const pos2Index = transformWorldToIndex(imageData, worldPos2);\n                pos2Index[0] = Math.floor(pos2Index[0]);\n                pos2Index[1] = Math.floor(pos2Index[1]);\n                pos2Index[2] = Math.floor(pos2Index[2]);\n                if (this._isInsideVolume(pos1Index, pos2Index, dimensions)) {\n                    this.isHandleOutsideImage = false;\n                    const iMin = Math.min(pos1Index[0], pos2Index[0]);\n                    const iMax = Math.max(pos1Index[0], pos2Index[0]);\n                    const jMin = Math.min(pos1Index[1], pos2Index[1]);\n                    const jMax = Math.max(pos1Index[1], pos2Index[1]);\n                    const kMin = Math.min(pos1Index[2], pos2Index[2]);\n                    const kMax = Math.max(pos1Index[2], pos2Index[2]);\n                    const boundsIJK = [\n                        [iMin, iMax],\n                        [jMin, jMax],\n                        [kMin, kMax],\n                    ];\n                    const { worldWidth, worldHeight } = getWorldWidthAndHeightFromCorners(viewPlaneNormal, viewUp, worldPos1, worldPos2);\n                    const handles = [pos1Index, pos2Index];\n                    const { scale, areaUnit } = getCalibratedLengthUnitsAndScale(image, handles);\n                    const area = Math.abs(worldWidth * worldHeight) / (scale * scale);\n                    const pixelUnitsOptions = {\n                        isPreScaled: isViewportPreScaled(viewport, targetId),\n                        isSuvScaled: this.isSuvScaled(viewport, targetId, annotation.metadata.referencedImageId),\n                    };\n                    const modalityUnit = getPixelValueUnits(metadata.Modality, annotation.metadata.referencedImageId, pixelUnitsOptions);\n                    const pointsInShape = voxelManager.forEach(this.configuration.statsCalculator.statsCallback, {\n                        boundsIJK,\n                        imageData,\n                        returnPoints: this.configuration.storePointData,\n                    });\n                    const stats = this.configuration.statsCalculator.getStatistics();\n                    cachedStats[targetId] = {\n                        Modality: metadata.Modality,\n                        area,\n                        mean: stats.mean?.value,\n                        stdDev: stats.stdDev?.value,\n                        max: stats.max?.value,\n                        statsArray: stats.array,\n                        pointsInShape: pointsInShape,\n                        areaUnit,\n                        modalityUnit,\n                    };\n                }\n                else {\n                    this.isHandleOutsideImage = true;\n                    cachedStats[targetId] = {\n                        Modality: metadata.Modality,\n                    };\n                }\n            }\n            annotation.invalidated = false;\n            triggerAnnotationModified(annotation, element);\n            return cachedStats;\n        };\n        this._isInsideVolume = (index1, index2, dimensions) => {\n            return (csUtils.indexWithinDimensions(index1, dimensions) &&\n                csUtils.indexWithinDimensions(index2, dimensions));\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStats, 100, { trailing: true });\n    }\n}\nfunction defaultGetTextLines(data, targetId) {\n    const cachedVolumeStats = data.cachedStats[targetId];\n    const { area, mean, max, stdDev, areaUnit, modalityUnit } = cachedVolumeStats;\n    if (mean === undefined) {\n        return;\n    }\n    const textLines = [];\n    textLines.push(`Area: ${csUtils.roundNumber(area)} ${areaUnit}`);\n    textLines.push(`Mean: ${csUtils.roundNumber(mean)} ${modalityUnit}`);\n    textLines.push(`Max: ${csUtils.roundNumber(max)} ${modalityUnit}`);\n    textLines.push(`Std Dev: ${csUtils.roundNumber(stdDev)} ${modalityUnit}`);\n    return textLines;\n}\nRectangleROITool.toolName = 'RectangleROI';\nexport default RectangleROITool;\n","import { utilities, getEnabledElement, StackViewport, cache, VideoViewport, BaseVolumeViewport, } from '@cornerstonejs/core';\nimport BaseTool from './BaseTool';\nimport { getAnnotationManager } from '../../stateManagement/annotation/annotationState';\nimport triggerAnnotationRender from '../../utilities/triggerAnnotationRender';\nimport filterAnnotationsForDisplay from '../../utilities/planar/filterAnnotationsForDisplay';\nimport { getStyleProperty } from '../../stateManagement/annotation/config/helpers';\nimport { getState } from '../../stateManagement/annotation/config';\nclass AnnotationDisplayTool extends BaseTool {\n    constructor() {\n        super(...arguments);\n        this.onImageSpacingCalibrated = (evt) => {\n            const { element, imageId } = evt.detail;\n            const imageURI = utilities.imageIdToURI(imageId);\n            const annotationManager = getAnnotationManager();\n            const framesOfReference = annotationManager.getFramesOfReference();\n            framesOfReference.forEach((frameOfReference) => {\n                const frameOfReferenceSpecificAnnotations = annotationManager.getAnnotations(frameOfReference);\n                const toolSpecificAnnotations = frameOfReferenceSpecificAnnotations[this.getToolName()];\n                if (!toolSpecificAnnotations || !toolSpecificAnnotations.length) {\n                    return;\n                }\n                toolSpecificAnnotations.forEach((annotation) => {\n                    if (!annotation.metadata?.referencedImageId) {\n                        return;\n                    }\n                    const referencedImageURI = utilities.imageIdToURI(annotation.metadata.referencedImageId);\n                    if (referencedImageURI === imageURI) {\n                        annotation.invalidated = true;\n                        annotation.data.cachedStats = {};\n                    }\n                });\n                triggerAnnotationRender(element);\n            });\n        };\n    }\n    filterInteractableAnnotationsForElement(element, annotations) {\n        if (!annotations || !annotations.length) {\n            return;\n        }\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        return filterAnnotationsForDisplay(viewport, annotations);\n    }\n    getReferencedImageId(viewport, worldPos, viewPlaneNormal, viewUp) {\n        const targetId = this.getTargetId(viewport);\n        let referencedImageId = targetId.split(/^[a-zA-Z]+:/)[1];\n        if (viewport instanceof BaseVolumeViewport) {\n            const volumeId = utilities.getVolumeId(targetId);\n            const imageVolume = cache.getVolume(volumeId);\n            referencedImageId = utilities.getClosestImageId(imageVolume, worldPos, viewPlaneNormal);\n        }\n        return referencedImageId;\n    }\n    getStyle(property, specifications, annotation) {\n        return getStyleProperty(property, specifications, getState(annotation), this.mode);\n    }\n}\nAnnotationDisplayTool.toolName = 'AnnotationDisplayTool';\nexport default AnnotationDisplayTool;\n","import { utilities, BaseVolumeViewport } from '@cornerstonejs/core';\nimport ToolModes from '../../enums/ToolModes';\nclass BaseTool {\n    constructor(toolProps, defaultToolProps) {\n        const initialProps = utilities.deepMerge(defaultToolProps, toolProps);\n        const { configuration = {}, supportedInteractionTypes, toolGroupId, } = initialProps;\n        if (!configuration.strategies) {\n            configuration.strategies = {};\n            configuration.defaultStrategy = undefined;\n            configuration.activeStrategy = undefined;\n            configuration.strategyOptions = {};\n        }\n        this.toolGroupId = toolGroupId;\n        this.supportedInteractionTypes = supportedInteractionTypes || [];\n        this.configuration = Object.assign({}, configuration);\n        this.mode = ToolModes.Disabled;\n    }\n    getToolName() {\n        return this.constructor.toolName;\n    }\n    applyActiveStrategy(enabledElement, operationData) {\n        const { strategies, activeStrategy } = this.configuration;\n        return strategies[activeStrategy]?.call(this, enabledElement, operationData);\n    }\n    applyActiveStrategyCallback(enabledElement, operationData, callbackType) {\n        const { strategies, activeStrategy } = this.configuration;\n        if (!strategies[activeStrategy]) {\n            throw new Error(`applyActiveStrategyCallback: active strategy ${activeStrategy} not found, check tool configuration or spellings`);\n        }\n        return strategies[activeStrategy][callbackType]?.call(this, enabledElement, operationData);\n    }\n    setConfiguration(newConfiguration) {\n        this.configuration = utilities.deepMerge(this.configuration, newConfiguration);\n    }\n    setActiveStrategy(strategyName) {\n        this.setConfiguration({ activeStrategy: strategyName });\n    }\n    getTargetImageData(targetId) {\n        if (targetId.startsWith('imageId:')) {\n            const imageId = targetId.split('imageId:')[1];\n            const imageURI = utilities.imageIdToURI(imageId);\n            let viewports = utilities.getViewportsWithImageURI(imageURI);\n            if (!viewports || !viewports.length) {\n                return;\n            }\n            viewports = viewports.filter((viewport) => {\n                return viewport.getCurrentImageId() === imageId;\n            });\n            if (!viewports || !viewports.length) {\n                return;\n            }\n            return viewports[0].getImageData();\n        }\n        else if (targetId.startsWith('volumeId:')) {\n            const volumeId = utilities.getVolumeId(targetId);\n            const viewports = utilities.getViewportsWithVolumeId(volumeId);\n            if (!viewports || !viewports.length) {\n                return;\n            }\n            return viewports[0].getImageData();\n        }\n        else if (targetId.startsWith('videoId:')) {\n            const imageURI = utilities.imageIdToURI(targetId);\n            const viewports = utilities.getViewportsWithImageURI(imageURI);\n            if (!viewports || !viewports.length) {\n                return;\n            }\n            return viewports[0].getImageData();\n        }\n        else {\n            throw new Error('getTargetIdImage: targetId must start with \"imageId:\" or \"volumeId:\"');\n        }\n    }\n    getTargetId(viewport) {\n        const targetId = viewport.getViewReferenceId?.();\n        if (targetId) {\n            return targetId;\n        }\n        throw new Error('getTargetId: viewport must have a getViewReferenceId method');\n    }\n}\nBaseTool.toolName = 'BaseTool';\nexport default BaseTool;\n","import { getEnabledElementByViewportId } from '@cornerstonejs/core';\nimport Representations from '../../../enums/SegmentationRepresentations';\nimport { handleContourSegmentation } from './contourHandler/handleContourSegmentation';\nimport { getSegmentation } from '../../../stateManagement/segmentation/getSegmentation';\nimport { canComputeRequestedRepresentation } from '../../../stateManagement/segmentation/polySeg/canComputeRequestedRepresentation';\nimport { computeAndAddContourRepresentation } from '../../../stateManagement/segmentation/polySeg/Contour/computeAndAddContourRepresentation';\nimport removeContourFromElement from './removeContourFromElement';\nlet polySegConversionInProgress = false;\nconst processedViewportSegmentations = new Map();\nfunction removeRepresentation(viewportId, segmentationId, renderImmediate = false) {\n    const enabledElement = getEnabledElementByViewportId(viewportId);\n    if (!enabledElement) {\n        return;\n    }\n    const { viewport } = enabledElement;\n    if (!renderImmediate) {\n        return;\n    }\n    removeContourFromElement(viewportId, segmentationId);\n    viewport.render();\n}\nasync function render(viewport, contourRepresentation) {\n    const { segmentationId } = contourRepresentation;\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation) {\n        return;\n    }\n    let contourData = segmentation.representationData[Representations.Contour];\n    if (!contourData &&\n        canComputeRequestedRepresentation(segmentationId, Representations.Contour) &&\n        !polySegConversionInProgress) {\n        polySegConversionInProgress = true;\n        contourData = await computeAndAddContourRepresentation(segmentationId, {\n            viewport,\n        });\n        polySegConversionInProgress = false;\n    }\n    if (!contourData) {\n        return;\n    }\n    if (!contourData.geometryIds?.length) {\n        return;\n    }\n    handleContourSegmentation(viewport, contourData.geometryIds, contourData.annotationUIDsMap, contourRepresentation);\n}\nexport default {\n    render,\n    removeRepresentation,\n};\n","import { getEnabledElementByViewportId, VolumeViewport, } from '@cornerstonejs/core';\nimport addLabelmapToElement from './addLabelmapToElement';\nimport removeLabelmapFromElement from './removeLabelmapFromElement';\nimport { getActiveSegmentation } from '../../../stateManagement/segmentation/activeSegmentation';\nimport { getColorLUT } from '../../../stateManagement/segmentation/getColorLUT';\nimport { getCurrentLabelmapImageIdForViewport } from '../../../stateManagement/segmentation/getCurrentLabelmapImageIdForViewport';\nimport { getSegmentation } from '../../../stateManagement/segmentation/getSegmentation';\nimport { canComputeRequestedRepresentation } from '../../../stateManagement/segmentation/polySeg/canComputeRequestedRepresentation';\nimport { computeAndAddLabelmapRepresentation } from '../../../stateManagement/segmentation/polySeg/Labelmap/computeAndAddLabelmapRepresentation';\nimport { segmentationStyle } from '../../../stateManagement/segmentation/SegmentationStyle';\nimport SegmentationRepresentations from '../../../enums/SegmentationRepresentations';\nimport { internalGetHiddenSegmentIndices } from '../../../stateManagement/segmentation/helpers/internalGetHiddenSegmentIndices';\nimport { getActiveSegmentIndex } from '../../../stateManagement/segmentation/getActiveSegmentIndex';\nimport { getLabelmapActorEntry } from '../../../stateManagement/segmentation/helpers/getSegmentationActor';\nconst MAX_NUMBER_COLORS = 255;\nconst labelMapConfigCache = new Map();\nlet polySegConversionInProgress = false;\nfunction removeRepresentation(viewportId, segmentationId, renderImmediate = false) {\n    const enabledElement = getEnabledElementByViewportId(viewportId);\n    labelMapConfigCache.forEach((value, key) => {\n        if (key.includes(segmentationId)) {\n            labelMapConfigCache.delete(key);\n        }\n    });\n    if (!enabledElement) {\n        return;\n    }\n    const { viewport } = enabledElement;\n    removeLabelmapFromElement(viewport.element, segmentationId);\n    if (!renderImmediate) {\n        return;\n    }\n    viewport.render();\n}\nasync function render(viewport, representation) {\n    const { segmentationId } = representation;\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation) {\n        console.warn('No segmentation found for segmentationId: ', segmentationId);\n        return;\n    }\n    let labelmapData = segmentation.representationData[SegmentationRepresentations.Labelmap];\n    let labelmapActorEntry = getLabelmapActorEntry(viewport.id, segmentationId);\n    if (!labelmapData &&\n        canComputeRequestedRepresentation(segmentationId, SegmentationRepresentations.Labelmap) &&\n        !polySegConversionInProgress) {\n        polySegConversionInProgress = true;\n        labelmapData = await computeAndAddLabelmapRepresentation(segmentationId, {\n            viewport,\n        });\n        if (!labelmapData) {\n            throw new Error(`No labelmap data found for segmentationId ${segmentationId}.`);\n        }\n        polySegConversionInProgress = false;\n    }\n    if (!labelmapData) {\n        return;\n    }\n    if (viewport instanceof VolumeViewport) {\n        if (!labelmapActorEntry) {\n            await _addLabelmapToViewport(viewport, labelmapData, segmentationId);\n        }\n        labelmapActorEntry = getLabelmapActorEntry(viewport.id, segmentationId);\n    }\n    else {\n        const labelmapImageId = getCurrentLabelmapImageIdForViewport(viewport.id, segmentationId);\n        if (!labelmapImageId) {\n            return;\n        }\n        if (!labelmapActorEntry) {\n            await _addLabelmapToViewport(viewport, labelmapData, segmentationId);\n        }\n        labelmapActorEntry = getLabelmapActorEntry(viewport.id, segmentationId);\n    }\n    if (!labelmapActorEntry) {\n        return;\n    }\n    _setLabelmapColorAndOpacity(viewport.id, labelmapActorEntry, representation);\n}\nfunction _setLabelmapColorAndOpacity(viewportId, labelmapActorEntry, segmentationRepresentation) {\n    const { segmentationId } = segmentationRepresentation;\n    const { cfun, ofun } = segmentationRepresentation.config;\n    const { colorLUTIndex } = segmentationRepresentation;\n    const activeSegmentation = getActiveSegmentation(viewportId);\n    const isActiveLabelmap = activeSegmentation?.segmentationId === segmentationId;\n    const labelmapStyle = segmentationStyle.getStyle({\n        viewportId,\n        type: SegmentationRepresentations.Labelmap,\n        segmentationId,\n    });\n    const renderInactiveSegmentations = segmentationStyle.getRenderInactiveSegmentations(viewportId);\n    const colorLUT = getColorLUT(colorLUTIndex);\n    const numColors = Math.min(256, colorLUT.length);\n    const { outlineWidth, renderOutline, outlineOpacity, activeSegmentOutlineWidthDelta, } = _getLabelmapConfig(labelmapStyle, isActiveLabelmap);\n    const segmentsHidden = internalGetHiddenSegmentIndices(viewportId, {\n        segmentationId,\n        type: SegmentationRepresentations.Labelmap,\n    });\n    for (let i = 0; i < numColors; i++) {\n        const segmentIndex = i;\n        const segmentColor = colorLUT[segmentIndex];\n        const perSegmentStyle = segmentationStyle.getStyle({\n            viewportId,\n            type: SegmentationRepresentations.Labelmap,\n            segmentationId,\n            segmentIndex,\n        });\n        const segmentSpecificLabelmapConfig = perSegmentStyle;\n        const { fillAlpha, outlineWidth, renderFill, renderOutline } = _getLabelmapConfig(labelmapStyle, isActiveLabelmap, segmentSpecificLabelmapConfig);\n        const { forceOpacityUpdate, forceColorUpdate } = _needsTransferFunctionUpdate(viewportId, segmentationId, segmentIndex, {\n            fillAlpha,\n            renderFill,\n            renderOutline,\n            segmentColor,\n            outlineWidth,\n            segmentsHidden: segmentsHidden,\n            cfun,\n            ofun,\n        });\n        if (forceColorUpdate) {\n            cfun.addRGBPoint(segmentIndex, segmentColor[0] / MAX_NUMBER_COLORS, segmentColor[1] / MAX_NUMBER_COLORS, segmentColor[2] / MAX_NUMBER_COLORS);\n        }\n        if (forceOpacityUpdate) {\n            if (renderFill) {\n                const segmentOpacity = segmentsHidden.has(segmentIndex)\n                    ? 0\n                    : (segmentColor[3] / 255) * fillAlpha;\n                ofun.removePoint(segmentIndex);\n                ofun.addPointLong(segmentIndex, segmentOpacity, 0.5, 1.0);\n            }\n            else {\n                ofun.addPointLong(segmentIndex, 0.01, 0.5, 1.0);\n            }\n        }\n    }\n    const labelmapActor = labelmapActorEntry.actor;\n    labelmapActor.getProperty().setRGBTransferFunction(0, cfun);\n    ofun.setClamping(false);\n    labelmapActor.getProperty().setScalarOpacity(0, ofun);\n    labelmapActor.getProperty().setInterpolationTypeToNearest();\n    if (renderOutline) {\n        labelmapActor.getProperty().setUseLabelOutline(renderOutline);\n        labelmapActor.getProperty().setLabelOutlineOpacity(outlineOpacity);\n        const activeSegmentIndex = getActiveSegmentIndex(segmentationRepresentation.segmentationId);\n        const outlineWidths = new Array(numColors - 1);\n        for (let i = 1; i < numColors; i++) {\n            const isHidden = segmentsHidden.has(i);\n            if (isHidden) {\n                outlineWidths[i - 1] = 0;\n                continue;\n            }\n            outlineWidths[i - 1] =\n                i === activeSegmentIndex\n                    ? outlineWidth + activeSegmentOutlineWidthDelta\n                    : outlineWidth;\n        }\n        labelmapActor.getProperty().setLabelOutlineThickness(outlineWidths);\n    }\n    else {\n        labelmapActor\n            .getProperty()\n            .setLabelOutlineThickness(new Array(numColors - 1).fill(0));\n    }\n    const visible = isActiveLabelmap || renderInactiveSegmentations;\n    labelmapActor.setVisibility(visible);\n}\nfunction _getLabelmapConfig(labelmapConfig, isActiveLabelmap, segmentsLabelmapConfig) {\n    const segmentLabelmapConfig = segmentsLabelmapConfig || {};\n    const configToUse = {\n        ...labelmapConfig,\n        ...segmentLabelmapConfig,\n    };\n    const fillAlpha = isActiveLabelmap\n        ? configToUse.fillAlpha\n        : configToUse.fillAlphaInactive;\n    const outlineWidth = isActiveLabelmap\n        ? configToUse.outlineWidth\n        : configToUse.outlineWidthInactive;\n    const renderFill = isActiveLabelmap\n        ? configToUse.renderFill\n        : configToUse.renderFillInactive;\n    const renderOutline = isActiveLabelmap\n        ? configToUse.renderOutline\n        : configToUse.renderOutlineInactive;\n    const outlineOpacity = isActiveLabelmap\n        ? configToUse.outlineOpacity\n        : configToUse.outlineOpacityInactive;\n    const activeSegmentOutlineWidthDelta = configToUse.activeSegmentOutlineWidthDelta;\n    return {\n        fillAlpha,\n        outlineWidth,\n        renderFill,\n        renderOutline,\n        outlineOpacity,\n        activeSegmentOutlineWidthDelta,\n    };\n}\nfunction _needsTransferFunctionUpdate(viewportId, segmentationId, segmentIndex, { fillAlpha, renderFill, renderOutline, segmentColor, outlineWidth, segmentsHidden, cfun, ofun, }) {\n    const cacheUID = `${viewportId}-${segmentationId}-${segmentIndex}`;\n    const oldConfig = labelMapConfigCache.get(cacheUID);\n    if (!oldConfig) {\n        labelMapConfigCache.set(cacheUID, {\n            fillAlpha,\n            renderFill,\n            renderOutline,\n            outlineWidth,\n            segmentColor: segmentColor.slice(),\n            segmentsHidden: new Set(segmentsHidden),\n            cfunMTime: cfun.getMTime(),\n            ofunMTime: ofun.getMTime(),\n        });\n        return {\n            forceOpacityUpdate: true,\n            forceColorUpdate: true,\n        };\n    }\n    const { fillAlpha: oldFillAlpha, renderFill: oldRenderFill, renderOutline: oldRenderOutline, outlineWidth: oldOutlineWidth, segmentColor: oldSegmentColor, segmentsHidden: oldSegmentsHidden, cfunMTime: oldCfunMTime, ofunMTime: oldOfunMTime, } = oldConfig;\n    const forceColorUpdate = oldSegmentColor[0] !== segmentColor[0] ||\n        oldSegmentColor[1] !== segmentColor[1] ||\n        oldSegmentColor[2] !== segmentColor[2];\n    const forceOpacityUpdate = oldSegmentColor[3] !== segmentColor[3] ||\n        oldFillAlpha !== fillAlpha ||\n        oldRenderFill !== renderFill ||\n        oldRenderOutline !== renderOutline ||\n        oldOutlineWidth !== outlineWidth ||\n        oldSegmentsHidden !== segmentsHidden;\n    if (forceOpacityUpdate || forceColorUpdate) {\n        labelMapConfigCache.set(cacheUID, {\n            fillAlpha,\n            renderFill,\n            renderOutline,\n            outlineWidth,\n            segmentColor: segmentColor.slice(),\n            segmentsHidden: new Set(segmentsHidden),\n            cfunMTime: cfun.getMTime(),\n            ofunMTime: ofun.getMTime(),\n        });\n    }\n    return {\n        forceOpacityUpdate,\n        forceColorUpdate,\n    };\n}\nasync function _addLabelmapToViewport(viewport, labelmapData, segmentationId) {\n    await addLabelmapToElement(viewport.element, labelmapData, segmentationId);\n}\nexport default {\n    render,\n    removeRepresentation,\n};\nexport { render, removeRepresentation };\n","import { cache, getEnabledElementByViewportId, Enums, } from '@cornerstonejs/core';\nimport Representations from '../../../enums/SegmentationRepresentations';\nimport removeSurfaceFromElement from './removeSurfaceFromElement';\nimport addOrUpdateSurfaceToElement from './addOrUpdateSurfaceToElement';\nimport { getSegmentation } from '../../../stateManagement/segmentation/getSegmentation';\nimport { getColorLUT } from '../../../stateManagement/segmentation/getColorLUT';\nimport { canComputeRequestedRepresentation } from '../../../stateManagement/segmentation/polySeg/canComputeRequestedRepresentation';\nimport { computeAndAddSurfaceRepresentation } from '../../../stateManagement/segmentation/polySeg/Surface/computeAndAddSurfaceRepresentation';\nconst { ViewportType } = Enums;\nfunction removeRepresentation(viewportId, segmentationId, renderImmediate = false) {\n    const enabledElement = getEnabledElementByViewportId(viewportId);\n    if (!enabledElement) {\n        return;\n    }\n    const { viewport } = enabledElement;\n    removeSurfaceFromElement(viewport.element, segmentationId);\n    if (!renderImmediate) {\n        return;\n    }\n    viewport.render();\n}\nasync function render(viewport, representation) {\n    const { segmentationId } = representation;\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation) {\n        return;\n    }\n    let SurfaceData = segmentation.representationData[Representations.Surface];\n    if (!SurfaceData &&\n        canComputeRequestedRepresentation(segmentationId, Representations.Surface)) {\n        SurfaceData = await computeAndAddSurfaceRepresentation(segmentationId, {\n            viewport,\n        });\n        if (!SurfaceData) {\n            throw new Error(`No Surface data found for segmentationId ${segmentationId}.`);\n        }\n    }\n    const { geometryIds } = SurfaceData;\n    if (!geometryIds?.size) {\n        console.warn(`No Surfaces found for segmentationId ${segmentationId}. Skipping render.`);\n    }\n    const { colorLUTIndex } = representation;\n    const colorLUT = getColorLUT(colorLUTIndex);\n    const surfaces = [];\n    geometryIds.forEach((geometryId) => {\n        const geometry = cache.getGeometry(geometryId);\n        if (!geometry?.data) {\n            console.warn(`No Surfaces found for geometryId ${geometryId}. Skipping render.`);\n            return;\n        }\n        const segmentIndex = geometry.data.segmentIndex;\n        const surface = geometry.data;\n        const color = colorLUT[segmentIndex];\n        surface.color = color.slice(0, 3);\n        surfaces.push(surface);\n        addOrUpdateSurfaceToElement(viewport.element, surface, segmentationId);\n    });\n    viewport.render();\n}\nexport default {\n    render,\n    removeRepresentation,\n};\nexport { render, removeRepresentation };\n","import { utilities as csUtils, cache, getEnabledElement, StackViewport, eventTarget, Enums, BaseVolumeViewport, volumeLoader, } from '@cornerstonejs/core';\nimport { vec3, vec2 } from 'gl-matrix';\nimport { BaseTool } from '../base';\nimport { fillInsideSphere, thresholdInsideSphere, } from './strategies/fillSphere';\nimport { eraseInsideSphere } from './strategies/eraseSphere';\nimport { thresholdInsideCircle, fillInsideCircle, } from './strategies/fillCircle';\nimport { eraseInsideCircle } from './strategies/eraseCircle';\nimport { Events, ToolModes, SegmentationRepresentations, StrategyCallbacks, } from '../../enums';\nimport { drawCircle as drawCircleSvg } from '../../drawingSvg';\nimport { resetElementCursor, hideElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportUIDs from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { getCurrentLabelmapImageIdForViewport, getSegmentation, getStackSegmentationImageIdsForViewport, } from '../../stateManagement/segmentation/segmentationState';\nimport { getLockedSegmentIndices } from '../../stateManagement/segmentation/segmentLocking';\nimport { getActiveSegmentIndex } from '../../stateManagement/segmentation/getActiveSegmentIndex';\nimport { getSegmentIndexColor } from '../../stateManagement/segmentation/config/segmentationColor';\nimport { getActiveSegmentation } from '../../stateManagement/segmentation/getActiveSegmentation';\nclass BrushTool extends BaseTool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            strategies: {\n                FILL_INSIDE_CIRCLE: fillInsideCircle,\n                ERASE_INSIDE_CIRCLE: eraseInsideCircle,\n                FILL_INSIDE_SPHERE: fillInsideSphere,\n                ERASE_INSIDE_SPHERE: eraseInsideSphere,\n                THRESHOLD_INSIDE_CIRCLE: thresholdInsideCircle,\n                THRESHOLD_INSIDE_SPHERE: thresholdInsideSphere,\n            },\n            strategySpecificConfiguration: {\n                THRESHOLD: {\n                    threshold: [-150, -70],\n                },\n            },\n            defaultStrategy: 'FILL_INSIDE_CIRCLE',\n            activeStrategy: 'FILL_INSIDE_CIRCLE',\n            thresholdVolumeId: null,\n            brushSize: 25,\n            preview: {\n                enabled: false,\n                previewColors: {},\n                previewTimeMs: 250,\n                previewMoveDistance: 8,\n                dragMoveDistance: 4,\n                dragTimeMs: 500,\n            },\n            actions: {\n                [StrategyCallbacks.AcceptPreview]: {\n                    method: StrategyCallbacks.AcceptPreview,\n                    bindings: [\n                        {\n                            key: 'Enter',\n                        },\n                    ],\n                },\n                [StrategyCallbacks.RejectPreview]: {\n                    method: StrategyCallbacks.RejectPreview,\n                    bindings: [\n                        {\n                            key: 'Escape',\n                        },\n                    ],\n                },\n            },\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this._previewData = {\n            preview: null,\n            element: null,\n            timerStart: 0,\n            timer: null,\n            startPoint: [NaN, NaN],\n            isDrag: false,\n        };\n        this.onSetToolPassive = (evt) => {\n            this.disableCursor();\n        };\n        this.onSetToolEnabled = () => {\n            this.disableCursor();\n        };\n        this.onSetToolDisabled = (evt) => {\n            this.disableCursor();\n        };\n        this.preMouseDownCallback = (evt) => {\n            const eventData = evt.detail;\n            const { element } = eventData;\n            const enabledElement = getEnabledElement(element);\n            this._editData = this.createEditData(element);\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            this._previewData.isDrag = false;\n            this._previewData.timerStart = Date.now();\n            const hoverData = this._hoverData || this.createHoverData(element);\n            triggerAnnotationRenderForViewportUIDs(hoverData.viewportIdsToRender);\n            const operationData = this.getOperationData(element);\n            this.applyActiveStrategyCallback(enabledElement, operationData, StrategyCallbacks.OnInteractionStart);\n            return true;\n        };\n        this.mouseMoveCallback = (evt) => {\n            if (this.mode === ToolModes.Active) {\n                this.updateCursor(evt);\n                if (!this.configuration.preview.enabled) {\n                    return;\n                }\n                const { previewTimeMs, previewMoveDistance, dragMoveDistance } = this.configuration.preview;\n                const { currentPoints, element } = evt.detail;\n                const { canvas } = currentPoints;\n                const { preview, startPoint, timer, timerStart, isDrag } = this._previewData;\n                const delta = vec2.distance(canvas, startPoint);\n                const time = Date.now() - timerStart;\n                if (delta > previewMoveDistance ||\n                    (time > previewTimeMs && delta > dragMoveDistance)) {\n                    if (timer) {\n                        window.clearTimeout(timer);\n                        this._previewData.timer = null;\n                    }\n                    if (preview && !isDrag) {\n                        this.rejectPreview(element);\n                    }\n                }\n                if (!this._previewData.timer) {\n                    const timer = window.setTimeout(this.previewCallback, 250);\n                    Object.assign(this._previewData, {\n                        timerStart: Date.now(),\n                        timer,\n                        startPoint: canvas,\n                        element,\n                    });\n                }\n            }\n        };\n        this.previewCallback = () => {\n            this._previewData.timer = null;\n            if (this._previewData.preview) {\n                return;\n            }\n            this._previewData.preview = this.applyActiveStrategyCallback(getEnabledElement(this._previewData.element), this.getOperationData(this._previewData.element), StrategyCallbacks.Preview);\n        };\n        this._dragCallback = (evt) => {\n            const eventData = evt.detail;\n            const { element, currentPoints } = eventData;\n            const enabledElement = getEnabledElement(element);\n            this.updateCursor(evt);\n            const { viewportIdsToRender } = this._hoverData;\n            triggerAnnotationRenderForViewportUIDs(viewportIdsToRender);\n            const delta = vec2.distance(currentPoints.canvas, this._previewData.startPoint);\n            const { dragTimeMs, dragMoveDistance } = this.configuration.preview;\n            if (!this._previewData.isDrag &&\n                this._previewData.preview &&\n                Date.now() - this._previewData.timerStart < dragTimeMs &&\n                delta < dragMoveDistance) {\n                return;\n            }\n            this._previewData.preview = this.applyActiveStrategy(enabledElement, this.getOperationData(element));\n            this._previewData.element = element;\n            this._previewData.timerStart = Date.now() + dragTimeMs;\n            this._previewData.isDrag = true;\n            this._previewData.startPoint = currentPoints.canvas;\n        };\n        this._endCallback = (evt) => {\n            const eventData = evt.detail;\n            const { element } = eventData;\n            const enabledElement = getEnabledElement(element);\n            const operationData = this.getOperationData(element);\n            if (!this._previewData.preview && !this._previewData.isDrag) {\n                this.applyActiveStrategy(enabledElement, operationData);\n            }\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            this.updateCursor(evt);\n            this._editData = null;\n            this.applyActiveStrategyCallback(enabledElement, operationData, StrategyCallbacks.OnInteractionEnd);\n            if (!this._previewData.isDrag) {\n                this.acceptPreview(element);\n            }\n        };\n        this._activateDraw = (element) => {\n            element.addEventListener(Events.MOUSE_UP, this._endCallback);\n            element.addEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.addEventListener(Events.MOUSE_CLICK, this._endCallback);\n        };\n        this._deactivateDraw = (element) => {\n            element.removeEventListener(Events.MOUSE_UP, this._endCallback);\n            element.removeEventListener(Events.MOUSE_DRAG, this._dragCallback);\n            element.removeEventListener(Events.MOUSE_CLICK, this._endCallback);\n        };\n    }\n    disableCursor() {\n        this._hoverData = undefined;\n        this.rejectPreview();\n    }\n    createEditData(element) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const activeSegmentation = getActiveSegmentation(viewport.id);\n        if (!activeSegmentation) {\n            const event = new CustomEvent(Enums.Events.ERROR_EVENT, {\n                detail: {\n                    type: 'Segmentation',\n                    message: 'No active segmentation detected, create a segmentation representation before using the brush tool',\n                },\n                cancelable: true,\n            });\n            eventTarget.dispatchEvent(event);\n            return null;\n        }\n        const { segmentationId } = activeSegmentation;\n        const segmentsLocked = getLockedSegmentIndices(segmentationId);\n        const { representationData } = getSegmentation(segmentationId);\n        if (viewport instanceof BaseVolumeViewport) {\n            const { volumeId } = representationData[SegmentationRepresentations.Labelmap];\n            const actors = viewport.getActors();\n            const isStackViewport = viewport instanceof StackViewport;\n            if (isStackViewport) {\n                const event = new CustomEvent(Enums.Events.ERROR_EVENT, {\n                    detail: {\n                        type: 'Segmentation',\n                        message: 'Cannot perform brush operation on the selected viewport',\n                    },\n                    cancelable: true,\n                });\n                eventTarget.dispatchEvent(event);\n                return null;\n            }\n            const volumes = actors.map((actorEntry) => cache.getVolume(actorEntry.referencedId));\n            const segmentationVolume = cache.getVolume(volumeId);\n            const referencedVolumeIdToThreshold = volumes.find((volume) => csUtils.isEqual(volume.dimensions, segmentationVolume.dimensions))?.volumeId || volumes[0]?.volumeId;\n            return {\n                volumeId,\n                referencedVolumeId: this.configuration.thresholdVolumeId ?? referencedVolumeIdToThreshold,\n                segmentsLocked,\n            };\n        }\n        else {\n            const segmentationImageId = getCurrentLabelmapImageIdForViewport(viewport.id, segmentationId);\n            if (!segmentationImageId) {\n                return;\n            }\n            if (this.configuration.activeStrategy.includes('SPHERE')) {\n                const referencedImageIds = viewport.getImageIds();\n                const isValidVolumeForSphere = csUtils.isValidVolume(referencedImageIds);\n                if (!isValidVolumeForSphere) {\n                    throw new Error('Volume is not reconstructable for sphere manipulation');\n                }\n                const volumeId = `${segmentationId}_${viewport.id}`;\n                const volume = cache.getVolume(volumeId);\n                if (volume) {\n                    return {\n                        imageId: segmentationImageId,\n                        segmentsLocked,\n                        override: {\n                            voxelManager: volume.voxelManager,\n                            imageData: volume.imageData,\n                        },\n                    };\n                }\n                else {\n                    const labelmapImageIds = getStackSegmentationImageIdsForViewport(viewport.id, segmentationId);\n                    if (!labelmapImageIds || labelmapImageIds.length === 1) {\n                        return {\n                            imageId: segmentationImageId,\n                            segmentsLocked,\n                        };\n                    }\n                    const volume = volumeLoader.createAndCacheVolumeFromImagesSync(volumeId, labelmapImageIds);\n                    return {\n                        imageId: segmentationImageId,\n                        segmentsLocked,\n                        override: {\n                            voxelManager: volume.voxelManager,\n                            imageData: volume.imageData,\n                        },\n                    };\n                }\n            }\n            else {\n                return {\n                    imageId: segmentationImageId,\n                    segmentsLocked,\n                };\n            }\n        }\n    }\n    createHoverData(element, centerCanvas) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const camera = viewport.getCamera();\n        const { viewPlaneNormal, viewUp } = camera;\n        const viewportIdsToRender = [viewport.id];\n        const { segmentIndex, segmentationId, segmentColor } = this.getActiveSegmentationData(viewport) || {};\n        const brushCursor = {\n            metadata: {\n                viewPlaneNormal: [...viewPlaneNormal],\n                viewUp: [...viewUp],\n                FrameOfReferenceUID: viewport.getFrameOfReferenceUID(),\n                referencedImageId: '',\n                toolName: this.getToolName(),\n                segmentColor,\n            },\n            data: {},\n        };\n        return {\n            brushCursor,\n            centerCanvas,\n            segmentIndex,\n            viewport,\n            segmentationId,\n            segmentColor,\n            viewportIdsToRender,\n        };\n    }\n    getActiveSegmentationData(viewport) {\n        const viewportId = viewport.id;\n        const activeRepresentation = getActiveSegmentation(viewportId);\n        if (!activeRepresentation) {\n            return;\n        }\n        const { segmentationId } = activeRepresentation;\n        const segmentIndex = getActiveSegmentIndex(segmentationId);\n        if (!segmentIndex) {\n            return;\n        }\n        const segmentColor = getSegmentIndexColor(viewportId, segmentationId, segmentIndex);\n        return {\n            segmentIndex,\n            segmentationId,\n            segmentColor,\n        };\n    }\n    updateCursor(evt) {\n        const eventData = evt.detail;\n        const { element } = eventData;\n        const { currentPoints } = eventData;\n        const centerCanvas = currentPoints.canvas;\n        this._hoverData = this.createHoverData(element, centerCanvas);\n        this._calculateCursor(element, centerCanvas);\n        if (!this._hoverData) {\n            return;\n        }\n        triggerAnnotationRenderForViewportUIDs(this._hoverData.viewportIdsToRender);\n    }\n    getOperationData(element) {\n        const editData = this._editData || this.createEditData(element);\n        const { segmentIndex, segmentationId, brushCursor } = this._hoverData || this.createHoverData(element);\n        const { data, metadata = {} } = brushCursor || {};\n        const { viewPlaneNormal, viewUp } = metadata;\n        const operationData = {\n            ...editData,\n            points: data?.handles?.points,\n            segmentIndex,\n            previewColors: this.configuration.preview.enabled\n                ? this.configuration.preview.previewColors\n                : null,\n            viewPlaneNormal,\n            toolGroupId: this.toolGroupId,\n            segmentationId,\n            viewUp,\n            strategySpecificConfiguration: this.configuration.strategySpecificConfiguration,\n            preview: this._previewData?.preview,\n        };\n        return operationData;\n    }\n    _calculateCursor(element, centerCanvas) {\n        const enabledElement = getEnabledElement(element);\n        const { viewport } = enabledElement;\n        const { canvasToWorld } = viewport;\n        const camera = viewport.getCamera();\n        const { brushSize } = this.configuration;\n        const viewUp = vec3.fromValues(camera.viewUp[0], camera.viewUp[1], camera.viewUp[2]);\n        const viewPlaneNormal = vec3.fromValues(camera.viewPlaneNormal[0], camera.viewPlaneNormal[1], camera.viewPlaneNormal[2]);\n        const viewRight = vec3.create();\n        vec3.cross(viewRight, viewUp, viewPlaneNormal);\n        const centerCursorInWorld = canvasToWorld([\n            centerCanvas[0],\n            centerCanvas[1],\n        ]);\n        const bottomCursorInWorld = vec3.create();\n        const topCursorInWorld = vec3.create();\n        const leftCursorInWorld = vec3.create();\n        const rightCursorInWorld = vec3.create();\n        for (let i = 0; i <= 2; i++) {\n            bottomCursorInWorld[i] = centerCursorInWorld[i] - viewUp[i] * brushSize;\n            topCursorInWorld[i] = centerCursorInWorld[i] + viewUp[i] * brushSize;\n            leftCursorInWorld[i] = centerCursorInWorld[i] - viewRight[i] * brushSize;\n            rightCursorInWorld[i] = centerCursorInWorld[i] + viewRight[i] * brushSize;\n        }\n        if (!this._hoverData) {\n            return;\n        }\n        const { brushCursor } = this._hoverData;\n        const { data } = brushCursor;\n        if (data.handles === undefined) {\n            data.handles = {};\n        }\n        data.handles.points = [\n            bottomCursorInWorld,\n            topCursorInWorld,\n            leftCursorInWorld,\n            rightCursorInWorld,\n        ];\n        const activeStrategy = this.configuration.activeStrategy;\n        const strategy = this.configuration.strategies[activeStrategy];\n        if (typeof strategy.computeInnerCircleRadius === 'function') {\n            strategy.computeInnerCircleRadius({\n                configuration: this.configuration,\n                viewport,\n            });\n        }\n        data.invalidated = false;\n    }\n    rejectPreview(element = this._previewData.element) {\n        if (!element || !this._previewData.preview) {\n            return;\n        }\n        const enabledElement = getEnabledElement(element);\n        this.applyActiveStrategyCallback(enabledElement, this.getOperationData(element), StrategyCallbacks.RejectPreview);\n        this._previewData.preview = null;\n        this._previewData.isDrag = false;\n    }\n    acceptPreview(element = this._previewData.element) {\n        if (!element) {\n            return;\n        }\n        const enabledElement = getEnabledElement(element);\n        this.applyActiveStrategyCallback(enabledElement, this.getOperationData(element), StrategyCallbacks.AcceptPreview);\n        this._previewData.isDrag = false;\n        this._previewData.preview = null;\n    }\n    invalidateBrushCursor() {\n        if (this._hoverData === undefined) {\n            return;\n        }\n        const { data } = this._hoverData.brushCursor;\n        const { viewport } = this._hoverData;\n        data.invalidated = true;\n        const { segmentColor } = this.getActiveSegmentationData(viewport) || {};\n        this._hoverData.brushCursor.metadata.segmentColor = segmentColor;\n    }\n    renderAnnotation(enabledElement, svgDrawingHelper) {\n        if (!this._hoverData) {\n            return;\n        }\n        const { viewport } = enabledElement;\n        const viewportIdsToRender = this._hoverData.viewportIdsToRender;\n        if (!viewportIdsToRender.includes(viewport.id)) {\n            return;\n        }\n        const brushCursor = this._hoverData.brushCursor;\n        if (brushCursor.data.invalidated === true) {\n            const { centerCanvas } = this._hoverData;\n            const { element } = viewport;\n            this._calculateCursor(element, centerCanvas);\n        }\n        const toolMetadata = brushCursor.metadata;\n        if (!toolMetadata) {\n            return;\n        }\n        const annotationUID = toolMetadata.brushCursorUID;\n        const data = brushCursor.data;\n        const { points } = data.handles;\n        const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n        const bottom = canvasCoordinates[0];\n        const top = canvasCoordinates[1];\n        const center = [\n            Math.floor((bottom[0] + top[0]) / 2),\n            Math.floor((bottom[1] + top[1]) / 2),\n        ];\n        const radius = Math.abs(bottom[1] - Math.floor((bottom[1] + top[1]) / 2));\n        const color = `rgb(${toolMetadata.segmentColor?.slice(0, 3) || [0, 0, 0]})`;\n        if (!viewport.getRenderingEngine()) {\n            console.warn('Rendering Engine has been destroyed');\n            return;\n        }\n        const circleUID = '0';\n        drawCircleSvg(svgDrawingHelper, annotationUID, circleUID, center, radius, {\n            color,\n        });\n        const activeStrategy = this.configuration.activeStrategy;\n        const { dynamicRadiusInCanvas } = this.configuration\n            .strategySpecificConfiguration[activeStrategy] || {\n            dynamicRadiusInCanvas: 0,\n        };\n        if (dynamicRadiusInCanvas) {\n            const circleUID1 = '1';\n            drawCircleSvg(svgDrawingHelper, annotationUID, circleUID1, center, dynamicRadiusInCanvas, {\n                color,\n            });\n        }\n    }\n}\nBrushTool.toolName = 'Brush';\nexport default BrushTool;\n","import { getEnabledElement, cache, StackViewport, utilities as csUtils, } from '@cornerstonejs/core';\nimport { getCalibratedLengthUnitsAndScale } from '../../utilities/getCalibratedUnits';\nimport { vec3 } from 'gl-matrix';\nimport { addAnnotation, getAnnotations, removeAnnotation, } from '../../stateManagement';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { drawHandles as drawHandlesSvg, drawRect as drawRectSvg, drawLinkedTextBox as drawLinkedTextBoxSvg, } from '../../drawingSvg';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport throttle from '../../utilities/throttle';\nimport { getTextBoxCoordsCanvas } from '../../utilities/drawing';\nimport getWorldWidthAndHeightFromCorners from '../../utilities/planar/getWorldWidthAndHeightFromCorners';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { hideElementCursor, resetElementCursor, } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { triggerAnnotationCompleted, triggerAnnotationModified, } from '../../stateManagement/annotation/helpers/state';\nimport RectangleROITool from '../annotation/RectangleROITool';\nimport { isViewportPreScaled } from '../../utilities/viewport/isViewportPreScaled';\nimport { BasicStatsCalculator } from '../../utilities/math/basic';\nimport { filterAnnotationsWithinSamePlane } from '../../utilities/planar';\nimport { getPixelValueUnits } from '../../utilities/getPixelValueUnits';\nconst { transformWorldToIndex } = csUtils;\nclass RectangleROIStartEndThresholdTool extends RectangleROITool {\n    constructor(toolProps = {}, defaultToolProps = {\n        configuration: {\n            storePointData: false,\n            numSlicesToPropagate: 10,\n            computePointsInsideVolume: false,\n            getTextLines: defaultGetTextLines,\n            statsCalculator: BasicStatsCalculator,\n            showTextBox: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            let referencedImageId, imageVolume, volumeId;\n            if (viewport instanceof StackViewport) {\n                throw new Error('Stack Viewport Not implemented');\n            }\n            else {\n                const targetId = this.getTargetId(viewport);\n                volumeId = csUtils.getVolumeId(targetId);\n                imageVolume = cache.getVolume(volumeId);\n                referencedImageId = csUtils.getClosestImageId(imageVolume, worldPos, viewPlaneNormal);\n            }\n            const spacingInNormal = csUtils.getSpacingInNormalDirection(imageVolume, viewPlaneNormal);\n            const startCoord = this._getStartCoordinate(worldPos, viewPlaneNormal);\n            const endCoord = this._getEndCoordinate(worldPos, spacingInNormal, viewPlaneNormal);\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    enabledElement,\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    toolName: this.getToolName(),\n                    volumeId,\n                    spacingInNormal,\n                },\n                data: {\n                    label: '',\n                    startCoordinate: startCoord,\n                    endCoordinate: endCoord,\n                    cachedStats: {\n                        pointsInVolume: [],\n                        projectionPoints: [],\n                        projectionPointsImageIds: [referencedImageId],\n                        statistics: [],\n                    },\n                    handles: {\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        },\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                        activeHandleIndex: null,\n                    },\n                    labelmapUID: null,\n                },\n            };\n            this._computeProjectionPoints(annotation, imageVolume);\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 3,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this._endCallback = (evt) => {\n            const eventDetail = evt.detail;\n            const { element } = eventDetail;\n            const { annotation, viewportIdsToRender, newAnnotation, hasMoved } = this.editData;\n            const { data } = annotation;\n            if (newAnnotation && !hasMoved) {\n                return;\n            }\n            data.handles.activeHandleIndex = null;\n            this._deactivateModify(element);\n            this._deactivateDraw(element);\n            resetElementCursor(element);\n            const enabledElement = getEnabledElement(element);\n            this.editData = null;\n            this.isDrawing = false;\n            if (this.isHandleOutsideImage &&\n                this.configuration.preventHandleOutsideImage) {\n                removeAnnotation(annotation.annotationUID);\n            }\n            const targetId = this.getTargetId(enabledElement.viewport);\n            const imageVolume = cache.getVolume(targetId.split(/volumeId:|\\?/)[1]);\n            if (this.configuration.calculatePointsInsideVolume) {\n                this._computePointsInsideVolume(annotation, targetId, imageVolume, enabledElement);\n            }\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            if (newAnnotation) {\n                triggerAnnotationCompleted(annotation);\n            }\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            let annotations = getAnnotations(this.getToolName(), viewport.element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = filterAnnotationsWithinSamePlane(annotations, viewport.getCamera());\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { startCoordinate, endCoordinate } = data;\n                const { points, activeHandleIndex } = data.handles;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                styleSpecifier.annotationUID = annotationUID;\n                const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n                const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                const focalPoint = viewport.getCamera().focalPoint;\n                const viewplaneNormal = viewport.getCamera().viewPlaneNormal;\n                let startCoord = startCoordinate;\n                let endCoord = endCoordinate;\n                if (Array.isArray(startCoordinate)) {\n                    startCoord = this._getCoordinateForViewplaneNormal(startCoord, viewplaneNormal);\n                    data.startCoordinate = startCoord;\n                    data.handles.points[0][this._getIndexOfCoordinatesForViewplaneNormal(viewplaneNormal)] = startCoord;\n                    data.startCoordinate = startCoord;\n                    data.handles.points[0][this._getIndexOfCoordinatesForViewplaneNormal(viewplaneNormal)] = startCoord;\n                }\n                if (Array.isArray(endCoordinate)) {\n                    endCoord = this._getCoordinateForViewplaneNormal(endCoord, viewplaneNormal);\n                    data.endCoordinate = endCoord;\n                    data.endCoordinate = endCoord;\n                }\n                const roundedStartCoord = csUtils.roundToPrecision(startCoord);\n                const roundedEndCoord = csUtils.roundToPrecision(endCoord);\n                const coord = this._getCoordinateForViewplaneNormal(focalPoint, viewplaneNormal);\n                const roundedCoord = csUtils.roundToPrecision(coord);\n                if (roundedCoord < Math.min(roundedStartCoord, roundedEndCoord) ||\n                    roundedCoord > Math.max(roundedStartCoord, roundedEndCoord)) {\n                    continue;\n                }\n                if (annotation.invalidated) {\n                    this._throttledCalculateCachedStats(annotation, enabledElement);\n                }\n                let firstOrLastSlice = false;\n                if (roundedCoord === roundedStartCoord ||\n                    roundedCoord === roundedEndCoord) {\n                    firstOrLastSlice = true;\n                }\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null &&\n                    firstOrLastSlice) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                let lineDashToUse = lineDash;\n                if (!firstOrLastSlice) {\n                    lineDashToUse = 2;\n                }\n                const rectangleUID = '0';\n                drawRectSvg(svgDrawingHelper, annotationUID, rectangleUID, canvasCoordinates[0], canvasCoordinates[3], {\n                    color,\n                    lineDash: lineDashToUse,\n                    lineWidth,\n                });\n                renderStatus = true;\n                if (this.configuration.showTextBox &&\n                    this.configuration.calculatePointsInsideVolume) {\n                    const options = this.getLinkedTextBoxStyle(styleSpecifier, annotation);\n                    if (!options.visibility) {\n                        data.handles.textBox = {\n                            hasMoved: false,\n                            worldPosition: [0, 0, 0],\n                            worldBoundingBox: {\n                                topLeft: [0, 0, 0],\n                                topRight: [0, 0, 0],\n                                bottomLeft: [0, 0, 0],\n                                bottomRight: [0, 0, 0],\n                            },\n                        };\n                        continue;\n                    }\n                    const textLines = this.configuration.getTextLines(data);\n                    if (!textLines || textLines.length === 0) {\n                        continue;\n                    }\n                    if (!data.handles.textBox.hasMoved) {\n                        const canvasTextBoxCoords = getTextBoxCoordsCanvas(canvasCoordinates);\n                        data.handles.textBox.worldPosition =\n                            viewport.canvasToWorld(canvasTextBoxCoords);\n                    }\n                    const textBoxPosition = viewport.worldToCanvas(data.handles.textBox.worldPosition);\n                    const textBoxUID = '1';\n                    const boundingBox = drawLinkedTextBoxSvg(svgDrawingHelper, annotationUID, textBoxUID, textLines, textBoxPosition, canvasCoordinates, {}, options);\n                    const { x: left, y: top, width, height } = boundingBox;\n                    data.handles.textBox.worldBoundingBox = {\n                        topLeft: viewport.canvasToWorld([left, top]),\n                        topRight: viewport.canvasToWorld([left + width, top]),\n                        bottomLeft: viewport.canvasToWorld([left, top + height]),\n                        bottomRight: viewport.canvasToWorld([left + width, top + height]),\n                    };\n                }\n            }\n            return renderStatus;\n        };\n        this._throttledCalculateCachedStats = throttle(this._calculateCachedStatsTool, 100, { trailing: true });\n    }\n    _computeProjectionPoints(annotation, imageVolume) {\n        const { data, metadata } = annotation;\n        const { viewPlaneNormal, spacingInNormal } = metadata;\n        const { imageData } = imageVolume;\n        const { startCoordinate, endCoordinate } = data;\n        const { points } = data.handles;\n        const startIJK = transformWorldToIndex(imageData, points[0]);\n        const endIJK = transformWorldToIndex(imageData, points[0]);\n        const startWorld = vec3.create();\n        imageData.indexToWorldVec3(startIJK, startWorld);\n        const endWorld = vec3.create();\n        imageData.indexToWorldVec3(endIJK, endWorld);\n        if (this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) == 2) {\n            startWorld[2] = startCoordinate;\n            endWorld[2] = endCoordinate;\n        }\n        else if (this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) == 0) {\n            startWorld[0] = startCoordinate;\n            endWorld[0] = endCoordinate;\n        }\n        else if (this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) == 1) {\n            startWorld[1] = startCoordinate;\n            endWorld[1] = endCoordinate;\n        }\n        const distance = vec3.distance(startWorld, endWorld);\n        const newProjectionPoints = [];\n        for (let dist = 0; dist < distance; dist += spacingInNormal) {\n            newProjectionPoints.push(points.map((point) => {\n                const newPoint = vec3.create();\n                vec3.scaleAndAdd(newPoint, point, viewPlaneNormal, dist);\n                return Array.from(newPoint);\n            }));\n        }\n        data.cachedStats.projectionPoints = newProjectionPoints;\n    }\n    _computePointsInsideVolume(annotation, targetId, imageVolume, enabledElement) {\n        const { data, metadata } = annotation;\n        const { viewPlaneNormal, viewUp } = metadata;\n        const { viewport } = enabledElement;\n        const projectionPoints = data.cachedStats.projectionPoints;\n        const pointsInsideVolume = [[]];\n        const image = this.getTargetImageData(targetId);\n        const worldPos1 = data.handles.points[0];\n        const worldPos2 = data.handles.points[3];\n        const { worldWidth, worldHeight } = getWorldWidthAndHeightFromCorners(viewPlaneNormal, viewUp, worldPos1, worldPos2);\n        const measureInfo = getCalibratedLengthUnitsAndScale(image, data.habdles);\n        const area = Math.abs(worldWidth * worldHeight) /\n            (measureInfo.scale * measureInfo.scale);\n        const modalityUnitOptions = {\n            isPreScaled: isViewportPreScaled(viewport, targetId),\n            isSuvScaled: this.isSuvScaled(viewport, targetId, annotation.metadata.referencedImageId),\n        };\n        const modalityUnit = getPixelValueUnits(metadata.Modality, annotation.metadata.referencedImageId, modalityUnitOptions);\n        for (let i = 0; i < projectionPoints.length; i++) {\n            if (!imageVolume) {\n                continue;\n            }\n            const projectionPoint = projectionPoints[i][0];\n            const { dimensions, imageData, voxelManager } = imageVolume;\n            const worldPos1Index = transformWorldToIndex(imageData, worldPos1);\n            const worldProjectionPointIndex = transformWorldToIndex(imageData, projectionPoint);\n            const indexOfProjection = this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal);\n            worldPos1Index[0] = Math.floor(worldPos1Index[0]);\n            worldPos1Index[1] = Math.floor(worldPos1Index[1]);\n            worldPos1Index[2] = Math.floor(worldPos1Index[2]);\n            worldPos1Index[indexOfProjection] =\n                worldProjectionPointIndex[indexOfProjection];\n            const worldPos2Index = transformWorldToIndex(imageData, worldPos2);\n            worldPos2Index[0] = Math.floor(worldPos2Index[0]);\n            worldPos2Index[1] = Math.floor(worldPos2Index[1]);\n            worldPos2Index[2] = Math.floor(worldPos2Index[2]);\n            worldPos2Index[indexOfProjection] =\n                worldProjectionPointIndex[indexOfProjection];\n            if (this._isInsideVolume(worldPos1Index, worldPos2Index, dimensions)) {\n                this.isHandleOutsideImage = false;\n                const iMin = Math.min(worldPos1Index[0], worldPos2Index[0]);\n                const iMax = Math.max(worldPos1Index[0], worldPos2Index[0]);\n                const jMin = Math.min(worldPos1Index[1], worldPos2Index[1]);\n                const jMax = Math.max(worldPos1Index[1], worldPos2Index[1]);\n                const kMin = Math.min(worldPos1Index[2], worldPos2Index[2]);\n                const kMax = Math.max(worldPos1Index[2], worldPos2Index[2]);\n                const boundsIJK = [\n                    [iMin, iMax],\n                    [jMin, jMax],\n                    [kMin, kMax],\n                ];\n                const pointsInShape = voxelManager.forEach(this.configuration.statsCalculator.statsCallback, {\n                    boundsIJK,\n                    imageData,\n                    returnPoints: this.configuration.storePointData,\n                });\n                pointsInsideVolume.push(pointsInShape);\n            }\n        }\n        const stats = this.configuration.statsCalculator.getStatistics();\n        data.cachedStats.pointsInVolume = pointsInsideVolume;\n        data.cachedStats.statistics = {\n            Modality: metadata.Modality,\n            area,\n            mean: stats.mean?.value,\n            stdDev: stats.stdDev?.value,\n            max: stats.max?.value,\n            statsArray: stats.array,\n            areaUnit: measureInfo.areaUnit,\n            modalityUnit,\n        };\n    }\n    _calculateCachedStatsTool(annotation, enabledElement) {\n        const data = annotation.data;\n        const { viewport } = enabledElement;\n        const { cachedStats } = data;\n        const targetId = this.getTargetId(viewport);\n        const imageVolume = cache.getVolume(targetId.split(/volumeId:|\\?/)[1]);\n        this._computeProjectionPoints(annotation, imageVolume);\n        if (this.configuration.calculatePointsInsideVolume) {\n            this._computePointsInsideVolume(annotation, targetId, imageVolume, enabledElement);\n        }\n        if (this.configuration.calculatePointsInsideVolume) {\n            this._computePointsInsideVolume(annotation, targetId, imageVolume, enabledElement);\n        }\n        annotation.invalidated = false;\n        triggerAnnotationModified(annotation, viewport.element);\n        return cachedStats;\n    }\n    _getStartCoordinate(worldPos, viewPlaneNormal) {\n        const startPos = worldPos;\n        const startCoord = this._getCoordinateForViewplaneNormal(startPos, viewPlaneNormal);\n        return startCoord;\n    }\n    _getEndCoordinate(worldPos, spacingInNormal, viewPlaneNormal) {\n        const numSlicesToPropagate = this.configuration.numSlicesToPropagate;\n        const endPos = vec3.create();\n        vec3.scaleAndAdd(endPos, worldPos, viewPlaneNormal, numSlicesToPropagate * spacingInNormal);\n        const endCoord = this._getCoordinateForViewplaneNormal(endPos, viewPlaneNormal);\n        return endCoord;\n    }\n    _getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal) {\n        const viewplaneNormalAbs = [\n            Math.abs(viewPlaneNormal[0]),\n            Math.abs(viewPlaneNormal[1]),\n            Math.abs(viewPlaneNormal[2]),\n        ];\n        const indexOfDirection = viewplaneNormalAbs.indexOf(Math.max(...viewplaneNormalAbs));\n        return indexOfDirection;\n    }\n    _getCoordinateForViewplaneNormal(pos, viewPlaneNormal) {\n        const indexOfDirection = this._getIndexOfCoordinatesForViewplaneNormal(viewPlaneNormal);\n        return pos[indexOfDirection];\n    }\n}\nfunction defaultGetTextLines(data) {\n    const cachedVolumeStats = data.cachedStats.statistics;\n    const { area, mean, max, stdDev, areaUnit, modalityUnit } = cachedVolumeStats;\n    if (mean === undefined) {\n        return;\n    }\n    const textLines = [];\n    textLines.push(`Area: ${csUtils.roundNumber(area)} ${areaUnit}`);\n    textLines.push(`Mean: ${csUtils.roundNumber(mean)} ${modalityUnit}`);\n    textLines.push(`Max: ${csUtils.roundNumber(max)} ${modalityUnit}`);\n    textLines.push(`Std Dev: ${csUtils.roundNumber(stdDev)} ${modalityUnit}`);\n    return textLines;\n}\nRectangleROIStartEndThresholdTool.toolName = 'RectangleROIStartEndThreshold';\nexport default RectangleROIStartEndThresholdTool;\n","import { getEnabledElement, cache, StackViewport, utilities as csUtils, } from '@cornerstonejs/core';\nimport { addAnnotation, getAnnotations } from '../../stateManagement';\nimport { isAnnotationLocked } from '../../stateManagement/annotation/annotationLocking';\nimport { drawHandles as drawHandlesSvg, drawRect as drawRectSvg, } from '../../drawingSvg';\nimport { getViewportIdsWithToolToRender } from '../../utilities/viewportFilters';\nimport { hideElementCursor } from '../../cursors/elementCursor';\nimport triggerAnnotationRenderForViewportIds from '../../utilities/triggerAnnotationRenderForViewportIds';\nimport { isAnnotationVisible } from '../../stateManagement/annotation/annotationVisibility';\nimport { triggerAnnotationModified } from '../../stateManagement/annotation/helpers/state';\nimport RectangleROITool from '../annotation/RectangleROITool';\nclass RectangleROIThresholdTool extends RectangleROITool {\n    constructor(toolProps = {}, defaultToolProps = {\n        supportedInteractionTypes: ['Mouse', 'Touch'],\n        configuration: {\n            shadow: true,\n            preventHandleOutsideImage: false,\n        },\n    }) {\n        super(toolProps, defaultToolProps);\n        this.addNewAnnotation = (evt) => {\n            const eventDetail = evt.detail;\n            const { currentPoints, element } = eventDetail;\n            const worldPos = currentPoints.world;\n            const enabledElement = getEnabledElement(element);\n            const { viewport, renderingEngine } = enabledElement;\n            this.isDrawing = true;\n            const camera = viewport.getCamera();\n            const { viewPlaneNormal, viewUp } = camera;\n            const targetId = this.getTargetId(viewport);\n            let referencedImageId, volumeId;\n            if (viewport instanceof StackViewport) {\n                referencedImageId = targetId.split('imageId:')[1];\n            }\n            else {\n                volumeId = csUtils.getVolumeId(targetId);\n                const imageVolume = cache.getVolume(volumeId);\n                referencedImageId = csUtils.getClosestImageId(imageVolume, worldPos, viewPlaneNormal);\n            }\n            const FrameOfReferenceUID = viewport.getFrameOfReferenceUID();\n            const annotation = {\n                highlighted: true,\n                invalidated: true,\n                metadata: {\n                    viewPlaneNormal: [...viewPlaneNormal],\n                    enabledElement,\n                    viewUp: [...viewUp],\n                    FrameOfReferenceUID,\n                    referencedImageId,\n                    toolName: this.getToolName(),\n                    volumeId,\n                },\n                data: {\n                    label: '',\n                    handles: {\n                        textBox: {\n                            hasMoved: false,\n                            worldPosition: null,\n                            worldBoundingBox: null,\n                        },\n                        points: [\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                            [...worldPos],\n                        ],\n                        activeHandleIndex: null,\n                    },\n                    segmentationId: null,\n                },\n            };\n            addAnnotation(annotation, element);\n            const viewportIdsToRender = getViewportIdsWithToolToRender(element, this.getToolName());\n            this.editData = {\n                annotation,\n                viewportIdsToRender,\n                handleIndex: 3,\n                newAnnotation: true,\n                hasMoved: false,\n            };\n            this._activateDraw(element);\n            hideElementCursor(element);\n            evt.preventDefault();\n            triggerAnnotationRenderForViewportIds(viewportIdsToRender);\n            return annotation;\n        };\n        this.renderAnnotation = (enabledElement, svgDrawingHelper) => {\n            let renderStatus = false;\n            const { viewport } = enabledElement;\n            const { element } = viewport;\n            let annotations = getAnnotations(this.getToolName(), element);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            annotations = this.filterInteractableAnnotationsForElement(element, annotations);\n            if (!annotations?.length) {\n                return renderStatus;\n            }\n            const styleSpecifier = {\n                toolGroupId: this.toolGroupId,\n                toolName: this.getToolName(),\n                viewportId: enabledElement.viewport.id,\n            };\n            for (let i = 0; i < annotations.length; i++) {\n                const annotation = annotations[i];\n                const { annotationUID, data } = annotation;\n                const { points, activeHandleIndex } = data.handles;\n                const canvasCoordinates = points.map((p) => viewport.worldToCanvas(p));\n                styleSpecifier.annotationUID = annotationUID;\n                const lineWidth = this.getStyle('lineWidth', styleSpecifier, annotation);\n                const lineDash = this.getStyle('lineDash', styleSpecifier, annotation);\n                const color = this.getStyle('color', styleSpecifier, annotation);\n                if (!viewport.getRenderingEngine()) {\n                    console.warn('Rendering Engine has been destroyed');\n                    return renderStatus;\n                }\n                triggerAnnotationModified(annotation, element);\n                let activeHandleCanvasCoords;\n                if (!isAnnotationVisible(annotationUID)) {\n                    continue;\n                }\n                if (!isAnnotationLocked(annotationUID) &&\n                    !this.editData &&\n                    activeHandleIndex !== null) {\n                    activeHandleCanvasCoords = [canvasCoordinates[activeHandleIndex]];\n                }\n                if (activeHandleCanvasCoords) {\n                    const handleGroupUID = '0';\n                    drawHandlesSvg(svgDrawingHelper, annotationUID, handleGroupUID, activeHandleCanvasCoords, {\n                        color,\n                    });\n                }\n                const rectangleUID = '0';\n                drawRectSvg(svgDrawingHelper, annotationUID, rectangleUID, canvasCoordinates[0], canvasCoordinates[3], {\n                    color,\n                    lineDash,\n                    lineWidth,\n                });\n                renderStatus = true;\n            }\n            return renderStatus;\n        };\n    }\n}\nRectangleROIThresholdTool.toolName = 'RectangleROIThreshold';\nexport default RectangleROIThresholdTool;\n","export var ContourWindingDirection;\n(function (ContourWindingDirection) {\n    ContourWindingDirection[ContourWindingDirection[\"CounterClockwise\"] = -1] = \"CounterClockwise\";\n    ContourWindingDirection[ContourWindingDirection[\"Unknown\"] = 0] = \"Unknown\";\n    ContourWindingDirection[ContourWindingDirection[\"Clockwise\"] = 1] = \"Clockwise\";\n})(ContourWindingDirection || (ContourWindingDirection = {}));\n","import { getEnabledElements, utilities as csUtils } from '@cornerstonejs/core';\nconst { isEqual } = csUtils;\nexport default function getViewportsForAnnotation(annotation) {\n    const { metadata } = annotation;\n    return getEnabledElements()\n        .filter((enabledElement) => {\n        if (enabledElement.FrameOfReferenceUID === metadata.FrameOfReferenceUID) {\n            const viewport = enabledElement.viewport;\n            const { viewPlaneNormal, viewUp } = viewport.getCamera();\n            return (isEqual(viewPlaneNormal, metadata.viewPlaneNormal) &&\n                (!metadata.viewUp || isEqual(viewUp, metadata.viewUp)));\n        }\n        return;\n    })\n        .map((enabledElement) => enabledElement.viewport);\n}\n","import { utilities, triggerEvent } from '@cornerstonejs/core';\nimport { getAnnotationNearPoint, getAnnotationNearPointOnEnabledElement, } from './getAnnotationNearPoint';\nimport debounce from './debounce';\nimport throttle from './throttle';\nimport isObject from './isObject';\nimport calibrateImageSpacing from './calibrateImageSpacing';\nimport { getCalibratedLengthUnitsAndScale, getCalibratedProbeUnitsAndValue, getCalibratedAspect, } from './getCalibratedUnits';\nimport triggerAnnotationRenderForViewportIds from './triggerAnnotationRenderForViewportIds';\nimport triggerAnnotationRenderForToolGroupIds from './triggerAnnotationRenderForToolGroupIds';\nimport triggerAnnotationRender from './triggerAnnotationRender';\nimport { getSphereBoundsInfo } from './getSphereBoundsInfo';\nimport { pointToString } from './pointToString';\nimport annotationFrameRange from './annotationFrameRange';\nimport getViewportForAnnotation from './getViewportForAnnotation';\nimport { annotationHydration, getClosestImageIdForStackViewport, } from './annotationHydration';\nimport * as contours from './contours';\nimport * as segmentation from './segmentation';\nimport * as drawing from './drawing';\nimport * as math from './math';\nimport * as planar from './planar';\nimport * as viewportFilters from './viewportFilters';\nimport * as orientation from './orientation';\nimport * as cine from './cine';\nimport * as boundingBox from './boundingBox';\nimport * as planarFreehandROITool from './planarFreehandROITool';\nimport * as rectangleROITool from './rectangleROITool';\nimport { stackPrefetch, stackContextPrefetch } from './stackPrefetch';\nimport * as viewport from './viewport';\nimport * as touch from './touch';\nimport * as dynamicVolume from './dynamicVolume';\nimport * as polyDataUtils from './polyData/utils';\nimport * as voi from './voi';\nimport * as contourSegmentation from './contourSegmentation';\nimport { pointInSurroundingSphereCallback } from './pointInSurroundingSphereCallback';\nconst roundNumber = utilities.roundNumber;\nexport { math, planar, viewportFilters, drawing, debounce, dynamicVolume, throttle, orientation, isObject, touch, triggerEvent, calibrateImageSpacing, getCalibratedLengthUnitsAndScale, getCalibratedProbeUnitsAndValue, getCalibratedAspect, segmentation, contours, triggerAnnotationRenderForViewportIds, triggerAnnotationRenderForToolGroupIds, triggerAnnotationRender, getSphereBoundsInfo, getAnnotationNearPoint, getViewportForAnnotation, getAnnotationNearPointOnEnabledElement, viewport, cine, boundingBox, rectangleROITool, planarFreehandROITool, stackPrefetch, stackContextPrefetch, roundNumber, pointToString, polyDataUtils, voi, annotationFrameRange, contourSegmentation, annotationHydration, getClosestImageIdForStackViewport, pointInSurroundingSphereCallback, };\n","export default function findClosestPoint(sourcePoints, targetPoint) {\n    let minPoint = [0, 0];\n    let minDistance = Number.MAX_SAFE_INTEGER;\n    sourcePoints.forEach(function (sourcePoint) {\n        const distance = _distanceBetween(targetPoint, sourcePoint);\n        if (distance < minDistance) {\n            minDistance = distance;\n            minPoint = [...sourcePoint];\n        }\n    });\n    return minPoint;\n}\nfunction _distanceBetween(p1, p2) {\n    const [x1, y1] = p1;\n    const [x2, y2] = p2;\n    return Math.sqrt(Math.pow(x1 - x2, 2) + Math.pow(y1 - y2, 2));\n}\n","import { cache } from '@cornerstonejs/core';\nimport { SegmentationRepresentations } from '../../enums';\nimport { getCachedSegmentIndices, setCachedSegmentIndices } from './utilities';\nimport { getSegmentation } from '../../stateManagement/segmentation/getSegmentation';\nfunction getUniqueSegmentIndices(segmentationId) {\n    const cachedResult = getCachedSegmentIndices(segmentationId);\n    if (cachedResult) {\n        return cachedResult;\n    }\n    const segmentation = getSegmentation(segmentationId);\n    if (!segmentation) {\n        throw new Error(`No segmentation found for segmentationId ${segmentationId}`);\n    }\n    let indices;\n    if (segmentation.representationData.Labelmap) {\n        indices = handleLabelmapSegmentation(segmentation, segmentationId);\n    }\n    else if (segmentation.representationData.Contour) {\n        indices = handleContourSegmentation(segmentation);\n    }\n    else if (segmentation.representationData.Surface) {\n        indices = handleSurfaceSegmentation(segmentation);\n    }\n    else {\n        throw new Error(`Unsupported segmentation type: ${segmentation.representationData}`);\n    }\n    setCachedSegmentIndices(segmentationId, indices);\n    return indices;\n}\nfunction handleLabelmapSegmentation(segmentation, segmentationId) {\n    const labelmapData = segmentation.representationData[SegmentationRepresentations.Labelmap];\n    const keySet = new Set();\n    if (labelmapData.imageIds) {\n        addImageSegmentIndices(keySet, labelmapData.imageIds);\n    }\n    else {\n        addVolumeSegmentIndices(keySet, segmentationId);\n    }\n    return Array.from(keySet)\n        .map(Number)\n        .sort((a, b) => a - b);\n}\nfunction addVolumeSegmentIndices(keySet, segmentationId) {\n    const volume = cache.getVolume(segmentationId);\n    volume.voxelManager.forEach(({ value }) => {\n        if (value !== 0) {\n            keySet.add(value);\n        }\n    });\n}\nfunction addImageSegmentIndices(keySet, imageIds) {\n    imageIds.forEach((segmentationImageId) => {\n        const image = cache.getImage(segmentationImageId);\n        const scalarData = image.voxelManager.getScalarData();\n        scalarData.forEach((segmentIndex) => {\n            if (segmentIndex !== 0) {\n                keySet.add(segmentIndex);\n            }\n        });\n    });\n}\nfunction handleContourSegmentation(segmentation) {\n    const { annotationUIDsMap, geometryIds } = segmentation.representationData.Contour || {};\n    if (!geometryIds) {\n        throw new Error(`No geometryIds found for segmentationId ${segmentation.segmentationId}`);\n    }\n    const indices = new Set([...annotationUIDsMap.keys()]);\n    geometryIds.forEach((geometryId) => {\n        const geometry = cache.getGeometry(geometryId);\n        indices.add(geometry.data.segmentIndex);\n    });\n    return Array.from(indices).sort((a, b) => a - b);\n}\nfunction handleSurfaceSegmentation(segmentation) {\n    const geometryIds = segmentation.representationData.Surface?.geometryIds ?? [];\n    return Array.from(geometryIds.keys())\n        .map(Number)\n        .sort((a, b) => a - b);\n}\nexport { getUniqueSegmentIndices };\n","import { getToolGroup } from '../../store/ToolGroupManager';\nimport triggerAnnotationRenderForViewportIds from '../triggerAnnotationRenderForViewportIds';\nimport { getBrushToolInstances } from './getBrushToolInstances';\nexport function invalidateBrushCursor(toolGroupId) {\n    const toolGroup = getToolGroup(toolGroupId);\n    if (toolGroup === undefined) {\n        return;\n    }\n    const brushBasedToolInstances = getBrushToolInstances(toolGroupId);\n    brushBasedToolInstances.forEach((tool) => {\n        tool.invalidateBrushCursor();\n    });\n    const viewportsInfo = toolGroup.getViewportsInfo();\n    const viewportsInfoArray = Object.keys(viewportsInfo).map((key) => viewportsInfo[key]);\n    if (!viewportsInfoArray.length) {\n        return;\n    }\n    const viewportIds = toolGroup.getViewportIds();\n    triggerAnnotationRenderForViewportIds(viewportIds);\n}\n","import { utilities as csUtils } from '@cornerstonejs/core';\nimport { getBoundingBoxAroundShapeIJK } from '../boundingBox/getBoundingBoxAroundShape';\nconst equalsCheck = (a, b) => {\n    return JSON.stringify(a) === JSON.stringify(b);\n};\nexport function getVoxelOverlap(imageData, dimensions, voxelSpacing, voxelCenter) {\n    const halfSpacingX = voxelSpacing[0] / 2;\n    const halfSpacingY = voxelSpacing[1] / 2;\n    const halfSpacingZ = voxelSpacing[2] / 2;\n    const voxelCornersIJK = new Array(8);\n    voxelCornersIJK[0] = csUtils.transformWorldToIndex(imageData, [\n        voxelCenter[0] - halfSpacingX,\n        voxelCenter[1] - halfSpacingY,\n        voxelCenter[2] - halfSpacingZ,\n    ]);\n    const offsets = [\n        [1, -1, -1],\n        [-1, 1, -1],\n        [1, 1, -1],\n        [-1, -1, 1],\n        [1, -1, 1],\n        [-1, 1, 1],\n        [1, 1, 1],\n    ];\n    for (let i = 0; i < 7; i++) {\n        const [xOff, yOff, zOff] = offsets[i];\n        voxelCornersIJK[i + 1] = csUtils.transformWorldToIndex(imageData, [\n            voxelCenter[0] + xOff * halfSpacingX,\n            voxelCenter[1] + yOff * halfSpacingY,\n            voxelCenter[2] + zOff * halfSpacingZ,\n        ]);\n    }\n    return getBoundingBoxAroundShapeIJK(voxelCornersIJK, dimensions);\n}\nexport function processVolumes(segmentationVolume, thresholdVolumeInformation) {\n    const { spacing: segmentationSpacing } = segmentationVolume;\n    const scalarDataLength = segmentationVolume.voxelManager.getScalarDataLength();\n    const volumeInfoList = [];\n    let baseVolumeIdx = 0;\n    for (let i = 0; i < thresholdVolumeInformation.length; i++) {\n        const { imageData, spacing, dimensions, voxelManager } = thresholdVolumeInformation[i].volume;\n        const volumeSize = thresholdVolumeInformation[i].volume.voxelManager.getScalarDataLength();\n        if (volumeSize === scalarDataLength &&\n            equalsCheck(spacing, segmentationSpacing)) {\n            baseVolumeIdx = i;\n        }\n        const lower = thresholdVolumeInformation[i].lower;\n        const upper = thresholdVolumeInformation[i].upper;\n        volumeInfoList.push({\n            imageData,\n            lower,\n            upper,\n            spacing,\n            dimensions,\n            volumeSize,\n            voxelManager,\n        });\n    }\n    return {\n        volumeInfoList,\n        baseVolumeIdx,\n    };\n}\nconst segmentIndicesCache = new Map();\nexport const setSegmentationDirty = (segmentationId) => {\n    const cached = segmentIndicesCache.get(segmentationId);\n    if (cached) {\n        cached.isDirty = true;\n    }\n};\nexport const setSegmentationClean = (segmentationId) => {\n    const cached = segmentIndicesCache.get(segmentationId);\n    if (cached) {\n        cached.isDirty = false;\n    }\n};\nexport const getCachedSegmentIndices = (segmentationId) => {\n    const cached = segmentIndicesCache.get(segmentationId);\n    if (cached && !cached.isDirty) {\n        return cached.indices;\n    }\n    return null;\n};\nexport const setCachedSegmentIndices = (segmentationId, indices) => {\n    segmentIndicesCache.set(segmentationId, { indices, isDirty: false });\n};\n","import { getEnabledElementByViewportId } from '@cornerstonejs/core';\nimport triggerAnnotationRender from './triggerAnnotationRender';\nexport function triggerAnnotationRenderForViewportIds(viewportIdsToRender) {\n    if (!viewportIdsToRender.length) {\n        return;\n    }\n    viewportIdsToRender.forEach((viewportId) => {\n        const enabledElement = getEnabledElementByViewportId(viewportId);\n        if (!enabledElement) {\n            console.warn(`Viewport not available for ${viewportId}`);\n            return;\n        }\n        const { viewport } = enabledElement;\n        if (!viewport) {\n            console.warn(`Viewport not available for ${viewportId}`);\n            return;\n        }\n        const element = viewport.element;\n        triggerAnnotationRender(element);\n    });\n}\nexport default triggerAnnotationRenderForViewportIds;\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nvar DEFAULT_SIZE = 24;\n\nexports.default = function (_ref) {\n  var _ref$fill = _ref.fill,\n      fill = _ref$fill === undefined ? 'currentColor' : _ref$fill,\n      _ref$width = _ref.width,\n      width = _ref$width === undefined ? DEFAULT_SIZE : _ref$width,\n      _ref$height = _ref.height,\n      height = _ref$height === undefined ? DEFAULT_SIZE : _ref$height,\n      _ref$style = _ref.style,\n      style = _ref$style === undefined ? {} : _ref$style,\n      props = _objectWithoutProperties(_ref, ['fill', 'width', 'height', 'style']);\n\n  return _react2.default.createElement(\n    'svg',\n    _extends({\n      viewBox: '0 0 ' + DEFAULT_SIZE + ' ' + DEFAULT_SIZE,\n      style: _extends({ fill: fill, width: width, height: height }, style)\n    }, props),\n    _react2.default.createElement('path', { d: 'M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z' })\n  );\n};","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nvar DEFAULT_SIZE = 24;\n\nexports.default = function (_ref) {\n  var _ref$fill = _ref.fill,\n      fill = _ref$fill === undefined ? 'currentColor' : _ref$fill,\n      _ref$width = _ref.width,\n      width = _ref$width === undefined ? DEFAULT_SIZE : _ref$width,\n      _ref$height = _ref.height,\n      height = _ref$height === undefined ? DEFAULT_SIZE : _ref$height,\n      _ref$style = _ref.style,\n      style = _ref$style === undefined ? {} : _ref$style,\n      props = _objectWithoutProperties(_ref, ['fill', 'width', 'height', 'style']);\n\n  return _react2.default.createElement(\n    'svg',\n    _extends({\n      viewBox: '0 0 ' + DEFAULT_SIZE + ' ' + DEFAULT_SIZE,\n      style: _extends({ fill: fill, width: width, height: height }, style)\n    }, props),\n    _react2.default.createElement('path', { d: 'M12,18.17L8.83,15L7.42,16.41L12,21L16.59,16.41L15.17,15M12,5.83L15.17,9L16.58,7.59L12,3L7.41,7.59L8.83,9L12,5.83Z' })\n  );\n};","function _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, _toPropertyKey(descriptor.key), descriptor);\n  }\n}\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  Object.defineProperty(Constructor, \"prototype\", {\n    writable: false\n  });\n  return Constructor;\n}\nfunction _toConsumableArray(arr) {\n  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();\n}\nfunction _arrayWithoutHoles(arr) {\n  if (Array.isArray(arr)) return _arrayLikeToArray(arr);\n}\nfunction _iterableToArray(iter) {\n  if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter);\n}\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];\n  return arr2;\n}\nfunction _nonIterableSpread() {\n  throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\nfunction _toPrimitive(input, hint) {\n  if (typeof input !== \"object\" || input === null) return input;\n  var prim = input[Symbol.toPrimitive];\n  if (prim !== undefined) {\n    var res = prim.call(input, hint || \"default\");\n    if (typeof res !== \"object\") return res;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (hint === \"string\" ? String : Number)(input);\n}\nfunction _toPropertyKey(arg) {\n  var key = _toPrimitive(arg, \"string\");\n  return typeof key === \"symbol\" ? key : String(key);\n}\n\n/**\n * Converts a Uint8Array to a String.\n * @param {Uint8Array} array that should be converted\n * @param {Number} offset array offset in case only subset of array items should\n                   be extracted (default: 0)\n * @param {Number} limit maximum number of array items that should be extracted\n                   (defaults to length of array)\n * @returns {String}\n */\nfunction uint8ArrayToString(arr) {\n  var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n  var limit = arguments.length > 2 ? arguments[2] : undefined;\n  var itemLimit = limit || arr.length - offset;\n  var str = '';\n  for (var i = offset; i < offset + itemLimit; i++) {\n    str += String.fromCharCode(arr[i]);\n  }\n  return str;\n}\n\n/**\n * Converts a String to a Uint8Array.\n * @param {String} str string that should be converted\n * @returns {Uint8Array}\n */\nfunction stringToUint8Array(str) {\n  var arr = new Uint8Array(str.length);\n  for (var i = 0, j = str.length; i < j; i++) {\n    arr[i] = str.charCodeAt(i);\n  }\n  return arr;\n}\n\n/**\n * Identifies the boundary in a multipart/related message header.\n * @param {String} header message header\n * @returns {String} boundary\n */\nfunction identifyBoundary(header) {\n  var parts = header.split('\\r\\n');\n  for (var i = 0; i < parts.length; i++) {\n    if (parts[i].substr(0, 2) === '--') {\n      return parts[i];\n    }\n  }\n  return null;\n}\n\n/**\n * Checks whether a given token is contained by a message at a given offset.\n * @param {Uint8Array} message message content\n * @param {Uint8Array} token substring that should be present\n * @param {Number} offset offset in message content from where search should start\n * @returns {Boolean} whether message contains token at offset\n */\nfunction containsToken(message, token) {\n  var offset = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n  if (offset + token.length > message.length) {\n    return false;\n  }\n  var index = offset;\n  for (var i = 0; i < token.length; i++) {\n    if (token[i] !== message[index]) {\n      return false;\n    }\n    index += 1;\n  }\n  return true;\n}\n\n/**\n * Finds a given token in a message at a given offset.\n * @param {Uint8Array} message message content\n * @param {Uint8Array} token substring that should be found\n * @param {String} offset message body offset from where search should start\n * @returns {Boolean} whether message has a part at given offset or not\n */\nfunction findToken(message, token) {\n  var offset = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n  var maxSearchLength = arguments.length > 3 ? arguments[3] : undefined;\n  var searchLength = message.length;\n  if (maxSearchLength) {\n    searchLength = Math.min(offset + maxSearchLength, message.length);\n  }\n  for (var i = offset; i < searchLength; i++) {\n    // If the first value of the message matches\n    // the first value of the token, check if\n    // this is the full token.\n    if (message[i] === token[0]) {\n      if (containsToken(message, token, i)) {\n        return i;\n      }\n    }\n  }\n  return -1;\n}\n\n/**\n * Create a random GUID\n *\n * @return {string}\n */\nfunction guid() {\n  function s4() {\n    return Math.floor((1 + Math.random()) * 0x10000).toString(16).substring(1);\n  }\n  return \"\".concat(s4() + s4(), \"-\").concat(s4(), \"-\").concat(s4(), \"-\").concat(s4(), \"-\").concat(s4()).concat(s4()).concat(s4());\n}\n\n/**\n * @typedef {Object} MultipartEncodedData\n * @property {ArrayBuffer} data The encoded Multipart Data\n * @property {String} boundary The boundary used to divide pieces of the encoded data\n */\n\n/**\n * Encode one or more DICOM datasets into a single body so it can be\n * sent using the Multipart Content-Type.\n *\n * @param {ArrayBuffer[]} datasets Array containing each file to be encoded in the\n                          multipart body, passed as ArrayBuffers.\n * @param {String} [boundary] Optional string to define a boundary between each part\n                              of the multipart body. If this is not specified, a random\n                              GUID will be generated.\n * @return {MultipartEncodedData} The Multipart encoded data returned as an Object. This\n                                  contains both the data itself, and the boundary string\n                                  used to divide it.\n */\nfunction multipartEncode(datasets) {\n  var boundary = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : guid();\n  var contentType = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 'application/dicom';\n  var contentTypeString = \"Content-Type: \".concat(contentType);\n  var header = \"\\r\\n--\".concat(boundary, \"\\r\\n\").concat(contentTypeString, \"\\r\\n\\r\\n\");\n  var footer = \"\\r\\n--\".concat(boundary, \"--\");\n  var headerArray = stringToUint8Array(header);\n  var footerArray = stringToUint8Array(footer);\n  var headerLength = headerArray.length;\n  var footerLength = footerArray.length;\n  var length = 0;\n\n  // Calculate the total length for the final array\n  var contentArrays = datasets.map(function (datasetBuffer) {\n    var contentArray = new Uint8Array(datasetBuffer);\n    var contentLength = contentArray.length;\n    length += headerLength + contentLength + footerLength;\n    return contentArray;\n  });\n\n  // Allocate the array\n  var multipartArray = new Uint8Array(length);\n\n  // Set the initial header\n  multipartArray.set(headerArray, 0);\n\n  // Write each dataset into the multipart array\n  var position = 0;\n  contentArrays.forEach(function (contentArray) {\n    multipartArray.set(headerArray, position);\n    multipartArray.set(contentArray, position + headerLength);\n    position += headerLength + contentArray.length;\n  });\n  multipartArray.set(footerArray, position);\n  return {\n    data: multipartArray.buffer,\n    boundary: boundary\n  };\n}\n\n/**\n * Decode a Multipart encoded ArrayBuffer and return the components as an Array.\n *\n * @param {ArrayBuffer} response Data encoded as a 'multipart/related' message\n * @returns {Array} The content\n */\nfunction multipartDecode(response) {\n  // Use the raw data if it is provided in an appropriate format\n  var message = ArrayBuffer.isView(response) ? response : new Uint8Array(response);\n\n  /* Set a maximum length to search for the header boundaries, otherwise\n       findToken can run for a long time\n    */\n  var maxSearchLength = 1000;\n\n  // First look for the multipart mime header\n  var separator = stringToUint8Array('\\r\\n\\r\\n');\n  var headerIndex = findToken(message, separator, 0, maxSearchLength);\n  if (headerIndex === -1) {\n    throw new Error('Response message has no multipart mime header');\n  }\n  var header = uint8ArrayToString(message, 0, headerIndex);\n  var boundaryString = identifyBoundary(header);\n  if (!boundaryString) {\n    throw new Error('Header of response message does not specify boundary');\n  }\n  var boundary = stringToUint8Array(boundaryString);\n  var boundaryLength = boundary.length;\n  var components = [];\n  var offset = boundaryLength;\n\n  // Loop until we cannot find any more boundaries\n  var boundaryIndex;\n  while (boundaryIndex !== -1) {\n    // Search for the next boundary in the message, starting\n    // from the current offset position\n    boundaryIndex = findToken(message, boundary, offset);\n\n    // If no further boundaries are found, stop here.\n    if (boundaryIndex === -1) {\n      break;\n    }\n    var headerTokenIndex = findToken(message, separator, offset, maxSearchLength);\n    if (headerTokenIndex === -1) {\n      throw new Error('Response message part has no mime header');\n    }\n    offset = headerTokenIndex + separator.length;\n\n    // Extract data from response message, excluding \"\\r\\n\"\n    var spacingLength = 2;\n    var data = response.slice(offset, boundaryIndex - spacingLength);\n\n    // Add the data to the array of results\n    components.push(data);\n\n    // Move the offset to the end of the current section,\n    // plus the identified boundary\n    offset = boundaryIndex + boundaryLength;\n  }\n  return components;\n}\n\nfunction isObject(obj) {\n  return _typeof(obj) === 'object' && obj !== null;\n}\nfunction isEmptyObject(obj) {\n  return Object.keys(obj).length === 0 && obj.constructor === Object;\n}\nfunction areValidRequestHooks(requestHooks) {\n  var isValid = Array.isArray(requestHooks) && requestHooks.every(function (requestHook) {\n    return typeof requestHook === 'function' && requestHook.length === 2;\n  });\n  if (!isValid) {\n    console.warn('Request hooks should have the following signature: ' + 'function requestHook(request, metadata) { return request; }');\n  }\n  return isValid;\n}\nvar getFirstResult = function getFirstResult(result) {\n  return result[0];\n};\nvar MEDIATYPES = {\n  DICOM: 'application/dicom',\n  DICOM_JSON: 'application/dicom+json',\n  OCTET_STREAM: 'application/octet-stream',\n  PDF: 'application/pdf',\n  JPEG: 'image/jpeg',\n  PNG: 'image/png'\n};\n\n/**\n * debugLog is a function that can be called with console.log arguments, and will\n * be conditionally displayed, only when debug logging is enabled.\n */\nvar debugLog = function debugLog() {};\n\n/**\n * @typedef { import(\"../types/types\").InstanceMetadata } InstanceMetadata\n */\n\n/**\n * A callback with the request instance and metadata information\n * of the currently request being executed that should necessarily\n * return the given request optionally modified.\n * @typedef {function} RequestHook\n * @param {XMLHttpRequest} request - The original XMLHttpRequest instance.\n * @param {object} metadata - The metadata used by the request.\n */\n\n/**\n * Class for interacting with DICOMweb RESTful services.\n */\nvar DICOMwebClient = /*#__PURE__*/function () {\n  /**\n   * @constructor\n   * @param {Object} options\n   * @param {String} options.url - URL of the DICOMweb RESTful Service endpoint\n   * @param {String=} options.qidoURLPrefix - URL path prefix for QIDO-RS\n   * @param {String=} options.wadoURLPrefix - URL path prefix for WADO-RS\n   * @param {String=} options.stowURLPrefix - URL path prefix for STOW-RS\n   * @param {String=} options.username - Username\n   * @param {String=} options.password - Password\n   * @param {Object=} options.headers - HTTP headers\n   * @param {Array.<RequestHook>=} options.requestHooks - Request hooks.\n   * @param {Object=} options.verbose - print to console request warnings and errors, default true\n   * @param {Object=} options.debug - print to the console debug level information/status updates.\n   * @param {boolean|String} options.singlepart - retrieve singlepart for the named types.\n   * The available types are:  bulkdata, video, image.  true means all.\n   */\n  function DICOMwebClient(options) {\n    _classCallCheck(this, DICOMwebClient);\n    this.baseURL = options.url;\n    if (!this.baseURL) {\n      console.error('no DICOMweb base url provided - calls that require a URL will fail');\n    }\n    if ('username' in options) {\n      this.username = options.username;\n      if (!('password' in options)) {\n        console.error('no password provided to authenticate with DICOMweb service');\n      }\n      this.password = options.password;\n    }\n    if ('qidoURLPrefix' in options) {\n      debugLog(\"use URL prefix for QIDO-RS: \".concat(options.qidoURLPrefix));\n      this.qidoURL = \"\".concat(this.baseURL, \"/\").concat(options.qidoURLPrefix);\n    } else {\n      this.qidoURL = this.baseURL;\n    }\n    if ('wadoURLPrefix' in options) {\n      debugLog(\"use URL prefix for WADO-RS: \".concat(options.wadoURLPrefix));\n      this.wadoURL = \"\".concat(this.baseURL, \"/\").concat(options.wadoURLPrefix);\n    } else {\n      this.wadoURL = this.baseURL;\n    }\n    if ('stowURLPrefix' in options) {\n      debugLog(\"use URL prefix for STOW-RS: \".concat(options.stowURLPrefix));\n      this.stowURL = \"\".concat(this.baseURL, \"/\").concat(options.stowURLPrefix);\n    } else {\n      this.stowURL = this.baseURL;\n    }\n    if (options.singlepart) {\n      debugLog('use singlepart', options.singlepart);\n      this.singlepart = options.singlepart === true ? 'bulkdata,video,image' : options.singlepart;\n    } else {\n      this.singlepart = '';\n    }\n    if ('requestHooks' in options) {\n      this.requestHooks = options.requestHooks;\n    }\n\n    // Headers to pass to requests.\n    this.headers = options.headers || {};\n\n    // Optional error interceptor callback to handle any failed request.\n    this.errorInterceptor = options.errorInterceptor || function () {\n      return undefined;\n    };\n\n    // Verbose - print to console request warnings and errors, default true\n    this.verbose = options.verbose !== false;\n    this.setDebug(options.debug);\n  }\n\n  /**\n   * Allows setting the debug log information. \n   * Note this is different from verbose in that verbose is whether to include warning/error information, defaulting to true\n   * \n   * @param {boolean} debugLevel \n   * @param {function} debugLogFunction to call with the debug output arguments. \n   */\n  _createClass(DICOMwebClient, [{\n    key: \"setDebug\",\n    value: function setDebug() {\n      var debugLevel = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n      var debugLogFunction = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : null;\n      this.debugLevel = !!debugLevel;\n      debugLog = debugLogFunction || debugLevel ? console.log : function () {};\n    }\n    /**\n     * Gets debug flag\n     * \n     * @returns true if debug logging is enabled\n     */\n  }, {\n    key: \"getDebug\",\n    value: function getDebug() {\n      return this.debugLevel;\n    }\n    /**\n     * Sets verbose flag.\n     *\n     * @param {Boolean} verbose\n     */\n  }, {\n    key: \"setVerbose\",\n    value: function setVerbose(verbose) {\n      this.verbose = verbose;\n    }\n    /**\n     * Gets verbose flag.\n     *\n     * @return {Boolean} verbose\n     */\n  }, {\n    key: \"getVerbose\",\n    value: function getVerbose() {\n      return this.verbose;\n    }\n  }, {\n    key: \"_httpRequest\",\n    /**\n     * Performs an HTTP request.\n     *\n     * @param {String} url\n     * @param {String} method\n     * @param {Object} headers\n     * @param {Object} options\n     * @param {Array.<RequestHook>} options.requestHooks - Request hooks.\n     * @param {XMLHttpRequest} [options.request] - if specified, the request to use, otherwise one will be created; useful for adding custom upload and abort listeners/objects\n     * @return {*}\n     * @private\n     */\n    value: function _httpRequest(url, method) {\n      var _this = this;\n      var headers = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n      var errorInterceptor = this.errorInterceptor,\n        requestHooks = this.requestHooks;\n      return new Promise(function (resolve, reject) {\n        var request = options.request ? options.request : new XMLHttpRequest();\n        request.open(method, url, true);\n        if ('responseType' in options) {\n          request.responseType = options.responseType;\n        }\n        if (_typeof(headers) === 'object') {\n          Object.keys(headers).forEach(function (key) {\n            request.setRequestHeader(key, headers[key]);\n          });\n        }\n\n        // now add custom headers from the user\n        // (e.g. access tokens)\n        var userHeaders = _this.headers;\n        Object.keys(userHeaders).forEach(function (key) {\n          request.setRequestHeader(key, userHeaders[key]);\n        });\n\n        // Event triggered when upload starts\n        request.onloadstart = function onloadstart() {\n          debugLog('upload started: ', url);\n        };\n\n        // Event triggered when upload ends\n        request.onloadend = function onloadend() {\n          debugLog('upload finished');\n        };\n\n        // Handle response message\n        request.onreadystatechange = function () {\n          if (request.readyState === 4) {\n            if (request.status === 200) {\n              var contentType = request.getResponseHeader('Content-Type');\n              // Automatically distinguishes between multipart and singlepart in an array buffer, and\n              // converts them into a consistent type.\n              if (contentType && contentType.indexOf('multipart') !== -1) {\n                resolve(multipartDecode(request.response));\n              } else if (request.responseType === 'arraybuffer') {\n                resolve([request.response]);\n              } else {\n                resolve(request.response);\n              }\n            } else if (request.status === 202) {\n              if (_this.verbose) {\n                console.warn('some resources already existed: ', request);\n              }\n              resolve(request.response);\n            } else if (request.status === 204) {\n              if (_this.verbose) {\n                console.warn('empty response for request: ', request);\n              }\n              resolve([]);\n            } else {\n              var error = new Error('request failed');\n              error.request = request;\n              error.response = request.response;\n              error.status = request.status;\n              if (_this.verbose) {\n                console.error('request failed: ', request);\n                console.error(error);\n                console.error(error.response);\n              }\n              errorInterceptor(error);\n              reject(error);\n            }\n          }\n        };\n\n        // Event triggered while download progresses\n        if ('progressCallback' in options) {\n          if (typeof options.progressCallback === 'function') {\n            request.onprogress = options.progressCallback;\n          }\n        }\n        if (requestHooks && areValidRequestHooks(requestHooks)) {\n          var combinedHeaders = Object.assign({}, headers, _this.headers);\n          var metadata = {\n            method: method,\n            url: url,\n            headers: combinedHeaders\n          };\n          var pipeRequestHooks = function pipeRequestHooks(functions) {\n            return function (args) {\n              return functions.reduce(function (props, fn) {\n                return fn(props, metadata);\n              }, args);\n            };\n          };\n          var pipedRequest = pipeRequestHooks(requestHooks);\n          request = pipedRequest(request);\n        }\n\n        // Add withCredentials to request if needed\n        if ('withCredentials' in options) {\n          if (options.withCredentials) {\n            request.withCredentials = true;\n          }\n        }\n        if ('data' in options) {\n          request.send(options.data);\n        } else {\n          request.send();\n        }\n      });\n    }\n    /**\n     * Performs an HTTP GET request.\n     *\n     * @param {String} url\n     * @param {Object} headers\n     * @param {Object} responseType\n     * @param {Function} progressCallback\n     * @return {*}\n     * @private\n     */\n  }, {\n    key: \"_httpGet\",\n    value: function _httpGet(url, headers, responseType, progressCallback, withCredentials) {\n      return this._httpRequest(url, 'get', headers, {\n        responseType: responseType,\n        progressCallback: progressCallback,\n        withCredentials: withCredentials\n      });\n    }\n    /**\n     * Performs an HTTP GET request that accepts a message with application/json\n     * media type.\n     *\n     * @param {String} url\n     * @param {Object} params\n     * @param {Function} progressCallback\n     * @return {*}\n     * @private\n     */\n  }, {\n    key: \"_httpGetApplicationJson\",\n    value: function _httpGetApplicationJson(url) {\n      var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var progressCallback = arguments.length > 2 ? arguments[2] : undefined;\n      var withCredentials = arguments.length > 3 ? arguments[3] : undefined;\n      var urlWithQueryParams = url;\n      if (_typeof(params) === 'object') {\n        if (!isEmptyObject(params)) {\n          urlWithQueryParams += DICOMwebClient._parseQueryParameters(params);\n        }\n      }\n      var headers = {\n        Accept: MEDIATYPES.DICOM_JSON\n      };\n      var responseType = 'json';\n      return this._httpGet(urlWithQueryParams, headers, responseType, progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP GET request that accepts a message with application/pdf\n     * media type.\n     *\n     * @param {String} url\n     * @param {Object} params\n     * @param {Function} progressCallback\n     * @return {*}\n     * @private\n     */\n  }, {\n    key: \"_httpGetApplicationPdf\",\n    value: function _httpGetApplicationPdf(url) {\n      var params = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n      var progressCallback = arguments.length > 2 ? arguments[2] : undefined;\n      var withCredentials = arguments.length > 3 ? arguments[3] : undefined;\n      var urlWithQueryParams = url;\n      if (_typeof(params) === 'object') {\n        if (!isEmptyObject(params)) {\n          urlWithQueryParams += DICOMwebClient._parseQueryParameters(params);\n        }\n      }\n      var headers = {\n        Accept: MEDIATYPES.PDF\n      };\n      var responseType = 'json';\n      return this._httpGet(urlWithQueryParams, headers, responseType, progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP GET request that accepts a message with an image\n     media type.\n     *\n     * @param {String} url\n     * @param {Object[]} mediaTypes\n     * @param {Object} params\n     * @param {Function} progressCallback\n     * @return {*}\n     * @private\n     */\n  }, {\n    key: \"_httpGetImage\",\n    value: function _httpGetImage(url, mediaTypes) {\n      var params = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var progressCallback = arguments.length > 3 ? arguments[3] : undefined;\n      var withCredentials = arguments.length > 4 ? arguments[4] : undefined;\n      var urlWithQueryParams = url;\n      if (_typeof(params) === 'object') {\n        if (!isEmptyObject(params)) {\n          urlWithQueryParams += DICOMwebClient._parseQueryParameters(params);\n        }\n      }\n      var supportedMediaTypes = ['image/', 'image/*', 'image/jpeg', 'image/jp2', 'image/gif', 'image/png'];\n      var acceptHeaderFieldValue = DICOMwebClient._buildAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes);\n      var headers = {\n        Accept: acceptHeaderFieldValue\n      };\n      var responseType = 'arraybuffer';\n      return this._httpGet(urlWithQueryParams, headers, responseType, progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP GET request that accepts a message with a text\n     media type.\n     *\n     * @param {String} url\n     * @param {Object[]} mediaTypes\n     * @param {Object} params\n     * @param {Function} progressCallback\n     * @return {*}\n     * @private\n     */\n  }, {\n    key: \"_httpGetText\",\n    value: function _httpGetText(url, mediaTypes) {\n      var params = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var progressCallback = arguments.length > 3 ? arguments[3] : undefined;\n      var withCredentials = arguments.length > 4 ? arguments[4] : undefined;\n      var urlWithQueryParams = url;\n      if (_typeof(params) === 'object') {\n        if (!isEmptyObject(params)) {\n          urlWithQueryParams += DICOMwebClient._parseQueryParameters(params);\n        }\n      }\n      var supportedMediaTypes = ['text/', 'text/*', 'text/html', 'text/plain', 'text/rtf', 'text/xml'];\n      var acceptHeaderFieldValue = DICOMwebClient._buildAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes);\n      var headers = {\n        Accept: acceptHeaderFieldValue\n      };\n      var responseType = 'arraybuffer';\n      return this._httpGet(urlWithQueryParams, headers, responseType, progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP GET request that accepts a message with a video\n     media type.\n     *\n     * @param {String} url\n     * @param {Object[]} mediaTypes\n     * @param {Object} params\n     * @param {Function} progressCallback\n     * @return {*}\n     * @private\n     */\n  }, {\n    key: \"_httpGetVideo\",\n    value: function _httpGetVideo(url, mediaTypes) {\n      var params = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n      var progressCallback = arguments.length > 3 ? arguments[3] : undefined;\n      var withCredentials = arguments.length > 4 ? arguments[4] : undefined;\n      var urlWithQueryParams = url;\n      if (_typeof(params) === 'object') {\n        if (!isEmptyObject(params)) {\n          urlWithQueryParams += DICOMwebClient._parseQueryParameters(params);\n        }\n      }\n      var supportedMediaTypes = ['video/', 'video/*', 'video/mpeg', 'video/mp4', 'video/H265'];\n      var acceptHeaderFieldValue = DICOMwebClient._buildAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes);\n      var headers = {\n        Accept: acceptHeaderFieldValue\n      };\n      var responseType = 'arraybuffer';\n      return this._httpGet(urlWithQueryParams, headers, responseType, progressCallback, withCredentials);\n    }\n    /**\n     * Asserts that a given media type is valid.\n     *\n     * @params {String} mediaType media type\n     */\n  }, {\n    key: \"_httpGetMultipartImage\",\n    /**\n     * Performs an HTTP GET request that accepts a multipart message with an image media type.\n     *\n     * @param {String} url - Unique resource locator\n     * @param {Object[]} mediaTypes - Acceptable media types and optionally the UIDs of the\n     corresponding transfer syntaxes\n     * @param {Array} byteRange - Start and end of byte range\n     * @param {Object} params - Additional HTTP GET query parameters\n     * @param {Boolean} rendered - Whether resource should be requested using rendered media types\n     * @param {Function} progressCallback\n     * @private\n     * @returns {Promise<Array>} Content of HTTP message body parts\n     */\n    value: function _httpGetMultipartImage(url, mediaTypes, byteRange, params) {\n      var rendered = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;\n      var progressCallback = arguments.length > 5 ? arguments[5] : undefined;\n      var withCredentials = arguments.length > 6 ? arguments[6] : undefined;\n      var headers = {};\n      var supportedMediaTypes;\n      if (rendered) {\n        supportedMediaTypes = ['image/jpeg', 'image/gif', 'image/png', 'image/jp2'];\n      } else {\n        supportedMediaTypes = {\n          '1.2.840.10008.1.2.5': ['image/x-dicom-rle'],\n          '1.2.840.10008.1.2.4.50': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.51': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.57': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.70': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.80': ['image/x-jls', 'image/jls'],\n          '1.2.840.10008.1.2.4.81': ['image/x-jls', 'image/jls'],\n          '1.2.840.10008.1.2.4.90': ['image/jp2'],\n          '1.2.840.10008.1.2.4.91': ['image/jp2'],\n          '1.2.840.10008.1.2.4.92': ['image/jpx'],\n          '1.2.840.10008.1.2.4.93': ['image/jpx']\n        };\n        if (byteRange) {\n          headers.Range = DICOMwebClient._buildRangeHeaderFieldValue(byteRange);\n        }\n      }\n      headers.Accept = DICOMwebClient._buildMultipartAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes);\n      return this._httpGet(url, headers, 'arraybuffer', progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP GET request that accepts a multipart message with a video media type.\n     *\n     * @param {String} url - Unique resource locator\n     * @param {Object[]} mediaTypes - Acceptable media types and optionally the UIDs of the\n     corresponding transfer syntaxes\n     * @param {Array} byteRange - Start and end of byte range\n     * @param {Object} params - Additional HTTP GET query parameters\n     * @param {Boolean} rendered - Whether resource should be requested using rendered media types\n     * @param {Function} progressCallback\n     * @private\n     * @returns {Promise<Array>} Content of HTTP message body parts\n     */\n  }, {\n    key: \"_httpGetMultipartVideo\",\n    value: function _httpGetMultipartVideo(url, mediaTypes, byteRange, params) {\n      var rendered = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : false;\n      var progressCallback = arguments.length > 5 ? arguments[5] : undefined;\n      var withCredentials = arguments.length > 6 ? arguments[6] : undefined;\n      var headers = {};\n      var supportedMediaTypes;\n      if (rendered) {\n        supportedMediaTypes = ['video/', 'video/*', 'video/mpeg2', 'video/mp4', 'video/H265'];\n      } else {\n        supportedMediaTypes = {\n          '1.2.840.10008.1.2.4.100': ['video/mpeg2'],\n          '1.2.840.10008.1.2.4.101': ['video/mpeg2'],\n          '1.2.840.10008.1.2.4.102': ['video/mp4'],\n          '1.2.840.10008.1.2.4.103': ['video/mp4'],\n          '1.2.840.10008.1.2.4.104': ['video/mp4'],\n          '1.2.840.10008.1.2.4.105': ['video/mp4'],\n          '1.2.840.10008.1.2.4.106': ['video/mp4']\n        };\n        if (byteRange) {\n          headers.Range = DICOMwebClient._buildRangeHeaderFieldValue(byteRange);\n        }\n      }\n      headers.Accept = DICOMwebClient._buildMultipartAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes);\n      return this._httpGet(url, headers, 'arraybuffer', progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP GET request that accepts a multipart message\n     * with a application/dicom media type.\n     *\n     * @param {String} url - Unique resource locator\n     * @param {Object[]} mediaTypes - Acceptable media types and optionally the UIDs of the\n     corresponding transfer syntaxes\n     * @param {Object} params - Additional HTTP GET query parameters\n     * @param {Function} progressCallback\n     * @private\n     * @returns {Promise<Array>} Content of HTTP message body parts\n     */\n  }, {\n    key: \"_httpGetMultipartApplicationDicom\",\n    value: function _httpGetMultipartApplicationDicom(url, mediaTypes, params, progressCallback, withCredentials) {\n      var headers = {};\n      var defaultMediaType = 'application/dicom';\n      var supportedMediaTypes = {\n        '1.2.840.10008.1.2.1': [defaultMediaType],\n        '1.2.840.10008.1.2.5': [defaultMediaType],\n        '1.2.840.10008.1.2.4.50': [defaultMediaType],\n        '1.2.840.10008.1.2.4.51': [defaultMediaType],\n        '1.2.840.10008.1.2.4.57': [defaultMediaType],\n        '1.2.840.10008.1.2.4.70': [defaultMediaType],\n        '1.2.840.10008.1.2.4.80': [defaultMediaType],\n        '1.2.840.10008.1.2.4.81': [defaultMediaType],\n        '1.2.840.10008.1.2.4.90': [defaultMediaType],\n        '1.2.840.10008.1.2.4.91': [defaultMediaType],\n        '1.2.840.10008.1.2.4.92': [defaultMediaType],\n        '1.2.840.10008.1.2.4.93': [defaultMediaType],\n        '1.2.840.10008.1.2.4.100': [defaultMediaType],\n        '1.2.840.10008.1.2.4.101': [defaultMediaType],\n        '1.2.840.10008.1.2.4.102': [defaultMediaType],\n        '1.2.840.10008.1.2.4.103': [defaultMediaType],\n        '1.2.840.10008.1.2.4.104': [defaultMediaType],\n        '1.2.840.10008.1.2.4.105': [defaultMediaType],\n        '1.2.840.10008.1.2.4.106': [defaultMediaType]\n      };\n      var acceptableMediaTypes = mediaTypes;\n      if (!mediaTypes) {\n        acceptableMediaTypes = [{\n          mediaType: defaultMediaType\n        }];\n      }\n      headers.Accept = DICOMwebClient._buildMultipartAcceptHeaderFieldValue(acceptableMediaTypes, supportedMediaTypes);\n      return this._httpGet(url, headers, 'arraybuffer', progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP GET request that accepts a multipart message\n     * with a application/octet-stream, OR any of the equivalencies for that (eg\n     * application/pdf etc)\n     *\n     * @param {String} url - Unique resource locator\n     * @param {Object[]} mediaTypes - Acceptable media types and optionally the UIDs of the\n     corresponding transfer syntaxes\n     * @param {Array} byteRange start and end of byte range\n     * @param {Object} params - Additional HTTP GET query parameters\n     * @param {Function} progressCallback\n     * @private\n     * @returns {Promise<Array>} Content of HTTP message body parts\n     */\n  }, {\n    key: \"_httpGetMultipartApplicationOctetStream\",\n    value: function _httpGetMultipartApplicationOctetStream(url, mediaTypes, byteRange, params, progressCallback, withCredentials) {\n      var headers = {};\n      var defaultMediaType = 'application/octet-stream';\n      var supportedMediaTypes = {\n        '1.2.840.10008.1.2.1': _toConsumableArray(Object.values(MEDIATYPES))\n      };\n      var acceptableMediaTypes = mediaTypes;\n      if (!mediaTypes) {\n        acceptableMediaTypes = [{\n          mediaType: defaultMediaType\n        }];\n      }\n      if (byteRange) {\n        headers.Range = DICOMwebClient._buildRangeHeaderFieldValue(byteRange);\n      }\n      headers.Accept = DICOMwebClient._buildMultipartAcceptHeaderFieldValue(acceptableMediaTypes, supportedMediaTypes);\n      return this._httpGet(url, headers, 'arraybuffer', progressCallback, withCredentials);\n    }\n    /**\n     * Performs an HTTP POST request.\n     *\n     * @param {String} url - Unique resource locator\n     * @param {Object} headers - HTTP header fields\n     * @param {Array} data - Data that should be stored\n     * @param {Function} progressCallback\n     * @param {Function} progressCallback\n     * @param {XMLHttpRequest} request - if specified, the request to use, otherwise one will be created; useful for adding custom upload and abort listeners/objects\n     * @private\n     * @returns {Promise} Response\n     */\n  }, {\n    key: \"_httpPost\",\n    value: function _httpPost(url, headers, data, progressCallback, withCredentials, request) {\n      return this._httpRequest(url, 'post', headers, {\n        data: data,\n        progressCallback: progressCallback,\n        withCredentials: withCredentials,\n        request: request\n      });\n    }\n    /**\n     * Performs an HTTP POST request with content-type application/dicom+json.\n     *\n     * @param {String} url - Unique resource locator\n     * @param {Object} headers - HTTP header fields\n     * @param {Array} data - Data that should be stored\n     * @param {Function} progressCallback\n     * @private\n     * @returns {Promise} Response\n     */\n  }, {\n    key: \"_httpPostApplicationJson\",\n    value: function _httpPostApplicationJson(url, data, progressCallback, withCredentials) {\n      var headers = {\n        'Content-Type': MEDIATYPES.DICOM_JSON\n      };\n      return this._httpPost(url, headers, data, progressCallback, withCredentials);\n    }\n    /**\n     * Parses media type and extracts its type and subtype.\n     *\n     * @param {String} mediaType - HTTP media type (e.g. image/jpeg)\n     * @private\n     * @returns {String[]} Media type and subtype\n     */\n  }, {\n    key: \"searchForStudies\",\n    /**\n     * Searches for DICOM studies.\n     *\n     * @param {Object} options\n     * @param {Object} [options.queryParams] - HTTP query parameters\n     * @return {Object[]} Study representations (http://dicom.nema.org/medical/dicom/current/output/chtml/part18/sect_6.7.html#table_6.7.1-2)\n     */\n    value: function searchForStudies() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      debugLog('search for studies');\n      var withCredentials = false;\n      var url = \"\".concat(this.qidoURL, \"/studies\");\n      if ('queryParams' in options) {\n        url += DICOMwebClient._parseQueryParameters(options.queryParams);\n      }\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      return this._httpGetApplicationJson(url, {}, false, withCredentials);\n    }\n    /**\n     * Retrieves metadata for a DICOM study.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @returns {Promise<InstanceMetadata[]>} Metadata elements in DICOM JSON format for each instance\n                        belonging to the study\n     */\n  }, {\n    key: \"retrieveStudyMetadata\",\n    value: function retrieveStudyMetadata(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of study metadata');\n      }\n      debugLog(\"retrieve metadata of study \".concat(options.studyInstanceUID));\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/metadata\");\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      return this._httpGetApplicationJson(url, {}, false, withCredentials);\n    }\n    /**\n     * Searches for DICOM series.\n     *\n     * @param {Object} options\n     * @param {Object} [options.studyInstanceUID] - Study Instance UID\n     * @param {Object} [options.queryParams] - HTTP query parameters\n     * @returns {Object[]} Series representations (http://dicom.nema.org/medical/dicom/current/output/chtml/part18/sect_6.7.html#table_6.7.1-2a)\n     */\n  }, {\n    key: \"searchForSeries\",\n    value: function searchForSeries() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var url = this.qidoURL;\n      if ('studyInstanceUID' in options) {\n        debugLog(\"search series of study \".concat(options.studyInstanceUID));\n        url += \"/studies/\".concat(options.studyInstanceUID);\n      }\n      url += '/series';\n      if ('queryParams' in options) {\n        url += DICOMwebClient._parseQueryParameters(options.queryParams);\n      }\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      return this._httpGetApplicationJson(url, {}, false, withCredentials);\n    }\n    /**\n     * Retrieves metadata for a DICOM series.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @returns {Promise<InstanceMetadata[]>} Metadata elements in DICOM JSON format for each instance\n                        belonging to the series\n     */\n  }, {\n    key: \"retrieveSeriesMetadata\",\n    value: function retrieveSeriesMetadata(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of series metadata');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required for retrieval of series metadata');\n      }\n      debugLog(\"retrieve metadata of series \".concat(options.seriesInstanceUID));\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/metadata\");\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      return this._httpGetApplicationJson(url, {}, false, withCredentials);\n    }\n    /**\n     * Searches for DICOM Instances.\n     *\n     * @param {Object} options\n     * @param {String} [options.studyInstanceUID] - Study Instance UID\n     * @param {String} [options.seriesInstanceUID] - Series Instance UID\n     * @param {Object} [options.queryParams] - HTTP query parameters\n     * @returns {Object[]} Instance representations (http://dicom.nema.org/medical/dicom/current/output/chtml/part18/sect_6.7.html#table_6.7.1-2b)\n     */\n  }, {\n    key: \"searchForInstances\",\n    value: function searchForInstances() {\n      var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var url = this.qidoURL;\n      var withCredentials = false;\n      if ('studyInstanceUID' in options) {\n        url += \"/studies/\".concat(options.studyInstanceUID);\n        if ('seriesInstanceUID' in options) {\n          debugLog(\"search for instances of series \".concat(options.seriesInstanceUID));\n          url += \"/series/\".concat(options.seriesInstanceUID);\n        } else {\n          debugLog(\"search for instances of study \".concat(options.studyInstanceUID));\n        }\n      } else {\n        debugLog('search for instances');\n      }\n      url += '/instances';\n      if ('queryParams' in options) {\n        url += DICOMwebClient._parseQueryParameters(options.queryParams);\n      }\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      return this._httpGetApplicationJson(url, {}, false, withCredentials);\n    }\n    /** Returns a WADO-URI URL for an instance\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @returns {String} WADO-URI URL\n     */\n  }, {\n    key: \"buildInstanceWadoURIUrl\",\n    value: function buildInstanceWadoURIUrl(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required.');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required.');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required.');\n      }\n      var contentType = options.contentType || MEDIATYPES.DICOM;\n      var transferSyntax = options.transferSyntax || '*';\n      var params = [];\n      params.push('requestType=WADO');\n      params.push(\"studyUID=\".concat(options.studyInstanceUID));\n      params.push(\"seriesUID=\".concat(options.seriesInstanceUID));\n      params.push(\"objectUID=\".concat(options.sopInstanceUID));\n      params.push(\"contentType=\".concat(contentType));\n      params.push(\"transferSyntax=\".concat(transferSyntax));\n      var paramString = params.join('&');\n      return \"\".concat(this.wadoURL, \"?\").concat(paramString);\n    }\n    /**\n     * Retrieves metadata for a DICOM Instance.\n     *\n     * @param {Object} options object\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @returns {Promise<InstanceMetadata>} metadata elements in DICOM JSON format\n     */\n  }, {\n    key: \"retrieveInstanceMetadata\",\n    value: function retrieveInstanceMetadata(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of instance metadata');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required for retrieval of instance metadata');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required for retrieval of instance metadata');\n      }\n      debugLog(\"retrieve metadata of instance \".concat(options.sopInstanceUID));\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/instances/\").concat(options.sopInstanceUID, \"/metadata\");\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      return this._httpGetApplicationJson(url, {}, false, withCredentials);\n    }\n    /**\n     * Retrieves frames for a DICOM Instance.\n     * @param {Object} options options object\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @param {String} options.frameNumbers - One-based indices of Frame Items\n     * @returns {Array} frame items as byte arrays of the pixel data element\n     */\n  }, {\n    key: \"retrieveInstanceFrames\",\n    value: function retrieveInstanceFrames(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of instance frames');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required for retrieval of instance frames');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required for retrieval of instance frames');\n      }\n      if (!('frameNumbers' in options)) {\n        throw new Error('frame numbers are required for retrieval of instance frames');\n      }\n      debugLog(\"retrieve frames \".concat(options.frameNumbers.toString(), \" of instance \").concat(options.sopInstanceUID));\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/instances/\").concat(options.sopInstanceUID, \"/frames/\").concat(options.frameNumbers.toString());\n      var mediaTypes = options.mediaTypes;\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      var progressCallback = false;\n      if ('progressCallback' in options) {\n        progressCallback = options.progressCallback;\n      }\n      if (!mediaTypes) {\n        return this._httpGetMultipartApplicationOctetStream(url, false, false, false, progressCallback, withCredentials);\n      }\n      var sharedMediaTypes = DICOMwebClient._getSharedMediaTypes(mediaTypes);\n      if (sharedMediaTypes.length > 1) {\n        /**\n         * Enable request of frames that are stored either compressed\n         * (image/* media type) or uncompressed (application/octet-stream\n         * media type).\n         */\n        var supportedMediaTypes = {\n          '1.2.840.10008.1.2.1': ['application/octet-stream'],\n          '1.2.840.10008.1.2.5': ['image/x-dicom-rle'],\n          '1.2.840.10008.1.2.4.50': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.51': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.57': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.70': ['image/jpeg'],\n          '1.2.840.10008.1.2.4.80': ['image/x-jls', 'image/jls'],\n          '1.2.840.10008.1.2.4.81': ['image/x-jls', 'image/jls'],\n          '1.2.840.10008.1.2.4.90': ['image/jp2'],\n          '1.2.840.10008.1.2.4.91': ['image/jp2'],\n          '1.2.840.10008.1.2.4.92': ['image/jpx'],\n          '1.2.840.10008.1.2.4.93': ['image/jpx'],\n          '1.2.840.10008.1.2.4.201': ['image/jhc'],\n          '1.2.840.10008.1.2.4.202': ['image/jhc']\n        };\n        var headers = {\n          Accept: DICOMwebClient._buildMultipartAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes)\n        };\n        return this._httpGet(url, headers, 'arraybuffer', progressCallback, withCredentials);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType.startsWith('application')) {\n        return this._httpGetMultipartApplicationOctetStream(url, mediaTypes, false, false, progressCallback, withCredentials);\n      }\n      if (commonMediaType.startsWith('image')) {\n        return this._httpGetMultipartImage(url, mediaTypes, false, false, false, progressCallback, withCredentials);\n      }\n      if (commonMediaType.startsWith('video')) {\n        return this._httpGetMultipartVideo(url, mediaTypes, false, false, false, progressCallback, withCredentials);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported for retrieval of frames.\"));\n    }\n    /**\n    * Element in mediaTypes parameter\n    * @typedef {Object} MediaType\n    * @param {String} [MediaType.mediaType] - ie 'image/jpeg', 'image/png'...\n    */\n    /**\n     * Retrieves an individual, server-side rendered DICOM Instance.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @param {MediaType[]} [options.mediaTypes] - Acceptable HTTP media types\n     * @param {Object} [options.queryParams] - HTTP query parameters\n     * @returns {Promise<ArrayBuffer>} Rendered DICOM Instance\n     */\n  }, {\n    key: \"retrieveInstanceRendered\",\n    value: function retrieveInstanceRendered(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of rendered instance');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required for retrieval of rendered instance');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required for retrieval of rendered instance');\n      }\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/instances/\").concat(options.sopInstanceUID, \"/rendered\");\n      var mediaTypes = options.mediaTypes,\n        queryParams = options.queryParams;\n      var headers = {};\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      var progressCallback = false;\n      if ('progressCallback' in options) {\n        progressCallback = options.progressCallback;\n      }\n      if (!mediaTypes) {\n        var responseType = 'arraybuffer';\n        if (queryParams) {\n          url += DICOMwebClient._parseQueryParameters(queryParams);\n        }\n        return this._httpGet(url, headers, responseType, progressCallback, withCredentials);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType.startsWith('image')) {\n        return this._httpGetImage(url, mediaTypes, queryParams, progressCallback, withCredentials);\n      }\n      if (commonMediaType.startsWith('video')) {\n        return this._httpGetVideo(url, mediaTypes, queryParams, progressCallback, withCredentials);\n      }\n      if (commonMediaType.startsWith('text')) {\n        return this._httpGetText(url, mediaTypes, queryParams, progressCallback, withCredentials);\n      }\n      if (commonMediaType === MEDIATYPES.PDF) {\n        return this._httpGetApplicationPdf(url, queryParams, progressCallback, withCredentials);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported \") + 'for retrieval of rendered instance.');\n    }\n    /**\n     * Retrieves a thumbnail of an DICOM Instance.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @param {MediaType[]} [options.mediaTypes] - Acceptable HTTP media types\n     * @param {Object} [options.queryParams] - HTTP query parameters\n     * @returns {ArrayBuffer} Thumbnail\n     */\n  }, {\n    key: \"retrieveInstanceThumbnail\",\n    value: function retrieveInstanceThumbnail(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of rendered instance');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required for retrieval of rendered instance');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required for retrieval of rendered instance');\n      }\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/instances/\").concat(options.sopInstanceUID, \"/thumbnail\");\n      var mediaTypes = options.mediaTypes,\n        queryParams = options.queryParams;\n      var headers = {};\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      var progressCallback = false;\n      if ('progressCallback' in options) {\n        progressCallback = options.progressCallback;\n      }\n      if (!mediaTypes) {\n        var responseType = 'arraybuffer';\n        if (queryParams) {\n          url += DICOMwebClient._parseQueryParameters(queryParams);\n        }\n        return this._httpGet(url, headers, responseType, progressCallback, withCredentials);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType.startsWith('image')) {\n        return this._httpGetImage(url, mediaTypes, queryParams, progressCallback, withCredentials);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported \") + 'for retrieval of rendered instance.');\n    }\n    /**\n     * Retrieves rendered frames for a DICOM Instance.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @param {String} options.frameNumbers - One-based indices of Frame Items\n     * @param {MediaType[]} [options.mediaTypes] - Acceptable HTTP media types\n     * @param {Object} [options.queryParams] - HTTP query parameters\n     * @returns {ArrayBuffer[]} Rendered Frame Items as byte arrays\n     */\n  }, {\n    key: \"retrieveInstanceFramesRendered\",\n    value: function retrieveInstanceFramesRendered(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of rendered instance frames');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required for retrieval of rendered instance frames');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required for retrieval of rendered instance frames');\n      }\n      if (!('frameNumbers' in options)) {\n        throw new Error('frame numbers are required for retrieval of rendered instance frames');\n      }\n      debugLog(\"retrieve rendered frames \".concat(options.frameNumbers.toString(), \" of instance \").concat(options.sopInstanceUID));\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/instances/\").concat(options.sopInstanceUID, \"/frames/\").concat(options.frameNumbers.toString(), \"/rendered\");\n      var mediaTypes = options.mediaTypes,\n        queryParams = options.queryParams;\n      var headers = {};\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      var progressCallback = false;\n      if ('progressCallback' in options) {\n        progressCallback = options.progressCallback;\n      }\n      if (!mediaTypes) {\n        var responseType = 'arraybuffer';\n        if (queryParams) {\n          url += DICOMwebClient._parseQueryParameters(queryParams);\n        }\n        return this._httpGet(url, headers, responseType, false, withCredentials);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType.startsWith('image')) {\n        return this._httpGetImage(url, mediaTypes, queryParams, progressCallback, withCredentials);\n      }\n      if (commonMediaType.startsWith('video')) {\n        return this._httpGetVideo(url, mediaTypes, queryParams, progressCallback, withCredentials);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported \") + 'for retrieval of rendered frame.');\n    }\n    /**\n     * Retrieves thumbnail of frames for a DICOM Instance.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @param {String} options.frameNumbers - One-based indices of Frame Items\n     * @param {Object} [options.queryParams] - HTTP query parameters\n     * @returns {ArrayBuffer[]} Rendered Frame Items as byte arrays\n     */\n  }, {\n    key: \"retrieveInstanceFramesThumbnail\",\n    value: function retrieveInstanceFramesThumbnail(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required for retrieval of rendered instance frames');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required for retrieval of rendered instance frames');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required for retrieval of rendered instance frames');\n      }\n      if (!('frameNumbers' in options)) {\n        throw new Error('frame numbers are required for retrieval of rendered instance frames');\n      }\n      console.debug(\"retrieve rendered frames \".concat(options.frameNumbers.toString(), \" of instance \").concat(options.sopInstanceUID));\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/instances/\").concat(options.sopInstanceUID, \"/frames/\").concat(options.frameNumbers.toString(), \"/thumbnail\");\n      var mediaTypes = options.mediaTypes,\n        queryParams = options.queryParams;\n      var headers = {};\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      var progressCallback = false;\n      if ('progressCallback' in options) {\n        progressCallback = options.progressCallback;\n      }\n      if (!mediaTypes) {\n        var responseType = 'arraybuffer';\n        if (queryParams) {\n          url += DICOMwebClient._parseQueryParameters(queryParams);\n        }\n        return this._httpGet(url, headers, responseType, progressCallback, withCredentials);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType.startsWith('image')) {\n        return this._httpGetImage(url, mediaTypes, queryParams, progressCallback, withCredentials);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported \") + 'for retrieval of rendered frame.');\n    }\n    /**\n     * Retrieves a DICOM Instance.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {String} options.sopInstanceUID - SOP Instance UID\n     * @returns {Promise<ArrayBuffer>} DICOM Part 10 file as Arraybuffer\n     */\n  }, {\n    key: \"retrieveInstance\",\n    value: function retrieveInstance(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required');\n      }\n      if (!('sopInstanceUID' in options)) {\n        throw new Error('SOP Instance UID is required');\n      }\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID, \"/instances/\").concat(options.sopInstanceUID);\n      var mediaTypes = options.mediaTypes;\n      var _options$withCredenti = options.withCredentials,\n        withCredentials = _options$withCredenti === void 0 ? false : _options$withCredenti;\n      var _options$progressCall = options.progressCallback,\n        progressCallback = _options$progressCall === void 0 ? false : _options$progressCall;\n      if (!mediaTypes) {\n        return this._httpGetMultipartApplicationDicom(url, false, false, progressCallback, withCredentials).then(getFirstResult);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType === MEDIATYPES.DICOM) {\n        return this._httpGetMultipartApplicationDicom(url, mediaTypes, false, progressCallback, withCredentials).then(getFirstResult);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported for retrieval of instance.\"));\n    }\n    /**\n     * Retrieves all DICOM Instances of a Series.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @param {String} options.seriesInstanceUID - Series Instance UID\n     * @param {Function} options.progressCallback\n     * @returns {Promise<ArrayBuffer[]>} DICOM Instances\n     */\n  }, {\n    key: \"retrieveSeries\",\n    value: function retrieveSeries(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required');\n      }\n      if (!('seriesInstanceUID' in options)) {\n        throw new Error('Series Instance UID is required');\n      }\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID, \"/series/\").concat(options.seriesInstanceUID);\n      var mediaTypes = options.mediaTypes;\n      var withCredentials = false;\n      if ('withCredentials' in options) {\n        if (options.withCredentials) {\n          withCredentials = options.withCredentials;\n        }\n      }\n      var progressCallback = false;\n      if ('progressCallback' in options) {\n        progressCallback = options.progressCallback;\n      }\n      if (!mediaTypes) {\n        return this._httpGetMultipartApplicationDicom(url, false, false, progressCallback, withCredentials);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType === MEDIATYPES.DICOM) {\n        return this._httpGetMultipartApplicationDicom(url, mediaTypes, false, progressCallback, withCredentials);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported for retrieval of series.\"));\n    }\n    /**\n     * Retrieves all DICOM Instances of a Study.\n     *\n     * @param {Object} options\n     * @param {String} options.studyInstanceUID - Study Instance UID\n     * @returns {ArrayBuffer[]} DICOM Instances\n     */\n  }, {\n    key: \"retrieveStudy\",\n    value: function retrieveStudy(options) {\n      if (!('studyInstanceUID' in options)) {\n        throw new Error('Study Instance UID is required');\n      }\n      var url = \"\".concat(this.wadoURL, \"/studies/\").concat(options.studyInstanceUID);\n      var mediaTypes = options.mediaTypes;\n      var _options$withCredenti2 = options.withCredentials,\n        withCredentials = _options$withCredenti2 === void 0 ? false : _options$withCredenti2;\n      var _options$progressCall2 = options.progressCallback,\n        progressCallback = _options$progressCall2 === void 0 ? false : _options$progressCall2;\n      if (!mediaTypes) {\n        return this._httpGetMultipartApplicationDicom(url, false, false, progressCallback, withCredentials);\n      }\n      var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n      if (commonMediaType === MEDIATYPES.DICOM) {\n        return this._httpGetMultipartApplicationDicom(url, mediaTypes, false, progressCallback, withCredentials);\n      }\n      throw new Error(\"Media type \".concat(commonMediaType, \" is not supported for retrieval of study.\"));\n    }\n    /**\n     * Retrieves and parses BulkData from a BulkDataURI location.\n     * Decodes the multipart encoded data and returns the resulting data\n     * as an ArrayBuffer.\n     *\n     * See http://dicom.nema.org/medical/dicom/current/output/chtml/part18/sect_6.5.5.html\n     *\n     * @param {Object} options\n     * @param {string} options.BulkDataURI to retrieve\n     * @param {Array}  options.mediaTypes to use to fetch the URI\n     * @param {string} options.byteRange to request a sub-range (only valid on single part)\n     * @returns {Promise<Array>} Bulkdata parts\n     */\n  }, {\n    key: \"retrieveBulkData\",\n    value: function retrieveBulkData(options) {\n      if (!('BulkDataURI' in options)) {\n        throw new Error('BulkDataURI is required.');\n      }\n      var url = options.BulkDataURI;\n      var mediaTypes = options.mediaTypes,\n        byteRange = options.byteRange;\n      var _options$withCredenti3 = options.withCredentials,\n        withCredentials = _options$withCredenti3 === void 0 ? false : _options$withCredenti3;\n      var _options$progressCall3 = options.progressCallback,\n        progressCallback = _options$progressCall3 === void 0 ? false : _options$progressCall3;\n      if (this.singlepart.indexOf('bulkdata') !== -1) {\n        return this._httpGet(url, options.headers, 'arraybuffer', null, withCredentials);\n      }\n      if (mediaTypes) {\n        try {\n          var commonMediaType = DICOMwebClient._getCommonMediaType(mediaTypes);\n          if (commonMediaType === 'image/') {\n            return this._httpGetMultipartImage(url, mediaTypes, byteRange, false, false, progressCallback, withCredentials);\n          }\n        } catch (e) {\n          // No-op - this happens sometimes if trying to fetch the specific desired type but want to fallback to octet-stream\n        }\n      }\n\n      // Just use the media types provided\n      return this._httpGetMultipartApplicationOctetStream(url, mediaTypes, byteRange, false, progressCallback, withCredentials);\n    }\n    /**\n     * Stores DICOM Instances.\n     *\n     * @param {Object} options\n     * @param {ArrayBuffer[]} options.datasets - DICOM Instances in PS3.10 format\n     * @param {String} [options.studyInstanceUID] - Study Instance UID\n     * @param {XMLHttpRequest} [options.request] - if specified, the request to use, otherwise one will be created; useful for adding custom upload and abort listeners/objects\n     * @returns {Promise} Response message\n     */\n  }, {\n    key: \"storeInstances\",\n    value: function storeInstances(options) {\n      if (!('datasets' in options)) {\n        throw new Error('datasets are required for storing');\n      }\n      var url = \"\".concat(this.stowURL, \"/studies\");\n      if ('studyInstanceUID' in options) {\n        url += \"/\".concat(options.studyInstanceUID);\n      }\n      var _multipartEncode = multipartEncode(options.datasets),\n        data = _multipartEncode.data,\n        boundary = _multipartEncode.boundary;\n      var headers = {\n        'Content-Type': \"multipart/related; type=\\\"application/dicom\\\"; boundary=\\\"\".concat(boundary, \"\\\"\")\n      };\n      var _options$withCredenti4 = options.withCredentials,\n        withCredentials = _options$withCredenti4 === void 0 ? false : _options$withCredenti4;\n      return this._httpPost(url, headers, data, options.progressCallback, withCredentials, options.request);\n    }\n  }], [{\n    key: \"_parseQueryParameters\",\n    value: function _parseQueryParameters() {\n      var params = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n      var queryString = '?';\n      Object.keys(params).forEach(function (key, index) {\n        if (index !== 0) {\n          queryString += '&';\n        }\n        queryString += \"\".concat(key, \"=\").concat(encodeURIComponent(params[key]));\n      });\n      return queryString;\n    }\n  }, {\n    key: \"_assertMediaTypeIsValid\",\n    value: function _assertMediaTypeIsValid(mediaType) {\n      if (!mediaType) {\n        throw new Error(\"Not a valid media type: \".concat(mediaType));\n      }\n      var sepIndex = mediaType.indexOf('/');\n      if (sepIndex === -1) {\n        throw new Error(\"Not a valid media type: \".concat(mediaType));\n      }\n      var mediaTypeType = mediaType.slice(0, sepIndex);\n      var types = ['application', 'image', 'text', 'video'];\n      if (!types.includes(mediaTypeType)) {\n        throw new Error(\"Not a valid media type: \".concat(mediaType));\n      }\n      if (mediaType.slice(sepIndex + 1).includes('/')) {\n        throw new Error(\"Not a valid media type: \".concat(mediaType));\n      }\n    }\n  }, {\n    key: \"_parseMediaType\",\n    value: function _parseMediaType(mediaType) {\n      DICOMwebClient._assertMediaTypeIsValid(mediaType);\n      return mediaType.split('/');\n    }\n    /**\n     * Builds an accept header field value for HTTP GET request messages.\n     *\n     * @param {Object[]} mediaTypes - Acceptable media types\n     * @param {Object[]} supportedMediaTypes - Supported media types\n     * @return {*}\n     * @private\n     */\n  }, {\n    key: \"_buildAcceptHeaderFieldValue\",\n    value: function _buildAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes) {\n      if (!Array.isArray(mediaTypes)) {\n        throw new Error('Acceptable media types must be provided as an Array');\n      }\n      var fieldValueParts = mediaTypes.map(function (item) {\n        var mediaType = item.mediaType;\n        DICOMwebClient._assertMediaTypeIsValid(mediaType);\n        if (!supportedMediaTypes.includes(mediaType)) {\n          throw new Error(\"Media type \".concat(mediaType, \" is not supported for requested resource\"));\n        }\n        return mediaType;\n      });\n      return fieldValueParts.join(', ');\n    }\n    /**\n     * Builds an accept header field value for HTTP GET multipart request\n     * messages.  Will throw an exception if no media types are found which are acceptable,\n     * but will only log a verbose level message when types are specified which are\n     * not acceptable.  This allows requesting several types with having to know\n     * whether they are all acceptable or not.\n     *\n     * @param {Object[]} mediaTypes - Acceptable media types\n     * @param {Object[]} supportedMediaTypes - Supported media types\n     * @private\n     */\n  }, {\n    key: \"_buildMultipartAcceptHeaderFieldValue\",\n    value: function _buildMultipartAcceptHeaderFieldValue(mediaTypes, supportedMediaTypes) {\n      var _this2 = this;\n      if (!Array.isArray(mediaTypes)) {\n        throw new Error('Acceptable media types must be provided as an Array');\n      }\n      if (!Array.isArray(supportedMediaTypes) && !isObject(supportedMediaTypes)) {\n        throw new Error('Supported media types must be provided as an Array or an Object');\n      }\n      var fieldValueParts = [];\n      mediaTypes.forEach(function (item) {\n        var transferSyntaxUID = item.transferSyntaxUID,\n          mediaType = item.mediaType;\n        DICOMwebClient._assertMediaTypeIsValid(mediaType);\n        var fieldValue = \"multipart/related; type=\\\"\".concat(mediaType, \"\\\"\");\n        if (isObject(supportedMediaTypes)) {\n          // SupportedMediaTypes is a lookup table that maps Transfer Syntax UID\n          // to one or more Media Types\n          if (!Object.values(supportedMediaTypes).flat(1).includes(mediaType)) {\n            if (!mediaType.endsWith('/*') || !mediaType.endsWith('/')) {\n              debugLog(\"Media type \".concat(mediaType, \" is not supported for requested resource\"));\n              return;\n            }\n          }\n          if (transferSyntaxUID) {\n            if (transferSyntaxUID !== '*') {\n              if (!Object.keys(supportedMediaTypes).includes(transferSyntaxUID)) {\n                throw new Error(\"Transfer syntax \".concat(transferSyntaxUID, \" is not supported for requested resource\"));\n              }\n              var expectedMediaTypes = supportedMediaTypes[transferSyntaxUID];\n              if (!expectedMediaTypes.includes(mediaType)) {\n                var actualType = DICOMwebClient._parseMediaType(mediaType)[0];\n                expectedMediaTypes.map(function (expectedMediaType) {\n                  var expectedType = DICOMwebClient._parseMediaType(expectedMediaType)[0];\n                  var haveSameType = actualType === expectedType;\n                  if (haveSameType && (mediaType.endsWith('/*') || mediaType.endsWith('/'))) {\n                    return;\n                  }\n                  throw new Error(\"Transfer syntax \".concat(transferSyntaxUID, \" is not supported for requested resource\"));\n                });\n              }\n            }\n            fieldValue += \"; transfer-syntax=\".concat(transferSyntaxUID);\n          }\n        } else if (Array.isArray(supportedMediaTypes) && !supportedMediaTypes.includes(mediaType)) {\n          if (_this2.verbose) {\n            console.warn(\"Media type \".concat(mediaType, \" is not supported for requested resource\"));\n          }\n          return;\n        }\n        fieldValueParts.push(fieldValue);\n      });\n      if (!fieldValueParts.length) {\n        throw new Error(\"No acceptable media types found among \".concat(JSON.stringify(mediaTypes)));\n      }\n      return fieldValueParts.join(', ');\n    }\n    /**\n     * Builds a range header field value for HTTP GET request messages.\n     *\n     * @param {Array} byteRange - Start and end of byte range\n     * @returns {String} Range header field value\n     * @private\n     */\n  }, {\n    key: \"_buildRangeHeaderFieldValue\",\n    value: function _buildRangeHeaderFieldValue() {\n      var byteRange = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n      if (byteRange.length === 1) {\n        return \"bytes=\".concat(byteRange[0], \"-\");\n      }\n      if (byteRange.length === 2) {\n        return \"bytes=\".concat(byteRange[0], \"-\").concat(byteRange[1]);\n      }\n      return 'bytes=0-';\n    }\n    /**\n     * Gets types that are shared among acceptable media types.\n     *\n     * @param {Object[]} mediaTypes - Acceptable media types and optionally the UIDs of the\n     corresponding transfer syntaxes\n     * @private\n     * @returns {String[]} Types that are shared among acceptable media types\n     */\n  }, {\n    key: \"_getSharedMediaTypes\",\n    value: function _getSharedMediaTypes(mediaTypes) {\n      var types = new Set();\n      if (!mediaTypes || !mediaTypes.length) {\n        return types;\n      }\n      mediaTypes.forEach(function (item) {\n        var mediaType = item.mediaType;\n        var type = DICOMwebClient._parseMediaType(mediaType)[0];\n        types.add(\"\".concat(type, \"/\"));\n      });\n      return Array.from(types);\n    }\n    /**\n     * Gets common base type of acceptable media types and asserts that only\n     one type is specified. For example, ``(\"image/jpeg\", \"image/jp2\")``\n     will pass, but ``(\"image/jpeg\", \"video/mpeg2\")`` will raise an\n     exception.\n     *\n     * @param {Object[]} mediaTypes - Acceptable media types and optionally the UIDs of the\n     corresponding transfer syntaxes\n     * @private\n     * @returns {String[]} Common media type, eg `image/` for the above example.\n     */\n  }, {\n    key: \"_getCommonMediaType\",\n    value: function _getCommonMediaType(mediaTypes) {\n      if (!mediaTypes || !mediaTypes.length) {\n        throw new Error('No acceptable media types provided');\n      }\n      var sharedMediaTypes = DICOMwebClient._getSharedMediaTypes(mediaTypes);\n      if (sharedMediaTypes.length === 0) {\n        throw new Error('No common acceptable media type could be identified.');\n      } else if (sharedMediaTypes.length > 1) {\n        throw new Error('Acceptable media types must have the same type.');\n      }\n      return sharedMediaTypes[0];\n    }\n  }]);\n  return DICOMwebClient;\n}();\n\nfunction findSubstring(str, before, after) {\n  var beforeIndex = str.lastIndexOf(before) + before.length;\n  if (beforeIndex < before.length) {\n    return null;\n  }\n  if (after !== undefined) {\n    var afterIndex = str.lastIndexOf(after);\n    if (afterIndex < 0) {\n      return null;\n    }\n    return str.substring(beforeIndex, afterIndex);\n  }\n  return str.substring(beforeIndex);\n}\nfunction getStudyInstanceUIDFromUri(uri) {\n  var uid = findSubstring(uri, 'studies/', '/series');\n  if (!uid) {\n    uid = findSubstring(uri, 'studies/');\n  }\n  if (!uid) {\n    console.debug(\"Study Instance UID could not be dertermined from URI \\\"\".concat(uri, \"\\\"\"));\n  }\n  return uid;\n}\nfunction getSeriesInstanceUIDFromUri(uri) {\n  var uid = findSubstring(uri, 'series/', '/instances');\n  if (!uid) {\n    uid = findSubstring(uri, 'series/');\n  }\n  if (!uid) {\n    console.debug(\"Series Instance UID could not be dertermined from URI \\\"\".concat(uri, \"\\\"\"));\n  }\n  return uid;\n}\nfunction getSOPInstanceUIDFromUri(uri) {\n  var uid = findSubstring(uri, '/instances/', '/frames');\n  if (!uid) {\n    uid = findSubstring(uri, '/instances/', '/metadata');\n  }\n  if (!uid) {\n    uid = findSubstring(uri, '/instances/');\n  }\n  if (!uid) {\n    console.debug(\"SOP Instance UID could not be dertermined from URI\\\"\".concat(uri, \"\\\"\"));\n  }\n  return uid;\n}\nfunction getFrameNumbersFromUri(uri) {\n  var numbers = findSubstring(uri, '/frames/', '/rendered');\n  if (!numbers) {\n    numbers = findSubstring(uri, '/frames/');\n  }\n  if (numbers === undefined) {\n    console.debug(\"Frame Numbers could not be dertermined from URI\\\"\".concat(uri, \"\\\"\"));\n  }\n  return numbers.split(',');\n}\n\nvar version = '0.5.2';\n\nvar api = {\n  DICOMwebClient: DICOMwebClient\n};\nvar utils = {\n  getStudyInstanceUIDFromUri: getStudyInstanceUIDFromUri,\n  getSeriesInstanceUIDFromUri: getSeriesInstanceUIDFromUri,\n  getSOPInstanceUIDFromUri: getSOPInstanceUIDFromUri,\n  getFrameNumbersFromUri: getFrameNumbersFromUri\n};\n\nexport { api, utils, version };\n//# sourceMappingURL=dicomweb-client.es.js.map\n","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** `Object#toString` result references. */\nvar funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    symbolTag = '[object Symbol]';\n\n/** Used to match property names within property paths. */\nvar reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n    reIsPlainProp = /^\\w*$/,\n    reLeadingDot = /^\\./,\n    rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g;\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to match backslashes in property paths. */\nvar reEscapeChar = /\\\\(\\\\)?/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\n/**\n * Checks if `value` is a host object in IE < 9.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a host object, else `false`.\n */\nfunction isHostObject(value) {\n  // Many host objects are `Object` objects that can coerce to strings\n  // despite having improperly defined `toString` methods.\n  var result = false;\n  if (value != null && typeof value.toString != 'function') {\n    try {\n      result = !!(value + '');\n    } catch (e) {}\n  }\n  return result;\n}\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype,\n    funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/** Built-in value references. */\nvar Symbol = root.Symbol,\n    splice = arrayProto.splice;\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map'),\n    nativeCreate = getNative(Object, 'create');\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n}\n\n/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  return this.has(key) && delete this.__data__[key];\n}\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? data[key] !== undefined : hasOwnProperty.call(data, key);\n}\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n}\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  return true;\n}\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries ? entries.length : 0;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  return getMapData(this, key)['delete'](key);\n}\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  getMapData(this, key).set(key, value);\n  return this;\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\n/**\n * The base implementation of `_.get` without support for default values.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @returns {*} Returns the resolved value.\n */\nfunction baseGet(object, path) {\n  path = isKey(path, object) ? [path] : castPath(path);\n\n  var index = 0,\n      length = path.length;\n\n  while (object != null && index < length) {\n    object = object[toKey(path[index++])];\n  }\n  return (index && index == length) ? object : undefined;\n}\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = (isFunction(value) || isHostObject(value)) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\n/**\n * Casts `value` to a path array if it's not one.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {Array} Returns the cast property path array.\n */\nfunction castPath(value) {\n  return isArray(value) ? value : stringToPath(value);\n}\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\n/**\n * Checks if `value` is a property name and not a property path.\n *\n * @private\n * @param {*} value The value to check.\n * @param {Object} [object] The object to query keys on.\n * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n */\nfunction isKey(value, object) {\n  if (isArray(value)) {\n    return false;\n  }\n  var type = typeof value;\n  if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n      value == null || isSymbol(value)) {\n    return true;\n  }\n  return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n    (object != null && value in Object(object));\n}\n\n/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\n/**\n * Converts `string` to a property path array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the property path array.\n */\nvar stringToPath = memoize(function(string) {\n  string = toString(string);\n\n  var result = [];\n  if (reLeadingDot.test(string)) {\n    result.push('');\n  }\n  string.replace(rePropName, function(match, number, quote, string) {\n    result.push(quote ? string.replace(reEscapeChar, '$1') : (number || match));\n  });\n  return result;\n});\n\n/**\n * Converts `value` to a string key if it's not a string or symbol.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {string|symbol} Returns the key.\n */\nfunction toKey(value) {\n  if (typeof value == 'string' || isSymbol(value)) {\n    return value;\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to process.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\n/**\n * Creates a function that memoizes the result of `func`. If `resolver` is\n * provided, it determines the cache key for storing the result based on the\n * arguments provided to the memoized function. By default, the first argument\n * provided to the memoized function is used as the map cache key. The `func`\n * is invoked with the `this` binding of the memoized function.\n *\n * **Note:** The cache is exposed as the `cache` property on the memoized\n * function. Its creation may be customized by replacing the `_.memoize.Cache`\n * constructor with one whose instances implement the\n * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)\n * method interface of `delete`, `get`, `has`, and `set`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to have its output memoized.\n * @param {Function} [resolver] The function to resolve the cache key.\n * @returns {Function} Returns the new memoized function.\n * @example\n *\n * var object = { 'a': 1, 'b': 2 };\n * var other = { 'c': 3, 'd': 4 };\n *\n * var values = _.memoize(_.values);\n * values(object);\n * // => [1, 2]\n *\n * values(other);\n * // => [3, 4]\n *\n * object.a = 2;\n * values(object);\n * // => [1, 2]\n *\n * // Modify the result cache.\n * values.cache.set(object, ['a', 'b']);\n * values(object);\n * // => ['a', 'b']\n *\n * // Replace `_.memoize.Cache`.\n * _.memoize.Cache = WeakMap;\n */\nfunction memoize(func, resolver) {\n  if (typeof func != 'function' || (resolver && typeof resolver != 'function')) {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  var memoized = function() {\n    var args = arguments,\n        key = resolver ? resolver.apply(this, args) : args[0],\n        cache = memoized.cache;\n\n    if (cache.has(key)) {\n      return cache.get(key);\n    }\n    var result = func.apply(this, args);\n    memoized.cache = cache.set(key, result);\n    return result;\n  };\n  memoized.cache = new (memoize.Cache || MapCache);\n  return memoized;\n}\n\n// Assign cache to `_.memoize`.\nmemoize.Cache = MapCache;\n\n/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\n/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 8-9 which returns 'object' for typed array and other constructors.\n  var tag = isObject(value) ? objectToString.call(value) : '';\n  return tag == funcTag || tag == genTag;\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\n/**\n * Gets the value at `path` of `object`. If the resolved value is\n * `undefined`, the `defaultValue` is returned in its place.\n *\n * @static\n * @memberOf _\n * @since 3.7.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n * @returns {*} Returns the resolved value.\n * @example\n *\n * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n *\n * _.get(object, 'a[0].b.c');\n * // => 3\n *\n * _.get(object, ['a', '0', 'b', 'c']);\n * // => 3\n *\n * _.get(object, 'a.b.c', 'default');\n * // => 'default'\n */\nfunction get(object, path, defaultValue) {\n  var result = object == null ? undefined : baseGet(object, path);\n  return result === undefined ? defaultValue : result;\n}\n\nmodule.exports = get;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar DataView = getNative(root, 'DataView');\n\nmodule.exports = DataView;\n","var hashClear = require('./_hashClear'),\n    hashDelete = require('./_hashDelete'),\n    hashGet = require('./_hashGet'),\n    hashHas = require('./_hashHas'),\n    hashSet = require('./_hashSet');\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\nmodule.exports = Hash;\n","var listCacheClear = require('./_listCacheClear'),\n    listCacheDelete = require('./_listCacheDelete'),\n    listCacheGet = require('./_listCacheGet'),\n    listCacheHas = require('./_listCacheHas'),\n    listCacheSet = require('./_listCacheSet');\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\nmodule.exports = ListCache;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map');\n\nmodule.exports = Map;\n","var mapCacheClear = require('./_mapCacheClear'),\n    mapCacheDelete = require('./_mapCacheDelete'),\n    mapCacheGet = require('./_mapCacheGet'),\n    mapCacheHas = require('./_mapCacheHas'),\n    mapCacheSet = require('./_mapCacheSet');\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\nmodule.exports = MapCache;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Promise = getNative(root, 'Promise');\n\nmodule.exports = Promise;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Set = getNative(root, 'Set');\n\nmodule.exports = Set;\n","var MapCache = require('./_MapCache'),\n    setCacheAdd = require('./_setCacheAdd'),\n    setCacheHas = require('./_setCacheHas');\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values == null ? 0 : values.length;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\nmodule.exports = SetCache;\n","var ListCache = require('./_ListCache'),\n    stackClear = require('./_stackClear'),\n    stackDelete = require('./_stackDelete'),\n    stackGet = require('./_stackGet'),\n    stackHas = require('./_stackHas'),\n    stackSet = require('./_stackSet');\n\n/**\n * Creates a stack cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Stack(entries) {\n  var data = this.__data__ = new ListCache(entries);\n  this.size = data.size;\n}\n\n// Add methods to `Stack`.\nStack.prototype.clear = stackClear;\nStack.prototype['delete'] = stackDelete;\nStack.prototype.get = stackGet;\nStack.prototype.has = stackHas;\nStack.prototype.set = stackSet;\n\nmodule.exports = Stack;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Uint8Array = root.Uint8Array;\n\nmodule.exports = Uint8Array;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar WeakMap = getNative(root, 'WeakMap');\n\nmodule.exports = WeakMap;\n","/**\n * A specialized version of `_.forEach` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns `array`.\n */\nfunction arrayEach(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (iteratee(array[index], index, array) === false) {\n      break;\n    }\n  }\n  return array;\n}\n\nmodule.exports = arrayEach;\n","/**\n * A specialized version of `_.filter` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction arrayFilter(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (predicate(value, index, array)) {\n      result[resIndex++] = value;\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayFilter;\n","var baseTimes = require('./_baseTimes'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isIndex = require('./_isIndex'),\n    isTypedArray = require('./isTypedArray');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayLikeKeys;\n","/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\nmodule.exports = arrayMap;\n","/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\nmodule.exports = arrayPush;\n","/**\n * A specialized version of `_.some` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n */\nfunction arraySome(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (predicate(array[index], index, array)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nmodule.exports = arraySome;\n","var baseAssignValue = require('./_baseAssignValue'),\n    eq = require('./eq');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns `value` to `key` of `object` if the existing value is not equivalent\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignValue(object, key, value) {\n  var objValue = object[key];\n  if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nmodule.exports = assignValue;\n","var eq = require('./eq');\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\nmodule.exports = assocIndexOf;\n","var copyObject = require('./_copyObject'),\n    keys = require('./keys');\n\n/**\n * The base implementation of `_.assign` without support for multiple sources\n * or `customizer` functions.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @returns {Object} Returns `object`.\n */\nfunction baseAssign(object, source) {\n  return object && copyObject(source, keys(source), object);\n}\n\nmodule.exports = baseAssign;\n","var copyObject = require('./_copyObject'),\n    keysIn = require('./keysIn');\n\n/**\n * The base implementation of `_.assignIn` without support for multiple sources\n * or `customizer` functions.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @returns {Object} Returns `object`.\n */\nfunction baseAssignIn(object, source) {\n  return object && copyObject(source, keysIn(source), object);\n}\n\nmodule.exports = baseAssignIn;\n","var defineProperty = require('./_defineProperty');\n\n/**\n * The base implementation of `assignValue` and `assignMergeValue` without\n * value checks.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction baseAssignValue(object, key, value) {\n  if (key == '__proto__' && defineProperty) {\n    defineProperty(object, key, {\n      'configurable': true,\n      'enumerable': true,\n      'value': value,\n      'writable': true\n    });\n  } else {\n    object[key] = value;\n  }\n}\n\nmodule.exports = baseAssignValue;\n","var Stack = require('./_Stack'),\n    arrayEach = require('./_arrayEach'),\n    assignValue = require('./_assignValue'),\n    baseAssign = require('./_baseAssign'),\n    baseAssignIn = require('./_baseAssignIn'),\n    cloneBuffer = require('./_cloneBuffer'),\n    copyArray = require('./_copyArray'),\n    copySymbols = require('./_copySymbols'),\n    copySymbolsIn = require('./_copySymbolsIn'),\n    getAllKeys = require('./_getAllKeys'),\n    getAllKeysIn = require('./_getAllKeysIn'),\n    getTag = require('./_getTag'),\n    initCloneArray = require('./_initCloneArray'),\n    initCloneByTag = require('./_initCloneByTag'),\n    initCloneObject = require('./_initCloneObject'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isMap = require('./isMap'),\n    isObject = require('./isObject'),\n    isSet = require('./isSet'),\n    keys = require('./keys'),\n    keysIn = require('./keysIn');\n\n/** Used to compose bitmasks for cloning. */\nvar CLONE_DEEP_FLAG = 1,\n    CLONE_FLAT_FLAG = 2,\n    CLONE_SYMBOLS_FLAG = 4;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values supported by `_.clone`. */\nvar cloneableTags = {};\ncloneableTags[argsTag] = cloneableTags[arrayTag] =\ncloneableTags[arrayBufferTag] = cloneableTags[dataViewTag] =\ncloneableTags[boolTag] = cloneableTags[dateTag] =\ncloneableTags[float32Tag] = cloneableTags[float64Tag] =\ncloneableTags[int8Tag] = cloneableTags[int16Tag] =\ncloneableTags[int32Tag] = cloneableTags[mapTag] =\ncloneableTags[numberTag] = cloneableTags[objectTag] =\ncloneableTags[regexpTag] = cloneableTags[setTag] =\ncloneableTags[stringTag] = cloneableTags[symbolTag] =\ncloneableTags[uint8Tag] = cloneableTags[uint8ClampedTag] =\ncloneableTags[uint16Tag] = cloneableTags[uint32Tag] = true;\ncloneableTags[errorTag] = cloneableTags[funcTag] =\ncloneableTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.clone` and `_.cloneDeep` which tracks\n * traversed objects.\n *\n * @private\n * @param {*} value The value to clone.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Deep clone\n *  2 - Flatten inherited properties\n *  4 - Clone symbols\n * @param {Function} [customizer] The function to customize cloning.\n * @param {string} [key] The key of `value`.\n * @param {Object} [object] The parent object of `value`.\n * @param {Object} [stack] Tracks traversed objects and their clone counterparts.\n * @returns {*} Returns the cloned value.\n */\nfunction baseClone(value, bitmask, customizer, key, object, stack) {\n  var result,\n      isDeep = bitmask & CLONE_DEEP_FLAG,\n      isFlat = bitmask & CLONE_FLAT_FLAG,\n      isFull = bitmask & CLONE_SYMBOLS_FLAG;\n\n  if (customizer) {\n    result = object ? customizer(value, key, object, stack) : customizer(value);\n  }\n  if (result !== undefined) {\n    return result;\n  }\n  if (!isObject(value)) {\n    return value;\n  }\n  var isArr = isArray(value);\n  if (isArr) {\n    result = initCloneArray(value);\n    if (!isDeep) {\n      return copyArray(value, result);\n    }\n  } else {\n    var tag = getTag(value),\n        isFunc = tag == funcTag || tag == genTag;\n\n    if (isBuffer(value)) {\n      return cloneBuffer(value, isDeep);\n    }\n    if (tag == objectTag || tag == argsTag || (isFunc && !object)) {\n      result = (isFlat || isFunc) ? {} : initCloneObject(value);\n      if (!isDeep) {\n        return isFlat\n          ? copySymbolsIn(value, baseAssignIn(result, value))\n          : copySymbols(value, baseAssign(result, value));\n      }\n    } else {\n      if (!cloneableTags[tag]) {\n        return object ? value : {};\n      }\n      result = initCloneByTag(value, tag, isDeep);\n    }\n  }\n  // Check for circular references and return its corresponding clone.\n  stack || (stack = new Stack);\n  var stacked = stack.get(value);\n  if (stacked) {\n    return stacked;\n  }\n  stack.set(value, result);\n\n  if (isSet(value)) {\n    value.forEach(function(subValue) {\n      result.add(baseClone(subValue, bitmask, customizer, subValue, value, stack));\n    });\n  } else if (isMap(value)) {\n    value.forEach(function(subValue, key) {\n      result.set(key, baseClone(subValue, bitmask, customizer, key, value, stack));\n    });\n  }\n\n  var keysFunc = isFull\n    ? (isFlat ? getAllKeysIn : getAllKeys)\n    : (isFlat ? keysIn : keys);\n\n  var props = isArr ? undefined : keysFunc(value);\n  arrayEach(props || value, function(subValue, key) {\n    if (props) {\n      key = subValue;\n      subValue = value[key];\n    }\n    // Recursively populate clone (susceptible to call stack limits).\n    assignValue(result, key, baseClone(subValue, bitmask, customizer, key, value, stack));\n  });\n  return result;\n}\n\nmodule.exports = baseClone;\n","var isObject = require('./isObject');\n\n/** Built-in value references. */\nvar objectCreate = Object.create;\n\n/**\n * The base implementation of `_.create` without support for assigning\n * properties to the created object.\n *\n * @private\n * @param {Object} proto The object to inherit from.\n * @returns {Object} Returns the new object.\n */\nvar baseCreate = (function() {\n  function object() {}\n  return function(proto) {\n    if (!isObject(proto)) {\n      return {};\n    }\n    if (objectCreate) {\n      return objectCreate(proto);\n    }\n    object.prototype = proto;\n    var result = new object;\n    object.prototype = undefined;\n    return result;\n  };\n}());\n\nmodule.exports = baseCreate;\n","var baseForOwn = require('./_baseForOwn'),\n    createBaseEach = require('./_createBaseEach');\n\n/**\n * The base implementation of `_.forEach` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array|Object} Returns `collection`.\n */\nvar baseEach = createBaseEach(baseForOwn);\n\nmodule.exports = baseEach;\n","var createBaseFor = require('./_createBaseFor');\n\n/**\n * The base implementation of `baseForOwn` which iterates over `object`\n * properties returned by `keysFunc` and invokes `iteratee` for each property.\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @returns {Object} Returns `object`.\n */\nvar baseFor = createBaseFor();\n\nmodule.exports = baseFor;\n","var baseFor = require('./_baseFor'),\n    keys = require('./keys');\n\n/**\n * The base implementation of `_.forOwn` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Object} Returns `object`.\n */\nfunction baseForOwn(object, iteratee) {\n  return object && baseFor(object, iteratee, keys);\n}\n\nmodule.exports = baseForOwn;\n","var castPath = require('./_castPath'),\n    toKey = require('./_toKey');\n\n/**\n * The base implementation of `_.get` without support for default values.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @returns {*} Returns the resolved value.\n */\nfunction baseGet(object, path) {\n  path = castPath(path, object);\n\n  var index = 0,\n      length = path.length;\n\n  while (object != null && index < length) {\n    object = object[toKey(path[index++])];\n  }\n  return (index && index == length) ? object : undefined;\n}\n\nmodule.exports = baseGet;\n","var arrayPush = require('./_arrayPush'),\n    isArray = require('./isArray');\n\n/**\n * The base implementation of `getAllKeys` and `getAllKeysIn` which uses\n * `keysFunc` and `symbolsFunc` to get the enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @param {Function} symbolsFunc The function to get the symbols of `object`.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction baseGetAllKeys(object, keysFunc, symbolsFunc) {\n  var result = keysFunc(object);\n  return isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n}\n\nmodule.exports = baseGetAllKeys;\n","/**\n * The base implementation of `_.hasIn` without support for deep paths.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {Array|string} key The key to check.\n * @returns {boolean} Returns `true` if `key` exists, else `false`.\n */\nfunction baseHasIn(object, key) {\n  return object != null && key in Object(object);\n}\n\nmodule.exports = baseHasIn;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nmodule.exports = baseIsArguments;\n","var baseIsEqualDeep = require('./_baseIsEqualDeep'),\n    isObjectLike = require('./isObjectLike');\n\n/**\n * The base implementation of `_.isEqual` which supports partial comparisons\n * and tracks traversed objects.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Unordered comparison\n *  2 - Partial comparison\n * @param {Function} [customizer] The function to customize comparisons.\n * @param {Object} [stack] Tracks traversed `value` and `other` objects.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n */\nfunction baseIsEqual(value, other, bitmask, customizer, stack) {\n  if (value === other) {\n    return true;\n  }\n  if (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n    return value !== value && other !== other;\n  }\n  return baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n}\n\nmodule.exports = baseIsEqual;\n","var Stack = require('./_Stack'),\n    equalArrays = require('./_equalArrays'),\n    equalByTag = require('./_equalByTag'),\n    equalObjects = require('./_equalObjects'),\n    getTag = require('./_getTag'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isTypedArray = require('./isTypedArray');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqual` for arrays and objects which performs\n * deep comparisons and tracks traversed objects enabling objects with circular\n * references to be compared.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} [stack] Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction baseIsEqualDeep(object, other, bitmask, customizer, equalFunc, stack) {\n  var objIsArr = isArray(object),\n      othIsArr = isArray(other),\n      objTag = objIsArr ? arrayTag : getTag(object),\n      othTag = othIsArr ? arrayTag : getTag(other);\n\n  objTag = objTag == argsTag ? objectTag : objTag;\n  othTag = othTag == argsTag ? objectTag : othTag;\n\n  var objIsObj = objTag == objectTag,\n      othIsObj = othTag == objectTag,\n      isSameTag = objTag == othTag;\n\n  if (isSameTag && isBuffer(object)) {\n    if (!isBuffer(other)) {\n      return false;\n    }\n    objIsArr = true;\n    objIsObj = false;\n  }\n  if (isSameTag && !objIsObj) {\n    stack || (stack = new Stack);\n    return (objIsArr || isTypedArray(object))\n      ? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n      : equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n  }\n  if (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n    var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),\n        othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');\n\n    if (objIsWrapped || othIsWrapped) {\n      var objUnwrapped = objIsWrapped ? object.value() : object,\n          othUnwrapped = othIsWrapped ? other.value() : other;\n\n      stack || (stack = new Stack);\n      return equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n    }\n  }\n  if (!isSameTag) {\n    return false;\n  }\n  stack || (stack = new Stack);\n  return equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n}\n\nmodule.exports = baseIsEqualDeep;\n","var getTag = require('./_getTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]';\n\n/**\n * The base implementation of `_.isMap` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a map, else `false`.\n */\nfunction baseIsMap(value) {\n  return isObjectLike(value) && getTag(value) == mapTag;\n}\n\nmodule.exports = baseIsMap;\n","var Stack = require('./_Stack'),\n    baseIsEqual = require('./_baseIsEqual');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.isMatch` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to inspect.\n * @param {Object} source The object of property values to match.\n * @param {Array} matchData The property names, values, and compare flags to match.\n * @param {Function} [customizer] The function to customize comparisons.\n * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n */\nfunction baseIsMatch(object, source, matchData, customizer) {\n  var index = matchData.length,\n      length = index,\n      noCustomizer = !customizer;\n\n  if (object == null) {\n    return !length;\n  }\n  object = Object(object);\n  while (index--) {\n    var data = matchData[index];\n    if ((noCustomizer && data[2])\n          ? data[1] !== object[data[0]]\n          : !(data[0] in object)\n        ) {\n      return false;\n    }\n  }\n  while (++index < length) {\n    data = matchData[index];\n    var key = data[0],\n        objValue = object[key],\n        srcValue = data[1];\n\n    if (noCustomizer && data[2]) {\n      if (objValue === undefined && !(key in object)) {\n        return false;\n      }\n    } else {\n      var stack = new Stack;\n      if (customizer) {\n        var result = customizer(objValue, srcValue, key, object, source, stack);\n      }\n      if (!(result === undefined\n            ? baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG, customizer, stack)\n            : result\n          )) {\n        return false;\n      }\n    }\n  }\n  return true;\n}\n\nmodule.exports = baseIsMatch;\n","var isFunction = require('./isFunction'),\n    isMasked = require('./_isMasked'),\n    isObject = require('./isObject'),\n    toSource = require('./_toSource');\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\nmodule.exports = baseIsNative;\n","var getTag = require('./_getTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar setTag = '[object Set]';\n\n/**\n * The base implementation of `_.isSet` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a set, else `false`.\n */\nfunction baseIsSet(value) {\n  return isObjectLike(value) && getTag(value) == setTag;\n}\n\nmodule.exports = baseIsSet;\n","var baseGetTag = require('./_baseGetTag'),\n    isLength = require('./isLength'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nmodule.exports = baseIsTypedArray;\n","var baseMatches = require('./_baseMatches'),\n    baseMatchesProperty = require('./_baseMatchesProperty'),\n    identity = require('./identity'),\n    isArray = require('./isArray'),\n    property = require('./property');\n\n/**\n * The base implementation of `_.iteratee`.\n *\n * @private\n * @param {*} [value=_.identity] The value to convert to an iteratee.\n * @returns {Function} Returns the iteratee.\n */\nfunction baseIteratee(value) {\n  // Don't store the `typeof` result in a variable to avoid a JIT bug in Safari 9.\n  // See https://bugs.webkit.org/show_bug.cgi?id=156034 for more details.\n  if (typeof value == 'function') {\n    return value;\n  }\n  if (value == null) {\n    return identity;\n  }\n  if (typeof value == 'object') {\n    return isArray(value)\n      ? baseMatchesProperty(value[0], value[1])\n      : baseMatches(value);\n  }\n  return property(value);\n}\n\nmodule.exports = baseIteratee;\n","var isPrototype = require('./_isPrototype'),\n    nativeKeys = require('./_nativeKeys');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseKeys;\n","var isObject = require('./isObject'),\n    isPrototype = require('./_isPrototype'),\n    nativeKeysIn = require('./_nativeKeysIn');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keysIn` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeysIn(object) {\n  if (!isObject(object)) {\n    return nativeKeysIn(object);\n  }\n  var isProto = isPrototype(object),\n      result = [];\n\n  for (var key in object) {\n    if (!(key == 'constructor' && (isProto || !hasOwnProperty.call(object, key)))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseKeysIn;\n","var baseEach = require('./_baseEach'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * The base implementation of `_.map` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction baseMap(collection, iteratee) {\n  var index = -1,\n      result = isArrayLike(collection) ? Array(collection.length) : [];\n\n  baseEach(collection, function(value, key, collection) {\n    result[++index] = iteratee(value, key, collection);\n  });\n  return result;\n}\n\nmodule.exports = baseMap;\n","var baseIsMatch = require('./_baseIsMatch'),\n    getMatchData = require('./_getMatchData'),\n    matchesStrictComparable = require('./_matchesStrictComparable');\n\n/**\n * The base implementation of `_.matches` which doesn't clone `source`.\n *\n * @private\n * @param {Object} source The object of property values to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatches(source) {\n  var matchData = getMatchData(source);\n  if (matchData.length == 1 && matchData[0][2]) {\n    return matchesStrictComparable(matchData[0][0], matchData[0][1]);\n  }\n  return function(object) {\n    return object === source || baseIsMatch(object, source, matchData);\n  };\n}\n\nmodule.exports = baseMatches;\n","var baseIsEqual = require('./_baseIsEqual'),\n    get = require('./get'),\n    hasIn = require('./hasIn'),\n    isKey = require('./_isKey'),\n    isStrictComparable = require('./_isStrictComparable'),\n    matchesStrictComparable = require('./_matchesStrictComparable'),\n    toKey = require('./_toKey');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.matchesProperty` which doesn't clone `srcValue`.\n *\n * @private\n * @param {string} path The path of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatchesProperty(path, srcValue) {\n  if (isKey(path) && isStrictComparable(srcValue)) {\n    return matchesStrictComparable(toKey(path), srcValue);\n  }\n  return function(object) {\n    var objValue = get(object, path);\n    return (objValue === undefined && objValue === srcValue)\n      ? hasIn(object, path)\n      : baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG);\n  };\n}\n\nmodule.exports = baseMatchesProperty;\n","/**\n * The base implementation of `_.property` without support for deep paths.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction baseProperty(key) {\n  return function(object) {\n    return object == null ? undefined : object[key];\n  };\n}\n\nmodule.exports = baseProperty;\n","var baseGet = require('./_baseGet');\n\n/**\n * A specialized version of `baseProperty` which supports deep paths.\n *\n * @private\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction basePropertyDeep(path) {\n  return function(object) {\n    return baseGet(object, path);\n  };\n}\n\nmodule.exports = basePropertyDeep;\n","/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nmodule.exports = baseTimes;\n","var Symbol = require('./_Symbol'),\n    arrayMap = require('./_arrayMap'),\n    isArray = require('./isArray'),\n    isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isArray(value)) {\n    // Recursively convert values (susceptible to call stack limits).\n    return arrayMap(value, baseToString) + '';\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nmodule.exports = baseToString;\n","/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\nmodule.exports = baseUnary;\n","/**\n * Checks if a `cache` value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\nmodule.exports = cacheHas;\n","var identity = require('./identity');\n\n/**\n * Casts `value` to `identity` if it's not a function.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {Function} Returns cast function.\n */\nfunction castFunction(value) {\n  return typeof value == 'function' ? value : identity;\n}\n\nmodule.exports = castFunction;\n","var isArray = require('./isArray'),\n    isKey = require('./_isKey'),\n    stringToPath = require('./_stringToPath'),\n    toString = require('./toString');\n\n/**\n * Casts `value` to a path array if it's not one.\n *\n * @private\n * @param {*} value The value to inspect.\n * @param {Object} [object] The object to query keys on.\n * @returns {Array} Returns the cast property path array.\n */\nfunction castPath(value, object) {\n  if (isArray(value)) {\n    return value;\n  }\n  return isKey(value, object) ? [value] : stringToPath(toString(value));\n}\n\nmodule.exports = castPath;\n","var Uint8Array = require('./_Uint8Array');\n\n/**\n * Creates a clone of `arrayBuffer`.\n *\n * @private\n * @param {ArrayBuffer} arrayBuffer The array buffer to clone.\n * @returns {ArrayBuffer} Returns the cloned array buffer.\n */\nfunction cloneArrayBuffer(arrayBuffer) {\n  var result = new arrayBuffer.constructor(arrayBuffer.byteLength);\n  new Uint8Array(result).set(new Uint8Array(arrayBuffer));\n  return result;\n}\n\nmodule.exports = cloneArrayBuffer;\n","var root = require('./_root');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined,\n    allocUnsafe = Buffer ? Buffer.allocUnsafe : undefined;\n\n/**\n * Creates a clone of  `buffer`.\n *\n * @private\n * @param {Buffer} buffer The buffer to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Buffer} Returns the cloned buffer.\n */\nfunction cloneBuffer(buffer, isDeep) {\n  if (isDeep) {\n    return buffer.slice();\n  }\n  var length = buffer.length,\n      result = allocUnsafe ? allocUnsafe(length) : new buffer.constructor(length);\n\n  buffer.copy(result);\n  return result;\n}\n\nmodule.exports = cloneBuffer;\n","var cloneArrayBuffer = require('./_cloneArrayBuffer');\n\n/**\n * Creates a clone of `dataView`.\n *\n * @private\n * @param {Object} dataView The data view to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the cloned data view.\n */\nfunction cloneDataView(dataView, isDeep) {\n  var buffer = isDeep ? cloneArrayBuffer(dataView.buffer) : dataView.buffer;\n  return new dataView.constructor(buffer, dataView.byteOffset, dataView.byteLength);\n}\n\nmodule.exports = cloneDataView;\n","/** Used to match `RegExp` flags from their coerced string values. */\nvar reFlags = /\\w*$/;\n\n/**\n * Creates a clone of `regexp`.\n *\n * @private\n * @param {Object} regexp The regexp to clone.\n * @returns {Object} Returns the cloned regexp.\n */\nfunction cloneRegExp(regexp) {\n  var result = new regexp.constructor(regexp.source, reFlags.exec(regexp));\n  result.lastIndex = regexp.lastIndex;\n  return result;\n}\n\nmodule.exports = cloneRegExp;\n","var Symbol = require('./_Symbol');\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * Creates a clone of the `symbol` object.\n *\n * @private\n * @param {Object} symbol The symbol object to clone.\n * @returns {Object} Returns the cloned symbol object.\n */\nfunction cloneSymbol(symbol) {\n  return symbolValueOf ? Object(symbolValueOf.call(symbol)) : {};\n}\n\nmodule.exports = cloneSymbol;\n","var cloneArrayBuffer = require('./_cloneArrayBuffer');\n\n/**\n * Creates a clone of `typedArray`.\n *\n * @private\n * @param {Object} typedArray The typed array to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the cloned typed array.\n */\nfunction cloneTypedArray(typedArray, isDeep) {\n  var buffer = isDeep ? cloneArrayBuffer(typedArray.buffer) : typedArray.buffer;\n  return new typedArray.constructor(buffer, typedArray.byteOffset, typedArray.length);\n}\n\nmodule.exports = cloneTypedArray;\n","/**\n * Copies the values of `source` to `array`.\n *\n * @private\n * @param {Array} source The array to copy values from.\n * @param {Array} [array=[]] The array to copy values to.\n * @returns {Array} Returns `array`.\n */\nfunction copyArray(source, array) {\n  var index = -1,\n      length = source.length;\n\n  array || (array = Array(length));\n  while (++index < length) {\n    array[index] = source[index];\n  }\n  return array;\n}\n\nmodule.exports = copyArray;\n","var assignValue = require('./_assignValue'),\n    baseAssignValue = require('./_baseAssignValue');\n\n/**\n * Copies properties of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy properties from.\n * @param {Array} props The property identifiers to copy.\n * @param {Object} [object={}] The object to copy properties to.\n * @param {Function} [customizer] The function to customize copied values.\n * @returns {Object} Returns `object`.\n */\nfunction copyObject(source, props, object, customizer) {\n  var isNew = !object;\n  object || (object = {});\n\n  var index = -1,\n      length = props.length;\n\n  while (++index < length) {\n    var key = props[index];\n\n    var newValue = customizer\n      ? customizer(object[key], source[key], key, object, source)\n      : undefined;\n\n    if (newValue === undefined) {\n      newValue = source[key];\n    }\n    if (isNew) {\n      baseAssignValue(object, key, newValue);\n    } else {\n      assignValue(object, key, newValue);\n    }\n  }\n  return object;\n}\n\nmodule.exports = copyObject;\n","var copyObject = require('./_copyObject'),\n    getSymbols = require('./_getSymbols');\n\n/**\n * Copies own symbols of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy symbols from.\n * @param {Object} [object={}] The object to copy symbols to.\n * @returns {Object} Returns `object`.\n */\nfunction copySymbols(source, object) {\n  return copyObject(source, getSymbols(source), object);\n}\n\nmodule.exports = copySymbols;\n","var copyObject = require('./_copyObject'),\n    getSymbolsIn = require('./_getSymbolsIn');\n\n/**\n * Copies own and inherited symbols of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy symbols from.\n * @param {Object} [object={}] The object to copy symbols to.\n * @returns {Object} Returns `object`.\n */\nfunction copySymbolsIn(source, object) {\n  return copyObject(source, getSymbolsIn(source), object);\n}\n\nmodule.exports = copySymbolsIn;\n","var root = require('./_root');\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\nmodule.exports = coreJsData;\n","var isArrayLike = require('./isArrayLike');\n\n/**\n * Creates a `baseEach` or `baseEachRight` function.\n *\n * @private\n * @param {Function} eachFunc The function to iterate over a collection.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseEach(eachFunc, fromRight) {\n  return function(collection, iteratee) {\n    if (collection == null) {\n      return collection;\n    }\n    if (!isArrayLike(collection)) {\n      return eachFunc(collection, iteratee);\n    }\n    var length = collection.length,\n        index = fromRight ? length : -1,\n        iterable = Object(collection);\n\n    while ((fromRight ? index-- : ++index < length)) {\n      if (iteratee(iterable[index], index, iterable) === false) {\n        break;\n      }\n    }\n    return collection;\n  };\n}\n\nmodule.exports = createBaseEach;\n","/**\n * Creates a base function for methods like `_.forIn` and `_.forOwn`.\n *\n * @private\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseFor(fromRight) {\n  return function(object, iteratee, keysFunc) {\n    var index = -1,\n        iterable = Object(object),\n        props = keysFunc(object),\n        length = props.length;\n\n    while (length--) {\n      var key = props[fromRight ? length : ++index];\n      if (iteratee(iterable[key], key, iterable) === false) {\n        break;\n      }\n    }\n    return object;\n  };\n}\n\nmodule.exports = createBaseFor;\n","var getNative = require('./_getNative');\n\nvar defineProperty = (function() {\n  try {\n    var func = getNative(Object, 'defineProperty');\n    func({}, '', {});\n    return func;\n  } catch (e) {}\n}());\n\nmodule.exports = defineProperty;\n","var SetCache = require('./_SetCache'),\n    arraySome = require('./_arraySome'),\n    cacheHas = require('./_cacheHas');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * A specialized version of `baseIsEqualDeep` for arrays with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Array} array The array to compare.\n * @param {Array} other The other array to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `array` and `other` objects.\n * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.\n */\nfunction equalArrays(array, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      arrLength = array.length,\n      othLength = other.length;\n\n  if (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n    return false;\n  }\n  // Check that cyclic values are equal.\n  var arrStacked = stack.get(array);\n  var othStacked = stack.get(other);\n  if (arrStacked && othStacked) {\n    return arrStacked == other && othStacked == array;\n  }\n  var index = -1,\n      result = true,\n      seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache : undefined;\n\n  stack.set(array, other);\n  stack.set(other, array);\n\n  // Ignore non-index properties.\n  while (++index < arrLength) {\n    var arrValue = array[index],\n        othValue = other[index];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, arrValue, index, other, array, stack)\n        : customizer(arrValue, othValue, index, array, other, stack);\n    }\n    if (compared !== undefined) {\n      if (compared) {\n        continue;\n      }\n      result = false;\n      break;\n    }\n    // Recursively compare arrays (susceptible to call stack limits).\n    if (seen) {\n      if (!arraySome(other, function(othValue, othIndex) {\n            if (!cacheHas(seen, othIndex) &&\n                (arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n              return seen.push(othIndex);\n            }\n          })) {\n        result = false;\n        break;\n      }\n    } else if (!(\n          arrValue === othValue ||\n            equalFunc(arrValue, othValue, bitmask, customizer, stack)\n        )) {\n      result = false;\n      break;\n    }\n  }\n  stack['delete'](array);\n  stack['delete'](other);\n  return result;\n}\n\nmodule.exports = equalArrays;\n","var Symbol = require('./_Symbol'),\n    Uint8Array = require('./_Uint8Array'),\n    eq = require('./eq'),\n    equalArrays = require('./_equalArrays'),\n    mapToArray = require('./_mapToArray'),\n    setToArray = require('./_setToArray');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/** `Object#toString` result references. */\nvar boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]';\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * A specialized version of `baseIsEqualDeep` for comparing objects of\n * the same `toStringTag`.\n *\n * **Note:** This function only supports comparing values with tags of\n * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {string} tag The `toStringTag` of the objects to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalByTag(object, other, tag, bitmask, customizer, equalFunc, stack) {\n  switch (tag) {\n    case dataViewTag:\n      if ((object.byteLength != other.byteLength) ||\n          (object.byteOffset != other.byteOffset)) {\n        return false;\n      }\n      object = object.buffer;\n      other = other.buffer;\n\n    case arrayBufferTag:\n      if ((object.byteLength != other.byteLength) ||\n          !equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n        return false;\n      }\n      return true;\n\n    case boolTag:\n    case dateTag:\n    case numberTag:\n      // Coerce booleans to `1` or `0` and dates to milliseconds.\n      // Invalid dates are coerced to `NaN`.\n      return eq(+object, +other);\n\n    case errorTag:\n      return object.name == other.name && object.message == other.message;\n\n    case regexpTag:\n    case stringTag:\n      // Coerce regexes to strings and treat strings, primitives and objects,\n      // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n      // for more details.\n      return object == (other + '');\n\n    case mapTag:\n      var convert = mapToArray;\n\n    case setTag:\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n      convert || (convert = setToArray);\n\n      if (object.size != other.size && !isPartial) {\n        return false;\n      }\n      // Assume cyclic values are equal.\n      var stacked = stack.get(object);\n      if (stacked) {\n        return stacked == other;\n      }\n      bitmask |= COMPARE_UNORDERED_FLAG;\n\n      // Recursively compare objects (susceptible to call stack limits).\n      stack.set(object, other);\n      var result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n      stack['delete'](object);\n      return result;\n\n    case symbolTag:\n      if (symbolValueOf) {\n        return symbolValueOf.call(object) == symbolValueOf.call(other);\n      }\n  }\n  return false;\n}\n\nmodule.exports = equalByTag;\n","var getAllKeys = require('./_getAllKeys');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqualDeep` for objects with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalObjects(object, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      objProps = getAllKeys(object),\n      objLength = objProps.length,\n      othProps = getAllKeys(other),\n      othLength = othProps.length;\n\n  if (objLength != othLength && !isPartial) {\n    return false;\n  }\n  var index = objLength;\n  while (index--) {\n    var key = objProps[index];\n    if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n      return false;\n    }\n  }\n  // Check that cyclic values are equal.\n  var objStacked = stack.get(object);\n  var othStacked = stack.get(other);\n  if (objStacked && othStacked) {\n    return objStacked == other && othStacked == object;\n  }\n  var result = true;\n  stack.set(object, other);\n  stack.set(other, object);\n\n  var skipCtor = isPartial;\n  while (++index < objLength) {\n    key = objProps[index];\n    var objValue = object[key],\n        othValue = other[key];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, objValue, key, other, object, stack)\n        : customizer(objValue, othValue, key, object, other, stack);\n    }\n    // Recursively compare objects (susceptible to call stack limits).\n    if (!(compared === undefined\n          ? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n          : compared\n        )) {\n      result = false;\n      break;\n    }\n    skipCtor || (skipCtor = key == 'constructor');\n  }\n  if (result && !skipCtor) {\n    var objCtor = object.constructor,\n        othCtor = other.constructor;\n\n    // Non `Object` object instances with different constructors are not equal.\n    if (objCtor != othCtor &&\n        ('constructor' in object && 'constructor' in other) &&\n        !(typeof objCtor == 'function' && objCtor instanceof objCtor &&\n          typeof othCtor == 'function' && othCtor instanceof othCtor)) {\n      result = false;\n    }\n  }\n  stack['delete'](object);\n  stack['delete'](other);\n  return result;\n}\n\nmodule.exports = equalObjects;\n","var baseGetAllKeys = require('./_baseGetAllKeys'),\n    getSymbols = require('./_getSymbols'),\n    keys = require('./keys');\n\n/**\n * Creates an array of own enumerable property names and symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeys(object) {\n  return baseGetAllKeys(object, keys, getSymbols);\n}\n\nmodule.exports = getAllKeys;\n","var baseGetAllKeys = require('./_baseGetAllKeys'),\n    getSymbolsIn = require('./_getSymbolsIn'),\n    keysIn = require('./keysIn');\n\n/**\n * Creates an array of own and inherited enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeysIn(object) {\n  return baseGetAllKeys(object, keysIn, getSymbolsIn);\n}\n\nmodule.exports = getAllKeysIn;\n","var isKeyable = require('./_isKeyable');\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\nmodule.exports = getMapData;\n","var isStrictComparable = require('./_isStrictComparable'),\n    keys = require('./keys');\n\n/**\n * Gets the property names, values, and compare flags of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the match data of `object`.\n */\nfunction getMatchData(object) {\n  var result = keys(object),\n      length = result.length;\n\n  while (length--) {\n    var key = result[length],\n        value = object[key];\n\n    result[length] = [key, value, isStrictComparable(value)];\n  }\n  return result;\n}\n\nmodule.exports = getMatchData;\n","var baseIsNative = require('./_baseIsNative'),\n    getValue = require('./_getValue');\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\nmodule.exports = getNative;\n","var overArg = require('./_overArg');\n\n/** Built-in value references. */\nvar getPrototype = overArg(Object.getPrototypeOf, Object);\n\nmodule.exports = getPrototype;\n","var arrayFilter = require('./_arrayFilter'),\n    stubArray = require('./stubArray');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols;\n\n/**\n * Creates an array of the own enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbols = !nativeGetSymbols ? stubArray : function(object) {\n  if (object == null) {\n    return [];\n  }\n  object = Object(object);\n  return arrayFilter(nativeGetSymbols(object), function(symbol) {\n    return propertyIsEnumerable.call(object, symbol);\n  });\n};\n\nmodule.exports = getSymbols;\n","var arrayPush = require('./_arrayPush'),\n    getPrototype = require('./_getPrototype'),\n    getSymbols = require('./_getSymbols'),\n    stubArray = require('./stubArray');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols;\n\n/**\n * Creates an array of the own and inherited enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbolsIn = !nativeGetSymbols ? stubArray : function(object) {\n  var result = [];\n  while (object) {\n    arrayPush(result, getSymbols(object));\n    object = getPrototype(object);\n  }\n  return result;\n};\n\nmodule.exports = getSymbolsIn;\n","var DataView = require('./_DataView'),\n    Map = require('./_Map'),\n    Promise = require('./_Promise'),\n    Set = require('./_Set'),\n    WeakMap = require('./_WeakMap'),\n    baseGetTag = require('./_baseGetTag'),\n    toSource = require('./_toSource');\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]',\n    objectTag = '[object Object]',\n    promiseTag = '[object Promise]',\n    setTag = '[object Set]',\n    weakMapTag = '[object WeakMap]';\n\nvar dataViewTag = '[object DataView]';\n\n/** Used to detect maps, sets, and weakmaps. */\nvar dataViewCtorString = toSource(DataView),\n    mapCtorString = toSource(Map),\n    promiseCtorString = toSource(Promise),\n    setCtorString = toSource(Set),\n    weakMapCtorString = toSource(WeakMap);\n\n/**\n * Gets the `toStringTag` of `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nvar getTag = baseGetTag;\n\n// Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\nif ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||\n    (Map && getTag(new Map) != mapTag) ||\n    (Promise && getTag(Promise.resolve()) != promiseTag) ||\n    (Set && getTag(new Set) != setTag) ||\n    (WeakMap && getTag(new WeakMap) != weakMapTag)) {\n  getTag = function(value) {\n    var result = baseGetTag(value),\n        Ctor = result == objectTag ? value.constructor : undefined,\n        ctorString = Ctor ? toSource(Ctor) : '';\n\n    if (ctorString) {\n      switch (ctorString) {\n        case dataViewCtorString: return dataViewTag;\n        case mapCtorString: return mapTag;\n        case promiseCtorString: return promiseTag;\n        case setCtorString: return setTag;\n        case weakMapCtorString: return weakMapTag;\n      }\n    }\n    return result;\n  };\n}\n\nmodule.exports = getTag;\n","/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nmodule.exports = getValue;\n","var castPath = require('./_castPath'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isIndex = require('./_isIndex'),\n    isLength = require('./isLength'),\n    toKey = require('./_toKey');\n\n/**\n * Checks if `path` exists on `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @param {Function} hasFunc The function to check properties.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n */\nfunction hasPath(object, path, hasFunc) {\n  path = castPath(path, object);\n\n  var index = -1,\n      length = path.length,\n      result = false;\n\n  while (++index < length) {\n    var key = toKey(path[index]);\n    if (!(result = object != null && hasFunc(object, key))) {\n      break;\n    }\n    object = object[key];\n  }\n  if (result || ++index != length) {\n    return result;\n  }\n  length = object == null ? 0 : object.length;\n  return !!length && isLength(length) && isIndex(key, length) &&\n    (isArray(object) || isArguments(object));\n}\n\nmodule.exports = hasPath;\n","var nativeCreate = require('./_nativeCreate');\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n  this.size = 0;\n}\n\nmodule.exports = hashClear;\n","/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nmodule.exports = hashDelete;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\nmodule.exports = hashGet;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n}\n\nmodule.exports = hashHas;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  this.size += this.has(key) ? 0 : 1;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\nmodule.exports = hashSet;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Initializes an array clone.\n *\n * @private\n * @param {Array} array The array to clone.\n * @returns {Array} Returns the initialized clone.\n */\nfunction initCloneArray(array) {\n  var length = array.length,\n      result = new array.constructor(length);\n\n  // Add properties assigned by `RegExp#exec`.\n  if (length && typeof array[0] == 'string' && hasOwnProperty.call(array, 'index')) {\n    result.index = array.index;\n    result.input = array.input;\n  }\n  return result;\n}\n\nmodule.exports = initCloneArray;\n","var cloneArrayBuffer = require('./_cloneArrayBuffer'),\n    cloneDataView = require('./_cloneDataView'),\n    cloneRegExp = require('./_cloneRegExp'),\n    cloneSymbol = require('./_cloneSymbol'),\n    cloneTypedArray = require('./_cloneTypedArray');\n\n/** `Object#toString` result references. */\nvar boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/**\n * Initializes an object clone based on its `toStringTag`.\n *\n * **Note:** This function only supports cloning values with tags of\n * `Boolean`, `Date`, `Error`, `Map`, `Number`, `RegExp`, `Set`, or `String`.\n *\n * @private\n * @param {Object} object The object to clone.\n * @param {string} tag The `toStringTag` of the object to clone.\n * @param {boolean} [isDeep] Specify a deep clone.\n * @returns {Object} Returns the initialized clone.\n */\nfunction initCloneByTag(object, tag, isDeep) {\n  var Ctor = object.constructor;\n  switch (tag) {\n    case arrayBufferTag:\n      return cloneArrayBuffer(object);\n\n    case boolTag:\n    case dateTag:\n      return new Ctor(+object);\n\n    case dataViewTag:\n      return cloneDataView(object, isDeep);\n\n    case float32Tag: case float64Tag:\n    case int8Tag: case int16Tag: case int32Tag:\n    case uint8Tag: case uint8ClampedTag: case uint16Tag: case uint32Tag:\n      return cloneTypedArray(object, isDeep);\n\n    case mapTag:\n      return new Ctor;\n\n    case numberTag:\n    case stringTag:\n      return new Ctor(object);\n\n    case regexpTag:\n      return cloneRegExp(object);\n\n    case setTag:\n      return new Ctor;\n\n    case symbolTag:\n      return cloneSymbol(object);\n  }\n}\n\nmodule.exports = initCloneByTag;\n","var baseCreate = require('./_baseCreate'),\n    getPrototype = require('./_getPrototype'),\n    isPrototype = require('./_isPrototype');\n\n/**\n * Initializes an object clone.\n *\n * @private\n * @param {Object} object The object to clone.\n * @returns {Object} Returns the initialized clone.\n */\nfunction initCloneObject(object) {\n  return (typeof object.constructor == 'function' && !isPrototype(object))\n    ? baseCreate(getPrototype(object))\n    : {};\n}\n\nmodule.exports = initCloneObject;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  var type = typeof value;\n  length = length == null ? MAX_SAFE_INTEGER : length;\n\n  return !!length &&\n    (type == 'number' ||\n      (type != 'symbol' && reIsUint.test(value))) &&\n        (value > -1 && value % 1 == 0 && value < length);\n}\n\nmodule.exports = isIndex;\n","var isArray = require('./isArray'),\n    isSymbol = require('./isSymbol');\n\n/** Used to match property names within property paths. */\nvar reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n    reIsPlainProp = /^\\w*$/;\n\n/**\n * Checks if `value` is a property name and not a property path.\n *\n * @private\n * @param {*} value The value to check.\n * @param {Object} [object] The object to query keys on.\n * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n */\nfunction isKey(value, object) {\n  if (isArray(value)) {\n    return false;\n  }\n  var type = typeof value;\n  if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n      value == null || isSymbol(value)) {\n    return true;\n  }\n  return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n    (object != null && value in Object(object));\n}\n\nmodule.exports = isKey;\n","/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\nmodule.exports = isKeyable;\n","var coreJsData = require('./_coreJsData');\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nmodule.exports = isMasked;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\nmodule.exports = isPrototype;\n","var isObject = require('./isObject');\n\n/**\n * Checks if `value` is suitable for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` if suitable for strict\n *  equality comparisons, else `false`.\n */\nfunction isStrictComparable(value) {\n  return value === value && !isObject(value);\n}\n\nmodule.exports = isStrictComparable;\n","/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\nmodule.exports = listCacheClear;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/** Built-in value references. */\nvar splice = arrayProto.splice;\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  --this.size;\n  return true;\n}\n\nmodule.exports = listCacheDelete;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\nmodule.exports = listCacheGet;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\nmodule.exports = listCacheHas;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    ++this.size;\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\nmodule.exports = listCacheSet;\n","var Hash = require('./_Hash'),\n    ListCache = require('./_ListCache'),\n    Map = require('./_Map');\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.size = 0;\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\nmodule.exports = mapCacheClear;\n","var getMapData = require('./_getMapData');\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  var result = getMapData(this, key)['delete'](key);\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nmodule.exports = mapCacheDelete;\n","var getMapData = require('./_getMapData');\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\nmodule.exports = mapCacheGet;\n","var getMapData = require('./_getMapData');\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\nmodule.exports = mapCacheHas;\n","var getMapData = require('./_getMapData');\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  var data = getMapData(this, key),\n      size = data.size;\n\n  data.set(key, value);\n  this.size += data.size == size ? 0 : 1;\n  return this;\n}\n\nmodule.exports = mapCacheSet;\n","/**\n * Converts `map` to its key-value pairs.\n *\n * @private\n * @param {Object} map The map to convert.\n * @returns {Array} Returns the key-value pairs.\n */\nfunction mapToArray(map) {\n  var index = -1,\n      result = Array(map.size);\n\n  map.forEach(function(value, key) {\n    result[++index] = [key, value];\n  });\n  return result;\n}\n\nmodule.exports = mapToArray;\n","/**\n * A specialized version of `matchesProperty` for source values suitable\n * for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction matchesStrictComparable(key, srcValue) {\n  return function(object) {\n    if (object == null) {\n      return false;\n    }\n    return object[key] === srcValue &&\n      (srcValue !== undefined || (key in Object(object)));\n  };\n}\n\nmodule.exports = matchesStrictComparable;\n","var memoize = require('./memoize');\n\n/** Used as the maximum memoize cache size. */\nvar MAX_MEMOIZE_SIZE = 500;\n\n/**\n * A specialized version of `_.memoize` which clears the memoized function's\n * cache when it exceeds `MAX_MEMOIZE_SIZE`.\n *\n * @private\n * @param {Function} func The function to have its output memoized.\n * @returns {Function} Returns the new memoized function.\n */\nfunction memoizeCapped(func) {\n  var result = memoize(func, function(key) {\n    if (cache.size === MAX_MEMOIZE_SIZE) {\n      cache.clear();\n    }\n    return key;\n  });\n\n  var cache = result.cache;\n  return result;\n}\n\nmodule.exports = memoizeCapped;\n","var getNative = require('./_getNative');\n\n/* Built-in method references that are verified to be native. */\nvar nativeCreate = getNative(Object, 'create');\n\nmodule.exports = nativeCreate;\n","var overArg = require('./_overArg');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object);\n\nmodule.exports = nativeKeys;\n","/**\n * This function is like\n * [`Object.keys`](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * except that it includes inherited enumerable properties.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction nativeKeysIn(object) {\n  var result = [];\n  if (object != null) {\n    for (var key in Object(object)) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = nativeKeysIn;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    // Use `util.types` for Node.js 10+.\n    var types = freeModule && freeModule.require && freeModule.require('util').types;\n\n    if (types) {\n      return types;\n    }\n\n    // Legacy `process.binding('util')` for Node.js < 10.\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\nmodule.exports = nodeUtil;\n","/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nmodule.exports = overArg;\n","/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\nmodule.exports = setCacheAdd;\n","/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\nmodule.exports = setCacheHas;\n","/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\nmodule.exports = setToArray;\n","var ListCache = require('./_ListCache');\n\n/**\n * Removes all key-value entries from the stack.\n *\n * @private\n * @name clear\n * @memberOf Stack\n */\nfunction stackClear() {\n  this.__data__ = new ListCache;\n  this.size = 0;\n}\n\nmodule.exports = stackClear;\n","/**\n * Removes `key` and its value from the stack.\n *\n * @private\n * @name delete\n * @memberOf Stack\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction stackDelete(key) {\n  var data = this.__data__,\n      result = data['delete'](key);\n\n  this.size = data.size;\n  return result;\n}\n\nmodule.exports = stackDelete;\n","/**\n * Gets the stack value for `key`.\n *\n * @private\n * @name get\n * @memberOf Stack\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction stackGet(key) {\n  return this.__data__.get(key);\n}\n\nmodule.exports = stackGet;\n","/**\n * Checks if a stack value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Stack\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction stackHas(key) {\n  return this.__data__.has(key);\n}\n\nmodule.exports = stackHas;\n","var ListCache = require('./_ListCache'),\n    Map = require('./_Map'),\n    MapCache = require('./_MapCache');\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * Sets the stack `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Stack\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the stack cache instance.\n */\nfunction stackSet(key, value) {\n  var data = this.__data__;\n  if (data instanceof ListCache) {\n    var pairs = data.__data__;\n    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n      pairs.push([key, value]);\n      this.size = ++data.size;\n      return this;\n    }\n    data = this.__data__ = new MapCache(pairs);\n  }\n  data.set(key, value);\n  this.size = data.size;\n  return this;\n}\n\nmodule.exports = stackSet;\n","var memoizeCapped = require('./_memoizeCapped');\n\n/** Used to match property names within property paths. */\nvar rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g;\n\n/** Used to match backslashes in property paths. */\nvar reEscapeChar = /\\\\(\\\\)?/g;\n\n/**\n * Converts `string` to a property path array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the property path array.\n */\nvar stringToPath = memoizeCapped(function(string) {\n  var result = [];\n  if (string.charCodeAt(0) === 46 /* . */) {\n    result.push('');\n  }\n  string.replace(rePropName, function(match, number, quote, subString) {\n    result.push(quote ? subString.replace(reEscapeChar, '$1') : (number || match));\n  });\n  return result;\n});\n\nmodule.exports = stringToPath;\n","var isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Converts `value` to a string key if it's not a string or symbol.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {string|symbol} Returns the key.\n */\nfunction toKey(value) {\n  if (typeof value == 'string' || isSymbol(value)) {\n    return value;\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nmodule.exports = toKey;\n","/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nmodule.exports = toSource;\n","var baseClone = require('./_baseClone');\n\n/** Used to compose bitmasks for cloning. */\nvar CLONE_DEEP_FLAG = 1,\n    CLONE_SYMBOLS_FLAG = 4;\n\n/**\n * This method is like `_.clone` except that it recursively clones `value`.\n *\n * @static\n * @memberOf _\n * @since 1.0.0\n * @category Lang\n * @param {*} value The value to recursively clone.\n * @returns {*} Returns the deep cloned value.\n * @see _.clone\n * @example\n *\n * var objects = [{ 'a': 1 }, { 'b': 2 }];\n *\n * var deep = _.cloneDeep(objects);\n * console.log(deep[0] === objects[0]);\n * // => false\n */\nfunction cloneDeep(value) {\n  return baseClone(value, CLONE_DEEP_FLAG | CLONE_SYMBOLS_FLAG);\n}\n\nmodule.exports = cloneDeep;\n","/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nmodule.exports = eq;\n","var baseForOwn = require('./_baseForOwn'),\n    castFunction = require('./_castFunction');\n\n/**\n * Iterates over own enumerable string keyed properties of an object and\n * invokes `iteratee` for each property. The iteratee is invoked with three\n * arguments: (value, key, object). Iteratee functions may exit iteration\n * early by explicitly returning `false`.\n *\n * @static\n * @memberOf _\n * @since 0.3.0\n * @category Object\n * @param {Object} object The object to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Object} Returns `object`.\n * @see _.forOwnRight\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.forOwn(new Foo, function(value, key) {\n *   console.log(key);\n * });\n * // => Logs 'a' then 'b' (iteration order is not guaranteed).\n */\nfunction forOwn(object, iteratee) {\n  return object && baseForOwn(object, castFunction(iteratee));\n}\n\nmodule.exports = forOwn;\n","var baseGet = require('./_baseGet');\n\n/**\n * Gets the value at `path` of `object`. If the resolved value is\n * `undefined`, the `defaultValue` is returned in its place.\n *\n * @static\n * @memberOf _\n * @since 3.7.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n * @returns {*} Returns the resolved value.\n * @example\n *\n * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n *\n * _.get(object, 'a[0].b.c');\n * // => 3\n *\n * _.get(object, ['a', '0', 'b', 'c']);\n * // => 3\n *\n * _.get(object, 'a.b.c', 'default');\n * // => 'default'\n */\nfunction get(object, path, defaultValue) {\n  var result = object == null ? undefined : baseGet(object, path);\n  return result === undefined ? defaultValue : result;\n}\n\nmodule.exports = get;\n","var baseHasIn = require('./_baseHasIn'),\n    hasPath = require('./_hasPath');\n\n/**\n * Checks if `path` is a direct or inherited property of `object`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n * @example\n *\n * var object = _.create({ 'a': _.create({ 'b': 2 }) });\n *\n * _.hasIn(object, 'a');\n * // => true\n *\n * _.hasIn(object, 'a.b');\n * // => true\n *\n * _.hasIn(object, ['a', 'b']);\n * // => true\n *\n * _.hasIn(object, 'b');\n * // => false\n */\nfunction hasIn(object, path) {\n  return object != null && hasPath(object, path, baseHasIn);\n}\n\nmodule.exports = hasIn;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nmodule.exports = identity;\n","var baseIsArguments = require('./_baseIsArguments'),\n    isObjectLike = require('./isObjectLike');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nmodule.exports = isArguments;\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nmodule.exports = isArray;\n","var isFunction = require('./isFunction'),\n    isLength = require('./isLength');\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\nmodule.exports = isArrayLike;\n","var root = require('./_root'),\n    stubFalse = require('./stubFalse');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\nmodule.exports = isBuffer;\n","var baseGetTag = require('./_baseGetTag'),\n    isObject = require('./isObject');\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nmodule.exports = isFunction;\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\nmodule.exports = isLength;\n","var baseIsMap = require('./_baseIsMap'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsMap = nodeUtil && nodeUtil.isMap;\n\n/**\n * Checks if `value` is classified as a `Map` object.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a map, else `false`.\n * @example\n *\n * _.isMap(new Map);\n * // => true\n *\n * _.isMap(new WeakMap);\n * // => false\n */\nvar isMap = nodeIsMap ? baseUnary(nodeIsMap) : baseIsMap;\n\nmodule.exports = isMap;\n","var baseGetTag = require('./_baseGetTag'),\n    getPrototype = require('./_getPrototype'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to infer the `Object` constructor. */\nvar objectCtorString = funcToString.call(Object);\n\n/**\n * Checks if `value` is a plain object, that is, an object created by the\n * `Object` constructor or one with a `[[Prototype]]` of `null`.\n *\n * @static\n * @memberOf _\n * @since 0.8.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a plain object, else `false`.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * _.isPlainObject(new Foo);\n * // => false\n *\n * _.isPlainObject([1, 2, 3]);\n * // => false\n *\n * _.isPlainObject({ 'x': 0, 'y': 0 });\n * // => true\n *\n * _.isPlainObject(Object.create(null));\n * // => true\n */\nfunction isPlainObject(value) {\n  if (!isObjectLike(value) || baseGetTag(value) != objectTag) {\n    return false;\n  }\n  var proto = getPrototype(value);\n  if (proto === null) {\n    return true;\n  }\n  var Ctor = hasOwnProperty.call(proto, 'constructor') && proto.constructor;\n  return typeof Ctor == 'function' && Ctor instanceof Ctor &&\n    funcToString.call(Ctor) == objectCtorString;\n}\n\nmodule.exports = isPlainObject;\n","var baseIsSet = require('./_baseIsSet'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsSet = nodeUtil && nodeUtil.isSet;\n\n/**\n * Checks if `value` is classified as a `Set` object.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a set, else `false`.\n * @example\n *\n * _.isSet(new Set);\n * // => true\n *\n * _.isSet(new WeakSet);\n * // => false\n */\nvar isSet = nodeIsSet ? baseUnary(nodeIsSet) : baseIsSet;\n\nmodule.exports = isSet;\n","var baseGetTag = require('./_baseGetTag'),\n    isArray = require('./isArray'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar stringTag = '[object String]';\n\n/**\n * Checks if `value` is classified as a `String` primitive or object.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a string, else `false`.\n * @example\n *\n * _.isString('abc');\n * // => true\n *\n * _.isString(1);\n * // => false\n */\nfunction isString(value) {\n  return typeof value == 'string' ||\n    (!isArray(value) && isObjectLike(value) && baseGetTag(value) == stringTag);\n}\n\nmodule.exports = isString;\n","var baseIsTypedArray = require('./_baseIsTypedArray'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\nmodule.exports = isTypedArray;\n","var arrayLikeKeys = require('./_arrayLikeKeys'),\n    baseKeys = require('./_baseKeys'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nmodule.exports = keys;\n","var arrayLikeKeys = require('./_arrayLikeKeys'),\n    baseKeysIn = require('./_baseKeysIn'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * Creates an array of the own and inherited enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keysIn(new Foo);\n * // => ['a', 'b', 'c'] (iteration order is not guaranteed)\n */\nfunction keysIn(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object, true) : baseKeysIn(object);\n}\n\nmodule.exports = keysIn;\n","var arrayMap = require('./_arrayMap'),\n    baseIteratee = require('./_baseIteratee'),\n    baseMap = require('./_baseMap'),\n    isArray = require('./isArray');\n\n/**\n * Creates an array of values by running each element in `collection` thru\n * `iteratee`. The iteratee is invoked with three arguments:\n * (value, index|key, collection).\n *\n * Many lodash methods are guarded to work as iteratees for methods like\n * `_.every`, `_.filter`, `_.map`, `_.mapValues`, `_.reject`, and `_.some`.\n *\n * The guarded methods are:\n * `ary`, `chunk`, `curry`, `curryRight`, `drop`, `dropRight`, `every`,\n * `fill`, `invert`, `parseInt`, `random`, `range`, `rangeRight`, `repeat`,\n * `sampleSize`, `slice`, `some`, `sortBy`, `split`, `take`, `takeRight`,\n * `template`, `trim`, `trimEnd`, `trimStart`, and `words`\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n * @example\n *\n * function square(n) {\n *   return n * n;\n * }\n *\n * _.map([4, 8], square);\n * // => [16, 64]\n *\n * _.map({ 'a': 4, 'b': 8 }, square);\n * // => [16, 64] (iteration order is not guaranteed)\n *\n * var users = [\n *   { 'user': 'barney' },\n *   { 'user': 'fred' }\n * ];\n *\n * // The `_.property` iteratee shorthand.\n * _.map(users, 'user');\n * // => ['barney', 'fred']\n */\nfunction map(collection, iteratee) {\n  var func = isArray(collection) ? arrayMap : baseMap;\n  return func(collection, baseIteratee(iteratee, 3));\n}\n\nmodule.exports = map;\n","var MapCache = require('./_MapCache');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a function that memoizes the result of `func`. If `resolver` is\n * provided, it determines the cache key for storing the result based on the\n * arguments provided to the memoized function. By default, the first argument\n * provided to the memoized function is used as the map cache key. The `func`\n * is invoked with the `this` binding of the memoized function.\n *\n * **Note:** The cache is exposed as the `cache` property on the memoized\n * function. Its creation may be customized by replacing the `_.memoize.Cache`\n * constructor with one whose instances implement the\n * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)\n * method interface of `clear`, `delete`, `get`, `has`, and `set`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to have its output memoized.\n * @param {Function} [resolver] The function to resolve the cache key.\n * @returns {Function} Returns the new memoized function.\n * @example\n *\n * var object = { 'a': 1, 'b': 2 };\n * var other = { 'c': 3, 'd': 4 };\n *\n * var values = _.memoize(_.values);\n * values(object);\n * // => [1, 2]\n *\n * values(other);\n * // => [3, 4]\n *\n * object.a = 2;\n * values(object);\n * // => [1, 2]\n *\n * // Modify the result cache.\n * values.cache.set(object, ['a', 'b']);\n * values(object);\n * // => ['a', 'b']\n *\n * // Replace `_.memoize.Cache`.\n * _.memoize.Cache = WeakMap;\n */\nfunction memoize(func, resolver) {\n  if (typeof func != 'function' || (resolver != null && typeof resolver != 'function')) {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  var memoized = function() {\n    var args = arguments,\n        key = resolver ? resolver.apply(this, args) : args[0],\n        cache = memoized.cache;\n\n    if (cache.has(key)) {\n      return cache.get(key);\n    }\n    var result = func.apply(this, args);\n    memoized.cache = cache.set(key, result) || cache;\n    return result;\n  };\n  memoized.cache = new (memoize.Cache || MapCache);\n  return memoized;\n}\n\n// Expose `MapCache`.\nmemoize.Cache = MapCache;\n\nmodule.exports = memoize;\n","var baseProperty = require('./_baseProperty'),\n    basePropertyDeep = require('./_basePropertyDeep'),\n    isKey = require('./_isKey'),\n    toKey = require('./_toKey');\n\n/**\n * Creates a function that returns the value at `path` of a given object.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n * @example\n *\n * var objects = [\n *   { 'a': { 'b': 2 } },\n *   { 'a': { 'b': 1 } }\n * ];\n *\n * _.map(objects, _.property('a.b'));\n * // => [2, 1]\n *\n * _.map(_.sortBy(objects, _.property(['a', 'b'])), 'a.b');\n * // => [1, 2]\n */\nfunction property(path) {\n  return isKey(path) ? baseProperty(toKey(path)) : basePropertyDeep(path);\n}\n\nmodule.exports = property;\n","/**\n * This method returns a new empty array.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {Array} Returns the new empty array.\n * @example\n *\n * var arrays = _.times(2, _.stubArray);\n *\n * console.log(arrays);\n * // => [[], []]\n *\n * console.log(arrays[0] === arrays[1]);\n * // => false\n */\nfunction stubArray() {\n  return [];\n}\n\nmodule.exports = stubArray;\n","/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nmodule.exports = stubFalse;\n","var baseToString = require('./_baseToString');\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\nmodule.exports = toString;\n","var checkboardCache = {};\n\nexport var render = function render(c1, c2, size, serverCanvas) {\n  if (typeof document === 'undefined' && !serverCanvas) {\n    return null;\n  }\n  var canvas = serverCanvas ? new serverCanvas() : document.createElement('canvas');\n  canvas.width = size * 2;\n  canvas.height = size * 2;\n  var ctx = canvas.getContext('2d');\n  if (!ctx) {\n    return null;\n  } // If no context can be found, return early.\n  ctx.fillStyle = c1;\n  ctx.fillRect(0, 0, canvas.width, canvas.height);\n  ctx.fillStyle = c2;\n  ctx.fillRect(0, 0, size, size);\n  ctx.translate(size, size);\n  ctx.fillRect(0, 0, size, size);\n  return canvas.toDataURL();\n};\n\nexport var get = function get(c1, c2, size, serverCanvas) {\n  var key = c1 + '-' + c2 + '-' + size + (serverCanvas ? '-server' : '');\n\n  if (checkboardCache[key]) {\n    return checkboardCache[key];\n  }\n\n  var checkboard = render(c1, c2, size, serverCanvas);\n  checkboardCache[key] = checkboard;\n  return checkboard;\n};","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport React, { isValidElement } from 'react';\nimport reactCSS from 'reactcss';\nimport * as checkboard from '../../helpers/checkboard';\n\nexport var Checkboard = function Checkboard(_ref) {\n  var white = _ref.white,\n      grey = _ref.grey,\n      size = _ref.size,\n      renderers = _ref.renderers,\n      borderRadius = _ref.borderRadius,\n      boxShadow = _ref.boxShadow,\n      children = _ref.children;\n\n  var styles = reactCSS({\n    'default': {\n      grid: {\n        borderRadius: borderRadius,\n        boxShadow: boxShadow,\n        absolute: '0px 0px 0px 0px',\n        background: 'url(' + checkboard.get(white, grey, size, renderers.canvas) + ') center left'\n      }\n    }\n  });\n  return isValidElement(children) ? React.cloneElement(children, _extends({}, children.props, { style: _extends({}, children.props.style, styles.grid) })) : React.createElement('div', { style: styles.grid });\n};\n\nCheckboard.defaultProps = {\n  size: 8,\n  white: 'transparent',\n  grey: 'rgba(0,0,0,.08)',\n  renderers: {}\n};\n\nexport default Checkboard;","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport React, { Component, PureComponent } from 'react';\nimport reactCSS from 'reactcss';\nimport * as alpha from '../../helpers/alpha';\n\nimport Checkboard from './Checkboard';\n\nexport var Alpha = function (_ref) {\n  _inherits(Alpha, _ref);\n\n  function Alpha() {\n    var _ref2;\n\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, Alpha);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref2 = Alpha.__proto__ || Object.getPrototypeOf(Alpha)).call.apply(_ref2, [this].concat(args))), _this), _this.handleChange = function (e) {\n      var change = alpha.calculateChange(e, _this.props.hsl, _this.props.direction, _this.props.a, _this.container);\n      change && typeof _this.props.onChange === 'function' && _this.props.onChange(change, e);\n    }, _this.handleMouseDown = function (e) {\n      _this.handleChange(e);\n      window.addEventListener('mousemove', _this.handleChange);\n      window.addEventListener('mouseup', _this.handleMouseUp);\n    }, _this.handleMouseUp = function () {\n      _this.unbindEventListeners();\n    }, _this.unbindEventListeners = function () {\n      window.removeEventListener('mousemove', _this.handleChange);\n      window.removeEventListener('mouseup', _this.handleMouseUp);\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  _createClass(Alpha, [{\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      this.unbindEventListeners();\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      var rgb = this.props.rgb;\n      var styles = reactCSS({\n        'default': {\n          alpha: {\n            absolute: '0px 0px 0px 0px',\n            borderRadius: this.props.radius\n          },\n          checkboard: {\n            absolute: '0px 0px 0px 0px',\n            overflow: 'hidden',\n            borderRadius: this.props.radius\n          },\n          gradient: {\n            absolute: '0px 0px 0px 0px',\n            background: 'linear-gradient(to right, rgba(' + rgb.r + ',' + rgb.g + ',' + rgb.b + ', 0) 0%,\\n           rgba(' + rgb.r + ',' + rgb.g + ',' + rgb.b + ', 1) 100%)',\n            boxShadow: this.props.shadow,\n            borderRadius: this.props.radius\n          },\n          container: {\n            position: 'relative',\n            height: '100%',\n            margin: '0 3px'\n          },\n          pointer: {\n            position: 'absolute',\n            left: rgb.a * 100 + '%'\n          },\n          slider: {\n            width: '4px',\n            borderRadius: '1px',\n            height: '8px',\n            boxShadow: '0 0 2px rgba(0, 0, 0, .6)',\n            background: '#fff',\n            marginTop: '1px',\n            transform: 'translateX(-2px)'\n          }\n        },\n        'vertical': {\n          gradient: {\n            background: 'linear-gradient(to bottom, rgba(' + rgb.r + ',' + rgb.g + ',' + rgb.b + ', 0) 0%,\\n           rgba(' + rgb.r + ',' + rgb.g + ',' + rgb.b + ', 1) 100%)'\n          },\n          pointer: {\n            left: 0,\n            top: rgb.a * 100 + '%'\n          }\n        },\n        'overwrite': _extends({}, this.props.style)\n      }, {\n        vertical: this.props.direction === 'vertical',\n        overwrite: true\n      });\n\n      return React.createElement(\n        'div',\n        { style: styles.alpha },\n        React.createElement(\n          'div',\n          { style: styles.checkboard },\n          React.createElement(Checkboard, { renderers: this.props.renderers })\n        ),\n        React.createElement('div', { style: styles.gradient }),\n        React.createElement(\n          'div',\n          {\n            style: styles.container,\n            ref: function ref(container) {\n              return _this2.container = container;\n            },\n            onMouseDown: this.handleMouseDown,\n            onTouchMove: this.handleChange,\n            onTouchStart: this.handleChange\n          },\n          React.createElement(\n            'div',\n            { style: styles.pointer },\n            this.props.pointer ? React.createElement(this.props.pointer, this.props) : React.createElement('div', { style: styles.slider })\n          )\n        )\n      );\n    }\n  }]);\n\n  return Alpha;\n}(PureComponent || Component);\n\nexport default Alpha;","export var calculateChange = function calculateChange(e, hsl, direction, initialA, container) {\n  var containerWidth = container.clientWidth;\n  var containerHeight = container.clientHeight;\n  var x = typeof e.pageX === 'number' ? e.pageX : e.touches[0].pageX;\n  var y = typeof e.pageY === 'number' ? e.pageY : e.touches[0].pageY;\n  var left = x - (container.getBoundingClientRect().left + window.pageXOffset);\n  var top = y - (container.getBoundingClientRect().top + window.pageYOffset);\n\n  if (direction === 'vertical') {\n    var a = void 0;\n    if (top < 0) {\n      a = 0;\n    } else if (top > containerHeight) {\n      a = 1;\n    } else {\n      a = Math.round(top * 100 / containerHeight) / 100;\n    }\n\n    if (hsl.a !== a) {\n      return {\n        h: hsl.h,\n        s: hsl.s,\n        l: hsl.l,\n        a: a,\n        source: 'rgb'\n      };\n    }\n  } else {\n    var _a = void 0;\n    if (left < 0) {\n      _a = 0;\n    } else if (left > containerWidth) {\n      _a = 1;\n    } else {\n      _a = Math.round(left * 100 / containerWidth) / 100;\n    }\n\n    if (initialA !== _a) {\n      return {\n        h: hsl.h,\n        s: hsl.s,\n        l: hsl.l,\n        a: _a,\n        source: 'rgb'\n      };\n    }\n  }\n  return null;\n};","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport React, { Component, PureComponent } from 'react';\nimport reactCSS from 'reactcss';\n\nvar DEFAULT_ARROW_OFFSET = 1;\n\nvar UP_KEY_CODE = 38;\nvar DOWN_KEY_CODE = 40;\nvar VALID_KEY_CODES = [UP_KEY_CODE, DOWN_KEY_CODE];\nvar isValidKeyCode = function isValidKeyCode(keyCode) {\n  return VALID_KEY_CODES.indexOf(keyCode) > -1;\n};\nvar getNumberValue = function getNumberValue(value) {\n  return Number(String(value).replace(/%/g, ''));\n};\n\nvar idCounter = 1;\n\nexport var EditableInput = function (_ref) {\n  _inherits(EditableInput, _ref);\n\n  function EditableInput(props) {\n    _classCallCheck(this, EditableInput);\n\n    var _this = _possibleConstructorReturn(this, (EditableInput.__proto__ || Object.getPrototypeOf(EditableInput)).call(this));\n\n    _this.handleBlur = function () {\n      if (_this.state.blurValue) {\n        _this.setState({ value: _this.state.blurValue, blurValue: null });\n      }\n    };\n\n    _this.handleChange = function (e) {\n      _this.setUpdatedValue(e.target.value, e);\n    };\n\n    _this.handleKeyDown = function (e) {\n      // In case `e.target.value` is a percentage remove the `%` character\n      // and update accordingly with a percentage\n      // https://github.com/casesandberg/react-color/issues/383\n      var value = getNumberValue(e.target.value);\n      if (!isNaN(value) && isValidKeyCode(e.keyCode)) {\n        var offset = _this.getArrowOffset();\n        var updatedValue = e.keyCode === UP_KEY_CODE ? value + offset : value - offset;\n\n        _this.setUpdatedValue(updatedValue, e);\n      }\n    };\n\n    _this.handleDrag = function (e) {\n      if (_this.props.dragLabel) {\n        var newValue = Math.round(_this.props.value + e.movementX);\n        if (newValue >= 0 && newValue <= _this.props.dragMax) {\n          _this.props.onChange && _this.props.onChange(_this.getValueObjectWithLabel(newValue), e);\n        }\n      }\n    };\n\n    _this.handleMouseDown = function (e) {\n      if (_this.props.dragLabel) {\n        e.preventDefault();\n        _this.handleDrag(e);\n        window.addEventListener('mousemove', _this.handleDrag);\n        window.addEventListener('mouseup', _this.handleMouseUp);\n      }\n    };\n\n    _this.handleMouseUp = function () {\n      _this.unbindEventListeners();\n    };\n\n    _this.unbindEventListeners = function () {\n      window.removeEventListener('mousemove', _this.handleDrag);\n      window.removeEventListener('mouseup', _this.handleMouseUp);\n    };\n\n    _this.state = {\n      value: String(props.value).toUpperCase(),\n      blurValue: String(props.value).toUpperCase()\n    };\n\n    _this.inputId = 'rc-editable-input-' + idCounter++;\n    return _this;\n  }\n\n  _createClass(EditableInput, [{\n    key: 'componentDidUpdate',\n    value: function componentDidUpdate(prevProps, prevState) {\n      if (this.props.value !== this.state.value && (prevProps.value !== this.props.value || prevState.value !== this.state.value)) {\n        if (this.input === document.activeElement) {\n          this.setState({ blurValue: String(this.props.value).toUpperCase() });\n        } else {\n          this.setState({ value: String(this.props.value).toUpperCase(), blurValue: !this.state.blurValue && String(this.props.value).toUpperCase() });\n        }\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      this.unbindEventListeners();\n    }\n  }, {\n    key: 'getValueObjectWithLabel',\n    value: function getValueObjectWithLabel(value) {\n      return _defineProperty({}, this.props.label, value);\n    }\n  }, {\n    key: 'getArrowOffset',\n    value: function getArrowOffset() {\n      return this.props.arrowOffset || DEFAULT_ARROW_OFFSET;\n    }\n  }, {\n    key: 'setUpdatedValue',\n    value: function setUpdatedValue(value, e) {\n      var onChangeValue = this.props.label ? this.getValueObjectWithLabel(value) : value;\n      this.props.onChange && this.props.onChange(onChangeValue, e);\n\n      this.setState({ value: value });\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      var styles = reactCSS({\n        'default': {\n          wrap: {\n            position: 'relative'\n          }\n        },\n        'user-override': {\n          wrap: this.props.style && this.props.style.wrap ? this.props.style.wrap : {},\n          input: this.props.style && this.props.style.input ? this.props.style.input : {},\n          label: this.props.style && this.props.style.label ? this.props.style.label : {}\n        },\n        'dragLabel-true': {\n          label: {\n            cursor: 'ew-resize'\n          }\n        }\n      }, {\n        'user-override': true\n      }, this.props);\n\n      return React.createElement(\n        'div',\n        { style: styles.wrap },\n        React.createElement('input', {\n          id: this.inputId,\n          style: styles.input,\n          ref: function ref(input) {\n            return _this2.input = input;\n          },\n          value: this.state.value,\n          onKeyDown: this.handleKeyDown,\n          onChange: this.handleChange,\n          onBlur: this.handleBlur,\n          placeholder: this.props.placeholder,\n          spellCheck: 'false'\n        }),\n        this.props.label && !this.props.hideLabel ? React.createElement(\n          'label',\n          {\n            htmlFor: this.inputId,\n            style: styles.label,\n            onMouseDown: this.handleMouseDown\n          },\n          this.props.label\n        ) : null\n      );\n    }\n  }]);\n\n  return EditableInput;\n}(PureComponent || Component);\n\nexport default EditableInput;","export var calculateChange = function calculateChange(e, direction, hsl, container) {\n  var containerWidth = container.clientWidth;\n  var containerHeight = container.clientHeight;\n  var x = typeof e.pageX === 'number' ? e.pageX : e.touches[0].pageX;\n  var y = typeof e.pageY === 'number' ? e.pageY : e.touches[0].pageY;\n  var left = x - (container.getBoundingClientRect().left + window.pageXOffset);\n  var top = y - (container.getBoundingClientRect().top + window.pageYOffset);\n\n  if (direction === 'vertical') {\n    var h = void 0;\n    if (top < 0) {\n      h = 359;\n    } else if (top > containerHeight) {\n      h = 0;\n    } else {\n      var percent = -(top * 100 / containerHeight) + 100;\n      h = 360 * percent / 100;\n    }\n\n    if (hsl.h !== h) {\n      return {\n        h: h,\n        s: hsl.s,\n        l: hsl.l,\n        a: hsl.a,\n        source: 'hsl'\n      };\n    }\n  } else {\n    var _h = void 0;\n    if (left < 0) {\n      _h = 0;\n    } else if (left > containerWidth) {\n      _h = 359;\n    } else {\n      var _percent = left * 100 / containerWidth;\n      _h = 360 * _percent / 100;\n    }\n\n    if (hsl.h !== _h) {\n      return {\n        h: _h,\n        s: hsl.s,\n        l: hsl.l,\n        a: hsl.a,\n        source: 'hsl'\n      };\n    }\n  }\n  return null;\n};","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport React, { Component, PureComponent } from 'react';\nimport reactCSS from 'reactcss';\nimport * as hue from '../../helpers/hue';\n\nexport var Hue = function (_ref) {\n  _inherits(Hue, _ref);\n\n  function Hue() {\n    var _ref2;\n\n    var _temp, _this, _ret;\n\n    _classCallCheck(this, Hue);\n\n    for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref2 = Hue.__proto__ || Object.getPrototypeOf(Hue)).call.apply(_ref2, [this].concat(args))), _this), _this.handleChange = function (e) {\n      var change = hue.calculateChange(e, _this.props.direction, _this.props.hsl, _this.container);\n      change && typeof _this.props.onChange === 'function' && _this.props.onChange(change, e);\n    }, _this.handleMouseDown = function (e) {\n      _this.handleChange(e);\n      window.addEventListener('mousemove', _this.handleChange);\n      window.addEventListener('mouseup', _this.handleMouseUp);\n    }, _this.handleMouseUp = function () {\n      _this.unbindEventListeners();\n    }, _temp), _possibleConstructorReturn(_this, _ret);\n  }\n\n  _createClass(Hue, [{\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      this.unbindEventListeners();\n    }\n  }, {\n    key: 'unbindEventListeners',\n    value: function unbindEventListeners() {\n      window.removeEventListener('mousemove', this.handleChange);\n      window.removeEventListener('mouseup', this.handleMouseUp);\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      var _props$direction = this.props.direction,\n          direction = _props$direction === undefined ? 'horizontal' : _props$direction;\n\n\n      var styles = reactCSS({\n        'default': {\n          hue: {\n            absolute: '0px 0px 0px 0px',\n            borderRadius: this.props.radius,\n            boxShadow: this.props.shadow\n          },\n          container: {\n            padding: '0 2px',\n            position: 'relative',\n            height: '100%',\n            borderRadius: this.props.radius\n          },\n          pointer: {\n            position: 'absolute',\n            left: this.props.hsl.h * 100 / 360 + '%'\n          },\n          slider: {\n            marginTop: '1px',\n            width: '4px',\n            borderRadius: '1px',\n            height: '8px',\n            boxShadow: '0 0 2px rgba(0, 0, 0, .6)',\n            background: '#fff',\n            transform: 'translateX(-2px)'\n          }\n        },\n        'vertical': {\n          pointer: {\n            left: '0px',\n            top: -(this.props.hsl.h * 100 / 360) + 100 + '%'\n          }\n        }\n      }, { vertical: direction === 'vertical' });\n\n      return React.createElement(\n        'div',\n        { style: styles.hue },\n        React.createElement(\n          'div',\n          {\n            className: 'hue-' + direction,\n            style: styles.container,\n            ref: function ref(container) {\n              return _this2.container = container;\n            },\n            onMouseDown: this.handleMouseDown,\n            onTouchMove: this.handleChange,\n            onTouchStart: this.handleChange\n          },\n          React.createElement(\n            'style',\n            null,\n            '\\n            .hue-horizontal {\\n              background: linear-gradient(to right, #f00 0%, #ff0 17%, #0f0\\n                33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\\n              background: -webkit-linear-gradient(to right, #f00 0%, #ff0\\n                17%, #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\\n            }\\n\\n            .hue-vertical {\\n              background: linear-gradient(to top, #f00 0%, #ff0 17%, #0f0 33%,\\n                #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\\n              background: -webkit-linear-gradient(to top, #f00 0%, #ff0 17%,\\n                #0f0 33%, #0ff 50%, #00f 67%, #f0f 83%, #f00 100%);\\n            }\\n          '\n          ),\n          React.createElement(\n            'div',\n            { style: styles.pointer },\n            this.props.pointer ? React.createElement(this.props.pointer, this.props) : React.createElement('div', { style: styles.slider })\n          )\n        )\n      );\n    }\n  }]);\n\n  return Hue;\n}(PureComponent || Component);\n\nexport default Hue;","import baseAssignValue from './_baseAssignValue.js';\nimport eq from './eq.js';\n\n/**\n * This function is like `assignValue` except that it doesn't assign\n * `undefined` values.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignMergeValue(object, key, value) {\n  if ((value !== undefined && !eq(object[key], value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nexport default assignMergeValue;\n","import createBaseFor from './_createBaseFor.js';\n\n/**\n * The base implementation of `baseForOwn` which iterates over `object`\n * properties returned by `keysFunc` and invokes `iteratee` for each property.\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @returns {Object} Returns `object`.\n */\nvar baseFor = createBaseFor();\n\nexport default baseFor;\n","/**\n * Creates a base function for methods like `_.forIn` and `_.forOwn`.\n *\n * @private\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseFor(fromRight) {\n  return function(object, iteratee, keysFunc) {\n    var index = -1,\n        iterable = Object(object),\n        props = keysFunc(object),\n        length = props.length;\n\n    while (length--) {\n      var key = props[fromRight ? length : ++index];\n      if (iteratee(iterable[key], key, iterable) === false) {\n        break;\n      }\n    }\n    return object;\n  };\n}\n\nexport default createBaseFor;\n","import isArrayLike from './isArrayLike.js';\nimport isObjectLike from './isObjectLike.js';\n\n/**\n * This method is like `_.isArrayLike` except that it also checks if `value`\n * is an object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array-like object,\n *  else `false`.\n * @example\n *\n * _.isArrayLikeObject([1, 2, 3]);\n * // => true\n *\n * _.isArrayLikeObject(document.body.children);\n * // => true\n *\n * _.isArrayLikeObject('abc');\n * // => false\n *\n * _.isArrayLikeObject(_.noop);\n * // => false\n */\nfunction isArrayLikeObject(value) {\n  return isObjectLike(value) && isArrayLike(value);\n}\n\nexport default isArrayLikeObject;\n","/**\n * Gets the value at `key`, unless `key` is \"__proto__\" or \"constructor\".\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction safeGet(object, key) {\n  if (key === 'constructor' && typeof object[key] === 'function') {\n    return;\n  }\n\n  if (key == '__proto__') {\n    return;\n  }\n\n  return object[key];\n}\n\nexport default safeGet;\n","import copyObject from './_copyObject.js';\nimport keysIn from './keysIn.js';\n\n/**\n * Converts `value` to a plain object flattening inherited enumerable string\n * keyed properties of `value` to own properties of the plain object.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {Object} Returns the converted plain object.\n * @example\n *\n * function Foo() {\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.assign({ 'a': 1 }, new Foo);\n * // => { 'a': 1, 'b': 2 }\n *\n * _.assign({ 'a': 1 }, _.toPlainObject(new Foo));\n * // => { 'a': 1, 'b': 2, 'c': 3 }\n */\nfunction toPlainObject(value) {\n  return copyObject(value, keysIn(value));\n}\n\nexport default toPlainObject;\n","import assignMergeValue from './_assignMergeValue.js';\nimport cloneBuffer from './_cloneBuffer.js';\nimport cloneTypedArray from './_cloneTypedArray.js';\nimport copyArray from './_copyArray.js';\nimport initCloneObject from './_initCloneObject.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\nimport isArrayLikeObject from './isArrayLikeObject.js';\nimport isBuffer from './isBuffer.js';\nimport isFunction from './isFunction.js';\nimport isObject from './isObject.js';\nimport isPlainObject from './isPlainObject.js';\nimport isTypedArray from './isTypedArray.js';\nimport safeGet from './_safeGet.js';\nimport toPlainObject from './toPlainObject.js';\n\n/**\n * A specialized version of `baseMerge` for arrays and objects which performs\n * deep merges and tracks traversed objects enabling objects with circular\n * references to be merged.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @param {string} key The key of the value to merge.\n * @param {number} srcIndex The index of `source`.\n * @param {Function} mergeFunc The function to merge values.\n * @param {Function} [customizer] The function to customize assigned values.\n * @param {Object} [stack] Tracks traversed source values and their merged\n *  counterparts.\n */\nfunction baseMergeDeep(object, source, key, srcIndex, mergeFunc, customizer, stack) {\n  var objValue = safeGet(object, key),\n      srcValue = safeGet(source, key),\n      stacked = stack.get(srcValue);\n\n  if (stacked) {\n    assignMergeValue(object, key, stacked);\n    return;\n  }\n  var newValue = customizer\n    ? customizer(objValue, srcValue, (key + ''), object, source, stack)\n    : undefined;\n\n  var isCommon = newValue === undefined;\n\n  if (isCommon) {\n    var isArr = isArray(srcValue),\n        isBuff = !isArr && isBuffer(srcValue),\n        isTyped = !isArr && !isBuff && isTypedArray(srcValue);\n\n    newValue = srcValue;\n    if (isArr || isBuff || isTyped) {\n      if (isArray(objValue)) {\n        newValue = objValue;\n      }\n      else if (isArrayLikeObject(objValue)) {\n        newValue = copyArray(objValue);\n      }\n      else if (isBuff) {\n        isCommon = false;\n        newValue = cloneBuffer(srcValue, true);\n      }\n      else if (isTyped) {\n        isCommon = false;\n        newValue = cloneTypedArray(srcValue, true);\n      }\n      else {\n        newValue = [];\n      }\n    }\n    else if (isPlainObject(srcValue) || isArguments(srcValue)) {\n      newValue = objValue;\n      if (isArguments(objValue)) {\n        newValue = toPlainObject(objValue);\n      }\n      else if (!isObject(objValue) || isFunction(objValue)) {\n        newValue = initCloneObject(srcValue);\n      }\n    }\n    else {\n      isCommon = false;\n    }\n  }\n  if (isCommon) {\n    // Recursively merge objects and arrays (susceptible to call stack limits).\n    stack.set(srcValue, newValue);\n    mergeFunc(newValue, srcValue, srcIndex, customizer, stack);\n    stack['delete'](srcValue);\n  }\n  assignMergeValue(object, key, newValue);\n}\n\nexport default baseMergeDeep;\n","import Stack from './_Stack.js';\nimport assignMergeValue from './_assignMergeValue.js';\nimport baseFor from './_baseFor.js';\nimport baseMergeDeep from './_baseMergeDeep.js';\nimport isObject from './isObject.js';\nimport keysIn from './keysIn.js';\nimport safeGet from './_safeGet.js';\n\n/**\n * The base implementation of `_.merge` without support for multiple sources.\n *\n * @private\n * @param {Object} object The destination object.\n * @param {Object} source The source object.\n * @param {number} srcIndex The index of `source`.\n * @param {Function} [customizer] The function to customize merged values.\n * @param {Object} [stack] Tracks traversed source values and their merged\n *  counterparts.\n */\nfunction baseMerge(object, source, srcIndex, customizer, stack) {\n  if (object === source) {\n    return;\n  }\n  baseFor(source, function(srcValue, key) {\n    stack || (stack = new Stack);\n    if (isObject(srcValue)) {\n      baseMergeDeep(object, source, key, srcIndex, baseMerge, customizer, stack);\n    }\n    else {\n      var newValue = customizer\n        ? customizer(safeGet(object, key), srcValue, (key + ''), object, source, stack)\n        : undefined;\n\n      if (newValue === undefined) {\n        newValue = srcValue;\n      }\n      assignMergeValue(object, key, newValue);\n    }\n  }, keysIn);\n}\n\nexport default baseMerge;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nexport default identity;\n","/**\n * A faster alternative to `Function#apply`, this function invokes `func`\n * with the `this` binding of `thisArg` and the arguments of `args`.\n *\n * @private\n * @param {Function} func The function to invoke.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} args The arguments to invoke `func` with.\n * @returns {*} Returns the result of `func`.\n */\nfunction apply(func, thisArg, args) {\n  switch (args.length) {\n    case 0: return func.call(thisArg);\n    case 1: return func.call(thisArg, args[0]);\n    case 2: return func.call(thisArg, args[0], args[1]);\n    case 3: return func.call(thisArg, args[0], args[1], args[2]);\n  }\n  return func.apply(thisArg, args);\n}\n\nexport default apply;\n","import apply from './_apply.js';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * A specialized version of `baseRest` which transforms the rest array.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @param {Function} transform The rest array transform.\n * @returns {Function} Returns the new function.\n */\nfunction overRest(func, start, transform) {\n  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n  return function() {\n    var args = arguments,\n        index = -1,\n        length = nativeMax(args.length - start, 0),\n        array = Array(length);\n\n    while (++index < length) {\n      array[index] = args[start + index];\n    }\n    index = -1;\n    var otherArgs = Array(start + 1);\n    while (++index < start) {\n      otherArgs[index] = args[index];\n    }\n    otherArgs[start] = transform(array);\n    return apply(func, this, otherArgs);\n  };\n}\n\nexport default overRest;\n","/**\n * Creates a function that returns `value`.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {*} value The value to return from the new function.\n * @returns {Function} Returns the new constant function.\n * @example\n *\n * var objects = _.times(2, _.constant({ 'a': 1 }));\n *\n * console.log(objects);\n * // => [{ 'a': 1 }, { 'a': 1 }]\n *\n * console.log(objects[0] === objects[1]);\n * // => true\n */\nfunction constant(value) {\n  return function() {\n    return value;\n  };\n}\n\nexport default constant;\n","import constant from './constant.js';\nimport defineProperty from './_defineProperty.js';\nimport identity from './identity.js';\n\n/**\n * The base implementation of `setToString` without support for hot loop shorting.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar baseSetToString = !defineProperty ? identity : function(func, string) {\n  return defineProperty(func, 'toString', {\n    'configurable': true,\n    'enumerable': false,\n    'value': constant(string),\n    'writable': true\n  });\n};\n\nexport default baseSetToString;\n","/** Used to detect hot functions by number of calls within a span of milliseconds. */\nvar HOT_COUNT = 800,\n    HOT_SPAN = 16;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeNow = Date.now;\n\n/**\n * Creates a function that'll short out and invoke `identity` instead\n * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`\n * milliseconds.\n *\n * @private\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new shortable function.\n */\nfunction shortOut(func) {\n  var count = 0,\n      lastCalled = 0;\n\n  return function() {\n    var stamp = nativeNow(),\n        remaining = HOT_SPAN - (stamp - lastCalled);\n\n    lastCalled = stamp;\n    if (remaining > 0) {\n      if (++count >= HOT_COUNT) {\n        return arguments[0];\n      }\n    } else {\n      count = 0;\n    }\n    return func.apply(undefined, arguments);\n  };\n}\n\nexport default shortOut;\n","import baseSetToString from './_baseSetToString.js';\nimport shortOut from './_shortOut.js';\n\n/**\n * Sets the `toString` method of `func` to return `string`.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar setToString = shortOut(baseSetToString);\n\nexport default setToString;\n","import identity from './identity.js';\nimport overRest from './_overRest.js';\nimport setToString from './_setToString.js';\n\n/**\n * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @returns {Function} Returns the new function.\n */\nfunction baseRest(func, start) {\n  return setToString(overRest(func, start, identity), func + '');\n}\n\nexport default baseRest;\n","import eq from './eq.js';\nimport isArrayLike from './isArrayLike.js';\nimport isIndex from './_isIndex.js';\nimport isObject from './isObject.js';\n\n/**\n * Checks if the given arguments are from an iteratee call.\n *\n * @private\n * @param {*} value The potential iteratee value argument.\n * @param {*} index The potential iteratee index or key argument.\n * @param {*} object The potential iteratee object argument.\n * @returns {boolean} Returns `true` if the arguments are from an iteratee call,\n *  else `false`.\n */\nfunction isIterateeCall(value, index, object) {\n  if (!isObject(object)) {\n    return false;\n  }\n  var type = typeof index;\n  if (type == 'number'\n        ? (isArrayLike(object) && isIndex(index, object.length))\n        : (type == 'string' && index in object)\n      ) {\n    return eq(object[index], value);\n  }\n  return false;\n}\n\nexport default isIterateeCall;\n","import baseMerge from './_baseMerge.js';\nimport createAssigner from './_createAssigner.js';\n\n/**\n * This method is like `_.assign` except that it recursively merges own and\n * inherited enumerable string keyed properties of source objects into the\n * destination object. Source properties that resolve to `undefined` are\n * skipped if a destination value exists. Array and plain object properties\n * are merged recursively. Other objects and value types are overridden by\n * assignment. Source objects are applied from left to right. Subsequent\n * sources overwrite property assignments of previous sources.\n *\n * **Note:** This method mutates `object`.\n *\n * @static\n * @memberOf _\n * @since 0.5.0\n * @category Object\n * @param {Object} object The destination object.\n * @param {...Object} [sources] The source objects.\n * @returns {Object} Returns `object`.\n * @example\n *\n * var object = {\n *   'a': [{ 'b': 2 }, { 'd': 4 }]\n * };\n *\n * var other = {\n *   'a': [{ 'c': 3 }, { 'e': 5 }]\n * };\n *\n * _.merge(object, other);\n * // => { 'a': [{ 'b': 2, 'c': 3 }, { 'd': 4, 'e': 5 }] }\n */\nvar merge = createAssigner(function(object, source, srcIndex) {\n  baseMerge(object, source, srcIndex);\n});\n\nexport default merge;\n","import baseRest from './_baseRest.js';\nimport isIterateeCall from './_isIterateeCall.js';\n\n/**\n * Creates a function like `_.assign`.\n *\n * @private\n * @param {Function} assigner The function to assign values.\n * @returns {Function} Returns the new assigner function.\n */\nfunction createAssigner(assigner) {\n  return baseRest(function(object, sources) {\n    var index = -1,\n        length = sources.length,\n        customizer = length > 1 ? sources[length - 1] : undefined,\n        guard = length > 2 ? sources[2] : undefined;\n\n    customizer = (assigner.length > 3 && typeof customizer == 'function')\n      ? (length--, customizer)\n      : undefined;\n\n    if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n      customizer = length < 3 ? undefined : customizer;\n      length = 1;\n    }\n    object = Object(object);\n    while (++index < length) {\n      var source = sources[index];\n      if (source) {\n        assigner(object, source, index, customizer);\n      }\n    }\n    return object;\n  });\n}\n\nexport default createAssigner;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\n\nexport var Raised = function Raised(_ref) {\n  var zDepth = _ref.zDepth,\n      radius = _ref.radius,\n      background = _ref.background,\n      children = _ref.children,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles;\n\n  var styles = reactCSS(merge({\n    'default': {\n      wrap: {\n        position: 'relative',\n        display: 'inline-block'\n      },\n      content: {\n        position: 'relative'\n      },\n      bg: {\n        absolute: '0px 0px 0px 0px',\n        boxShadow: '0 ' + zDepth + 'px ' + zDepth * 4 + 'px rgba(0,0,0,.24)',\n        borderRadius: radius,\n        background: background\n      }\n    },\n    'zDepth-0': {\n      bg: {\n        boxShadow: 'none'\n      }\n    },\n\n    'zDepth-1': {\n      bg: {\n        boxShadow: '0 2px 10px rgba(0,0,0,.12), 0 2px 5px rgba(0,0,0,.16)'\n      }\n    },\n    'zDepth-2': {\n      bg: {\n        boxShadow: '0 6px 20px rgba(0,0,0,.19), 0 8px 17px rgba(0,0,0,.2)'\n      }\n    },\n    'zDepth-3': {\n      bg: {\n        boxShadow: '0 17px 50px rgba(0,0,0,.19), 0 12px 15px rgba(0,0,0,.24)'\n      }\n    },\n    'zDepth-4': {\n      bg: {\n        boxShadow: '0 25px 55px rgba(0,0,0,.21), 0 16px 28px rgba(0,0,0,.22)'\n      }\n    },\n    'zDepth-5': {\n      bg: {\n        boxShadow: '0 40px 77px rgba(0,0,0,.22), 0 27px 24px rgba(0,0,0,.2)'\n      }\n    },\n    'square': {\n      bg: {\n        borderRadius: '0'\n      }\n    },\n    'circle': {\n      bg: {\n        borderRadius: '50%'\n      }\n    }\n  }, passedStyles), { 'zDepth-1': zDepth === 1 });\n\n  return React.createElement(\n    'div',\n    { style: styles.wrap },\n    React.createElement('div', { style: styles.bg }),\n    React.createElement(\n      'div',\n      { style: styles.content },\n      children\n    )\n  );\n};\n\nRaised.propTypes = {\n  background: PropTypes.string,\n  zDepth: PropTypes.oneOf([0, 1, 2, 3, 4, 5]),\n  radius: PropTypes.number,\n  styles: PropTypes.object\n};\n\nRaised.defaultProps = {\n  background: '#fff',\n  zDepth: 1,\n  radius: 2,\n  styles: {}\n};\n\nexport default Raised;","import root from './_root.js';\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\nexport default now;\n","/** Used to match a single whitespace character. */\nvar reWhitespace = /\\s/;\n\n/**\n * Used by `_.trim` and `_.trimEnd` to get the index of the last non-whitespace\n * character of `string`.\n *\n * @private\n * @param {string} string The string to inspect.\n * @returns {number} Returns the index of the last non-whitespace character.\n */\nfunction trimmedEndIndex(string) {\n  var index = string.length;\n\n  while (index-- && reWhitespace.test(string.charAt(index))) {}\n  return index;\n}\n\nexport default trimmedEndIndex;\n","import trimmedEndIndex from './_trimmedEndIndex.js';\n\n/** Used to match leading whitespace. */\nvar reTrimStart = /^\\s+/;\n\n/**\n * The base implementation of `_.trim`.\n *\n * @private\n * @param {string} string The string to trim.\n * @returns {string} Returns the trimmed string.\n */\nfunction baseTrim(string) {\n  return string\n    ? string.slice(0, trimmedEndIndex(string) + 1).replace(reTrimStart, '')\n    : string;\n}\n\nexport default baseTrim;\n","import baseTrim from './_baseTrim.js';\nimport isObject from './isObject.js';\nimport isSymbol from './isSymbol.js';\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = baseTrim(value);\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nexport default toNumber;\n","import isObject from './isObject.js';\nimport now from './now.js';\nimport toNumber from './toNumber.js';\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        clearTimeout(timerId);\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nexport default debounce;\n","import debounce from './debounce.js';\nimport isObject from './isObject.js';\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a throttled function that only invokes `func` at most once per\n * every `wait` milliseconds. The throttled function comes with a `cancel`\n * method to cancel delayed `func` invocations and a `flush` method to\n * immediately invoke them. Provide `options` to indicate whether `func`\n * should be invoked on the leading and/or trailing edge of the `wait`\n * timeout. The `func` is invoked with the last arguments provided to the\n * throttled function. Subsequent calls to the throttled function return the\n * result of the last `func` invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the throttled function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.throttle` and `_.debounce`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to throttle.\n * @param {number} [wait=0] The number of milliseconds to throttle invocations to.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=true]\n *  Specify invoking on the leading edge of the timeout.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new throttled function.\n * @example\n *\n * // Avoid excessively updating the position while scrolling.\n * jQuery(window).on('scroll', _.throttle(updatePosition, 100));\n *\n * // Invoke `renewToken` when the click event is fired, but not more than once every 5 minutes.\n * var throttled = _.throttle(renewToken, 300000, { 'trailing': false });\n * jQuery(element).on('click', throttled);\n *\n * // Cancel the trailing throttled invocation.\n * jQuery(window).on('popstate', throttled.cancel);\n */\nfunction throttle(func, wait, options) {\n  var leading = true,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  if (isObject(options)) {\n    leading = 'leading' in options ? !!options.leading : leading;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n  return debounce(func, wait, {\n    'leading': leading,\n    'maxWait': wait,\n    'trailing': trailing\n  });\n}\n\nexport default throttle;\n","export var calculateChange = function calculateChange(e, hsl, container) {\n  var _container$getBoundin = container.getBoundingClientRect(),\n      containerWidth = _container$getBoundin.width,\n      containerHeight = _container$getBoundin.height;\n\n  var x = typeof e.pageX === 'number' ? e.pageX : e.touches[0].pageX;\n  var y = typeof e.pageY === 'number' ? e.pageY : e.touches[0].pageY;\n  var left = x - (container.getBoundingClientRect().left + window.pageXOffset);\n  var top = y - (container.getBoundingClientRect().top + window.pageYOffset);\n\n  if (left < 0) {\n    left = 0;\n  } else if (left > containerWidth) {\n    left = containerWidth;\n  }\n\n  if (top < 0) {\n    top = 0;\n  } else if (top > containerHeight) {\n    top = containerHeight;\n  }\n\n  var saturation = left / containerWidth;\n  var bright = 1 - top / containerHeight;\n\n  return {\n    h: hsl.h,\n    s: saturation,\n    v: bright,\n    a: hsl.a,\n    source: 'hsv'\n  };\n};","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport React, { Component, PureComponent } from 'react';\nimport reactCSS from 'reactcss';\nimport throttle from 'lodash-es/throttle';\nimport * as saturation from '../../helpers/saturation';\n\nexport var Saturation = function (_ref) {\n  _inherits(Saturation, _ref);\n\n  function Saturation(props) {\n    _classCallCheck(this, Saturation);\n\n    var _this = _possibleConstructorReturn(this, (Saturation.__proto__ || Object.getPrototypeOf(Saturation)).call(this, props));\n\n    _this.handleChange = function (e) {\n      typeof _this.props.onChange === 'function' && _this.throttle(_this.props.onChange, saturation.calculateChange(e, _this.props.hsl, _this.container), e);\n    };\n\n    _this.handleMouseDown = function (e) {\n      _this.handleChange(e);\n      var renderWindow = _this.getContainerRenderWindow();\n      renderWindow.addEventListener('mousemove', _this.handleChange);\n      renderWindow.addEventListener('mouseup', _this.handleMouseUp);\n    };\n\n    _this.handleMouseUp = function () {\n      _this.unbindEventListeners();\n    };\n\n    _this.throttle = throttle(function (fn, data, e) {\n      fn(data, e);\n    }, 50);\n    return _this;\n  }\n\n  _createClass(Saturation, [{\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      this.throttle.cancel();\n      this.unbindEventListeners();\n    }\n  }, {\n    key: 'getContainerRenderWindow',\n    value: function getContainerRenderWindow() {\n      var container = this.container;\n\n      var renderWindow = window;\n      while (!renderWindow.document.contains(container) && renderWindow.parent !== renderWindow) {\n        renderWindow = renderWindow.parent;\n      }\n      return renderWindow;\n    }\n  }, {\n    key: 'unbindEventListeners',\n    value: function unbindEventListeners() {\n      var renderWindow = this.getContainerRenderWindow();\n      renderWindow.removeEventListener('mousemove', this.handleChange);\n      renderWindow.removeEventListener('mouseup', this.handleMouseUp);\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      var _ref2 = this.props.style || {},\n          color = _ref2.color,\n          white = _ref2.white,\n          black = _ref2.black,\n          pointer = _ref2.pointer,\n          circle = _ref2.circle;\n\n      var styles = reactCSS({\n        'default': {\n          color: {\n            absolute: '0px 0px 0px 0px',\n            background: 'hsl(' + this.props.hsl.h + ',100%, 50%)',\n            borderRadius: this.props.radius\n          },\n          white: {\n            absolute: '0px 0px 0px 0px',\n            borderRadius: this.props.radius\n          },\n          black: {\n            absolute: '0px 0px 0px 0px',\n            boxShadow: this.props.shadow,\n            borderRadius: this.props.radius\n          },\n          pointer: {\n            position: 'absolute',\n            top: -(this.props.hsv.v * 100) + 100 + '%',\n            left: this.props.hsv.s * 100 + '%',\n            cursor: 'default'\n          },\n          circle: {\n            width: '4px',\n            height: '4px',\n            boxShadow: '0 0 0 1.5px #fff, inset 0 0 1px 1px rgba(0,0,0,.3),\\n            0 0 1px 2px rgba(0,0,0,.4)',\n            borderRadius: '50%',\n            cursor: 'hand',\n            transform: 'translate(-2px, -2px)'\n          }\n        },\n        'custom': {\n          color: color,\n          white: white,\n          black: black,\n          pointer: pointer,\n          circle: circle\n        }\n      }, { 'custom': !!this.props.style });\n\n      return React.createElement(\n        'div',\n        {\n          style: styles.color,\n          ref: function ref(container) {\n            return _this2.container = container;\n          },\n          onMouseDown: this.handleMouseDown,\n          onTouchMove: this.handleChange,\n          onTouchStart: this.handleChange\n        },\n        React.createElement(\n          'style',\n          null,\n          '\\n          .saturation-white {\\n            background: -webkit-linear-gradient(to right, #fff, rgba(255,255,255,0));\\n            background: linear-gradient(to right, #fff, rgba(255,255,255,0));\\n          }\\n          .saturation-black {\\n            background: -webkit-linear-gradient(to top, #000, rgba(0,0,0,0));\\n            background: linear-gradient(to top, #000, rgba(0,0,0,0));\\n          }\\n        '\n        ),\n        React.createElement(\n          'div',\n          { style: styles.white, className: 'saturation-white' },\n          React.createElement('div', { style: styles.black, className: 'saturation-black' }),\n          React.createElement(\n            'div',\n            { style: styles.pointer },\n            this.props.pointer ? React.createElement(this.props.pointer, this.props) : React.createElement('div', { style: styles.circle })\n          )\n        )\n      );\n    }\n  }]);\n\n  return Saturation;\n}(PureComponent || Component);\n\nexport default Saturation;","import baseForOwn from './_baseForOwn.js';\nimport createBaseEach from './_createBaseEach.js';\n\n/**\n * The base implementation of `_.forEach` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array|Object} Returns `collection`.\n */\nvar baseEach = createBaseEach(baseForOwn);\n\nexport default baseEach;\n","import isArrayLike from './isArrayLike.js';\n\n/**\n * Creates a `baseEach` or `baseEachRight` function.\n *\n * @private\n * @param {Function} eachFunc The function to iterate over a collection.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseEach(eachFunc, fromRight) {\n  return function(collection, iteratee) {\n    if (collection == null) {\n      return collection;\n    }\n    if (!isArrayLike(collection)) {\n      return eachFunc(collection, iteratee);\n    }\n    var length = collection.length,\n        index = fromRight ? length : -1,\n        iterable = Object(collection);\n\n    while ((fromRight ? index-- : ++index < length)) {\n      if (iteratee(iterable[index], index, iterable) === false) {\n        break;\n      }\n    }\n    return collection;\n  };\n}\n\nexport default createBaseEach;\n","import baseFor from './_baseFor.js';\nimport keys from './keys.js';\n\n/**\n * The base implementation of `_.forOwn` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Object} Returns `object`.\n */\nfunction baseForOwn(object, iteratee) {\n  return object && baseFor(object, iteratee, keys);\n}\n\nexport default baseForOwn;\n","import identity from './identity.js';\n\n/**\n * Casts `value` to `identity` if it's not a function.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {Function} Returns cast function.\n */\nfunction castFunction(value) {\n  return typeof value == 'function' ? value : identity;\n}\n\nexport default castFunction;\n","import arrayEach from './_arrayEach.js';\nimport baseEach from './_baseEach.js';\nimport castFunction from './_castFunction.js';\nimport isArray from './isArray.js';\n\n/**\n * Iterates over elements of `collection` and invokes `iteratee` for each element.\n * The iteratee is invoked with three arguments: (value, index|key, collection).\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * **Note:** As with other \"Collections\" methods, objects with a \"length\"\n * property are iterated like arrays. To avoid this behavior use `_.forIn`\n * or `_.forOwn` for object iteration.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @alias each\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Array|Object} Returns `collection`.\n * @see _.forEachRight\n * @example\n *\n * _.forEach([1, 2], function(value) {\n *   console.log(value);\n * });\n * // => Logs `1` then `2`.\n *\n * _.forEach({ 'a': 1, 'b': 2 }, function(value, key) {\n *   console.log(key);\n * });\n * // => Logs 'a' then 'b' (iteration order is not guaranteed).\n */\nfunction forEach(collection, iteratee) {\n  var func = isArray(collection) ? arrayEach : baseEach;\n  return func(collection, castFunction(iteratee));\n}\n\nexport default forEach;\n","// This file is autogenerated. It's used to publish ESM to npm.\nfunction _typeof(obj) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (obj) {\n    return typeof obj;\n  } : function (obj) {\n    return obj && \"function\" == typeof Symbol && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj;\n  }, _typeof(obj);\n}\n\n// https://github.com/bgrins/TinyColor\n// Brian Grinstead, MIT License\n\nvar trimLeft = /^\\s+/;\nvar trimRight = /\\s+$/;\nfunction tinycolor(color, opts) {\n  color = color ? color : \"\";\n  opts = opts || {};\n\n  // If input is already a tinycolor, return itself\n  if (color instanceof tinycolor) {\n    return color;\n  }\n  // If we are called as a function, call using new instead\n  if (!(this instanceof tinycolor)) {\n    return new tinycolor(color, opts);\n  }\n  var rgb = inputToRGB(color);\n  this._originalInput = color, this._r = rgb.r, this._g = rgb.g, this._b = rgb.b, this._a = rgb.a, this._roundA = Math.round(100 * this._a) / 100, this._format = opts.format || rgb.format;\n  this._gradientType = opts.gradientType;\n\n  // Don't let the range of [0,255] come back in [0,1].\n  // Potentially lose a little bit of precision here, but will fix issues where\n  // .5 gets interpreted as half of the total, instead of half of 1\n  // If it was supposed to be 128, this was already taken care of by `inputToRgb`\n  if (this._r < 1) this._r = Math.round(this._r);\n  if (this._g < 1) this._g = Math.round(this._g);\n  if (this._b < 1) this._b = Math.round(this._b);\n  this._ok = rgb.ok;\n}\ntinycolor.prototype = {\n  isDark: function isDark() {\n    return this.getBrightness() < 128;\n  },\n  isLight: function isLight() {\n    return !this.isDark();\n  },\n  isValid: function isValid() {\n    return this._ok;\n  },\n  getOriginalInput: function getOriginalInput() {\n    return this._originalInput;\n  },\n  getFormat: function getFormat() {\n    return this._format;\n  },\n  getAlpha: function getAlpha() {\n    return this._a;\n  },\n  getBrightness: function getBrightness() {\n    //http://www.w3.org/TR/AERT#color-contrast\n    var rgb = this.toRgb();\n    return (rgb.r * 299 + rgb.g * 587 + rgb.b * 114) / 1000;\n  },\n  getLuminance: function getLuminance() {\n    //http://www.w3.org/TR/2008/REC-WCAG20-20081211/#relativeluminancedef\n    var rgb = this.toRgb();\n    var RsRGB, GsRGB, BsRGB, R, G, B;\n    RsRGB = rgb.r / 255;\n    GsRGB = rgb.g / 255;\n    BsRGB = rgb.b / 255;\n    if (RsRGB <= 0.03928) R = RsRGB / 12.92;else R = Math.pow((RsRGB + 0.055) / 1.055, 2.4);\n    if (GsRGB <= 0.03928) G = GsRGB / 12.92;else G = Math.pow((GsRGB + 0.055) / 1.055, 2.4);\n    if (BsRGB <= 0.03928) B = BsRGB / 12.92;else B = Math.pow((BsRGB + 0.055) / 1.055, 2.4);\n    return 0.2126 * R + 0.7152 * G + 0.0722 * B;\n  },\n  setAlpha: function setAlpha(value) {\n    this._a = boundAlpha(value);\n    this._roundA = Math.round(100 * this._a) / 100;\n    return this;\n  },\n  toHsv: function toHsv() {\n    var hsv = rgbToHsv(this._r, this._g, this._b);\n    return {\n      h: hsv.h * 360,\n      s: hsv.s,\n      v: hsv.v,\n      a: this._a\n    };\n  },\n  toHsvString: function toHsvString() {\n    var hsv = rgbToHsv(this._r, this._g, this._b);\n    var h = Math.round(hsv.h * 360),\n      s = Math.round(hsv.s * 100),\n      v = Math.round(hsv.v * 100);\n    return this._a == 1 ? \"hsv(\" + h + \", \" + s + \"%, \" + v + \"%)\" : \"hsva(\" + h + \", \" + s + \"%, \" + v + \"%, \" + this._roundA + \")\";\n  },\n  toHsl: function toHsl() {\n    var hsl = rgbToHsl(this._r, this._g, this._b);\n    return {\n      h: hsl.h * 360,\n      s: hsl.s,\n      l: hsl.l,\n      a: this._a\n    };\n  },\n  toHslString: function toHslString() {\n    var hsl = rgbToHsl(this._r, this._g, this._b);\n    var h = Math.round(hsl.h * 360),\n      s = Math.round(hsl.s * 100),\n      l = Math.round(hsl.l * 100);\n    return this._a == 1 ? \"hsl(\" + h + \", \" + s + \"%, \" + l + \"%)\" : \"hsla(\" + h + \", \" + s + \"%, \" + l + \"%, \" + this._roundA + \")\";\n  },\n  toHex: function toHex(allow3Char) {\n    return rgbToHex(this._r, this._g, this._b, allow3Char);\n  },\n  toHexString: function toHexString(allow3Char) {\n    return \"#\" + this.toHex(allow3Char);\n  },\n  toHex8: function toHex8(allow4Char) {\n    return rgbaToHex(this._r, this._g, this._b, this._a, allow4Char);\n  },\n  toHex8String: function toHex8String(allow4Char) {\n    return \"#\" + this.toHex8(allow4Char);\n  },\n  toRgb: function toRgb() {\n    return {\n      r: Math.round(this._r),\n      g: Math.round(this._g),\n      b: Math.round(this._b),\n      a: this._a\n    };\n  },\n  toRgbString: function toRgbString() {\n    return this._a == 1 ? \"rgb(\" + Math.round(this._r) + \", \" + Math.round(this._g) + \", \" + Math.round(this._b) + \")\" : \"rgba(\" + Math.round(this._r) + \", \" + Math.round(this._g) + \", \" + Math.round(this._b) + \", \" + this._roundA + \")\";\n  },\n  toPercentageRgb: function toPercentageRgb() {\n    return {\n      r: Math.round(bound01(this._r, 255) * 100) + \"%\",\n      g: Math.round(bound01(this._g, 255) * 100) + \"%\",\n      b: Math.round(bound01(this._b, 255) * 100) + \"%\",\n      a: this._a\n    };\n  },\n  toPercentageRgbString: function toPercentageRgbString() {\n    return this._a == 1 ? \"rgb(\" + Math.round(bound01(this._r, 255) * 100) + \"%, \" + Math.round(bound01(this._g, 255) * 100) + \"%, \" + Math.round(bound01(this._b, 255) * 100) + \"%)\" : \"rgba(\" + Math.round(bound01(this._r, 255) * 100) + \"%, \" + Math.round(bound01(this._g, 255) * 100) + \"%, \" + Math.round(bound01(this._b, 255) * 100) + \"%, \" + this._roundA + \")\";\n  },\n  toName: function toName() {\n    if (this._a === 0) {\n      return \"transparent\";\n    }\n    if (this._a < 1) {\n      return false;\n    }\n    return hexNames[rgbToHex(this._r, this._g, this._b, true)] || false;\n  },\n  toFilter: function toFilter(secondColor) {\n    var hex8String = \"#\" + rgbaToArgbHex(this._r, this._g, this._b, this._a);\n    var secondHex8String = hex8String;\n    var gradientType = this._gradientType ? \"GradientType = 1, \" : \"\";\n    if (secondColor) {\n      var s = tinycolor(secondColor);\n      secondHex8String = \"#\" + rgbaToArgbHex(s._r, s._g, s._b, s._a);\n    }\n    return \"progid:DXImageTransform.Microsoft.gradient(\" + gradientType + \"startColorstr=\" + hex8String + \",endColorstr=\" + secondHex8String + \")\";\n  },\n  toString: function toString(format) {\n    var formatSet = !!format;\n    format = format || this._format;\n    var formattedString = false;\n    var hasAlpha = this._a < 1 && this._a >= 0;\n    var needsAlphaFormat = !formatSet && hasAlpha && (format === \"hex\" || format === \"hex6\" || format === \"hex3\" || format === \"hex4\" || format === \"hex8\" || format === \"name\");\n    if (needsAlphaFormat) {\n      // Special case for \"transparent\", all other non-alpha formats\n      // will return rgba when there is transparency.\n      if (format === \"name\" && this._a === 0) {\n        return this.toName();\n      }\n      return this.toRgbString();\n    }\n    if (format === \"rgb\") {\n      formattedString = this.toRgbString();\n    }\n    if (format === \"prgb\") {\n      formattedString = this.toPercentageRgbString();\n    }\n    if (format === \"hex\" || format === \"hex6\") {\n      formattedString = this.toHexString();\n    }\n    if (format === \"hex3\") {\n      formattedString = this.toHexString(true);\n    }\n    if (format === \"hex4\") {\n      formattedString = this.toHex8String(true);\n    }\n    if (format === \"hex8\") {\n      formattedString = this.toHex8String();\n    }\n    if (format === \"name\") {\n      formattedString = this.toName();\n    }\n    if (format === \"hsl\") {\n      formattedString = this.toHslString();\n    }\n    if (format === \"hsv\") {\n      formattedString = this.toHsvString();\n    }\n    return formattedString || this.toHexString();\n  },\n  clone: function clone() {\n    return tinycolor(this.toString());\n  },\n  _applyModification: function _applyModification(fn, args) {\n    var color = fn.apply(null, [this].concat([].slice.call(args)));\n    this._r = color._r;\n    this._g = color._g;\n    this._b = color._b;\n    this.setAlpha(color._a);\n    return this;\n  },\n  lighten: function lighten() {\n    return this._applyModification(_lighten, arguments);\n  },\n  brighten: function brighten() {\n    return this._applyModification(_brighten, arguments);\n  },\n  darken: function darken() {\n    return this._applyModification(_darken, arguments);\n  },\n  desaturate: function desaturate() {\n    return this._applyModification(_desaturate, arguments);\n  },\n  saturate: function saturate() {\n    return this._applyModification(_saturate, arguments);\n  },\n  greyscale: function greyscale() {\n    return this._applyModification(_greyscale, arguments);\n  },\n  spin: function spin() {\n    return this._applyModification(_spin, arguments);\n  },\n  _applyCombination: function _applyCombination(fn, args) {\n    return fn.apply(null, [this].concat([].slice.call(args)));\n  },\n  analogous: function analogous() {\n    return this._applyCombination(_analogous, arguments);\n  },\n  complement: function complement() {\n    return this._applyCombination(_complement, arguments);\n  },\n  monochromatic: function monochromatic() {\n    return this._applyCombination(_monochromatic, arguments);\n  },\n  splitcomplement: function splitcomplement() {\n    return this._applyCombination(_splitcomplement, arguments);\n  },\n  // Disabled until https://github.com/bgrins/TinyColor/issues/254\n  // polyad: function (number) {\n  //   return this._applyCombination(polyad, [number]);\n  // },\n  triad: function triad() {\n    return this._applyCombination(polyad, [3]);\n  },\n  tetrad: function tetrad() {\n    return this._applyCombination(polyad, [4]);\n  }\n};\n\n// If input is an object, force 1 into \"1.0\" to handle ratios properly\n// String input requires \"1.0\" as input, so 1 will be treated as 1\ntinycolor.fromRatio = function (color, opts) {\n  if (_typeof(color) == \"object\") {\n    var newColor = {};\n    for (var i in color) {\n      if (color.hasOwnProperty(i)) {\n        if (i === \"a\") {\n          newColor[i] = color[i];\n        } else {\n          newColor[i] = convertToPercentage(color[i]);\n        }\n      }\n    }\n    color = newColor;\n  }\n  return tinycolor(color, opts);\n};\n\n// Given a string or object, convert that input to RGB\n// Possible string inputs:\n//\n//     \"red\"\n//     \"#f00\" or \"f00\"\n//     \"#ff0000\" or \"ff0000\"\n//     \"#ff000000\" or \"ff000000\"\n//     \"rgb 255 0 0\" or \"rgb (255, 0, 0)\"\n//     \"rgb 1.0 0 0\" or \"rgb (1, 0, 0)\"\n//     \"rgba (255, 0, 0, 1)\" or \"rgba 255, 0, 0, 1\"\n//     \"rgba (1.0, 0, 0, 1)\" or \"rgba 1.0, 0, 0, 1\"\n//     \"hsl(0, 100%, 50%)\" or \"hsl 0 100% 50%\"\n//     \"hsla(0, 100%, 50%, 1)\" or \"hsla 0 100% 50%, 1\"\n//     \"hsv(0, 100%, 100%)\" or \"hsv 0 100% 100%\"\n//\nfunction inputToRGB(color) {\n  var rgb = {\n    r: 0,\n    g: 0,\n    b: 0\n  };\n  var a = 1;\n  var s = null;\n  var v = null;\n  var l = null;\n  var ok = false;\n  var format = false;\n  if (typeof color == \"string\") {\n    color = stringInputToObject(color);\n  }\n  if (_typeof(color) == \"object\") {\n    if (isValidCSSUnit(color.r) && isValidCSSUnit(color.g) && isValidCSSUnit(color.b)) {\n      rgb = rgbToRgb(color.r, color.g, color.b);\n      ok = true;\n      format = String(color.r).substr(-1) === \"%\" ? \"prgb\" : \"rgb\";\n    } else if (isValidCSSUnit(color.h) && isValidCSSUnit(color.s) && isValidCSSUnit(color.v)) {\n      s = convertToPercentage(color.s);\n      v = convertToPercentage(color.v);\n      rgb = hsvToRgb(color.h, s, v);\n      ok = true;\n      format = \"hsv\";\n    } else if (isValidCSSUnit(color.h) && isValidCSSUnit(color.s) && isValidCSSUnit(color.l)) {\n      s = convertToPercentage(color.s);\n      l = convertToPercentage(color.l);\n      rgb = hslToRgb(color.h, s, l);\n      ok = true;\n      format = \"hsl\";\n    }\n    if (color.hasOwnProperty(\"a\")) {\n      a = color.a;\n    }\n  }\n  a = boundAlpha(a);\n  return {\n    ok: ok,\n    format: color.format || format,\n    r: Math.min(255, Math.max(rgb.r, 0)),\n    g: Math.min(255, Math.max(rgb.g, 0)),\n    b: Math.min(255, Math.max(rgb.b, 0)),\n    a: a\n  };\n}\n\n// Conversion Functions\n// --------------------\n\n// `rgbToHsl`, `rgbToHsv`, `hslToRgb`, `hsvToRgb` modified from:\n// <http://mjijackson.com/2008/02/rgb-to-hsl-and-rgb-to-hsv-color-model-conversion-algorithms-in-javascript>\n\n// `rgbToRgb`\n// Handle bounds / percentage checking to conform to CSS color spec\n// <http://www.w3.org/TR/css3-color/>\n// *Assumes:* r, g, b in [0, 255] or [0, 1]\n// *Returns:* { r, g, b } in [0, 255]\nfunction rgbToRgb(r, g, b) {\n  return {\n    r: bound01(r, 255) * 255,\n    g: bound01(g, 255) * 255,\n    b: bound01(b, 255) * 255\n  };\n}\n\n// `rgbToHsl`\n// Converts an RGB color value to HSL.\n// *Assumes:* r, g, and b are contained in [0, 255] or [0, 1]\n// *Returns:* { h, s, l } in [0,1]\nfunction rgbToHsl(r, g, b) {\n  r = bound01(r, 255);\n  g = bound01(g, 255);\n  b = bound01(b, 255);\n  var max = Math.max(r, g, b),\n    min = Math.min(r, g, b);\n  var h,\n    s,\n    l = (max + min) / 2;\n  if (max == min) {\n    h = s = 0; // achromatic\n  } else {\n    var d = max - min;\n    s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n    switch (max) {\n      case r:\n        h = (g - b) / d + (g < b ? 6 : 0);\n        break;\n      case g:\n        h = (b - r) / d + 2;\n        break;\n      case b:\n        h = (r - g) / d + 4;\n        break;\n    }\n    h /= 6;\n  }\n  return {\n    h: h,\n    s: s,\n    l: l\n  };\n}\n\n// `hslToRgb`\n// Converts an HSL color value to RGB.\n// *Assumes:* h is contained in [0, 1] or [0, 360] and s and l are contained [0, 1] or [0, 100]\n// *Returns:* { r, g, b } in the set [0, 255]\nfunction hslToRgb(h, s, l) {\n  var r, g, b;\n  h = bound01(h, 360);\n  s = bound01(s, 100);\n  l = bound01(l, 100);\n  function hue2rgb(p, q, t) {\n    if (t < 0) t += 1;\n    if (t > 1) t -= 1;\n    if (t < 1 / 6) return p + (q - p) * 6 * t;\n    if (t < 1 / 2) return q;\n    if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;\n    return p;\n  }\n  if (s === 0) {\n    r = g = b = l; // achromatic\n  } else {\n    var q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n    var p = 2 * l - q;\n    r = hue2rgb(p, q, h + 1 / 3);\n    g = hue2rgb(p, q, h);\n    b = hue2rgb(p, q, h - 1 / 3);\n  }\n  return {\n    r: r * 255,\n    g: g * 255,\n    b: b * 255\n  };\n}\n\n// `rgbToHsv`\n// Converts an RGB color value to HSV\n// *Assumes:* r, g, and b are contained in the set [0, 255] or [0, 1]\n// *Returns:* { h, s, v } in [0,1]\nfunction rgbToHsv(r, g, b) {\n  r = bound01(r, 255);\n  g = bound01(g, 255);\n  b = bound01(b, 255);\n  var max = Math.max(r, g, b),\n    min = Math.min(r, g, b);\n  var h,\n    s,\n    v = max;\n  var d = max - min;\n  s = max === 0 ? 0 : d / max;\n  if (max == min) {\n    h = 0; // achromatic\n  } else {\n    switch (max) {\n      case r:\n        h = (g - b) / d + (g < b ? 6 : 0);\n        break;\n      case g:\n        h = (b - r) / d + 2;\n        break;\n      case b:\n        h = (r - g) / d + 4;\n        break;\n    }\n    h /= 6;\n  }\n  return {\n    h: h,\n    s: s,\n    v: v\n  };\n}\n\n// `hsvToRgb`\n// Converts an HSV color value to RGB.\n// *Assumes:* h is contained in [0, 1] or [0, 360] and s and v are contained in [0, 1] or [0, 100]\n// *Returns:* { r, g, b } in the set [0, 255]\nfunction hsvToRgb(h, s, v) {\n  h = bound01(h, 360) * 6;\n  s = bound01(s, 100);\n  v = bound01(v, 100);\n  var i = Math.floor(h),\n    f = h - i,\n    p = v * (1 - s),\n    q = v * (1 - f * s),\n    t = v * (1 - (1 - f) * s),\n    mod = i % 6,\n    r = [v, q, p, p, t, v][mod],\n    g = [t, v, v, q, p, p][mod],\n    b = [p, p, t, v, v, q][mod];\n  return {\n    r: r * 255,\n    g: g * 255,\n    b: b * 255\n  };\n}\n\n// `rgbToHex`\n// Converts an RGB color to hex\n// Assumes r, g, and b are contained in the set [0, 255]\n// Returns a 3 or 6 character hex\nfunction rgbToHex(r, g, b, allow3Char) {\n  var hex = [pad2(Math.round(r).toString(16)), pad2(Math.round(g).toString(16)), pad2(Math.round(b).toString(16))];\n\n  // Return a 3 character hex if possible\n  if (allow3Char && hex[0].charAt(0) == hex[0].charAt(1) && hex[1].charAt(0) == hex[1].charAt(1) && hex[2].charAt(0) == hex[2].charAt(1)) {\n    return hex[0].charAt(0) + hex[1].charAt(0) + hex[2].charAt(0);\n  }\n  return hex.join(\"\");\n}\n\n// `rgbaToHex`\n// Converts an RGBA color plus alpha transparency to hex\n// Assumes r, g, b are contained in the set [0, 255] and\n// a in [0, 1]. Returns a 4 or 8 character rgba hex\nfunction rgbaToHex(r, g, b, a, allow4Char) {\n  var hex = [pad2(Math.round(r).toString(16)), pad2(Math.round(g).toString(16)), pad2(Math.round(b).toString(16)), pad2(convertDecimalToHex(a))];\n\n  // Return a 4 character hex if possible\n  if (allow4Char && hex[0].charAt(0) == hex[0].charAt(1) && hex[1].charAt(0) == hex[1].charAt(1) && hex[2].charAt(0) == hex[2].charAt(1) && hex[3].charAt(0) == hex[3].charAt(1)) {\n    return hex[0].charAt(0) + hex[1].charAt(0) + hex[2].charAt(0) + hex[3].charAt(0);\n  }\n  return hex.join(\"\");\n}\n\n// `rgbaToArgbHex`\n// Converts an RGBA color to an ARGB Hex8 string\n// Rarely used, but required for \"toFilter()\"\nfunction rgbaToArgbHex(r, g, b, a) {\n  var hex = [pad2(convertDecimalToHex(a)), pad2(Math.round(r).toString(16)), pad2(Math.round(g).toString(16)), pad2(Math.round(b).toString(16))];\n  return hex.join(\"\");\n}\n\n// `equals`\n// Can be called with any tinycolor input\ntinycolor.equals = function (color1, color2) {\n  if (!color1 || !color2) return false;\n  return tinycolor(color1).toRgbString() == tinycolor(color2).toRgbString();\n};\ntinycolor.random = function () {\n  return tinycolor.fromRatio({\n    r: Math.random(),\n    g: Math.random(),\n    b: Math.random()\n  });\n};\n\n// Modification Functions\n// ----------------------\n// Thanks to less.js for some of the basics here\n// <https://github.com/cloudhead/less.js/blob/master/lib/less/functions.js>\n\nfunction _desaturate(color, amount) {\n  amount = amount === 0 ? 0 : amount || 10;\n  var hsl = tinycolor(color).toHsl();\n  hsl.s -= amount / 100;\n  hsl.s = clamp01(hsl.s);\n  return tinycolor(hsl);\n}\nfunction _saturate(color, amount) {\n  amount = amount === 0 ? 0 : amount || 10;\n  var hsl = tinycolor(color).toHsl();\n  hsl.s += amount / 100;\n  hsl.s = clamp01(hsl.s);\n  return tinycolor(hsl);\n}\nfunction _greyscale(color) {\n  return tinycolor(color).desaturate(100);\n}\nfunction _lighten(color, amount) {\n  amount = amount === 0 ? 0 : amount || 10;\n  var hsl = tinycolor(color).toHsl();\n  hsl.l += amount / 100;\n  hsl.l = clamp01(hsl.l);\n  return tinycolor(hsl);\n}\nfunction _brighten(color, amount) {\n  amount = amount === 0 ? 0 : amount || 10;\n  var rgb = tinycolor(color).toRgb();\n  rgb.r = Math.max(0, Math.min(255, rgb.r - Math.round(255 * -(amount / 100))));\n  rgb.g = Math.max(0, Math.min(255, rgb.g - Math.round(255 * -(amount / 100))));\n  rgb.b = Math.max(0, Math.min(255, rgb.b - Math.round(255 * -(amount / 100))));\n  return tinycolor(rgb);\n}\nfunction _darken(color, amount) {\n  amount = amount === 0 ? 0 : amount || 10;\n  var hsl = tinycolor(color).toHsl();\n  hsl.l -= amount / 100;\n  hsl.l = clamp01(hsl.l);\n  return tinycolor(hsl);\n}\n\n// Spin takes a positive or negative amount within [-360, 360] indicating the change of hue.\n// Values outside of this range will be wrapped into this range.\nfunction _spin(color, amount) {\n  var hsl = tinycolor(color).toHsl();\n  var hue = (hsl.h + amount) % 360;\n  hsl.h = hue < 0 ? 360 + hue : hue;\n  return tinycolor(hsl);\n}\n\n// Combination Functions\n// ---------------------\n// Thanks to jQuery xColor for some of the ideas behind these\n// <https://github.com/infusion/jQuery-xcolor/blob/master/jquery.xcolor.js>\n\nfunction _complement(color) {\n  var hsl = tinycolor(color).toHsl();\n  hsl.h = (hsl.h + 180) % 360;\n  return tinycolor(hsl);\n}\nfunction polyad(color, number) {\n  if (isNaN(number) || number <= 0) {\n    throw new Error(\"Argument to polyad must be a positive number\");\n  }\n  var hsl = tinycolor(color).toHsl();\n  var result = [tinycolor(color)];\n  var step = 360 / number;\n  for (var i = 1; i < number; i++) {\n    result.push(tinycolor({\n      h: (hsl.h + i * step) % 360,\n      s: hsl.s,\n      l: hsl.l\n    }));\n  }\n  return result;\n}\nfunction _splitcomplement(color) {\n  var hsl = tinycolor(color).toHsl();\n  var h = hsl.h;\n  return [tinycolor(color), tinycolor({\n    h: (h + 72) % 360,\n    s: hsl.s,\n    l: hsl.l\n  }), tinycolor({\n    h: (h + 216) % 360,\n    s: hsl.s,\n    l: hsl.l\n  })];\n}\nfunction _analogous(color, results, slices) {\n  results = results || 6;\n  slices = slices || 30;\n  var hsl = tinycolor(color).toHsl();\n  var part = 360 / slices;\n  var ret = [tinycolor(color)];\n  for (hsl.h = (hsl.h - (part * results >> 1) + 720) % 360; --results;) {\n    hsl.h = (hsl.h + part) % 360;\n    ret.push(tinycolor(hsl));\n  }\n  return ret;\n}\nfunction _monochromatic(color, results) {\n  results = results || 6;\n  var hsv = tinycolor(color).toHsv();\n  var h = hsv.h,\n    s = hsv.s,\n    v = hsv.v;\n  var ret = [];\n  var modification = 1 / results;\n  while (results--) {\n    ret.push(tinycolor({\n      h: h,\n      s: s,\n      v: v\n    }));\n    v = (v + modification) % 1;\n  }\n  return ret;\n}\n\n// Utility Functions\n// ---------------------\n\ntinycolor.mix = function (color1, color2, amount) {\n  amount = amount === 0 ? 0 : amount || 50;\n  var rgb1 = tinycolor(color1).toRgb();\n  var rgb2 = tinycolor(color2).toRgb();\n  var p = amount / 100;\n  var rgba = {\n    r: (rgb2.r - rgb1.r) * p + rgb1.r,\n    g: (rgb2.g - rgb1.g) * p + rgb1.g,\n    b: (rgb2.b - rgb1.b) * p + rgb1.b,\n    a: (rgb2.a - rgb1.a) * p + rgb1.a\n  };\n  return tinycolor(rgba);\n};\n\n// Readability Functions\n// ---------------------\n// <http://www.w3.org/TR/2008/REC-WCAG20-20081211/#contrast-ratiodef (WCAG Version 2)\n\n// `contrast`\n// Analyze the 2 colors and returns the color contrast defined by (WCAG Version 2)\ntinycolor.readability = function (color1, color2) {\n  var c1 = tinycolor(color1);\n  var c2 = tinycolor(color2);\n  return (Math.max(c1.getLuminance(), c2.getLuminance()) + 0.05) / (Math.min(c1.getLuminance(), c2.getLuminance()) + 0.05);\n};\n\n// `isReadable`\n// Ensure that foreground and background color combinations meet WCAG2 guidelines.\n// The third argument is an optional Object.\n//      the 'level' property states 'AA' or 'AAA' - if missing or invalid, it defaults to 'AA';\n//      the 'size' property states 'large' or 'small' - if missing or invalid, it defaults to 'small'.\n// If the entire object is absent, isReadable defaults to {level:\"AA\",size:\"small\"}.\n\n// *Example*\n//    tinycolor.isReadable(\"#000\", \"#111\") => false\n//    tinycolor.isReadable(\"#000\", \"#111\",{level:\"AA\",size:\"large\"}) => false\ntinycolor.isReadable = function (color1, color2, wcag2) {\n  var readability = tinycolor.readability(color1, color2);\n  var wcag2Parms, out;\n  out = false;\n  wcag2Parms = validateWCAG2Parms(wcag2);\n  switch (wcag2Parms.level + wcag2Parms.size) {\n    case \"AAsmall\":\n    case \"AAAlarge\":\n      out = readability >= 4.5;\n      break;\n    case \"AAlarge\":\n      out = readability >= 3;\n      break;\n    case \"AAAsmall\":\n      out = readability >= 7;\n      break;\n  }\n  return out;\n};\n\n// `mostReadable`\n// Given a base color and a list of possible foreground or background\n// colors for that base, returns the most readable color.\n// Optionally returns Black or White if the most readable color is unreadable.\n// *Example*\n//    tinycolor.mostReadable(tinycolor.mostReadable(\"#123\", [\"#124\", \"#125\"],{includeFallbackColors:false}).toHexString(); // \"#112255\"\n//    tinycolor.mostReadable(tinycolor.mostReadable(\"#123\", [\"#124\", \"#125\"],{includeFallbackColors:true}).toHexString();  // \"#ffffff\"\n//    tinycolor.mostReadable(\"#a8015a\", [\"#faf3f3\"],{includeFallbackColors:true,level:\"AAA\",size:\"large\"}).toHexString(); // \"#faf3f3\"\n//    tinycolor.mostReadable(\"#a8015a\", [\"#faf3f3\"],{includeFallbackColors:true,level:\"AAA\",size:\"small\"}).toHexString(); // \"#ffffff\"\ntinycolor.mostReadable = function (baseColor, colorList, args) {\n  var bestColor = null;\n  var bestScore = 0;\n  var readability;\n  var includeFallbackColors, level, size;\n  args = args || {};\n  includeFallbackColors = args.includeFallbackColors;\n  level = args.level;\n  size = args.size;\n  for (var i = 0; i < colorList.length; i++) {\n    readability = tinycolor.readability(baseColor, colorList[i]);\n    if (readability > bestScore) {\n      bestScore = readability;\n      bestColor = tinycolor(colorList[i]);\n    }\n  }\n  if (tinycolor.isReadable(baseColor, bestColor, {\n    level: level,\n    size: size\n  }) || !includeFallbackColors) {\n    return bestColor;\n  } else {\n    args.includeFallbackColors = false;\n    return tinycolor.mostReadable(baseColor, [\"#fff\", \"#000\"], args);\n  }\n};\n\n// Big List of Colors\n// ------------------\n// <https://www.w3.org/TR/css-color-4/#named-colors>\nvar names = tinycolor.names = {\n  aliceblue: \"f0f8ff\",\n  antiquewhite: \"faebd7\",\n  aqua: \"0ff\",\n  aquamarine: \"7fffd4\",\n  azure: \"f0ffff\",\n  beige: \"f5f5dc\",\n  bisque: \"ffe4c4\",\n  black: \"000\",\n  blanchedalmond: \"ffebcd\",\n  blue: \"00f\",\n  blueviolet: \"8a2be2\",\n  brown: \"a52a2a\",\n  burlywood: \"deb887\",\n  burntsienna: \"ea7e5d\",\n  cadetblue: \"5f9ea0\",\n  chartreuse: \"7fff00\",\n  chocolate: \"d2691e\",\n  coral: \"ff7f50\",\n  cornflowerblue: \"6495ed\",\n  cornsilk: \"fff8dc\",\n  crimson: \"dc143c\",\n  cyan: \"0ff\",\n  darkblue: \"00008b\",\n  darkcyan: \"008b8b\",\n  darkgoldenrod: \"b8860b\",\n  darkgray: \"a9a9a9\",\n  darkgreen: \"006400\",\n  darkgrey: \"a9a9a9\",\n  darkkhaki: \"bdb76b\",\n  darkmagenta: \"8b008b\",\n  darkolivegreen: \"556b2f\",\n  darkorange: \"ff8c00\",\n  darkorchid: \"9932cc\",\n  darkred: \"8b0000\",\n  darksalmon: \"e9967a\",\n  darkseagreen: \"8fbc8f\",\n  darkslateblue: \"483d8b\",\n  darkslategray: \"2f4f4f\",\n  darkslategrey: \"2f4f4f\",\n  darkturquoise: \"00ced1\",\n  darkviolet: \"9400d3\",\n  deeppink: \"ff1493\",\n  deepskyblue: \"00bfff\",\n  dimgray: \"696969\",\n  dimgrey: \"696969\",\n  dodgerblue: \"1e90ff\",\n  firebrick: \"b22222\",\n  floralwhite: \"fffaf0\",\n  forestgreen: \"228b22\",\n  fuchsia: \"f0f\",\n  gainsboro: \"dcdcdc\",\n  ghostwhite: \"f8f8ff\",\n  gold: \"ffd700\",\n  goldenrod: \"daa520\",\n  gray: \"808080\",\n  green: \"008000\",\n  greenyellow: \"adff2f\",\n  grey: \"808080\",\n  honeydew: \"f0fff0\",\n  hotpink: \"ff69b4\",\n  indianred: \"cd5c5c\",\n  indigo: \"4b0082\",\n  ivory: \"fffff0\",\n  khaki: \"f0e68c\",\n  lavender: \"e6e6fa\",\n  lavenderblush: \"fff0f5\",\n  lawngreen: \"7cfc00\",\n  lemonchiffon: \"fffacd\",\n  lightblue: \"add8e6\",\n  lightcoral: \"f08080\",\n  lightcyan: \"e0ffff\",\n  lightgoldenrodyellow: \"fafad2\",\n  lightgray: \"d3d3d3\",\n  lightgreen: \"90ee90\",\n  lightgrey: \"d3d3d3\",\n  lightpink: \"ffb6c1\",\n  lightsalmon: \"ffa07a\",\n  lightseagreen: \"20b2aa\",\n  lightskyblue: \"87cefa\",\n  lightslategray: \"789\",\n  lightslategrey: \"789\",\n  lightsteelblue: \"b0c4de\",\n  lightyellow: \"ffffe0\",\n  lime: \"0f0\",\n  limegreen: \"32cd32\",\n  linen: \"faf0e6\",\n  magenta: \"f0f\",\n  maroon: \"800000\",\n  mediumaquamarine: \"66cdaa\",\n  mediumblue: \"0000cd\",\n  mediumorchid: \"ba55d3\",\n  mediumpurple: \"9370db\",\n  mediumseagreen: \"3cb371\",\n  mediumslateblue: \"7b68ee\",\n  mediumspringgreen: \"00fa9a\",\n  mediumturquoise: \"48d1cc\",\n  mediumvioletred: \"c71585\",\n  midnightblue: \"191970\",\n  mintcream: \"f5fffa\",\n  mistyrose: \"ffe4e1\",\n  moccasin: \"ffe4b5\",\n  navajowhite: \"ffdead\",\n  navy: \"000080\",\n  oldlace: \"fdf5e6\",\n  olive: \"808000\",\n  olivedrab: \"6b8e23\",\n  orange: \"ffa500\",\n  orangered: \"ff4500\",\n  orchid: \"da70d6\",\n  palegoldenrod: \"eee8aa\",\n  palegreen: \"98fb98\",\n  paleturquoise: \"afeeee\",\n  palevioletred: \"db7093\",\n  papayawhip: \"ffefd5\",\n  peachpuff: \"ffdab9\",\n  peru: \"cd853f\",\n  pink: \"ffc0cb\",\n  plum: \"dda0dd\",\n  powderblue: \"b0e0e6\",\n  purple: \"800080\",\n  rebeccapurple: \"663399\",\n  red: \"f00\",\n  rosybrown: \"bc8f8f\",\n  royalblue: \"4169e1\",\n  saddlebrown: \"8b4513\",\n  salmon: \"fa8072\",\n  sandybrown: \"f4a460\",\n  seagreen: \"2e8b57\",\n  seashell: \"fff5ee\",\n  sienna: \"a0522d\",\n  silver: \"c0c0c0\",\n  skyblue: \"87ceeb\",\n  slateblue: \"6a5acd\",\n  slategray: \"708090\",\n  slategrey: \"708090\",\n  snow: \"fffafa\",\n  springgreen: \"00ff7f\",\n  steelblue: \"4682b4\",\n  tan: \"d2b48c\",\n  teal: \"008080\",\n  thistle: \"d8bfd8\",\n  tomato: \"ff6347\",\n  turquoise: \"40e0d0\",\n  violet: \"ee82ee\",\n  wheat: \"f5deb3\",\n  white: \"fff\",\n  whitesmoke: \"f5f5f5\",\n  yellow: \"ff0\",\n  yellowgreen: \"9acd32\"\n};\n\n// Make it easy to access colors via `hexNames[hex]`\nvar hexNames = tinycolor.hexNames = flip(names);\n\n// Utilities\n// ---------\n\n// `{ 'name1': 'val1' }` becomes `{ 'val1': 'name1' }`\nfunction flip(o) {\n  var flipped = {};\n  for (var i in o) {\n    if (o.hasOwnProperty(i)) {\n      flipped[o[i]] = i;\n    }\n  }\n  return flipped;\n}\n\n// Return a valid alpha value [0,1] with all invalid values being set to 1\nfunction boundAlpha(a) {\n  a = parseFloat(a);\n  if (isNaN(a) || a < 0 || a > 1) {\n    a = 1;\n  }\n  return a;\n}\n\n// Take input from [0, n] and return it as [0, 1]\nfunction bound01(n, max) {\n  if (isOnePointZero(n)) n = \"100%\";\n  var processPercent = isPercentage(n);\n  n = Math.min(max, Math.max(0, parseFloat(n)));\n\n  // Automatically convert percentage into number\n  if (processPercent) {\n    n = parseInt(n * max, 10) / 100;\n  }\n\n  // Handle floating point rounding errors\n  if (Math.abs(n - max) < 0.000001) {\n    return 1;\n  }\n\n  // Convert into [0, 1] range if it isn't already\n  return n % max / parseFloat(max);\n}\n\n// Force a number between 0 and 1\nfunction clamp01(val) {\n  return Math.min(1, Math.max(0, val));\n}\n\n// Parse a base-16 hex value into a base-10 integer\nfunction parseIntFromHex(val) {\n  return parseInt(val, 16);\n}\n\n// Need to handle 1.0 as 100%, since once it is a number, there is no difference between it and 1\n// <http://stackoverflow.com/questions/7422072/javascript-how-to-detect-number-as-a-decimal-including-1-0>\nfunction isOnePointZero(n) {\n  return typeof n == \"string\" && n.indexOf(\".\") != -1 && parseFloat(n) === 1;\n}\n\n// Check to see if string passed in is a percentage\nfunction isPercentage(n) {\n  return typeof n === \"string\" && n.indexOf(\"%\") != -1;\n}\n\n// Force a hex value to have 2 characters\nfunction pad2(c) {\n  return c.length == 1 ? \"0\" + c : \"\" + c;\n}\n\n// Replace a decimal with it's percentage value\nfunction convertToPercentage(n) {\n  if (n <= 1) {\n    n = n * 100 + \"%\";\n  }\n  return n;\n}\n\n// Converts a decimal to a hex value\nfunction convertDecimalToHex(d) {\n  return Math.round(parseFloat(d) * 255).toString(16);\n}\n// Converts a hex value to a decimal\nfunction convertHexToDecimal(h) {\n  return parseIntFromHex(h) / 255;\n}\nvar matchers = function () {\n  // <http://www.w3.org/TR/css3-values/#integers>\n  var CSS_INTEGER = \"[-\\\\+]?\\\\d+%?\";\n\n  // <http://www.w3.org/TR/css3-values/#number-value>\n  var CSS_NUMBER = \"[-\\\\+]?\\\\d*\\\\.\\\\d+%?\";\n\n  // Allow positive/negative integer/number.  Don't capture the either/or, just the entire outcome.\n  var CSS_UNIT = \"(?:\" + CSS_NUMBER + \")|(?:\" + CSS_INTEGER + \")\";\n\n  // Actual matching.\n  // Parentheses and commas are optional, but not required.\n  // Whitespace can take the place of commas or opening paren\n  var PERMISSIVE_MATCH3 = \"[\\\\s|\\\\(]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")\\\\s*\\\\)?\";\n  var PERMISSIVE_MATCH4 = \"[\\\\s|\\\\(]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")[,|\\\\s]+(\" + CSS_UNIT + \")\\\\s*\\\\)?\";\n  return {\n    CSS_UNIT: new RegExp(CSS_UNIT),\n    rgb: new RegExp(\"rgb\" + PERMISSIVE_MATCH3),\n    rgba: new RegExp(\"rgba\" + PERMISSIVE_MATCH4),\n    hsl: new RegExp(\"hsl\" + PERMISSIVE_MATCH3),\n    hsla: new RegExp(\"hsla\" + PERMISSIVE_MATCH4),\n    hsv: new RegExp(\"hsv\" + PERMISSIVE_MATCH3),\n    hsva: new RegExp(\"hsva\" + PERMISSIVE_MATCH4),\n    hex3: /^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,\n    hex6: /^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,\n    hex4: /^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,\n    hex8: /^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/\n  };\n}();\n\n// `isValidCSSUnit`\n// Take in a single string / number and check to see if it looks like a CSS unit\n// (see `matchers` above for definition).\nfunction isValidCSSUnit(color) {\n  return !!matchers.CSS_UNIT.exec(color);\n}\n\n// `stringInputToObject`\n// Permissive string parsing.  Take in a number of formats, and output an object\n// based on detected format.  Returns `{ r, g, b }` or `{ h, s, l }` or `{ h, s, v}`\nfunction stringInputToObject(color) {\n  color = color.replace(trimLeft, \"\").replace(trimRight, \"\").toLowerCase();\n  var named = false;\n  if (names[color]) {\n    color = names[color];\n    named = true;\n  } else if (color == \"transparent\") {\n    return {\n      r: 0,\n      g: 0,\n      b: 0,\n      a: 0,\n      format: \"name\"\n    };\n  }\n\n  // Try to match string input using regular expressions.\n  // Keep most of the number bounding out of this function - don't worry about [0,1] or [0,100] or [0,360]\n  // Just return an object and let the conversion functions handle that.\n  // This way the result will be the same whether the tinycolor is initialized with string or object.\n  var match;\n  if (match = matchers.rgb.exec(color)) {\n    return {\n      r: match[1],\n      g: match[2],\n      b: match[3]\n    };\n  }\n  if (match = matchers.rgba.exec(color)) {\n    return {\n      r: match[1],\n      g: match[2],\n      b: match[3],\n      a: match[4]\n    };\n  }\n  if (match = matchers.hsl.exec(color)) {\n    return {\n      h: match[1],\n      s: match[2],\n      l: match[3]\n    };\n  }\n  if (match = matchers.hsla.exec(color)) {\n    return {\n      h: match[1],\n      s: match[2],\n      l: match[3],\n      a: match[4]\n    };\n  }\n  if (match = matchers.hsv.exec(color)) {\n    return {\n      h: match[1],\n      s: match[2],\n      v: match[3]\n    };\n  }\n  if (match = matchers.hsva.exec(color)) {\n    return {\n      h: match[1],\n      s: match[2],\n      v: match[3],\n      a: match[4]\n    };\n  }\n  if (match = matchers.hex8.exec(color)) {\n    return {\n      r: parseIntFromHex(match[1]),\n      g: parseIntFromHex(match[2]),\n      b: parseIntFromHex(match[3]),\n      a: convertHexToDecimal(match[4]),\n      format: named ? \"name\" : \"hex8\"\n    };\n  }\n  if (match = matchers.hex6.exec(color)) {\n    return {\n      r: parseIntFromHex(match[1]),\n      g: parseIntFromHex(match[2]),\n      b: parseIntFromHex(match[3]),\n      format: named ? \"name\" : \"hex\"\n    };\n  }\n  if (match = matchers.hex4.exec(color)) {\n    return {\n      r: parseIntFromHex(match[1] + \"\" + match[1]),\n      g: parseIntFromHex(match[2] + \"\" + match[2]),\n      b: parseIntFromHex(match[3] + \"\" + match[3]),\n      a: convertHexToDecimal(match[4] + \"\" + match[4]),\n      format: named ? \"name\" : \"hex8\"\n    };\n  }\n  if (match = matchers.hex3.exec(color)) {\n    return {\n      r: parseIntFromHex(match[1] + \"\" + match[1]),\n      g: parseIntFromHex(match[2] + \"\" + match[2]),\n      b: parseIntFromHex(match[3] + \"\" + match[3]),\n      format: named ? \"name\" : \"hex\"\n    };\n  }\n  return false;\n}\nfunction validateWCAG2Parms(parms) {\n  // return valid WCAG2 parms for isReadable.\n  // If input parms are invalid, return {\"level\":\"AA\", \"size\":\"small\"}\n  var level, size;\n  parms = parms || {\n    level: \"AA\",\n    size: \"small\"\n  };\n  level = (parms.level || \"AA\").toUpperCase();\n  size = (parms.size || \"small\").toLowerCase();\n  if (level !== \"AA\" && level !== \"AAA\") {\n    level = \"AA\";\n  }\n  if (size !== \"small\" && size !== \"large\") {\n    size = \"small\";\n  }\n  return {\n    level: level,\n    size: size\n  };\n}\n\nexport { tinycolor as default };\n","import each from 'lodash-es/each';\nimport tinycolor from 'tinycolor2';\n\nexport var simpleCheckForValidColor = function simpleCheckForValidColor(data) {\n  var keysToCheck = ['r', 'g', 'b', 'a', 'h', 's', 'l', 'v'];\n  var checked = 0;\n  var passed = 0;\n  each(keysToCheck, function (letter) {\n    if (data[letter]) {\n      checked += 1;\n      if (!isNaN(data[letter])) {\n        passed += 1;\n      }\n      if (letter === 's' || letter === 'l') {\n        var percentPatt = /^\\d+%$/;\n        if (percentPatt.test(data[letter])) {\n          passed += 1;\n        }\n      }\n    }\n  });\n  return checked === passed ? data : false;\n};\n\nexport var toState = function toState(data, oldHue) {\n  var color = data.hex ? tinycolor(data.hex) : tinycolor(data);\n  var hsl = color.toHsl();\n  var hsv = color.toHsv();\n  var rgb = color.toRgb();\n  var hex = color.toHex();\n  if (hsl.s === 0) {\n    hsl.h = oldHue || 0;\n    hsv.h = oldHue || 0;\n  }\n  var transparent = hex === '000000' && rgb.a === 0;\n\n  return {\n    hsl: hsl,\n    hex: transparent ? 'transparent' : '#' + hex,\n    rgb: rgb,\n    hsv: hsv,\n    oldHue: data.h || oldHue || hsl.h,\n    source: data.source\n  };\n};\n\nexport var isValidHex = function isValidHex(hex) {\n  if (hex === 'transparent') {\n    return true;\n  }\n  // disable hex4 and hex8\n  var lh = String(hex).charAt(0) === '#' ? 1 : 0;\n  return hex.length !== 4 + lh && hex.length < 7 + lh && tinycolor(hex).isValid();\n};\n\nexport var getContrastingColor = function getContrastingColor(data) {\n  if (!data) {\n    return '#fff';\n  }\n  var col = toState(data);\n  if (col.hex === 'transparent') {\n    return 'rgba(0,0,0,0.4)';\n  }\n  var yiq = (col.rgb.r * 299 + col.rgb.g * 587 + col.rgb.b * 114) / 1000;\n  return yiq >= 128 ? '#000' : '#fff';\n};\n\nexport var red = {\n  hsl: { a: 1, h: 0, l: 0.5, s: 1 },\n  hex: '#ff0000',\n  rgb: { r: 255, g: 0, b: 0, a: 1 },\n  hsv: { h: 0, s: 1, v: 1, a: 1 }\n};\n\nexport var isvalidColorString = function isvalidColorString(string, type) {\n  var stringWithoutDegree = string.replace('°', '');\n  return tinycolor(type + ' (' + stringWithoutDegree + ')')._ok;\n};","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport React, { Component, PureComponent } from 'react';\nimport debounce from 'lodash-es/debounce';\nimport * as color from '../../helpers/color';\n\nexport var ColorWrap = function ColorWrap(Picker) {\n  var ColorPicker = function (_ref) {\n    _inherits(ColorPicker, _ref);\n\n    function ColorPicker(props) {\n      _classCallCheck(this, ColorPicker);\n\n      var _this = _possibleConstructorReturn(this, (ColorPicker.__proto__ || Object.getPrototypeOf(ColorPicker)).call(this));\n\n      _this.handleChange = function (data, event) {\n        var isValidColor = color.simpleCheckForValidColor(data);\n        if (isValidColor) {\n          var colors = color.toState(data, data.h || _this.state.oldHue);\n          _this.setState(colors);\n          _this.props.onChangeComplete && _this.debounce(_this.props.onChangeComplete, colors, event);\n          _this.props.onChange && _this.props.onChange(colors, event);\n        }\n      };\n\n      _this.handleSwatchHover = function (data, event) {\n        var isValidColor = color.simpleCheckForValidColor(data);\n        if (isValidColor) {\n          var colors = color.toState(data, data.h || _this.state.oldHue);\n          _this.props.onSwatchHover && _this.props.onSwatchHover(colors, event);\n        }\n      };\n\n      _this.state = _extends({}, color.toState(props.color, 0));\n\n      _this.debounce = debounce(function (fn, data, event) {\n        fn(data, event);\n      }, 100);\n      return _this;\n    }\n\n    _createClass(ColorPicker, [{\n      key: 'render',\n      value: function render() {\n        var optionalEvents = {};\n        if (this.props.onSwatchHover) {\n          optionalEvents.onSwatchHover = this.handleSwatchHover;\n        }\n\n        return React.createElement(Picker, _extends({}, this.props, this.state, {\n          onChange: this.handleChange\n        }, optionalEvents));\n      }\n    }], [{\n      key: 'getDerivedStateFromProps',\n      value: function getDerivedStateFromProps(nextProps, state) {\n        return _extends({}, color.toState(nextProps.color, state.oldHue));\n      }\n    }]);\n\n    return ColorPicker;\n  }(PureComponent || Component);\n\n  ColorPicker.propTypes = _extends({}, Picker.propTypes);\n\n  ColorPicker.defaultProps = _extends({}, Picker.defaultProps, {\n    color: {\n      h: 250,\n      s: 0.50,\n      l: 0.20,\n      a: 1\n    }\n  });\n\n  return ColorPicker;\n};\n\nexport default ColorWrap;","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n/* eslint-disable no-invalid-this */\nimport React from 'react';\n\nexport var handleFocus = function handleFocus(Component) {\n  var Span = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'span';\n  return function (_React$Component) {\n    _inherits(Focus, _React$Component);\n\n    function Focus() {\n      var _ref;\n\n      var _temp, _this, _ret;\n\n      _classCallCheck(this, Focus);\n\n      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = Focus.__proto__ || Object.getPrototypeOf(Focus)).call.apply(_ref, [this].concat(args))), _this), _this.state = { focus: false }, _this.handleFocus = function () {\n        return _this.setState({ focus: true });\n      }, _this.handleBlur = function () {\n        return _this.setState({ focus: false });\n      }, _temp), _possibleConstructorReturn(_this, _ret);\n    }\n\n    _createClass(Focus, [{\n      key: 'render',\n      value: function render() {\n        return React.createElement(\n          Span,\n          { onFocus: this.handleFocus, onBlur: this.handleBlur },\n          React.createElement(Component, _extends({}, this.props, this.state))\n        );\n      }\n    }]);\n\n    return Focus;\n  }(React.Component);\n};","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport React from 'react';\nimport reactCSS from 'reactcss';\nimport { handleFocus } from '../../helpers/interaction';\n\nimport Checkboard from './Checkboard';\n\nvar ENTER = 13;\n\nexport var Swatch = function Swatch(_ref) {\n  var color = _ref.color,\n      style = _ref.style,\n      _ref$onClick = _ref.onClick,\n      onClick = _ref$onClick === undefined ? function () {} : _ref$onClick,\n      onHover = _ref.onHover,\n      _ref$title = _ref.title,\n      title = _ref$title === undefined ? color : _ref$title,\n      children = _ref.children,\n      focus = _ref.focus,\n      _ref$focusStyle = _ref.focusStyle,\n      focusStyle = _ref$focusStyle === undefined ? {} : _ref$focusStyle;\n\n  var transparent = color === 'transparent';\n  var styles = reactCSS({\n    default: {\n      swatch: _extends({\n        background: color,\n        height: '100%',\n        width: '100%',\n        cursor: 'pointer',\n        position: 'relative',\n        outline: 'none'\n      }, style, focus ? focusStyle : {})\n    }\n  });\n\n  var handleClick = function handleClick(e) {\n    return onClick(color, e);\n  };\n  var handleKeyDown = function handleKeyDown(e) {\n    return e.keyCode === ENTER && onClick(color, e);\n  };\n  var handleHover = function handleHover(e) {\n    return onHover(color, e);\n  };\n\n  var optionalEvents = {};\n  if (onHover) {\n    optionalEvents.onMouseOver = handleHover;\n  }\n\n  return React.createElement(\n    'div',\n    _extends({\n      style: styles.swatch,\n      onClick: handleClick,\n      title: title,\n      tabIndex: 0,\n      onKeyDown: handleKeyDown\n    }, optionalEvents),\n    children,\n    transparent && React.createElement(Checkboard, {\n      borderRadius: styles.swatch.borderRadius,\n      boxShadow: 'inset 0 0 0 1px rgba(0,0,0,0.1)'\n    })\n  );\n};\n\nexport default handleFocus(Swatch);","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var AlphaPointer = function AlphaPointer(_ref) {\n  var direction = _ref.direction;\n\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '18px',\n        height: '18px',\n        borderRadius: '50%',\n        transform: 'translate(-9px, -1px)',\n        backgroundColor: 'rgb(248, 248, 248)',\n        boxShadow: '0 1px 4px 0 rgba(0, 0, 0, 0.37)'\n      }\n    },\n    'vertical': {\n      picker: {\n        transform: 'translate(-3px, -9px)'\n      }\n    }\n  }, { vertical: direction === 'vertical' });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nexport default AlphaPointer;","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport React from 'react';\nimport reactCSS from 'reactcss';\n\nimport { ColorWrap, Alpha } from '../common';\nimport AlphaPointer from './AlphaPointer';\n\nexport var AlphaPicker = function AlphaPicker(_ref) {\n  var rgb = _ref.rgb,\n      hsl = _ref.hsl,\n      width = _ref.width,\n      height = _ref.height,\n      onChange = _ref.onChange,\n      direction = _ref.direction,\n      style = _ref.style,\n      renderers = _ref.renderers,\n      pointer = _ref.pointer,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        position: 'relative',\n        width: width,\n        height: height\n      },\n      alpha: {\n        radius: '2px',\n        style: style\n      }\n    }\n  });\n\n  return React.createElement(\n    'div',\n    { style: styles.picker, className: 'alpha-picker ' + className },\n    React.createElement(Alpha, _extends({}, styles.alpha, {\n      rgb: rgb,\n      hsl: hsl,\n      pointer: pointer,\n      renderers: renderers,\n      onChange: onChange,\n      direction: direction\n    }))\n  );\n};\n\nAlphaPicker.defaultProps = {\n  width: '316px',\n  height: '16px',\n  direction: 'horizontal',\n  pointer: AlphaPointer\n};\n\nexport default ColorWrap(AlphaPicker);","/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\nexport default setCacheAdd;\n","/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\nexport default setCacheHas;\n","import MapCache from './_MapCache.js';\nimport setCacheAdd from './_setCacheAdd.js';\nimport setCacheHas from './_setCacheHas.js';\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values == null ? 0 : values.length;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\nexport default SetCache;\n","/**\n * A specialized version of `_.some` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n */\nfunction arraySome(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (predicate(array[index], index, array)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nexport default arraySome;\n","/**\n * Checks if a `cache` value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\nexport default cacheHas;\n","import SetCache from './_SetCache.js';\nimport arraySome from './_arraySome.js';\nimport cacheHas from './_cacheHas.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * A specialized version of `baseIsEqualDeep` for arrays with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Array} array The array to compare.\n * @param {Array} other The other array to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `array` and `other` objects.\n * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.\n */\nfunction equalArrays(array, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      arrLength = array.length,\n      othLength = other.length;\n\n  if (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n    return false;\n  }\n  // Check that cyclic values are equal.\n  var arrStacked = stack.get(array);\n  var othStacked = stack.get(other);\n  if (arrStacked && othStacked) {\n    return arrStacked == other && othStacked == array;\n  }\n  var index = -1,\n      result = true,\n      seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache : undefined;\n\n  stack.set(array, other);\n  stack.set(other, array);\n\n  // Ignore non-index properties.\n  while (++index < arrLength) {\n    var arrValue = array[index],\n        othValue = other[index];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, arrValue, index, other, array, stack)\n        : customizer(arrValue, othValue, index, array, other, stack);\n    }\n    if (compared !== undefined) {\n      if (compared) {\n        continue;\n      }\n      result = false;\n      break;\n    }\n    // Recursively compare arrays (susceptible to call stack limits).\n    if (seen) {\n      if (!arraySome(other, function(othValue, othIndex) {\n            if (!cacheHas(seen, othIndex) &&\n                (arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n              return seen.push(othIndex);\n            }\n          })) {\n        result = false;\n        break;\n      }\n    } else if (!(\n          arrValue === othValue ||\n            equalFunc(arrValue, othValue, bitmask, customizer, stack)\n        )) {\n      result = false;\n      break;\n    }\n  }\n  stack['delete'](array);\n  stack['delete'](other);\n  return result;\n}\n\nexport default equalArrays;\n","/**\n * Converts `map` to its key-value pairs.\n *\n * @private\n * @param {Object} map The map to convert.\n * @returns {Array} Returns the key-value pairs.\n */\nfunction mapToArray(map) {\n  var index = -1,\n      result = Array(map.size);\n\n  map.forEach(function(value, key) {\n    result[++index] = [key, value];\n  });\n  return result;\n}\n\nexport default mapToArray;\n","/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\nexport default setToArray;\n","import Symbol from './_Symbol.js';\nimport Uint8Array from './_Uint8Array.js';\nimport eq from './eq.js';\nimport equalArrays from './_equalArrays.js';\nimport mapToArray from './_mapToArray.js';\nimport setToArray from './_setToArray.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/** `Object#toString` result references. */\nvar boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]';\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * A specialized version of `baseIsEqualDeep` for comparing objects of\n * the same `toStringTag`.\n *\n * **Note:** This function only supports comparing values with tags of\n * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {string} tag The `toStringTag` of the objects to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalByTag(object, other, tag, bitmask, customizer, equalFunc, stack) {\n  switch (tag) {\n    case dataViewTag:\n      if ((object.byteLength != other.byteLength) ||\n          (object.byteOffset != other.byteOffset)) {\n        return false;\n      }\n      object = object.buffer;\n      other = other.buffer;\n\n    case arrayBufferTag:\n      if ((object.byteLength != other.byteLength) ||\n          !equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n        return false;\n      }\n      return true;\n\n    case boolTag:\n    case dateTag:\n    case numberTag:\n      // Coerce booleans to `1` or `0` and dates to milliseconds.\n      // Invalid dates are coerced to `NaN`.\n      return eq(+object, +other);\n\n    case errorTag:\n      return object.name == other.name && object.message == other.message;\n\n    case regexpTag:\n    case stringTag:\n      // Coerce regexes to strings and treat strings, primitives and objects,\n      // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n      // for more details.\n      return object == (other + '');\n\n    case mapTag:\n      var convert = mapToArray;\n\n    case setTag:\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n      convert || (convert = setToArray);\n\n      if (object.size != other.size && !isPartial) {\n        return false;\n      }\n      // Assume cyclic values are equal.\n      var stacked = stack.get(object);\n      if (stacked) {\n        return stacked == other;\n      }\n      bitmask |= COMPARE_UNORDERED_FLAG;\n\n      // Recursively compare objects (susceptible to call stack limits).\n      stack.set(object, other);\n      var result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n      stack['delete'](object);\n      return result;\n\n    case symbolTag:\n      if (symbolValueOf) {\n        return symbolValueOf.call(object) == symbolValueOf.call(other);\n      }\n  }\n  return false;\n}\n\nexport default equalByTag;\n","import getAllKeys from './_getAllKeys.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqualDeep` for objects with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalObjects(object, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      objProps = getAllKeys(object),\n      objLength = objProps.length,\n      othProps = getAllKeys(other),\n      othLength = othProps.length;\n\n  if (objLength != othLength && !isPartial) {\n    return false;\n  }\n  var index = objLength;\n  while (index--) {\n    var key = objProps[index];\n    if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n      return false;\n    }\n  }\n  // Check that cyclic values are equal.\n  var objStacked = stack.get(object);\n  var othStacked = stack.get(other);\n  if (objStacked && othStacked) {\n    return objStacked == other && othStacked == object;\n  }\n  var result = true;\n  stack.set(object, other);\n  stack.set(other, object);\n\n  var skipCtor = isPartial;\n  while (++index < objLength) {\n    key = objProps[index];\n    var objValue = object[key],\n        othValue = other[key];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, objValue, key, other, object, stack)\n        : customizer(objValue, othValue, key, object, other, stack);\n    }\n    // Recursively compare objects (susceptible to call stack limits).\n    if (!(compared === undefined\n          ? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n          : compared\n        )) {\n      result = false;\n      break;\n    }\n    skipCtor || (skipCtor = key == 'constructor');\n  }\n  if (result && !skipCtor) {\n    var objCtor = object.constructor,\n        othCtor = other.constructor;\n\n    // Non `Object` object instances with different constructors are not equal.\n    if (objCtor != othCtor &&\n        ('constructor' in object && 'constructor' in other) &&\n        !(typeof objCtor == 'function' && objCtor instanceof objCtor &&\n          typeof othCtor == 'function' && othCtor instanceof othCtor)) {\n      result = false;\n    }\n  }\n  stack['delete'](object);\n  stack['delete'](other);\n  return result;\n}\n\nexport default equalObjects;\n","import Stack from './_Stack.js';\nimport equalArrays from './_equalArrays.js';\nimport equalByTag from './_equalByTag.js';\nimport equalObjects from './_equalObjects.js';\nimport getTag from './_getTag.js';\nimport isArray from './isArray.js';\nimport isBuffer from './isBuffer.js';\nimport isTypedArray from './isTypedArray.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqual` for arrays and objects which performs\n * deep comparisons and tracks traversed objects enabling objects with circular\n * references to be compared.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} [stack] Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction baseIsEqualDeep(object, other, bitmask, customizer, equalFunc, stack) {\n  var objIsArr = isArray(object),\n      othIsArr = isArray(other),\n      objTag = objIsArr ? arrayTag : getTag(object),\n      othTag = othIsArr ? arrayTag : getTag(other);\n\n  objTag = objTag == argsTag ? objectTag : objTag;\n  othTag = othTag == argsTag ? objectTag : othTag;\n\n  var objIsObj = objTag == objectTag,\n      othIsObj = othTag == objectTag,\n      isSameTag = objTag == othTag;\n\n  if (isSameTag && isBuffer(object)) {\n    if (!isBuffer(other)) {\n      return false;\n    }\n    objIsArr = true;\n    objIsObj = false;\n  }\n  if (isSameTag && !objIsObj) {\n    stack || (stack = new Stack);\n    return (objIsArr || isTypedArray(object))\n      ? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n      : equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n  }\n  if (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n    var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),\n        othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');\n\n    if (objIsWrapped || othIsWrapped) {\n      var objUnwrapped = objIsWrapped ? object.value() : object,\n          othUnwrapped = othIsWrapped ? other.value() : other;\n\n      stack || (stack = new Stack);\n      return equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n    }\n  }\n  if (!isSameTag) {\n    return false;\n  }\n  stack || (stack = new Stack);\n  return equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n}\n\nexport default baseIsEqualDeep;\n","import baseIsEqualDeep from './_baseIsEqualDeep.js';\nimport isObjectLike from './isObjectLike.js';\n\n/**\n * The base implementation of `_.isEqual` which supports partial comparisons\n * and tracks traversed objects.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Unordered comparison\n *  2 - Partial comparison\n * @param {Function} [customizer] The function to customize comparisons.\n * @param {Object} [stack] Tracks traversed `value` and `other` objects.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n */\nfunction baseIsEqual(value, other, bitmask, customizer, stack) {\n  if (value === other) {\n    return true;\n  }\n  if (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n    return value !== value && other !== other;\n  }\n  return baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n}\n\nexport default baseIsEqual;\n","import Stack from './_Stack.js';\nimport baseIsEqual from './_baseIsEqual.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.isMatch` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to inspect.\n * @param {Object} source The object of property values to match.\n * @param {Array} matchData The property names, values, and compare flags to match.\n * @param {Function} [customizer] The function to customize comparisons.\n * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n */\nfunction baseIsMatch(object, source, matchData, customizer) {\n  var index = matchData.length,\n      length = index,\n      noCustomizer = !customizer;\n\n  if (object == null) {\n    return !length;\n  }\n  object = Object(object);\n  while (index--) {\n    var data = matchData[index];\n    if ((noCustomizer && data[2])\n          ? data[1] !== object[data[0]]\n          : !(data[0] in object)\n        ) {\n      return false;\n    }\n  }\n  while (++index < length) {\n    data = matchData[index];\n    var key = data[0],\n        objValue = object[key],\n        srcValue = data[1];\n\n    if (noCustomizer && data[2]) {\n      if (objValue === undefined && !(key in object)) {\n        return false;\n      }\n    } else {\n      var stack = new Stack;\n      if (customizer) {\n        var result = customizer(objValue, srcValue, key, object, source, stack);\n      }\n      if (!(result === undefined\n            ? baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG, customizer, stack)\n            : result\n          )) {\n        return false;\n      }\n    }\n  }\n  return true;\n}\n\nexport default baseIsMatch;\n","import isObject from './isObject.js';\n\n/**\n * Checks if `value` is suitable for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` if suitable for strict\n *  equality comparisons, else `false`.\n */\nfunction isStrictComparable(value) {\n  return value === value && !isObject(value);\n}\n\nexport default isStrictComparable;\n","import isStrictComparable from './_isStrictComparable.js';\nimport keys from './keys.js';\n\n/**\n * Gets the property names, values, and compare flags of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the match data of `object`.\n */\nfunction getMatchData(object) {\n  var result = keys(object),\n      length = result.length;\n\n  while (length--) {\n    var key = result[length],\n        value = object[key];\n\n    result[length] = [key, value, isStrictComparable(value)];\n  }\n  return result;\n}\n\nexport default getMatchData;\n","/**\n * A specialized version of `matchesProperty` for source values suitable\n * for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction matchesStrictComparable(key, srcValue) {\n  return function(object) {\n    if (object == null) {\n      return false;\n    }\n    return object[key] === srcValue &&\n      (srcValue !== undefined || (key in Object(object)));\n  };\n}\n\nexport default matchesStrictComparable;\n","import baseIsMatch from './_baseIsMatch.js';\nimport getMatchData from './_getMatchData.js';\nimport matchesStrictComparable from './_matchesStrictComparable.js';\n\n/**\n * The base implementation of `_.matches` which doesn't clone `source`.\n *\n * @private\n * @param {Object} source The object of property values to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatches(source) {\n  var matchData = getMatchData(source);\n  if (matchData.length == 1 && matchData[0][2]) {\n    return matchesStrictComparable(matchData[0][0], matchData[0][1]);\n  }\n  return function(object) {\n    return object === source || baseIsMatch(object, source, matchData);\n  };\n}\n\nexport default baseMatches;\n","import isArray from './isArray.js';\nimport isSymbol from './isSymbol.js';\n\n/** Used to match property names within property paths. */\nvar reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n    reIsPlainProp = /^\\w*$/;\n\n/**\n * Checks if `value` is a property name and not a property path.\n *\n * @private\n * @param {*} value The value to check.\n * @param {Object} [object] The object to query keys on.\n * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n */\nfunction isKey(value, object) {\n  if (isArray(value)) {\n    return false;\n  }\n  var type = typeof value;\n  if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n      value == null || isSymbol(value)) {\n    return true;\n  }\n  return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n    (object != null && value in Object(object));\n}\n\nexport default isKey;\n","import isArray from './isArray.js';\nimport isKey from './_isKey.js';\nimport stringToPath from './_stringToPath.js';\nimport toString from './toString.js';\n\n/**\n * Casts `value` to a path array if it's not one.\n *\n * @private\n * @param {*} value The value to inspect.\n * @param {Object} [object] The object to query keys on.\n * @returns {Array} Returns the cast property path array.\n */\nfunction castPath(value, object) {\n  if (isArray(value)) {\n    return value;\n  }\n  return isKey(value, object) ? [value] : stringToPath(toString(value));\n}\n\nexport default castPath;\n","import castPath from './_castPath.js';\nimport toKey from './_toKey.js';\n\n/**\n * The base implementation of `_.get` without support for default values.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @returns {*} Returns the resolved value.\n */\nfunction baseGet(object, path) {\n  path = castPath(path, object);\n\n  var index = 0,\n      length = path.length;\n\n  while (object != null && index < length) {\n    object = object[toKey(path[index++])];\n  }\n  return (index && index == length) ? object : undefined;\n}\n\nexport default baseGet;\n","import baseGet from './_baseGet.js';\n\n/**\n * Gets the value at `path` of `object`. If the resolved value is\n * `undefined`, the `defaultValue` is returned in its place.\n *\n * @static\n * @memberOf _\n * @since 3.7.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n * @returns {*} Returns the resolved value.\n * @example\n *\n * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n *\n * _.get(object, 'a[0].b.c');\n * // => 3\n *\n * _.get(object, ['a', '0', 'b', 'c']);\n * // => 3\n *\n * _.get(object, 'a.b.c', 'default');\n * // => 'default'\n */\nfunction get(object, path, defaultValue) {\n  var result = object == null ? undefined : baseGet(object, path);\n  return result === undefined ? defaultValue : result;\n}\n\nexport default get;\n","/**\n * The base implementation of `_.hasIn` without support for deep paths.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {Array|string} key The key to check.\n * @returns {boolean} Returns `true` if `key` exists, else `false`.\n */\nfunction baseHasIn(object, key) {\n  return object != null && key in Object(object);\n}\n\nexport default baseHasIn;\n","import castPath from './_castPath.js';\nimport isArguments from './isArguments.js';\nimport isArray from './isArray.js';\nimport isIndex from './_isIndex.js';\nimport isLength from './isLength.js';\nimport toKey from './_toKey.js';\n\n/**\n * Checks if `path` exists on `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @param {Function} hasFunc The function to check properties.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n */\nfunction hasPath(object, path, hasFunc) {\n  path = castPath(path, object);\n\n  var index = -1,\n      length = path.length,\n      result = false;\n\n  while (++index < length) {\n    var key = toKey(path[index]);\n    if (!(result = object != null && hasFunc(object, key))) {\n      break;\n    }\n    object = object[key];\n  }\n  if (result || ++index != length) {\n    return result;\n  }\n  length = object == null ? 0 : object.length;\n  return !!length && isLength(length) && isIndex(key, length) &&\n    (isArray(object) || isArguments(object));\n}\n\nexport default hasPath;\n","import baseHasIn from './_baseHasIn.js';\nimport hasPath from './_hasPath.js';\n\n/**\n * Checks if `path` is a direct or inherited property of `object`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n * @example\n *\n * var object = _.create({ 'a': _.create({ 'b': 2 }) });\n *\n * _.hasIn(object, 'a');\n * // => true\n *\n * _.hasIn(object, 'a.b');\n * // => true\n *\n * _.hasIn(object, ['a', 'b']);\n * // => true\n *\n * _.hasIn(object, 'b');\n * // => false\n */\nfunction hasIn(object, path) {\n  return object != null && hasPath(object, path, baseHasIn);\n}\n\nexport default hasIn;\n","import baseIsEqual from './_baseIsEqual.js';\nimport get from './get.js';\nimport hasIn from './hasIn.js';\nimport isKey from './_isKey.js';\nimport isStrictComparable from './_isStrictComparable.js';\nimport matchesStrictComparable from './_matchesStrictComparable.js';\nimport toKey from './_toKey.js';\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.matchesProperty` which doesn't clone `srcValue`.\n *\n * @private\n * @param {string} path The path of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatchesProperty(path, srcValue) {\n  if (isKey(path) && isStrictComparable(srcValue)) {\n    return matchesStrictComparable(toKey(path), srcValue);\n  }\n  return function(object) {\n    var objValue = get(object, path);\n    return (objValue === undefined && objValue === srcValue)\n      ? hasIn(object, path)\n      : baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG);\n  };\n}\n\nexport default baseMatchesProperty;\n","/**\n * The base implementation of `_.property` without support for deep paths.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction baseProperty(key) {\n  return function(object) {\n    return object == null ? undefined : object[key];\n  };\n}\n\nexport default baseProperty;\n","import baseGet from './_baseGet.js';\n\n/**\n * A specialized version of `baseProperty` which supports deep paths.\n *\n * @private\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction basePropertyDeep(path) {\n  return function(object) {\n    return baseGet(object, path);\n  };\n}\n\nexport default basePropertyDeep;\n","import baseProperty from './_baseProperty.js';\nimport basePropertyDeep from './_basePropertyDeep.js';\nimport isKey from './_isKey.js';\nimport toKey from './_toKey.js';\n\n/**\n * Creates a function that returns the value at `path` of a given object.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n * @example\n *\n * var objects = [\n *   { 'a': { 'b': 2 } },\n *   { 'a': { 'b': 1 } }\n * ];\n *\n * _.map(objects, _.property('a.b'));\n * // => [2, 1]\n *\n * _.map(_.sortBy(objects, _.property(['a', 'b'])), 'a.b');\n * // => [1, 2]\n */\nfunction property(path) {\n  return isKey(path) ? baseProperty(toKey(path)) : basePropertyDeep(path);\n}\n\nexport default property;\n","import baseMatches from './_baseMatches.js';\nimport baseMatchesProperty from './_baseMatchesProperty.js';\nimport identity from './identity.js';\nimport isArray from './isArray.js';\nimport property from './property.js';\n\n/**\n * The base implementation of `_.iteratee`.\n *\n * @private\n * @param {*} [value=_.identity] The value to convert to an iteratee.\n * @returns {Function} Returns the iteratee.\n */\nfunction baseIteratee(value) {\n  // Don't store the `typeof` result in a variable to avoid a JIT bug in Safari 9.\n  // See https://bugs.webkit.org/show_bug.cgi?id=156034 for more details.\n  if (typeof value == 'function') {\n    return value;\n  }\n  if (value == null) {\n    return identity;\n  }\n  if (typeof value == 'object') {\n    return isArray(value)\n      ? baseMatchesProperty(value[0], value[1])\n      : baseMatches(value);\n  }\n  return property(value);\n}\n\nexport default baseIteratee;\n","import baseEach from './_baseEach.js';\nimport isArrayLike from './isArrayLike.js';\n\n/**\n * The base implementation of `_.map` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction baseMap(collection, iteratee) {\n  var index = -1,\n      result = isArrayLike(collection) ? Array(collection.length) : [];\n\n  baseEach(collection, function(value, key, collection) {\n    result[++index] = iteratee(value, key, collection);\n  });\n  return result;\n}\n\nexport default baseMap;\n","import arrayMap from './_arrayMap.js';\nimport baseIteratee from './_baseIteratee.js';\nimport baseMap from './_baseMap.js';\nimport isArray from './isArray.js';\n\n/**\n * Creates an array of values by running each element in `collection` thru\n * `iteratee`. The iteratee is invoked with three arguments:\n * (value, index|key, collection).\n *\n * Many lodash methods are guarded to work as iteratees for methods like\n * `_.every`, `_.filter`, `_.map`, `_.mapValues`, `_.reject`, and `_.some`.\n *\n * The guarded methods are:\n * `ary`, `chunk`, `curry`, `curryRight`, `drop`, `dropRight`, `every`,\n * `fill`, `invert`, `parseInt`, `random`, `range`, `rangeRight`, `repeat`,\n * `sampleSize`, `slice`, `some`, `sortBy`, `split`, `take`, `takeRight`,\n * `template`, `trim`, `trimEnd`, `trimStart`, and `words`\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n * @example\n *\n * function square(n) {\n *   return n * n;\n * }\n *\n * _.map([4, 8], square);\n * // => [16, 64]\n *\n * _.map({ 'a': 4, 'b': 8 }, square);\n * // => [16, 64] (iteration order is not guaranteed)\n *\n * var users = [\n *   { 'user': 'barney' },\n *   { 'user': 'fred' }\n * ];\n *\n * // The `_.property` iteratee shorthand.\n * _.map(users, 'user');\n * // => ['barney', 'fred']\n */\nfunction map(collection, iteratee) {\n  var func = isArray(collection) ? arrayMap : baseMap;\n  return func(collection, baseIteratee(iteratee, 3));\n}\n\nexport default map;\n","import React from 'react';\nimport reactCSS from 'reactcss';\nimport map from 'lodash-es/map';\n\nimport { Swatch } from '../common';\n\nexport var BlockSwatches = function BlockSwatches(_ref) {\n  var colors = _ref.colors,\n      onClick = _ref.onClick,\n      onSwatchHover = _ref.onSwatchHover;\n\n  var styles = reactCSS({\n    'default': {\n      swatches: {\n        marginRight: '-10px'\n      },\n      swatch: {\n        width: '22px',\n        height: '22px',\n        float: 'left',\n        marginRight: '10px',\n        marginBottom: '10px',\n        borderRadius: '4px'\n      },\n      clear: {\n        clear: 'both'\n      }\n    }\n  });\n\n  return React.createElement(\n    'div',\n    { style: styles.swatches },\n    map(colors, function (c) {\n      return React.createElement(Swatch, {\n        key: c,\n        color: c,\n        style: styles.swatch,\n        onClick: onClick,\n        onHover: onSwatchHover,\n        focusStyle: {\n          boxShadow: '0 0 4px ' + c\n        }\n      });\n    }),\n    React.createElement('div', { style: styles.clear })\n  );\n};\n\nexport default BlockSwatches;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\nimport * as color from '../../helpers/color';\n\nimport { ColorWrap, EditableInput, Checkboard } from '../common';\nimport BlockSwatches from './BlockSwatches';\n\nexport var Block = function Block(_ref) {\n  var onChange = _ref.onChange,\n      onSwatchHover = _ref.onSwatchHover,\n      hex = _ref.hex,\n      colors = _ref.colors,\n      width = _ref.width,\n      triangle = _ref.triangle,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var transparent = hex === 'transparent';\n  var handleChange = function handleChange(hexCode, e) {\n    color.isValidHex(hexCode) && onChange({\n      hex: hexCode,\n      source: 'hex'\n    }, e);\n  };\n\n  var styles = reactCSS(merge({\n    'default': {\n      card: {\n        width: width,\n        background: '#fff',\n        boxShadow: '0 1px rgba(0,0,0,.1)',\n        borderRadius: '6px',\n        position: 'relative'\n      },\n      head: {\n        height: '110px',\n        background: hex,\n        borderRadius: '6px 6px 0 0',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        position: 'relative'\n      },\n      body: {\n        padding: '10px'\n      },\n      label: {\n        fontSize: '18px',\n        color: color.getContrastingColor(hex),\n        position: 'relative'\n      },\n      triangle: {\n        width: '0px',\n        height: '0px',\n        borderStyle: 'solid',\n        borderWidth: '0 10px 10px 10px',\n        borderColor: 'transparent transparent ' + hex + ' transparent',\n        position: 'absolute',\n        top: '-10px',\n        left: '50%',\n        marginLeft: '-10px'\n      },\n      input: {\n        width: '100%',\n        fontSize: '12px',\n        color: '#666',\n        border: '0px',\n        outline: 'none',\n        height: '22px',\n        boxShadow: 'inset 0 0 0 1px #ddd',\n        borderRadius: '4px',\n        padding: '0 7px',\n        boxSizing: 'border-box'\n      }\n    },\n    'hide-triangle': {\n      triangle: {\n        display: 'none'\n      }\n    }\n  }, passedStyles), { 'hide-triangle': triangle === 'hide' });\n\n  return React.createElement(\n    'div',\n    { style: styles.card, className: 'block-picker ' + className },\n    React.createElement('div', { style: styles.triangle }),\n    React.createElement(\n      'div',\n      { style: styles.head },\n      transparent && React.createElement(Checkboard, { borderRadius: '6px 6px 0 0' }),\n      React.createElement(\n        'div',\n        { style: styles.label },\n        hex\n      )\n    ),\n    React.createElement(\n      'div',\n      { style: styles.body },\n      React.createElement(BlockSwatches, { colors: colors, onClick: handleChange, onSwatchHover: onSwatchHover }),\n      React.createElement(EditableInput, {\n        style: { input: styles.input },\n        value: hex,\n        onChange: handleChange\n      })\n    )\n  );\n};\n\nBlock.propTypes = {\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  colors: PropTypes.arrayOf(PropTypes.string),\n  triangle: PropTypes.oneOf(['top', 'hide']),\n  styles: PropTypes.object\n};\n\nBlock.defaultProps = {\n  width: 170,\n  colors: ['#D9E3F0', '#F47373', '#697689', '#37D67A', '#2CCCE4', '#555555', '#dce775', '#ff8a65', '#ba68c8'],\n  triangle: 'top',\n  styles: {}\n};\n\nexport default ColorWrap(Block);","export var red = {\"50\":\"#ffebee\",\"100\":\"#ffcdd2\",\"200\":\"#ef9a9a\",\"300\":\"#e57373\",\"400\":\"#ef5350\",\"500\":\"#f44336\",\"600\":\"#e53935\",\"700\":\"#d32f2f\",\"800\":\"#c62828\",\"900\":\"#b71c1c\",\"a100\":\"#ff8a80\",\"a200\":\"#ff5252\",\"a400\":\"#ff1744\",\"a700\":\"#d50000\"};\nexport var pink = {\"50\":\"#fce4ec\",\"100\":\"#f8bbd0\",\"200\":\"#f48fb1\",\"300\":\"#f06292\",\"400\":\"#ec407a\",\"500\":\"#e91e63\",\"600\":\"#d81b60\",\"700\":\"#c2185b\",\"800\":\"#ad1457\",\"900\":\"#880e4f\",\"a100\":\"#ff80ab\",\"a200\":\"#ff4081\",\"a400\":\"#f50057\",\"a700\":\"#c51162\"};\nexport var purple = {\"50\":\"#f3e5f5\",\"100\":\"#e1bee7\",\"200\":\"#ce93d8\",\"300\":\"#ba68c8\",\"400\":\"#ab47bc\",\"500\":\"#9c27b0\",\"600\":\"#8e24aa\",\"700\":\"#7b1fa2\",\"800\":\"#6a1b9a\",\"900\":\"#4a148c\",\"a100\":\"#ea80fc\",\"a200\":\"#e040fb\",\"a400\":\"#d500f9\",\"a700\":\"#aa00ff\"};\nexport var deepPurple = {\"50\":\"#ede7f6\",\"100\":\"#d1c4e9\",\"200\":\"#b39ddb\",\"300\":\"#9575cd\",\"400\":\"#7e57c2\",\"500\":\"#673ab7\",\"600\":\"#5e35b1\",\"700\":\"#512da8\",\"800\":\"#4527a0\",\"900\":\"#311b92\",\"a100\":\"#b388ff\",\"a200\":\"#7c4dff\",\"a400\":\"#651fff\",\"a700\":\"#6200ea\"};\nexport var indigo = {\"50\":\"#e8eaf6\",\"100\":\"#c5cae9\",\"200\":\"#9fa8da\",\"300\":\"#7986cb\",\"400\":\"#5c6bc0\",\"500\":\"#3f51b5\",\"600\":\"#3949ab\",\"700\":\"#303f9f\",\"800\":\"#283593\",\"900\":\"#1a237e\",\"a100\":\"#8c9eff\",\"a200\":\"#536dfe\",\"a400\":\"#3d5afe\",\"a700\":\"#304ffe\"};\nexport var blue = {\"50\":\"#e3f2fd\",\"100\":\"#bbdefb\",\"200\":\"#90caf9\",\"300\":\"#64b5f6\",\"400\":\"#42a5f5\",\"500\":\"#2196f3\",\"600\":\"#1e88e5\",\"700\":\"#1976d2\",\"800\":\"#1565c0\",\"900\":\"#0d47a1\",\"a100\":\"#82b1ff\",\"a200\":\"#448aff\",\"a400\":\"#2979ff\",\"a700\":\"#2962ff\"};\nexport var lightBlue = {\"50\":\"#e1f5fe\",\"100\":\"#b3e5fc\",\"200\":\"#81d4fa\",\"300\":\"#4fc3f7\",\"400\":\"#29b6f6\",\"500\":\"#03a9f4\",\"600\":\"#039be5\",\"700\":\"#0288d1\",\"800\":\"#0277bd\",\"900\":\"#01579b\",\"a100\":\"#80d8ff\",\"a200\":\"#40c4ff\",\"a400\":\"#00b0ff\",\"a700\":\"#0091ea\"};\nexport var cyan = {\"50\":\"#e0f7fa\",\"100\":\"#b2ebf2\",\"200\":\"#80deea\",\"300\":\"#4dd0e1\",\"400\":\"#26c6da\",\"500\":\"#00bcd4\",\"600\":\"#00acc1\",\"700\":\"#0097a7\",\"800\":\"#00838f\",\"900\":\"#006064\",\"a100\":\"#84ffff\",\"a200\":\"#18ffff\",\"a400\":\"#00e5ff\",\"a700\":\"#00b8d4\"};\nexport var teal = {\"50\":\"#e0f2f1\",\"100\":\"#b2dfdb\",\"200\":\"#80cbc4\",\"300\":\"#4db6ac\",\"400\":\"#26a69a\",\"500\":\"#009688\",\"600\":\"#00897b\",\"700\":\"#00796b\",\"800\":\"#00695c\",\"900\":\"#004d40\",\"a100\":\"#a7ffeb\",\"a200\":\"#64ffda\",\"a400\":\"#1de9b6\",\"a700\":\"#00bfa5\"};\nexport var green = {\"50\":\"#e8f5e9\",\"100\":\"#c8e6c9\",\"200\":\"#a5d6a7\",\"300\":\"#81c784\",\"400\":\"#66bb6a\",\"500\":\"#4caf50\",\"600\":\"#43a047\",\"700\":\"#388e3c\",\"800\":\"#2e7d32\",\"900\":\"#1b5e20\",\"a100\":\"#b9f6ca\",\"a200\":\"#69f0ae\",\"a400\":\"#00e676\",\"a700\":\"#00c853\"};\nexport var lightGreen = {\"50\":\"#f1f8e9\",\"100\":\"#dcedc8\",\"200\":\"#c5e1a5\",\"300\":\"#aed581\",\"400\":\"#9ccc65\",\"500\":\"#8bc34a\",\"600\":\"#7cb342\",\"700\":\"#689f38\",\"800\":\"#558b2f\",\"900\":\"#33691e\",\"a100\":\"#ccff90\",\"a200\":\"#b2ff59\",\"a400\":\"#76ff03\",\"a700\":\"#64dd17\"};\nexport var lime = {\"50\":\"#f9fbe7\",\"100\":\"#f0f4c3\",\"200\":\"#e6ee9c\",\"300\":\"#dce775\",\"400\":\"#d4e157\",\"500\":\"#cddc39\",\"600\":\"#c0ca33\",\"700\":\"#afb42b\",\"800\":\"#9e9d24\",\"900\":\"#827717\",\"a100\":\"#f4ff81\",\"a200\":\"#eeff41\",\"a400\":\"#c6ff00\",\"a700\":\"#aeea00\"};\nexport var yellow = {\"50\":\"#fffde7\",\"100\":\"#fff9c4\",\"200\":\"#fff59d\",\"300\":\"#fff176\",\"400\":\"#ffee58\",\"500\":\"#ffeb3b\",\"600\":\"#fdd835\",\"700\":\"#fbc02d\",\"800\":\"#f9a825\",\"900\":\"#f57f17\",\"a100\":\"#ffff8d\",\"a200\":\"#ffff00\",\"a400\":\"#ffea00\",\"a700\":\"#ffd600\"};\nexport var amber = {\"50\":\"#fff8e1\",\"100\":\"#ffecb3\",\"200\":\"#ffe082\",\"300\":\"#ffd54f\",\"400\":\"#ffca28\",\"500\":\"#ffc107\",\"600\":\"#ffb300\",\"700\":\"#ffa000\",\"800\":\"#ff8f00\",\"900\":\"#ff6f00\",\"a100\":\"#ffe57f\",\"a200\":\"#ffd740\",\"a400\":\"#ffc400\",\"a700\":\"#ffab00\"};\nexport var orange = {\"50\":\"#fff3e0\",\"100\":\"#ffe0b2\",\"200\":\"#ffcc80\",\"300\":\"#ffb74d\",\"400\":\"#ffa726\",\"500\":\"#ff9800\",\"600\":\"#fb8c00\",\"700\":\"#f57c00\",\"800\":\"#ef6c00\",\"900\":\"#e65100\",\"a100\":\"#ffd180\",\"a200\":\"#ffab40\",\"a400\":\"#ff9100\",\"a700\":\"#ff6d00\"};\nexport var deepOrange = {\"50\":\"#fbe9e7\",\"100\":\"#ffccbc\",\"200\":\"#ffab91\",\"300\":\"#ff8a65\",\"400\":\"#ff7043\",\"500\":\"#ff5722\",\"600\":\"#f4511e\",\"700\":\"#e64a19\",\"800\":\"#d84315\",\"900\":\"#bf360c\",\"a100\":\"#ff9e80\",\"a200\":\"#ff6e40\",\"a400\":\"#ff3d00\",\"a700\":\"#dd2c00\"};\nexport var brown = {\"50\":\"#efebe9\",\"100\":\"#d7ccc8\",\"200\":\"#bcaaa4\",\"300\":\"#a1887f\",\"400\":\"#8d6e63\",\"500\":\"#795548\",\"600\":\"#6d4c41\",\"700\":\"#5d4037\",\"800\":\"#4e342e\",\"900\":\"#3e2723\"};\nexport var grey = {\"50\":\"#fafafa\",\"100\":\"#f5f5f5\",\"200\":\"#eeeeee\",\"300\":\"#e0e0e0\",\"400\":\"#bdbdbd\",\"500\":\"#9e9e9e\",\"600\":\"#757575\",\"700\":\"#616161\",\"800\":\"#424242\",\"900\":\"#212121\"};\nexport var blueGrey = {\"50\":\"#eceff1\",\"100\":\"#cfd8dc\",\"200\":\"#b0bec5\",\"300\":\"#90a4ae\",\"400\":\"#78909c\",\"500\":\"#607d8b\",\"600\":\"#546e7a\",\"700\":\"#455a64\",\"800\":\"#37474f\",\"900\":\"#263238\"};\nexport var darkText = {\"primary\":\"rgba(0, 0, 0, 0.87)\",\"secondary\":\"rgba(0, 0, 0, 0.54)\",\"disabled\":\"rgba(0, 0, 0, 0.38)\",\"dividers\":\"rgba(0, 0, 0, 0.12)\"};\nexport var lightText = {\"primary\":\"rgba(255, 255, 255, 1)\",\"secondary\":\"rgba(255, 255, 255, 0.7)\",\"disabled\":\"rgba(255, 255, 255, 0.5)\",\"dividers\":\"rgba(255, 255, 255, 0.12)\"};\nexport var darkIcons = {\"active\":\"rgba(0, 0, 0, 0.54)\",\"inactive\":\"rgba(0, 0, 0, 0.38)\"};\nexport var lightIcons = {\"active\":\"rgba(255, 255, 255, 1)\",\"inactive\":\"rgba(255, 255, 255, 0.5)\"};\nexport var white = \"#ffffff\";\nexport var black = \"#000000\";\n\nexport default {\n  red: red,\n  pink: pink,\n  purple: purple,\n  deepPurple: deepPurple,\n  indigo: indigo,\n  blue: blue,\n  lightBlue: lightBlue,\n  cyan: cyan,\n  teal: teal,\n  green: green,\n  lightGreen: lightGreen,\n  lime: lime,\n  yellow: yellow,\n  amber: amber,\n  orange: orange,\n  deepOrange: deepOrange,\n  brown: brown,\n  grey: grey,\n  blueGrey: blueGrey,\n  darkText: darkText,\n  lightText: lightText,\n  darkIcons: darkIcons,\n  lightIcons: lightIcons,\n  white: white,\n  black: black\n};\n","import React from 'react';\nimport reactCSS, { handleHover } from 'reactcss';\n\nimport { Swatch } from '../common';\n\nexport var CircleSwatch = function CircleSwatch(_ref) {\n  var color = _ref.color,\n      onClick = _ref.onClick,\n      onSwatchHover = _ref.onSwatchHover,\n      hover = _ref.hover,\n      active = _ref.active,\n      circleSize = _ref.circleSize,\n      circleSpacing = _ref.circleSpacing;\n\n  var styles = reactCSS({\n    'default': {\n      swatch: {\n        width: circleSize,\n        height: circleSize,\n        marginRight: circleSpacing,\n        marginBottom: circleSpacing,\n        transform: 'scale(1)',\n        transition: '100ms transform ease'\n      },\n      Swatch: {\n        borderRadius: '50%',\n        background: 'transparent',\n        boxShadow: 'inset 0 0 0 ' + (circleSize / 2 + 1) + 'px ' + color,\n        transition: '100ms box-shadow ease'\n      }\n    },\n    'hover': {\n      swatch: {\n        transform: 'scale(1.2)'\n      }\n    },\n    'active': {\n      Swatch: {\n        boxShadow: 'inset 0 0 0 3px ' + color\n      }\n    }\n  }, { hover: hover, active: active });\n\n  return React.createElement(\n    'div',\n    { style: styles.swatch },\n    React.createElement(Swatch, {\n      style: styles.Swatch,\n      color: color,\n      onClick: onClick,\n      onHover: onSwatchHover,\n      focusStyle: { boxShadow: styles.Swatch.boxShadow + ', 0 0 5px ' + color }\n    })\n  );\n};\n\nCircleSwatch.defaultProps = {\n  circleSize: 28,\n  circleSpacing: 14\n};\n\nexport default handleHover(CircleSwatch);","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport map from 'lodash-es/map';\nimport merge from 'lodash-es/merge';\nimport * as material from 'material-colors';\n\nimport { ColorWrap } from '../common';\nimport CircleSwatch from './CircleSwatch';\n\nexport var Circle = function Circle(_ref) {\n  var width = _ref.width,\n      onChange = _ref.onChange,\n      onSwatchHover = _ref.onSwatchHover,\n      colors = _ref.colors,\n      hex = _ref.hex,\n      circleSize = _ref.circleSize,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      circleSpacing = _ref.circleSpacing,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      card: {\n        width: width,\n        display: 'flex',\n        flexWrap: 'wrap',\n        marginRight: -circleSpacing,\n        marginBottom: -circleSpacing\n      }\n    }\n  }, passedStyles));\n\n  var handleChange = function handleChange(hexCode, e) {\n    return onChange({ hex: hexCode, source: 'hex' }, e);\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.card, className: 'circle-picker ' + className },\n    map(colors, function (c) {\n      return React.createElement(CircleSwatch, {\n        key: c,\n        color: c,\n        onClick: handleChange,\n        onSwatchHover: onSwatchHover,\n        active: hex === c.toLowerCase(),\n        circleSize: circleSize,\n        circleSpacing: circleSpacing\n      });\n    })\n  );\n};\n\nCircle.propTypes = {\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  circleSize: PropTypes.number,\n  circleSpacing: PropTypes.number,\n  styles: PropTypes.object\n};\n\nCircle.defaultProps = {\n  width: 252,\n  circleSize: 28,\n  circleSpacing: 14,\n  colors: [material.red['500'], material.pink['500'], material.purple['500'], material.deepPurple['500'], material.indigo['500'], material.blue['500'], material.lightBlue['500'], material.cyan['500'], material.teal['500'], material.green['500'], material.lightGreen['500'], material.lime['500'], material.yellow['500'], material.amber['500'], material.orange['500'], material.deepOrange['500'], material.brown['500'], material.blueGrey['500']],\n  styles: {}\n};\n\nexport default ColorWrap(Circle);","/**\n * Checks if `value` is `undefined`.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `undefined`, else `false`.\n * @example\n *\n * _.isUndefined(void 0);\n * // => true\n *\n * _.isUndefined(null);\n * // => false\n */\nfunction isUndefined(value) {\n  return value === undefined;\n}\n\nexport default isUndefined;\n","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n/* eslint-disable react/no-did-mount-set-state, no-param-reassign */\n\nimport React from 'react';\nimport reactCSS from 'reactcss';\nimport * as color from '../../helpers/color';\nimport isUndefined from 'lodash-es/isUndefined';\n\nimport { EditableInput } from '../common';\nimport UnfoldMoreHorizontalIcon from '@icons/material/UnfoldMoreHorizontalIcon';\n\nexport var ChromeFields = function (_React$Component) {\n  _inherits(ChromeFields, _React$Component);\n\n  function ChromeFields(props) {\n    _classCallCheck(this, ChromeFields);\n\n    var _this = _possibleConstructorReturn(this, (ChromeFields.__proto__ || Object.getPrototypeOf(ChromeFields)).call(this));\n\n    _this.toggleViews = function () {\n      if (_this.state.view === 'hex') {\n        _this.setState({ view: 'rgb' });\n      } else if (_this.state.view === 'rgb') {\n        _this.setState({ view: 'hsl' });\n      } else if (_this.state.view === 'hsl') {\n        if (_this.props.hsl.a === 1) {\n          _this.setState({ view: 'hex' });\n        } else {\n          _this.setState({ view: 'rgb' });\n        }\n      }\n    };\n\n    _this.handleChange = function (data, e) {\n      if (data.hex) {\n        color.isValidHex(data.hex) && _this.props.onChange({\n          hex: data.hex,\n          source: 'hex'\n        }, e);\n      } else if (data.r || data.g || data.b) {\n        _this.props.onChange({\n          r: data.r || _this.props.rgb.r,\n          g: data.g || _this.props.rgb.g,\n          b: data.b || _this.props.rgb.b,\n          source: 'rgb'\n        }, e);\n      } else if (data.a) {\n        if (data.a < 0) {\n          data.a = 0;\n        } else if (data.a > 1) {\n          data.a = 1;\n        }\n\n        _this.props.onChange({\n          h: _this.props.hsl.h,\n          s: _this.props.hsl.s,\n          l: _this.props.hsl.l,\n          a: Math.round(data.a * 100) / 100,\n          source: 'rgb'\n        }, e);\n      } else if (data.h || data.s || data.l) {\n        // Remove any occurances of '%'.\n        if (typeof data.s === 'string' && data.s.includes('%')) {\n          data.s = data.s.replace('%', '');\n        }\n        if (typeof data.l === 'string' && data.l.includes('%')) {\n          data.l = data.l.replace('%', '');\n        }\n\n        // We store HSL as a unit interval so we need to override the 1 input to 0.01\n        if (data.s == 1) {\n          data.s = 0.01;\n        } else if (data.l == 1) {\n          data.l = 0.01;\n        }\n\n        _this.props.onChange({\n          h: data.h || _this.props.hsl.h,\n          s: Number(!isUndefined(data.s) ? data.s : _this.props.hsl.s),\n          l: Number(!isUndefined(data.l) ? data.l : _this.props.hsl.l),\n          source: 'hsl'\n        }, e);\n      }\n    };\n\n    _this.showHighlight = function (e) {\n      e.currentTarget.style.background = '#eee';\n    };\n\n    _this.hideHighlight = function (e) {\n      e.currentTarget.style.background = 'transparent';\n    };\n\n    if (props.hsl.a !== 1 && props.view === \"hex\") {\n      _this.state = {\n        view: \"rgb\"\n      };\n    } else {\n      _this.state = {\n        view: props.view\n      };\n    }\n    return _this;\n  }\n\n  _createClass(ChromeFields, [{\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      var styles = reactCSS({\n        'default': {\n          wrap: {\n            paddingTop: '16px',\n            display: 'flex'\n          },\n          fields: {\n            flex: '1',\n            display: 'flex',\n            marginLeft: '-6px'\n          },\n          field: {\n            paddingLeft: '6px',\n            width: '100%'\n          },\n          alpha: {\n            paddingLeft: '6px',\n            width: '100%'\n          },\n          toggle: {\n            width: '32px',\n            textAlign: 'right',\n            position: 'relative'\n          },\n          icon: {\n            marginRight: '-4px',\n            marginTop: '12px',\n            cursor: 'pointer',\n            position: 'relative'\n          },\n          iconHighlight: {\n            position: 'absolute',\n            width: '24px',\n            height: '28px',\n            background: '#eee',\n            borderRadius: '4px',\n            top: '10px',\n            left: '12px',\n            display: 'none'\n          },\n          input: {\n            fontSize: '11px',\n            color: '#333',\n            width: '100%',\n            borderRadius: '2px',\n            border: 'none',\n            boxShadow: 'inset 0 0 0 1px #dadada',\n            height: '21px',\n            textAlign: 'center'\n          },\n          label: {\n            textTransform: 'uppercase',\n            fontSize: '11px',\n            lineHeight: '11px',\n            color: '#969696',\n            textAlign: 'center',\n            display: 'block',\n            marginTop: '12px'\n          },\n          svg: {\n            fill: '#333',\n            width: '24px',\n            height: '24px',\n            border: '1px transparent solid',\n            borderRadius: '5px'\n          }\n        },\n        'disableAlpha': {\n          alpha: {\n            display: 'none'\n          }\n        }\n      }, this.props, this.state);\n\n      var fields = void 0;\n      if (this.state.view === 'hex') {\n        fields = React.createElement(\n          'div',\n          { style: styles.fields, className: 'flexbox-fix' },\n          React.createElement(\n            'div',\n            { style: styles.field },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'hex', value: this.props.hex,\n              onChange: this.handleChange\n            })\n          )\n        );\n      } else if (this.state.view === 'rgb') {\n        fields = React.createElement(\n          'div',\n          { style: styles.fields, className: 'flexbox-fix' },\n          React.createElement(\n            'div',\n            { style: styles.field },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'r',\n              value: this.props.rgb.r,\n              onChange: this.handleChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.field },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'g',\n              value: this.props.rgb.g,\n              onChange: this.handleChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.field },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'b',\n              value: this.props.rgb.b,\n              onChange: this.handleChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.alpha },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'a',\n              value: this.props.rgb.a,\n              arrowOffset: 0.01,\n              onChange: this.handleChange\n            })\n          )\n        );\n      } else if (this.state.view === 'hsl') {\n        fields = React.createElement(\n          'div',\n          { style: styles.fields, className: 'flexbox-fix' },\n          React.createElement(\n            'div',\n            { style: styles.field },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'h',\n              value: Math.round(this.props.hsl.h),\n              onChange: this.handleChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.field },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 's',\n              value: Math.round(this.props.hsl.s * 100) + '%',\n              onChange: this.handleChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.field },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'l',\n              value: Math.round(this.props.hsl.l * 100) + '%',\n              onChange: this.handleChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.alpha },\n            React.createElement(EditableInput, {\n              style: { input: styles.input, label: styles.label },\n              label: 'a',\n              value: this.props.hsl.a,\n              arrowOffset: 0.01,\n              onChange: this.handleChange\n            })\n          )\n        );\n      }\n\n      return React.createElement(\n        'div',\n        { style: styles.wrap, className: 'flexbox-fix' },\n        fields,\n        React.createElement(\n          'div',\n          { style: styles.toggle },\n          React.createElement(\n            'div',\n            { style: styles.icon, onClick: this.toggleViews, ref: function ref(icon) {\n                return _this2.icon = icon;\n              } },\n            React.createElement(UnfoldMoreHorizontalIcon, {\n              style: styles.svg,\n              onMouseOver: this.showHighlight,\n              onMouseEnter: this.showHighlight,\n              onMouseOut: this.hideHighlight\n            })\n          )\n        )\n      );\n    }\n  }], [{\n    key: 'getDerivedStateFromProps',\n    value: function getDerivedStateFromProps(nextProps, state) {\n      if (nextProps.hsl.a !== 1 && state.view === 'hex') {\n        return { view: 'rgb' };\n      }\n      return null;\n    }\n  }]);\n\n  return ChromeFields;\n}(React.Component);\n\nChromeFields.defaultProps = {\n  view: \"hex\"\n};\n\nexport default ChromeFields;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var ChromePointer = function ChromePointer() {\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '12px',\n        height: '12px',\n        borderRadius: '6px',\n        transform: 'translate(-6px, -1px)',\n        backgroundColor: 'rgb(248, 248, 248)',\n        boxShadow: '0 1px 4px 0 rgba(0, 0, 0, 0.37)'\n      }\n    }\n  });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nexport default ChromePointer;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var ChromePointerCircle = function ChromePointerCircle() {\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '12px',\n        height: '12px',\n        borderRadius: '6px',\n        boxShadow: 'inset 0 0 0 1px #fff',\n        transform: 'translate(-6px, -6px)'\n      }\n    }\n  });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nexport default ChromePointerCircle;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\n\nimport { ColorWrap, Saturation, Hue, Alpha, Checkboard } from '../common';\nimport ChromeFields from './ChromeFields';\nimport ChromePointer from './ChromePointer';\nimport ChromePointerCircle from './ChromePointerCircle';\n\nexport var Chrome = function Chrome(_ref) {\n  var width = _ref.width,\n      onChange = _ref.onChange,\n      disableAlpha = _ref.disableAlpha,\n      rgb = _ref.rgb,\n      hsl = _ref.hsl,\n      hsv = _ref.hsv,\n      hex = _ref.hex,\n      renderers = _ref.renderers,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className,\n      defaultView = _ref.defaultView;\n\n  var styles = reactCSS(merge({\n    'default': {\n      picker: {\n        width: width,\n        background: '#fff',\n        borderRadius: '2px',\n        boxShadow: '0 0 2px rgba(0,0,0,.3), 0 4px 8px rgba(0,0,0,.3)',\n        boxSizing: 'initial',\n        fontFamily: 'Menlo'\n      },\n      saturation: {\n        width: '100%',\n        paddingBottom: '55%',\n        position: 'relative',\n        borderRadius: '2px 2px 0 0',\n        overflow: 'hidden'\n      },\n      Saturation: {\n        radius: '2px 2px 0 0'\n      },\n      body: {\n        padding: '16px 16px 12px'\n      },\n      controls: {\n        display: 'flex'\n      },\n      color: {\n        width: '32px'\n      },\n      swatch: {\n        marginTop: '6px',\n        width: '16px',\n        height: '16px',\n        borderRadius: '8px',\n        position: 'relative',\n        overflow: 'hidden'\n      },\n      active: {\n        absolute: '0px 0px 0px 0px',\n        borderRadius: '8px',\n        boxShadow: 'inset 0 0 0 1px rgba(0,0,0,.1)',\n        background: 'rgba(' + rgb.r + ', ' + rgb.g + ', ' + rgb.b + ', ' + rgb.a + ')',\n        zIndex: '2'\n      },\n      toggles: {\n        flex: '1'\n      },\n      hue: {\n        height: '10px',\n        position: 'relative',\n        marginBottom: '8px'\n      },\n      Hue: {\n        radius: '2px'\n      },\n      alpha: {\n        height: '10px',\n        position: 'relative'\n      },\n      Alpha: {\n        radius: '2px'\n      }\n    },\n    'disableAlpha': {\n      color: {\n        width: '22px'\n      },\n      alpha: {\n        display: 'none'\n      },\n      hue: {\n        marginBottom: '0px'\n      },\n      swatch: {\n        width: '10px',\n        height: '10px',\n        marginTop: '0px'\n      }\n    }\n  }, passedStyles), { disableAlpha: disableAlpha });\n\n  return React.createElement(\n    'div',\n    { style: styles.picker, className: 'chrome-picker ' + className },\n    React.createElement(\n      'div',\n      { style: styles.saturation },\n      React.createElement(Saturation, {\n        style: styles.Saturation,\n        hsl: hsl,\n        hsv: hsv,\n        pointer: ChromePointerCircle,\n        onChange: onChange\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.body },\n      React.createElement(\n        'div',\n        { style: styles.controls, className: 'flexbox-fix' },\n        React.createElement(\n          'div',\n          { style: styles.color },\n          React.createElement(\n            'div',\n            { style: styles.swatch },\n            React.createElement('div', { style: styles.active }),\n            React.createElement(Checkboard, { renderers: renderers })\n          )\n        ),\n        React.createElement(\n          'div',\n          { style: styles.toggles },\n          React.createElement(\n            'div',\n            { style: styles.hue },\n            React.createElement(Hue, {\n              style: styles.Hue,\n              hsl: hsl,\n              pointer: ChromePointer,\n              onChange: onChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.alpha },\n            React.createElement(Alpha, {\n              style: styles.Alpha,\n              rgb: rgb,\n              hsl: hsl,\n              pointer: ChromePointer,\n              renderers: renderers,\n              onChange: onChange\n            })\n          )\n        )\n      ),\n      React.createElement(ChromeFields, {\n        rgb: rgb,\n        hsl: hsl,\n        hex: hex,\n        view: defaultView,\n        onChange: onChange,\n        disableAlpha: disableAlpha\n      })\n    )\n  );\n};\n\nChrome.propTypes = {\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  disableAlpha: PropTypes.bool,\n  styles: PropTypes.object,\n  defaultView: PropTypes.oneOf([\"hex\", \"rgb\", \"hsl\"])\n};\n\nChrome.defaultProps = {\n  width: 225,\n  disableAlpha: false,\n  styles: {}\n};\n\nexport default ColorWrap(Chrome);","import React from 'react';\nimport reactCSS from 'reactcss';\nimport * as colorUtils from '../../helpers/color';\n\nimport { Swatch } from '../common';\n\nexport var CompactColor = function CompactColor(_ref) {\n  var color = _ref.color,\n      _ref$onClick = _ref.onClick,\n      onClick = _ref$onClick === undefined ? function () {} : _ref$onClick,\n      onSwatchHover = _ref.onSwatchHover,\n      active = _ref.active;\n\n  var styles = reactCSS({\n    'default': {\n      color: {\n        background: color,\n        width: '15px',\n        height: '15px',\n        float: 'left',\n        marginRight: '5px',\n        marginBottom: '5px',\n        position: 'relative',\n        cursor: 'pointer'\n      },\n      dot: {\n        absolute: '5px 5px 5px 5px',\n        background: colorUtils.getContrastingColor(color),\n        borderRadius: '50%',\n        opacity: '0'\n      }\n    },\n    'active': {\n      dot: {\n        opacity: '1'\n      }\n    },\n    'color-#FFFFFF': {\n      color: {\n        boxShadow: 'inset 0 0 0 1px #ddd'\n      },\n      dot: {\n        background: '#000'\n      }\n    },\n    'transparent': {\n      dot: {\n        background: '#000'\n      }\n    }\n  }, { active: active, 'color-#FFFFFF': color === '#FFFFFF', 'transparent': color === 'transparent' });\n\n  return React.createElement(\n    Swatch,\n    {\n      style: styles.color,\n      color: color,\n      onClick: onClick,\n      onHover: onSwatchHover,\n      focusStyle: { boxShadow: '0 0 4px ' + color }\n    },\n    React.createElement('div', { style: styles.dot })\n  );\n};\n\nexport default CompactColor;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nimport { EditableInput } from '../common';\n\nexport var CompactFields = function CompactFields(_ref) {\n  var hex = _ref.hex,\n      rgb = _ref.rgb,\n      onChange = _ref.onChange;\n\n  var styles = reactCSS({\n    'default': {\n      fields: {\n        display: 'flex',\n        paddingBottom: '6px',\n        paddingRight: '5px',\n        position: 'relative'\n      },\n      active: {\n        position: 'absolute',\n        top: '6px',\n        left: '5px',\n        height: '9px',\n        width: '9px',\n        background: hex\n      },\n      HEXwrap: {\n        flex: '6',\n        position: 'relative'\n      },\n      HEXinput: {\n        width: '80%',\n        padding: '0px',\n        paddingLeft: '20%',\n        border: 'none',\n        outline: 'none',\n        background: 'none',\n        fontSize: '12px',\n        color: '#333',\n        height: '16px'\n      },\n      HEXlabel: {\n        display: 'none'\n      },\n      RGBwrap: {\n        flex: '3',\n        position: 'relative'\n      },\n      RGBinput: {\n        width: '70%',\n        padding: '0px',\n        paddingLeft: '30%',\n        border: 'none',\n        outline: 'none',\n        background: 'none',\n        fontSize: '12px',\n        color: '#333',\n        height: '16px'\n      },\n      RGBlabel: {\n        position: 'absolute',\n        top: '3px',\n        left: '0px',\n        lineHeight: '16px',\n        textTransform: 'uppercase',\n        fontSize: '12px',\n        color: '#999'\n      }\n    }\n  });\n\n  var handleChange = function handleChange(data, e) {\n    if (data.r || data.g || data.b) {\n      onChange({\n        r: data.r || rgb.r,\n        g: data.g || rgb.g,\n        b: data.b || rgb.b,\n        source: 'rgb'\n      }, e);\n    } else {\n      onChange({\n        hex: data.hex,\n        source: 'hex'\n      }, e);\n    }\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.fields, className: 'flexbox-fix' },\n    React.createElement('div', { style: styles.active }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.HEXwrap, input: styles.HEXinput, label: styles.HEXlabel },\n      label: 'hex',\n      value: hex,\n      onChange: handleChange\n    }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'r',\n      value: rgb.r,\n      onChange: handleChange\n    }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'g',\n      value: rgb.g,\n      onChange: handleChange\n    }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'b',\n      value: rgb.b,\n      onChange: handleChange\n    })\n  );\n};\n\nexport default CompactFields;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport map from 'lodash-es/map';\nimport merge from 'lodash-es/merge';\nimport * as color from '../../helpers/color';\n\nimport { ColorWrap, Raised } from '../common';\nimport CompactColor from './CompactColor';\nimport CompactFields from './CompactFields';\n\nexport var Compact = function Compact(_ref) {\n  var onChange = _ref.onChange,\n      onSwatchHover = _ref.onSwatchHover,\n      colors = _ref.colors,\n      hex = _ref.hex,\n      rgb = _ref.rgb,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      Compact: {\n        background: '#f6f6f6',\n        radius: '4px'\n      },\n      compact: {\n        paddingTop: '5px',\n        paddingLeft: '5px',\n        boxSizing: 'initial',\n        width: '240px'\n      },\n      clear: {\n        clear: 'both'\n      }\n    }\n  }, passedStyles));\n\n  var handleChange = function handleChange(data, e) {\n    if (data.hex) {\n      color.isValidHex(data.hex) && onChange({\n        hex: data.hex,\n        source: 'hex'\n      }, e);\n    } else {\n      onChange(data, e);\n    }\n  };\n\n  return React.createElement(\n    Raised,\n    { style: styles.Compact, styles: passedStyles },\n    React.createElement(\n      'div',\n      { style: styles.compact, className: 'compact-picker ' + className },\n      React.createElement(\n        'div',\n        null,\n        map(colors, function (c) {\n          return React.createElement(CompactColor, {\n            key: c,\n            color: c,\n            active: c.toLowerCase() === hex,\n            onClick: handleChange,\n            onSwatchHover: onSwatchHover\n          });\n        }),\n        React.createElement('div', { style: styles.clear })\n      ),\n      React.createElement(CompactFields, { hex: hex, rgb: rgb, onChange: handleChange })\n    )\n  );\n};\n\nCompact.propTypes = {\n  colors: PropTypes.arrayOf(PropTypes.string),\n  styles: PropTypes.object\n};\n\nCompact.defaultProps = {\n  colors: ['#4D4D4D', '#999999', '#FFFFFF', '#F44E3B', '#FE9200', '#FCDC00', '#DBDF00', '#A4DD00', '#68CCCA', '#73D8FF', '#AEA1FF', '#FDA1FF', '#333333', '#808080', '#cccccc', '#D33115', '#E27300', '#FCC400', '#B0BC00', '#68BC00', '#16A5A5', '#009CE0', '#7B64FF', '#FA28FF', '#000000', '#666666', '#B3B3B3', '#9F0500', '#C45100', '#FB9E00', '#808900', '#194D33', '#0C797D', '#0062B1', '#653294', '#AB149E'],\n  styles: {}\n};\n\nexport default ColorWrap(Compact);","import React from 'react';\nimport reactCSS, { handleHover } from 'reactcss';\n\nimport { Swatch } from '../common';\n\nexport var GithubSwatch = function GithubSwatch(_ref) {\n  var hover = _ref.hover,\n      color = _ref.color,\n      onClick = _ref.onClick,\n      onSwatchHover = _ref.onSwatchHover;\n\n  var hoverSwatch = {\n    position: 'relative',\n    zIndex: '2',\n    outline: '2px solid #fff',\n    boxShadow: '0 0 5px 2px rgba(0,0,0,0.25)'\n  };\n\n  var styles = reactCSS({\n    'default': {\n      swatch: {\n        width: '25px',\n        height: '25px',\n        fontSize: '0'\n      }\n    },\n    'hover': {\n      swatch: hoverSwatch\n    }\n  }, { hover: hover });\n\n  return React.createElement(\n    'div',\n    { style: styles.swatch },\n    React.createElement(Swatch, {\n      color: color,\n      onClick: onClick,\n      onHover: onSwatchHover,\n      focusStyle: hoverSwatch\n    })\n  );\n};\n\nexport default handleHover(GithubSwatch);","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport map from 'lodash-es/map';\nimport merge from 'lodash-es/merge';\n\nimport { ColorWrap } from '../common';\nimport GithubSwatch from './GithubSwatch';\n\nexport var Github = function Github(_ref) {\n  var width = _ref.width,\n      colors = _ref.colors,\n      onChange = _ref.onChange,\n      onSwatchHover = _ref.onSwatchHover,\n      triangle = _ref.triangle,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      card: {\n        width: width,\n        background: '#fff',\n        border: '1px solid rgba(0,0,0,0.2)',\n        boxShadow: '0 3px 12px rgba(0,0,0,0.15)',\n        borderRadius: '4px',\n        position: 'relative',\n        padding: '5px',\n        display: 'flex',\n        flexWrap: 'wrap'\n      },\n      triangle: {\n        position: 'absolute',\n        border: '7px solid transparent',\n        borderBottomColor: '#fff'\n      },\n      triangleShadow: {\n        position: 'absolute',\n        border: '8px solid transparent',\n        borderBottomColor: 'rgba(0,0,0,0.15)'\n      }\n    },\n    'hide-triangle': {\n      triangle: {\n        display: 'none'\n      },\n      triangleShadow: {\n        display: 'none'\n      }\n    },\n    'top-left-triangle': {\n      triangle: {\n        top: '-14px',\n        left: '10px'\n      },\n      triangleShadow: {\n        top: '-16px',\n        left: '9px'\n      }\n    },\n    'top-right-triangle': {\n      triangle: {\n        top: '-14px',\n        right: '10px'\n      },\n      triangleShadow: {\n        top: '-16px',\n        right: '9px'\n      }\n    },\n    'bottom-left-triangle': {\n      triangle: {\n        top: '35px',\n        left: '10px',\n        transform: 'rotate(180deg)'\n      },\n      triangleShadow: {\n        top: '37px',\n        left: '9px',\n        transform: 'rotate(180deg)'\n      }\n    },\n    'bottom-right-triangle': {\n      triangle: {\n        top: '35px',\n        right: '10px',\n        transform: 'rotate(180deg)'\n      },\n      triangleShadow: {\n        top: '37px',\n        right: '9px',\n        transform: 'rotate(180deg)'\n      }\n    }\n  }, passedStyles), {\n    'hide-triangle': triangle === 'hide',\n    'top-left-triangle': triangle === 'top-left',\n    'top-right-triangle': triangle === 'top-right',\n    'bottom-left-triangle': triangle === 'bottom-left',\n    'bottom-right-triangle': triangle === 'bottom-right'\n  });\n\n  var handleChange = function handleChange(hex, e) {\n    return onChange({ hex: hex, source: 'hex' }, e);\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.card, className: 'github-picker ' + className },\n    React.createElement('div', { style: styles.triangleShadow }),\n    React.createElement('div', { style: styles.triangle }),\n    map(colors, function (c) {\n      return React.createElement(GithubSwatch, {\n        color: c,\n        key: c,\n        onClick: handleChange,\n        onSwatchHover: onSwatchHover\n      });\n    })\n  );\n};\n\nGithub.propTypes = {\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  colors: PropTypes.arrayOf(PropTypes.string),\n  triangle: PropTypes.oneOf(['hide', 'top-left', 'top-right', 'bottom-left', 'bottom-right']),\n  styles: PropTypes.object\n};\n\nGithub.defaultProps = {\n  width: 200,\n  colors: ['#B80000', '#DB3E00', '#FCCB00', '#008B02', '#006B76', '#1273DE', '#004DCF', '#5300EB', '#EB9694', '#FAD0C3', '#FEF3BD', '#C1E1C5', '#BEDADC', '#C4DEF6', '#BED3F3', '#D4C4FB'],\n  triangle: 'top-left',\n  styles: {}\n};\n\nexport default ColorWrap(Github);","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var SliderPointer = function SliderPointer(_ref) {\n  var direction = _ref.direction;\n\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '18px',\n        height: '18px',\n        borderRadius: '50%',\n        transform: 'translate(-9px, -1px)',\n        backgroundColor: 'rgb(248, 248, 248)',\n        boxShadow: '0 1px 4px 0 rgba(0, 0, 0, 0.37)'\n      }\n    },\n    'vertical': {\n      picker: {\n        transform: 'translate(-3px, -9px)'\n      }\n    }\n  }, { vertical: direction === 'vertical' });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nexport default SliderPointer;","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\n\nimport { ColorWrap, Hue } from '../common';\nimport HuePointer from './HuePointer';\n\nexport var HuePicker = function HuePicker(_ref) {\n  var width = _ref.width,\n      height = _ref.height,\n      onChange = _ref.onChange,\n      hsl = _ref.hsl,\n      direction = _ref.direction,\n      pointer = _ref.pointer,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      picker: {\n        position: 'relative',\n        width: width,\n        height: height\n      },\n      hue: {\n        radius: '2px'\n      }\n    }\n  }, passedStyles));\n\n  // Overwrite to provide pure hue color\n  var handleChange = function handleChange(data) {\n    return onChange({ a: 1, h: data.h, l: 0.5, s: 1 });\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.picker, className: 'hue-picker ' + className },\n    React.createElement(Hue, _extends({}, styles.hue, {\n      hsl: hsl,\n      pointer: pointer,\n      onChange: handleChange,\n      direction: direction\n    }))\n  );\n};\n\nHuePicker.propTypes = {\n  styles: PropTypes.object\n};\nHuePicker.defaultProps = {\n  width: '316px',\n  height: '16px',\n  direction: 'horizontal',\n  pointer: HuePointer,\n  styles: {}\n};\n\nexport default ColorWrap(HuePicker);","import React from 'react';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\nimport * as color from '../../helpers/color';\n\nimport { ColorWrap, EditableInput, Raised } from '../common';\n\nexport var Material = function Material(_ref) {\n  var onChange = _ref.onChange,\n      hex = _ref.hex,\n      rgb = _ref.rgb,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      material: {\n        width: '98px',\n        height: '98px',\n        padding: '16px',\n        fontFamily: 'Roboto'\n      },\n      HEXwrap: {\n        position: 'relative'\n      },\n      HEXinput: {\n        width: '100%',\n        marginTop: '12px',\n        fontSize: '15px',\n        color: '#333',\n        padding: '0px',\n        border: '0px',\n        borderBottom: '2px solid ' + hex,\n        outline: 'none',\n        height: '30px'\n      },\n      HEXlabel: {\n        position: 'absolute',\n        top: '0px',\n        left: '0px',\n        fontSize: '11px',\n        color: '#999999',\n        textTransform: 'capitalize'\n      },\n      Hex: {\n        style: {}\n      },\n      RGBwrap: {\n        position: 'relative'\n      },\n      RGBinput: {\n        width: '100%',\n        marginTop: '12px',\n        fontSize: '15px',\n        color: '#333',\n        padding: '0px',\n        border: '0px',\n        borderBottom: '1px solid #eee',\n        outline: 'none',\n        height: '30px'\n      },\n      RGBlabel: {\n        position: 'absolute',\n        top: '0px',\n        left: '0px',\n        fontSize: '11px',\n        color: '#999999',\n        textTransform: 'capitalize'\n      },\n      split: {\n        display: 'flex',\n        marginRight: '-10px',\n        paddingTop: '11px'\n      },\n      third: {\n        flex: '1',\n        paddingRight: '10px'\n      }\n    }\n  }, passedStyles));\n\n  var handleChange = function handleChange(data, e) {\n    if (data.hex) {\n      color.isValidHex(data.hex) && onChange({\n        hex: data.hex,\n        source: 'hex'\n      }, e);\n    } else if (data.r || data.g || data.b) {\n      onChange({\n        r: data.r || rgb.r,\n        g: data.g || rgb.g,\n        b: data.b || rgb.b,\n        source: 'rgb'\n      }, e);\n    }\n  };\n\n  return React.createElement(\n    Raised,\n    { styles: passedStyles },\n    React.createElement(\n      'div',\n      { style: styles.material, className: 'material-picker ' + className },\n      React.createElement(EditableInput, {\n        style: { wrap: styles.HEXwrap, input: styles.HEXinput, label: styles.HEXlabel },\n        label: 'hex',\n        value: hex,\n        onChange: handleChange\n      }),\n      React.createElement(\n        'div',\n        { style: styles.split, className: 'flexbox-fix' },\n        React.createElement(\n          'div',\n          { style: styles.third },\n          React.createElement(EditableInput, {\n            style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n            label: 'r', value: rgb.r,\n            onChange: handleChange\n          })\n        ),\n        React.createElement(\n          'div',\n          { style: styles.third },\n          React.createElement(EditableInput, {\n            style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n            label: 'g',\n            value: rgb.g,\n            onChange: handleChange\n          })\n        ),\n        React.createElement(\n          'div',\n          { style: styles.third },\n          React.createElement(EditableInput, {\n            style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n            label: 'b',\n            value: rgb.b,\n            onChange: handleChange\n          })\n        )\n      )\n    )\n  );\n};\n\nexport default ColorWrap(Material);","import React from 'react';\nimport reactCSS from 'reactcss';\nimport * as color from '../../helpers/color';\n\nimport { EditableInput } from '../common';\n\nexport var PhotoshopPicker = function PhotoshopPicker(_ref) {\n  var onChange = _ref.onChange,\n      rgb = _ref.rgb,\n      hsv = _ref.hsv,\n      hex = _ref.hex;\n\n  var styles = reactCSS({\n    'default': {\n      fields: {\n        paddingTop: '5px',\n        paddingBottom: '9px',\n        width: '80px',\n        position: 'relative'\n      },\n      divider: {\n        height: '5px'\n      },\n      RGBwrap: {\n        position: 'relative'\n      },\n      RGBinput: {\n        marginLeft: '40%',\n        width: '40%',\n        height: '18px',\n        border: '1px solid #888888',\n        boxShadow: 'inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC',\n        marginBottom: '5px',\n        fontSize: '13px',\n        paddingLeft: '3px',\n        marginRight: '10px'\n      },\n      RGBlabel: {\n        left: '0px',\n        top: '0px',\n        width: '34px',\n        textTransform: 'uppercase',\n        fontSize: '13px',\n        height: '18px',\n        lineHeight: '22px',\n        position: 'absolute'\n      },\n      HEXwrap: {\n        position: 'relative'\n      },\n      HEXinput: {\n        marginLeft: '20%',\n        width: '80%',\n        height: '18px',\n        border: '1px solid #888888',\n        boxShadow: 'inset 0 1px 1px rgba(0,0,0,.1), 0 1px 0 0 #ECECEC',\n        marginBottom: '6px',\n        fontSize: '13px',\n        paddingLeft: '3px'\n      },\n      HEXlabel: {\n        position: 'absolute',\n        top: '0px',\n        left: '0px',\n        width: '14px',\n        textTransform: 'uppercase',\n        fontSize: '13px',\n        height: '18px',\n        lineHeight: '22px'\n      },\n      fieldSymbols: {\n        position: 'absolute',\n        top: '5px',\n        right: '-7px',\n        fontSize: '13px'\n      },\n      symbol: {\n        height: '20px',\n        lineHeight: '22px',\n        paddingBottom: '7px'\n      }\n    }\n  });\n\n  var handleChange = function handleChange(data, e) {\n    if (data['#']) {\n      color.isValidHex(data['#']) && onChange({\n        hex: data['#'],\n        source: 'hex'\n      }, e);\n    } else if (data.r || data.g || data.b) {\n      onChange({\n        r: data.r || rgb.r,\n        g: data.g || rgb.g,\n        b: data.b || rgb.b,\n        source: 'rgb'\n      }, e);\n    } else if (data.h || data.s || data.v) {\n      onChange({\n        h: data.h || hsv.h,\n        s: data.s || hsv.s,\n        v: data.v || hsv.v,\n        source: 'hsv'\n      }, e);\n    }\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.fields },\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'h',\n      value: Math.round(hsv.h),\n      onChange: handleChange\n    }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 's',\n      value: Math.round(hsv.s * 100),\n      onChange: handleChange\n    }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'v',\n      value: Math.round(hsv.v * 100),\n      onChange: handleChange\n    }),\n    React.createElement('div', { style: styles.divider }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'r',\n      value: rgb.r,\n      onChange: handleChange\n    }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'g',\n      value: rgb.g,\n      onChange: handleChange\n    }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.RGBwrap, input: styles.RGBinput, label: styles.RGBlabel },\n      label: 'b',\n      value: rgb.b,\n      onChange: handleChange\n    }),\n    React.createElement('div', { style: styles.divider }),\n    React.createElement(EditableInput, {\n      style: { wrap: styles.HEXwrap, input: styles.HEXinput, label: styles.HEXlabel },\n      label: '#',\n      value: hex.replace('#', ''),\n      onChange: handleChange\n    }),\n    React.createElement(\n      'div',\n      { style: styles.fieldSymbols },\n      React.createElement(\n        'div',\n        { style: styles.symbol },\n        '\\xB0'\n      ),\n      React.createElement(\n        'div',\n        { style: styles.symbol },\n        '%'\n      ),\n      React.createElement(\n        'div',\n        { style: styles.symbol },\n        '%'\n      )\n    )\n  );\n};\n\nexport default PhotoshopPicker;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var PhotoshopPointerCircle = function PhotoshopPointerCircle(_ref) {\n  var hsl = _ref.hsl;\n\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '12px',\n        height: '12px',\n        borderRadius: '6px',\n        boxShadow: 'inset 0 0 0 1px #fff',\n        transform: 'translate(-6px, -6px)'\n      }\n    },\n    'black-outline': {\n      picker: {\n        boxShadow: 'inset 0 0 0 1px #000'\n      }\n    }\n  }, { 'black-outline': hsl.l > 0.5 });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nexport default PhotoshopPointerCircle;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var PhotoshopPointerCircle = function PhotoshopPointerCircle() {\n  var styles = reactCSS({\n    'default': {\n      triangle: {\n        width: 0,\n        height: 0,\n        borderStyle: 'solid',\n        borderWidth: '4px 0 4px 6px',\n        borderColor: 'transparent transparent transparent #fff',\n        position: 'absolute',\n        top: '1px',\n        left: '1px'\n      },\n      triangleBorder: {\n        width: 0,\n        height: 0,\n        borderStyle: 'solid',\n        borderWidth: '5px 0 5px 8px',\n        borderColor: 'transparent transparent transparent #555'\n      },\n\n      left: {\n        Extend: 'triangleBorder',\n        transform: 'translate(-13px, -4px)'\n      },\n      leftInside: {\n        Extend: 'triangle',\n        transform: 'translate(-8px, -5px)'\n      },\n\n      right: {\n        Extend: 'triangleBorder',\n        transform: 'translate(20px, -14px) rotate(180deg)'\n      },\n      rightInside: {\n        Extend: 'triangle',\n        transform: 'translate(-8px, -5px)'\n      }\n    }\n  });\n\n  return React.createElement(\n    'div',\n    { style: styles.pointer },\n    React.createElement(\n      'div',\n      { style: styles.left },\n      React.createElement('div', { style: styles.leftInside })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.right },\n      React.createElement('div', { style: styles.rightInside })\n    )\n  );\n};\n\nexport default PhotoshopPointerCircle;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var PhotoshopButton = function PhotoshopButton(_ref) {\n  var onClick = _ref.onClick,\n      label = _ref.label,\n      children = _ref.children,\n      active = _ref.active;\n\n  var styles = reactCSS({\n    'default': {\n      button: {\n        backgroundImage: 'linear-gradient(-180deg, #FFFFFF 0%, #E6E6E6 100%)',\n        border: '1px solid #878787',\n        borderRadius: '2px',\n        height: '20px',\n        boxShadow: '0 1px 0 0 #EAEAEA',\n        fontSize: '14px',\n        color: '#000',\n        lineHeight: '20px',\n        textAlign: 'center',\n        marginBottom: '10px',\n        cursor: 'pointer'\n      }\n    },\n    'active': {\n      button: {\n        boxShadow: '0 0 0 1px #878787'\n      }\n    }\n  }, { active: active });\n\n  return React.createElement(\n    'div',\n    { style: styles.button, onClick: onClick },\n    label || children\n  );\n};\n\nexport default PhotoshopButton;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var PhotoshopPreviews = function PhotoshopPreviews(_ref) {\n  var rgb = _ref.rgb,\n      currentColor = _ref.currentColor;\n\n  var styles = reactCSS({\n    'default': {\n      swatches: {\n        border: '1px solid #B3B3B3',\n        borderBottom: '1px solid #F0F0F0',\n        marginBottom: '2px',\n        marginTop: '1px'\n      },\n      new: {\n        height: '34px',\n        background: 'rgb(' + rgb.r + ',' + rgb.g + ', ' + rgb.b + ')',\n        boxShadow: 'inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 1px 0 #000'\n      },\n      current: {\n        height: '34px',\n        background: currentColor,\n        boxShadow: 'inset 1px 0 0 #000, inset -1px 0 0 #000, inset 0 -1px 0 #000'\n      },\n      label: {\n        fontSize: '14px',\n        color: '#000',\n        textAlign: 'center'\n      }\n    }\n  });\n\n  return React.createElement(\n    'div',\n    null,\n    React.createElement(\n      'div',\n      { style: styles.label },\n      'new'\n    ),\n    React.createElement(\n      'div',\n      { style: styles.swatches },\n      React.createElement('div', { style: styles.new }),\n      React.createElement('div', { style: styles.current })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.label },\n      'current'\n    )\n  );\n};\n\nexport default PhotoshopPreviews;","var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\n\nimport { ColorWrap, Saturation, Hue } from '../common';\nimport PhotoshopFields from './PhotoshopFields';\nimport PhotoshopPointerCircle from './PhotoshopPointerCircle';\nimport PhotoshopPointer from './PhotoshopPointer';\nimport PhotoshopButton from './PhotoshopButton';\nimport PhotoshopPreviews from './PhotoshopPreviews';\n\nexport var Photoshop = function (_React$Component) {\n  _inherits(Photoshop, _React$Component);\n\n  function Photoshop(props) {\n    _classCallCheck(this, Photoshop);\n\n    var _this = _possibleConstructorReturn(this, (Photoshop.__proto__ || Object.getPrototypeOf(Photoshop)).call(this));\n\n    _this.state = {\n      currentColor: props.hex\n    };\n    return _this;\n  }\n\n  _createClass(Photoshop, [{\n    key: 'render',\n    value: function render() {\n      var _props = this.props,\n          _props$styles = _props.styles,\n          passedStyles = _props$styles === undefined ? {} : _props$styles,\n          _props$className = _props.className,\n          className = _props$className === undefined ? '' : _props$className;\n\n      var styles = reactCSS(merge({\n        'default': {\n          picker: {\n            background: '#DCDCDC',\n            borderRadius: '4px',\n            boxShadow: '0 0 0 1px rgba(0,0,0,.25), 0 8px 16px rgba(0,0,0,.15)',\n            boxSizing: 'initial',\n            width: '513px'\n          },\n          head: {\n            backgroundImage: 'linear-gradient(-180deg, #F0F0F0 0%, #D4D4D4 100%)',\n            borderBottom: '1px solid #B1B1B1',\n            boxShadow: 'inset 0 1px 0 0 rgba(255,255,255,.2), inset 0 -1px 0 0 rgba(0,0,0,.02)',\n            height: '23px',\n            lineHeight: '24px',\n            borderRadius: '4px 4px 0 0',\n            fontSize: '13px',\n            color: '#4D4D4D',\n            textAlign: 'center'\n          },\n          body: {\n            padding: '15px 15px 0',\n            display: 'flex'\n          },\n          saturation: {\n            width: '256px',\n            height: '256px',\n            position: 'relative',\n            border: '2px solid #B3B3B3',\n            borderBottom: '2px solid #F0F0F0',\n            overflow: 'hidden'\n          },\n          hue: {\n            position: 'relative',\n            height: '256px',\n            width: '19px',\n            marginLeft: '10px',\n            border: '2px solid #B3B3B3',\n            borderBottom: '2px solid #F0F0F0'\n          },\n          controls: {\n            width: '180px',\n            marginLeft: '10px'\n          },\n          top: {\n            display: 'flex'\n          },\n          previews: {\n            width: '60px'\n          },\n          actions: {\n            flex: '1',\n            marginLeft: '20px'\n          }\n        }\n      }, passedStyles));\n\n      return React.createElement(\n        'div',\n        { style: styles.picker, className: 'photoshop-picker ' + className },\n        React.createElement(\n          'div',\n          { style: styles.head },\n          this.props.header\n        ),\n        React.createElement(\n          'div',\n          { style: styles.body, className: 'flexbox-fix' },\n          React.createElement(\n            'div',\n            { style: styles.saturation },\n            React.createElement(Saturation, {\n              hsl: this.props.hsl,\n              hsv: this.props.hsv,\n              pointer: PhotoshopPointerCircle,\n              onChange: this.props.onChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.hue },\n            React.createElement(Hue, {\n              direction: 'vertical',\n              hsl: this.props.hsl,\n              pointer: PhotoshopPointer,\n              onChange: this.props.onChange\n            })\n          ),\n          React.createElement(\n            'div',\n            { style: styles.controls },\n            React.createElement(\n              'div',\n              { style: styles.top, className: 'flexbox-fix' },\n              React.createElement(\n                'div',\n                { style: styles.previews },\n                React.createElement(PhotoshopPreviews, {\n                  rgb: this.props.rgb,\n                  currentColor: this.state.currentColor\n                })\n              ),\n              React.createElement(\n                'div',\n                { style: styles.actions },\n                React.createElement(PhotoshopButton, { label: 'OK', onClick: this.props.onAccept, active: true }),\n                React.createElement(PhotoshopButton, { label: 'Cancel', onClick: this.props.onCancel }),\n                React.createElement(PhotoshopFields, {\n                  onChange: this.props.onChange,\n                  rgb: this.props.rgb,\n                  hsv: this.props.hsv,\n                  hex: this.props.hex\n                })\n              )\n            )\n          )\n        )\n      );\n    }\n  }]);\n\n  return Photoshop;\n}(React.Component);\n\nPhotoshop.propTypes = {\n  header: PropTypes.string,\n  styles: PropTypes.object\n};\n\nPhotoshop.defaultProps = {\n  header: 'Color Picker',\n  styles: {}\n};\n\nexport default ColorWrap(Photoshop);","/* eslint-disable no-param-reassign */\n\nimport React from 'react';\nimport reactCSS from 'reactcss';\nimport * as color from '../../helpers/color';\n\nimport { EditableInput } from '../common';\n\nexport var SketchFields = function SketchFields(_ref) {\n  var onChange = _ref.onChange,\n      rgb = _ref.rgb,\n      hsl = _ref.hsl,\n      hex = _ref.hex,\n      disableAlpha = _ref.disableAlpha;\n\n  var styles = reactCSS({\n    'default': {\n      fields: {\n        display: 'flex',\n        paddingTop: '4px'\n      },\n      single: {\n        flex: '1',\n        paddingLeft: '6px'\n      },\n      alpha: {\n        flex: '1',\n        paddingLeft: '6px'\n      },\n      double: {\n        flex: '2'\n      },\n      input: {\n        width: '80%',\n        padding: '4px 10% 3px',\n        border: 'none',\n        boxShadow: 'inset 0 0 0 1px #ccc',\n        fontSize: '11px'\n      },\n      label: {\n        display: 'block',\n        textAlign: 'center',\n        fontSize: '11px',\n        color: '#222',\n        paddingTop: '3px',\n        paddingBottom: '4px',\n        textTransform: 'capitalize'\n      }\n    },\n    'disableAlpha': {\n      alpha: {\n        display: 'none'\n      }\n    }\n  }, { disableAlpha: disableAlpha });\n\n  var handleChange = function handleChange(data, e) {\n    if (data.hex) {\n      color.isValidHex(data.hex) && onChange({\n        hex: data.hex,\n        source: 'hex'\n      }, e);\n    } else if (data.r || data.g || data.b) {\n      onChange({\n        r: data.r || rgb.r,\n        g: data.g || rgb.g,\n        b: data.b || rgb.b,\n        a: rgb.a,\n        source: 'rgb'\n      }, e);\n    } else if (data.a) {\n      if (data.a < 0) {\n        data.a = 0;\n      } else if (data.a > 100) {\n        data.a = 100;\n      }\n\n      data.a /= 100;\n      onChange({\n        h: hsl.h,\n        s: hsl.s,\n        l: hsl.l,\n        a: data.a,\n        source: 'rgb'\n      }, e);\n    }\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.fields, className: 'flexbox-fix' },\n    React.createElement(\n      'div',\n      { style: styles.double },\n      React.createElement(EditableInput, {\n        style: { input: styles.input, label: styles.label },\n        label: 'hex',\n        value: hex.replace('#', ''),\n        onChange: handleChange\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.single },\n      React.createElement(EditableInput, {\n        style: { input: styles.input, label: styles.label },\n        label: 'r',\n        value: rgb.r,\n        onChange: handleChange,\n        dragLabel: 'true',\n        dragMax: '255'\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.single },\n      React.createElement(EditableInput, {\n        style: { input: styles.input, label: styles.label },\n        label: 'g',\n        value: rgb.g,\n        onChange: handleChange,\n        dragLabel: 'true',\n        dragMax: '255'\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.single },\n      React.createElement(EditableInput, {\n        style: { input: styles.input, label: styles.label },\n        label: 'b',\n        value: rgb.b,\n        onChange: handleChange,\n        dragLabel: 'true',\n        dragMax: '255'\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.alpha },\n      React.createElement(EditableInput, {\n        style: { input: styles.input, label: styles.label },\n        label: 'a',\n        value: Math.round(rgb.a * 100),\n        onChange: handleChange,\n        dragLabel: 'true',\n        dragMax: '100'\n      })\n    )\n  );\n};\n\nexport default SketchFields;","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\n\nimport { Swatch } from '../common';\n\nexport var SketchPresetColors = function SketchPresetColors(_ref) {\n  var colors = _ref.colors,\n      _ref$onClick = _ref.onClick,\n      onClick = _ref$onClick === undefined ? function () {} : _ref$onClick,\n      onSwatchHover = _ref.onSwatchHover;\n\n  var styles = reactCSS({\n    'default': {\n      colors: {\n        margin: '0 -10px',\n        padding: '10px 0 0 10px',\n        borderTop: '1px solid #eee',\n        display: 'flex',\n        flexWrap: 'wrap',\n        position: 'relative'\n      },\n      swatchWrap: {\n        width: '16px',\n        height: '16px',\n        margin: '0 10px 10px 0'\n      },\n      swatch: {\n        borderRadius: '3px',\n        boxShadow: 'inset 0 0 0 1px rgba(0,0,0,.15)'\n      }\n    },\n    'no-presets': {\n      colors: {\n        display: 'none'\n      }\n    }\n  }, {\n    'no-presets': !colors || !colors.length\n  });\n\n  var handleClick = function handleClick(hex, e) {\n    onClick({\n      hex: hex,\n      source: 'hex'\n    }, e);\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.colors, className: 'flexbox-fix' },\n    colors.map(function (colorObjOrString) {\n      var c = typeof colorObjOrString === 'string' ? { color: colorObjOrString } : colorObjOrString;\n      var key = '' + c.color + (c.title || '');\n      return React.createElement(\n        'div',\n        { key: key, style: styles.swatchWrap },\n        React.createElement(Swatch, _extends({}, c, {\n          style: styles.swatch,\n          onClick: handleClick,\n          onHover: onSwatchHover,\n          focusStyle: {\n            boxShadow: 'inset 0 0 0 1px rgba(0,0,0,.15), 0 0 4px ' + c.color\n          }\n        }))\n      );\n    })\n  );\n};\n\nSketchPresetColors.propTypes = {\n  colors: PropTypes.arrayOf(PropTypes.oneOfType([PropTypes.string, PropTypes.shape({\n    color: PropTypes.string,\n    title: PropTypes.string\n  })])).isRequired\n};\n\nexport default SketchPresetColors;","var _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\n\nimport { ColorWrap, Saturation, Hue, Alpha, Checkboard } from '../common';\nimport SketchFields from './SketchFields';\nimport SketchPresetColors from './SketchPresetColors';\n\nexport var Sketch = function Sketch(_ref) {\n  var width = _ref.width,\n      rgb = _ref.rgb,\n      hex = _ref.hex,\n      hsv = _ref.hsv,\n      hsl = _ref.hsl,\n      onChange = _ref.onChange,\n      onSwatchHover = _ref.onSwatchHover,\n      disableAlpha = _ref.disableAlpha,\n      presetColors = _ref.presetColors,\n      renderers = _ref.renderers,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': _extends({\n      picker: {\n        width: width,\n        padding: '10px 10px 0',\n        boxSizing: 'initial',\n        background: '#fff',\n        borderRadius: '4px',\n        boxShadow: '0 0 0 1px rgba(0,0,0,.15), 0 8px 16px rgba(0,0,0,.15)'\n      },\n      saturation: {\n        width: '100%',\n        paddingBottom: '75%',\n        position: 'relative',\n        overflow: 'hidden'\n      },\n      Saturation: {\n        radius: '3px',\n        shadow: 'inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)'\n      },\n      controls: {\n        display: 'flex'\n      },\n      sliders: {\n        padding: '4px 0',\n        flex: '1'\n      },\n      color: {\n        width: '24px',\n        height: '24px',\n        position: 'relative',\n        marginTop: '4px',\n        marginLeft: '4px',\n        borderRadius: '3px'\n      },\n      activeColor: {\n        absolute: '0px 0px 0px 0px',\n        borderRadius: '2px',\n        background: 'rgba(' + rgb.r + ',' + rgb.g + ',' + rgb.b + ',' + rgb.a + ')',\n        boxShadow: 'inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)'\n      },\n      hue: {\n        position: 'relative',\n        height: '10px',\n        overflow: 'hidden'\n      },\n      Hue: {\n        radius: '2px',\n        shadow: 'inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)'\n      },\n\n      alpha: {\n        position: 'relative',\n        height: '10px',\n        marginTop: '4px',\n        overflow: 'hidden'\n      },\n      Alpha: {\n        radius: '2px',\n        shadow: 'inset 0 0 0 1px rgba(0,0,0,.15), inset 0 0 4px rgba(0,0,0,.25)'\n      }\n    }, passedStyles),\n    'disableAlpha': {\n      color: {\n        height: '10px'\n      },\n      hue: {\n        height: '10px'\n      },\n      alpha: {\n        display: 'none'\n      }\n    }\n  }, passedStyles), { disableAlpha: disableAlpha });\n\n  return React.createElement(\n    'div',\n    { style: styles.picker, className: 'sketch-picker ' + className },\n    React.createElement(\n      'div',\n      { style: styles.saturation },\n      React.createElement(Saturation, {\n        style: styles.Saturation,\n        hsl: hsl,\n        hsv: hsv,\n        onChange: onChange\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.controls, className: 'flexbox-fix' },\n      React.createElement(\n        'div',\n        { style: styles.sliders },\n        React.createElement(\n          'div',\n          { style: styles.hue },\n          React.createElement(Hue, {\n            style: styles.Hue,\n            hsl: hsl,\n            onChange: onChange\n          })\n        ),\n        React.createElement(\n          'div',\n          { style: styles.alpha },\n          React.createElement(Alpha, {\n            style: styles.Alpha,\n            rgb: rgb,\n            hsl: hsl,\n            renderers: renderers,\n            onChange: onChange\n          })\n        )\n      ),\n      React.createElement(\n        'div',\n        { style: styles.color },\n        React.createElement(Checkboard, null),\n        React.createElement('div', { style: styles.activeColor })\n      )\n    ),\n    React.createElement(SketchFields, {\n      rgb: rgb,\n      hsl: hsl,\n      hex: hex,\n      onChange: onChange,\n      disableAlpha: disableAlpha\n    }),\n    React.createElement(SketchPresetColors, {\n      colors: presetColors,\n      onClick: onChange,\n      onSwatchHover: onSwatchHover\n    })\n  );\n};\n\nSketch.propTypes = {\n  disableAlpha: PropTypes.bool,\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  styles: PropTypes.object\n};\n\nSketch.defaultProps = {\n  disableAlpha: false,\n  width: 200,\n  styles: {},\n  presetColors: ['#D0021B', '#F5A623', '#F8E71C', '#8B572A', '#7ED321', '#417505', '#BD10E0', '#9013FE', '#4A90E2', '#50E3C2', '#B8E986', '#000000', '#4A4A4A', '#9B9B9B', '#FFFFFF']\n};\n\nexport default ColorWrap(Sketch);","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var SliderSwatch = function SliderSwatch(_ref) {\n  var hsl = _ref.hsl,\n      offset = _ref.offset,\n      _ref$onClick = _ref.onClick,\n      onClick = _ref$onClick === undefined ? function () {} : _ref$onClick,\n      active = _ref.active,\n      first = _ref.first,\n      last = _ref.last;\n\n  var styles = reactCSS({\n    'default': {\n      swatch: {\n        height: '12px',\n        background: 'hsl(' + hsl.h + ', 50%, ' + offset * 100 + '%)',\n        cursor: 'pointer'\n      }\n    },\n    'first': {\n      swatch: {\n        borderRadius: '2px 0 0 2px'\n      }\n    },\n    'last': {\n      swatch: {\n        borderRadius: '0 2px 2px 0'\n      }\n    },\n    'active': {\n      swatch: {\n        transform: 'scaleY(1.8)',\n        borderRadius: '3.6px/2px'\n      }\n    }\n  }, { active: active, first: first, last: last });\n\n  var handleClick = function handleClick(e) {\n    return onClick({\n      h: hsl.h,\n      s: 0.5,\n      l: offset,\n      source: 'hsl'\n    }, e);\n  };\n\n  return React.createElement('div', { style: styles.swatch, onClick: handleClick });\n};\n\nexport default SliderSwatch;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nimport SliderSwatch from './SliderSwatch';\n\nexport var SliderSwatches = function SliderSwatches(_ref) {\n  var onClick = _ref.onClick,\n      hsl = _ref.hsl;\n\n  var styles = reactCSS({\n    'default': {\n      swatches: {\n        marginTop: '20px'\n      },\n      swatch: {\n        boxSizing: 'border-box',\n        width: '20%',\n        paddingRight: '1px',\n        float: 'left'\n      },\n      clear: {\n        clear: 'both'\n      }\n    }\n  });\n\n  // Acceptible difference in floating point equality\n  var epsilon = 0.1;\n\n  return React.createElement(\n    'div',\n    { style: styles.swatches },\n    React.createElement(\n      'div',\n      { style: styles.swatch },\n      React.createElement(SliderSwatch, {\n        hsl: hsl,\n        offset: '.80',\n        active: Math.abs(hsl.l - 0.80) < epsilon && Math.abs(hsl.s - 0.50) < epsilon,\n        onClick: onClick,\n        first: true\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.swatch },\n      React.createElement(SliderSwatch, {\n        hsl: hsl,\n        offset: '.65',\n        active: Math.abs(hsl.l - 0.65) < epsilon && Math.abs(hsl.s - 0.50) < epsilon,\n        onClick: onClick\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.swatch },\n      React.createElement(SliderSwatch, {\n        hsl: hsl,\n        offset: '.50',\n        active: Math.abs(hsl.l - 0.50) < epsilon && Math.abs(hsl.s - 0.50) < epsilon,\n        onClick: onClick\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.swatch },\n      React.createElement(SliderSwatch, {\n        hsl: hsl,\n        offset: '.35',\n        active: Math.abs(hsl.l - 0.35) < epsilon && Math.abs(hsl.s - 0.50) < epsilon,\n        onClick: onClick\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.swatch },\n      React.createElement(SliderSwatch, {\n        hsl: hsl,\n        offset: '.20',\n        active: Math.abs(hsl.l - 0.20) < epsilon && Math.abs(hsl.s - 0.50) < epsilon,\n        onClick: onClick,\n        last: true\n      })\n    ),\n    React.createElement('div', { style: styles.clear })\n  );\n};\n\nexport default SliderSwatches;","import React from 'react';\nimport reactCSS from 'reactcss';\n\nexport var SliderPointer = function SliderPointer() {\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '14px',\n        height: '14px',\n        borderRadius: '6px',\n        transform: 'translate(-7px, -1px)',\n        backgroundColor: 'rgb(248, 248, 248)',\n        boxShadow: '0 1px 4px 0 rgba(0, 0, 0, 0.37)'\n      }\n    }\n  });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nexport default SliderPointer;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\n\nimport { ColorWrap, Hue } from '../common';\nimport SliderSwatches from './SliderSwatches';\nimport SliderPointer from './SliderPointer';\n\nexport var Slider = function Slider(_ref) {\n  var hsl = _ref.hsl,\n      onChange = _ref.onChange,\n      pointer = _ref.pointer,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      hue: {\n        height: '12px',\n        position: 'relative'\n      },\n      Hue: {\n        radius: '2px'\n      }\n    }\n  }, passedStyles));\n\n  return React.createElement(\n    'div',\n    { style: styles.wrap || {}, className: 'slider-picker ' + className },\n    React.createElement(\n      'div',\n      { style: styles.hue },\n      React.createElement(Hue, {\n        style: styles.Hue,\n        hsl: hsl,\n        pointer: pointer,\n        onChange: onChange\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.swatches },\n      React.createElement(SliderSwatches, { hsl: hsl, onClick: onChange })\n    )\n  );\n};\n\nSlider.propTypes = {\n  styles: PropTypes.object\n};\nSlider.defaultProps = {\n  pointer: SliderPointer,\n  styles: {}\n};\n\nexport default ColorWrap(Slider);","import React from 'react';\nimport reactCSS from 'reactcss';\nimport * as colorUtils from '../../helpers/color';\n\nimport { Swatch } from '../common';\nimport CheckIcon from '@icons/material/CheckIcon';\n\nexport var SwatchesColor = function SwatchesColor(_ref) {\n  var color = _ref.color,\n      _ref$onClick = _ref.onClick,\n      onClick = _ref$onClick === undefined ? function () {} : _ref$onClick,\n      onSwatchHover = _ref.onSwatchHover,\n      first = _ref.first,\n      last = _ref.last,\n      active = _ref.active;\n\n  var styles = reactCSS({\n    'default': {\n      color: {\n        width: '40px',\n        height: '24px',\n        cursor: 'pointer',\n        background: color,\n        marginBottom: '1px'\n      },\n      check: {\n        color: colorUtils.getContrastingColor(color),\n        marginLeft: '8px',\n        display: 'none'\n      }\n    },\n    'first': {\n      color: {\n        overflow: 'hidden',\n        borderRadius: '2px 2px 0 0'\n      }\n    },\n    'last': {\n      color: {\n        overflow: 'hidden',\n        borderRadius: '0 0 2px 2px'\n      }\n    },\n    'active': {\n      check: {\n        display: 'block'\n      }\n    },\n    'color-#FFFFFF': {\n      color: {\n        boxShadow: 'inset 0 0 0 1px #ddd'\n      },\n      check: {\n        color: '#333'\n      }\n    },\n    'transparent': {\n      check: {\n        color: '#333'\n      }\n    }\n  }, {\n    first: first,\n    last: last,\n    active: active,\n    'color-#FFFFFF': color === '#FFFFFF',\n    'transparent': color === 'transparent'\n  });\n\n  return React.createElement(\n    Swatch,\n    {\n      color: color,\n      style: styles.color,\n      onClick: onClick,\n      onHover: onSwatchHover,\n      focusStyle: { boxShadow: '0 0 4px ' + color }\n    },\n    React.createElement(\n      'div',\n      { style: styles.check },\n      React.createElement(CheckIcon, null)\n    )\n  );\n};\n\nexport default SwatchesColor;","import React from 'react';\nimport reactCSS from 'reactcss';\nimport map from 'lodash-es/map';\n\nimport SwatchesColor from './SwatchesColor';\n\nexport var SwatchesGroup = function SwatchesGroup(_ref) {\n  var onClick = _ref.onClick,\n      onSwatchHover = _ref.onSwatchHover,\n      group = _ref.group,\n      active = _ref.active;\n\n  var styles = reactCSS({\n    'default': {\n      group: {\n        paddingBottom: '10px',\n        width: '40px',\n        float: 'left',\n        marginRight: '10px'\n      }\n    }\n  });\n\n  return React.createElement(\n    'div',\n    { style: styles.group },\n    map(group, function (color, i) {\n      return React.createElement(SwatchesColor, {\n        key: color,\n        color: color,\n        active: color.toLowerCase() === active,\n        first: i === 0,\n        last: i === group.length - 1,\n        onClick: onClick,\n        onSwatchHover: onSwatchHover\n      });\n    })\n  );\n};\n\nexport default SwatchesGroup;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport map from 'lodash-es/map';\nimport merge from 'lodash-es/merge';\nimport * as material from 'material-colors';\n\nimport { ColorWrap, Raised } from '../common';\nimport SwatchesGroup from './SwatchesGroup';\n\nexport var Swatches = function Swatches(_ref) {\n  var width = _ref.width,\n      height = _ref.height,\n      onChange = _ref.onChange,\n      onSwatchHover = _ref.onSwatchHover,\n      colors = _ref.colors,\n      hex = _ref.hex,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      picker: {\n        width: width,\n        height: height\n      },\n      overflow: {\n        height: height,\n        overflowY: 'scroll'\n      },\n      body: {\n        padding: '16px 0 6px 16px'\n      },\n      clear: {\n        clear: 'both'\n      }\n    }\n  }, passedStyles));\n\n  var handleChange = function handleChange(data, e) {\n    return onChange({ hex: data, source: 'hex' }, e);\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.picker, className: 'swatches-picker ' + className },\n    React.createElement(\n      Raised,\n      null,\n      React.createElement(\n        'div',\n        { style: styles.overflow },\n        React.createElement(\n          'div',\n          { style: styles.body },\n          map(colors, function (group) {\n            return React.createElement(SwatchesGroup, {\n              key: group.toString(),\n              group: group,\n              active: hex,\n              onClick: handleChange,\n              onSwatchHover: onSwatchHover\n            });\n          }),\n          React.createElement('div', { style: styles.clear })\n        )\n      )\n    )\n  );\n};\n\nSwatches.propTypes = {\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  height: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  colors: PropTypes.arrayOf(PropTypes.arrayOf(PropTypes.string)),\n  styles: PropTypes.object\n\n  /* eslint-disable max-len */\n};Swatches.defaultProps = {\n  width: 320,\n  height: 240,\n  colors: [[material.red['900'], material.red['700'], material.red['500'], material.red['300'], material.red['100']], [material.pink['900'], material.pink['700'], material.pink['500'], material.pink['300'], material.pink['100']], [material.purple['900'], material.purple['700'], material.purple['500'], material.purple['300'], material.purple['100']], [material.deepPurple['900'], material.deepPurple['700'], material.deepPurple['500'], material.deepPurple['300'], material.deepPurple['100']], [material.indigo['900'], material.indigo['700'], material.indigo['500'], material.indigo['300'], material.indigo['100']], [material.blue['900'], material.blue['700'], material.blue['500'], material.blue['300'], material.blue['100']], [material.lightBlue['900'], material.lightBlue['700'], material.lightBlue['500'], material.lightBlue['300'], material.lightBlue['100']], [material.cyan['900'], material.cyan['700'], material.cyan['500'], material.cyan['300'], material.cyan['100']], [material.teal['900'], material.teal['700'], material.teal['500'], material.teal['300'], material.teal['100']], ['#194D33', material.green['700'], material.green['500'], material.green['300'], material.green['100']], [material.lightGreen['900'], material.lightGreen['700'], material.lightGreen['500'], material.lightGreen['300'], material.lightGreen['100']], [material.lime['900'], material.lime['700'], material.lime['500'], material.lime['300'], material.lime['100']], [material.yellow['900'], material.yellow['700'], material.yellow['500'], material.yellow['300'], material.yellow['100']], [material.amber['900'], material.amber['700'], material.amber['500'], material.amber['300'], material.amber['100']], [material.orange['900'], material.orange['700'], material.orange['500'], material.orange['300'], material.orange['100']], [material.deepOrange['900'], material.deepOrange['700'], material.deepOrange['500'], material.deepOrange['300'], material.deepOrange['100']], [material.brown['900'], material.brown['700'], material.brown['500'], material.brown['300'], material.brown['100']], [material.blueGrey['900'], material.blueGrey['700'], material.blueGrey['500'], material.blueGrey['300'], material.blueGrey['100']], ['#000000', '#525252', '#969696', '#D9D9D9', '#FFFFFF']],\n  styles: {}\n};\n\nexport default ColorWrap(Swatches);","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport map from 'lodash-es/map';\nimport merge from 'lodash-es/merge';\nimport * as color from '../../helpers/color';\n\nimport { ColorWrap, EditableInput, Swatch } from '../common';\n\nexport var Twitter = function Twitter(_ref) {\n  var onChange = _ref.onChange,\n      onSwatchHover = _ref.onSwatchHover,\n      hex = _ref.hex,\n      colors = _ref.colors,\n      width = _ref.width,\n      triangle = _ref.triangle,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      card: {\n        width: width,\n        background: '#fff',\n        border: '0 solid rgba(0,0,0,0.25)',\n        boxShadow: '0 1px 4px rgba(0,0,0,0.25)',\n        borderRadius: '4px',\n        position: 'relative'\n      },\n      body: {\n        padding: '15px 9px 9px 15px'\n      },\n      label: {\n        fontSize: '18px',\n        color: '#fff'\n      },\n      triangle: {\n        width: '0px',\n        height: '0px',\n        borderStyle: 'solid',\n        borderWidth: '0 9px 10px 9px',\n        borderColor: 'transparent transparent #fff transparent',\n        position: 'absolute'\n      },\n      triangleShadow: {\n        width: '0px',\n        height: '0px',\n        borderStyle: 'solid',\n        borderWidth: '0 9px 10px 9px',\n        borderColor: 'transparent transparent rgba(0,0,0,.1) transparent',\n        position: 'absolute'\n      },\n      hash: {\n        background: '#F0F0F0',\n        height: '30px',\n        width: '30px',\n        borderRadius: '4px 0 0 4px',\n        float: 'left',\n        color: '#98A1A4',\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center'\n      },\n      input: {\n        width: '100px',\n        fontSize: '14px',\n        color: '#666',\n        border: '0px',\n        outline: 'none',\n        height: '28px',\n        boxShadow: 'inset 0 0 0 1px #F0F0F0',\n        boxSizing: 'content-box',\n        borderRadius: '0 4px 4px 0',\n        float: 'left',\n        paddingLeft: '8px'\n      },\n      swatch: {\n        width: '30px',\n        height: '30px',\n        float: 'left',\n        borderRadius: '4px',\n        margin: '0 6px 6px 0'\n      },\n      clear: {\n        clear: 'both'\n      }\n    },\n    'hide-triangle': {\n      triangle: {\n        display: 'none'\n      },\n      triangleShadow: {\n        display: 'none'\n      }\n    },\n    'top-left-triangle': {\n      triangle: {\n        top: '-10px',\n        left: '12px'\n      },\n      triangleShadow: {\n        top: '-11px',\n        left: '12px'\n      }\n    },\n    'top-right-triangle': {\n      triangle: {\n        top: '-10px',\n        right: '12px'\n      },\n      triangleShadow: {\n        top: '-11px',\n        right: '12px'\n      }\n    }\n  }, passedStyles), {\n    'hide-triangle': triangle === 'hide',\n    'top-left-triangle': triangle === 'top-left',\n    'top-right-triangle': triangle === 'top-right'\n  });\n\n  var handleChange = function handleChange(hexcode, e) {\n    color.isValidHex(hexcode) && onChange({\n      hex: hexcode,\n      source: 'hex'\n    }, e);\n  };\n\n  return React.createElement(\n    'div',\n    { style: styles.card, className: 'twitter-picker ' + className },\n    React.createElement('div', { style: styles.triangleShadow }),\n    React.createElement('div', { style: styles.triangle }),\n    React.createElement(\n      'div',\n      { style: styles.body },\n      map(colors, function (c, i) {\n        return React.createElement(Swatch, {\n          key: i,\n          color: c,\n          hex: c,\n          style: styles.swatch,\n          onClick: handleChange,\n          onHover: onSwatchHover,\n          focusStyle: {\n            boxShadow: '0 0 4px ' + c\n          }\n        });\n      }),\n      React.createElement(\n        'div',\n        { style: styles.hash },\n        '#'\n      ),\n      React.createElement(EditableInput, {\n        label: null,\n        style: { input: styles.input },\n        value: hex.replace('#', ''),\n        onChange: handleChange\n      }),\n      React.createElement('div', { style: styles.clear })\n    )\n  );\n};\n\nTwitter.propTypes = {\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  triangle: PropTypes.oneOf(['hide', 'top-left', 'top-right']),\n  colors: PropTypes.arrayOf(PropTypes.string),\n  styles: PropTypes.object\n};\n\nTwitter.defaultProps = {\n  width: 276,\n  colors: ['#FF6900', '#FCB900', '#7BDCB5', '#00D084', '#8ED1FC', '#0693E3', '#ABB8C3', '#EB144C', '#F78DA7', '#9900EF'],\n  triangle: 'top-left',\n  styles: {}\n};\n\nexport default ColorWrap(Twitter);","import React from 'react';\nimport reactCSS from 'reactcss';\nimport PropTypes from 'prop-types';\n\nexport var GooglePointerCircle = function GooglePointerCircle(props) {\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '20px',\n        height: '20px',\n        borderRadius: '22px',\n        border: '2px #fff solid',\n        transform: 'translate(-12px, -13px)',\n        background: 'hsl(' + Math.round(props.hsl.h) + ', ' + Math.round(props.hsl.s * 100) + '%, ' + Math.round(props.hsl.l * 100) + '%)'\n      }\n    }\n  });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nGooglePointerCircle.propTypes = {\n  hsl: PropTypes.shape({\n    h: PropTypes.number,\n    s: PropTypes.number,\n    l: PropTypes.number,\n    a: PropTypes.number\n  })\n};\n\nGooglePointerCircle.defaultProps = {\n  hsl: { a: 1, h: 249.94, l: 0.2, s: 0.50 }\n};\n\nexport default GooglePointerCircle;","import React from 'react';\nimport reactCSS from 'reactcss';\nimport PropTypes from 'prop-types';\n\nexport var GooglePointer = function GooglePointer(props) {\n  var styles = reactCSS({\n    'default': {\n      picker: {\n        width: '20px',\n        height: '20px',\n        borderRadius: '22px',\n        transform: 'translate(-10px, -7px)',\n        background: 'hsl(' + Math.round(props.hsl.h) + ', 100%, 50%)',\n        border: '2px white solid'\n      }\n    }\n  });\n\n  return React.createElement('div', { style: styles.picker });\n};\n\nGooglePointer.propTypes = {\n  hsl: PropTypes.shape({\n    h: PropTypes.number,\n    s: PropTypes.number,\n    l: PropTypes.number,\n    a: PropTypes.number\n  })\n};\n\nGooglePointer.defaultProps = {\n  hsl: { a: 1, h: 249.94, l: 0.2, s: 0.50 }\n};\n\nexport default GooglePointer;","import React from 'react';\nimport reactCSS from 'reactcss';\nimport * as color from '../../helpers/color';\nimport { EditableInput } from '../common';\n\nexport var GoogleFields = function GoogleFields(_ref) {\n  var onChange = _ref.onChange,\n      rgb = _ref.rgb,\n      hsl = _ref.hsl,\n      hex = _ref.hex,\n      hsv = _ref.hsv;\n\n\n  var handleChange = function handleChange(data, e) {\n    if (data.hex) {\n      color.isValidHex(data.hex) && onChange({\n        hex: data.hex,\n        source: 'hex'\n      }, e);\n    } else if (data.rgb) {\n      var values = data.rgb.split(',');\n      color.isvalidColorString(data.rgb, 'rgb') && onChange({\n        r: values[0],\n        g: values[1],\n        b: values[2],\n        a: 1,\n        source: 'rgb'\n      }, e);\n    } else if (data.hsv) {\n      var _values = data.hsv.split(',');\n      if (color.isvalidColorString(data.hsv, 'hsv')) {\n        _values[2] = _values[2].replace('%', '');\n        _values[1] = _values[1].replace('%', '');\n        _values[0] = _values[0].replace('°', '');\n        if (_values[1] == 1) {\n          _values[1] = 0.01;\n        } else if (_values[2] == 1) {\n          _values[2] = 0.01;\n        }\n        onChange({\n          h: Number(_values[0]),\n          s: Number(_values[1]),\n          v: Number(_values[2]),\n          source: 'hsv'\n        }, e);\n      }\n    } else if (data.hsl) {\n      var _values2 = data.hsl.split(',');\n      if (color.isvalidColorString(data.hsl, 'hsl')) {\n        _values2[2] = _values2[2].replace('%', '');\n        _values2[1] = _values2[1].replace('%', '');\n        _values2[0] = _values2[0].replace('°', '');\n        if (hsvValue[1] == 1) {\n          hsvValue[1] = 0.01;\n        } else if (hsvValue[2] == 1) {\n          hsvValue[2] = 0.01;\n        }\n        onChange({\n          h: Number(_values2[0]),\n          s: Number(_values2[1]),\n          v: Number(_values2[2]),\n          source: 'hsl'\n        }, e);\n      }\n    }\n  };\n\n  var styles = reactCSS({\n    'default': {\n      wrap: {\n        display: 'flex',\n        height: '100px',\n        marginTop: '4px'\n      },\n      fields: {\n        width: '100%'\n      },\n      column: {\n        paddingTop: '10px',\n        display: 'flex',\n        justifyContent: 'space-between'\n      },\n      double: {\n        padding: '0px 4.4px',\n        boxSizing: 'border-box'\n      },\n      input: {\n        width: '100%',\n        height: '38px',\n        boxSizing: 'border-box',\n        padding: '4px 10% 3px',\n        textAlign: 'center',\n        border: '1px solid #dadce0',\n        fontSize: '11px',\n        textTransform: 'lowercase',\n        borderRadius: '5px',\n        outline: 'none',\n        fontFamily: 'Roboto,Arial,sans-serif'\n      },\n      input2: {\n        height: '38px',\n        width: '100%',\n        border: '1px solid #dadce0',\n        boxSizing: 'border-box',\n        fontSize: '11px',\n        textTransform: 'lowercase',\n        borderRadius: '5px',\n        outline: 'none',\n        paddingLeft: '10px',\n        fontFamily: 'Roboto,Arial,sans-serif'\n      },\n      label: {\n        textAlign: 'center',\n        fontSize: '12px',\n        background: '#fff',\n        position: 'absolute',\n        textTransform: 'uppercase',\n        color: '#3c4043',\n        width: '35px',\n        top: '-6px',\n        left: '0',\n        right: '0',\n        marginLeft: 'auto',\n        marginRight: 'auto',\n        fontFamily: 'Roboto,Arial,sans-serif'\n      },\n      label2: {\n        left: '10px',\n        textAlign: 'center',\n        fontSize: '12px',\n        background: '#fff',\n        position: 'absolute',\n        textTransform: 'uppercase',\n        color: '#3c4043',\n        width: '32px',\n        top: '-6px',\n        fontFamily: 'Roboto,Arial,sans-serif'\n      },\n      single: {\n        flexGrow: '1',\n        margin: '0px 4.4px'\n      }\n    }\n  });\n\n  var rgbValue = rgb.r + ', ' + rgb.g + ', ' + rgb.b;\n  var hslValue = Math.round(hsl.h) + '\\xB0, ' + Math.round(hsl.s * 100) + '%, ' + Math.round(hsl.l * 100) + '%';\n  var hsvValue = Math.round(hsv.h) + '\\xB0, ' + Math.round(hsv.s * 100) + '%, ' + Math.round(hsv.v * 100) + '%';\n\n  return React.createElement(\n    'div',\n    { style: styles.wrap, className: 'flexbox-fix' },\n    React.createElement(\n      'div',\n      { style: styles.fields },\n      React.createElement(\n        'div',\n        { style: styles.double },\n        React.createElement(EditableInput, {\n          style: { input: styles.input, label: styles.label },\n          label: 'hex',\n          value: hex,\n          onChange: handleChange\n        })\n      ),\n      React.createElement(\n        'div',\n        { style: styles.column },\n        React.createElement(\n          'div',\n          { style: styles.single },\n          React.createElement(EditableInput, {\n            style: { input: styles.input2, label: styles.label2 },\n            label: 'rgb',\n            value: rgbValue,\n            onChange: handleChange\n          })\n        ),\n        React.createElement(\n          'div',\n          { style: styles.single },\n          React.createElement(EditableInput, {\n            style: { input: styles.input2, label: styles.label2 },\n            label: 'hsv',\n            value: hsvValue,\n            onChange: handleChange\n          })\n        ),\n        React.createElement(\n          'div',\n          { style: styles.single },\n          React.createElement(EditableInput, {\n            style: { input: styles.input2, label: styles.label2 },\n            label: 'hsl',\n            value: hslValue,\n            onChange: handleChange\n          })\n        )\n      )\n    )\n  );\n};\n\nexport default GoogleFields;","import React from 'react';\nimport PropTypes from 'prop-types';\nimport reactCSS from 'reactcss';\nimport merge from 'lodash-es/merge';\n\nimport { ColorWrap, Saturation, Hue } from '../common';\nimport GooglePointerCircle from './GooglePointerCircle';\nimport GooglePointer from './GooglePointer';\nimport GoogleFields from './GoogleFields';\n\nexport var Google = function Google(_ref) {\n  var width = _ref.width,\n      onChange = _ref.onChange,\n      rgb = _ref.rgb,\n      hsl = _ref.hsl,\n      hsv = _ref.hsv,\n      hex = _ref.hex,\n      header = _ref.header,\n      _ref$styles = _ref.styles,\n      passedStyles = _ref$styles === undefined ? {} : _ref$styles,\n      _ref$className = _ref.className,\n      className = _ref$className === undefined ? '' : _ref$className;\n\n  var styles = reactCSS(merge({\n    'default': {\n      picker: {\n        width: width,\n        background: '#fff',\n        border: '1px solid #dfe1e5',\n        boxSizing: 'initial',\n        display: 'flex',\n        flexWrap: 'wrap',\n        borderRadius: '8px 8px 0px 0px'\n      },\n      head: {\n        height: '57px',\n        width: '100%',\n        paddingTop: '16px',\n        paddingBottom: '16px',\n        paddingLeft: '16px',\n        fontSize: '20px',\n        boxSizing: 'border-box',\n        fontFamily: 'Roboto-Regular,HelveticaNeue,Arial,sans-serif'\n      },\n      saturation: {\n        width: '70%',\n        padding: '0px',\n        position: 'relative',\n        overflow: 'hidden'\n      },\n      swatch: {\n        width: '30%',\n        height: '228px',\n        padding: '0px',\n        background: 'rgba(' + rgb.r + ', ' + rgb.g + ', ' + rgb.b + ', 1)',\n        position: 'relative',\n        overflow: 'hidden'\n      },\n      body: {\n        margin: 'auto',\n        width: '95%'\n      },\n      controls: {\n        display: 'flex',\n        boxSizing: 'border-box',\n        height: '52px',\n        paddingTop: '22px'\n      },\n      color: {\n        width: '32px'\n      },\n      hue: {\n        height: '8px',\n        position: 'relative',\n        margin: '0px 16px 0px 16px',\n        width: '100%'\n      },\n      Hue: {\n        radius: '2px'\n      }\n    }\n  }, passedStyles));\n  return React.createElement(\n    'div',\n    { style: styles.picker, className: 'google-picker ' + className },\n    React.createElement(\n      'div',\n      { style: styles.head },\n      header\n    ),\n    React.createElement('div', { style: styles.swatch }),\n    React.createElement(\n      'div',\n      { style: styles.saturation },\n      React.createElement(Saturation, {\n        hsl: hsl,\n        hsv: hsv,\n        pointer: GooglePointerCircle,\n        onChange: onChange\n      })\n    ),\n    React.createElement(\n      'div',\n      { style: styles.body },\n      React.createElement(\n        'div',\n        { style: styles.controls, className: 'flexbox-fix' },\n        React.createElement(\n          'div',\n          { style: styles.hue },\n          React.createElement(Hue, {\n            style: styles.Hue,\n            hsl: hsl,\n            radius: '4px',\n            pointer: GooglePointer,\n            onChange: onChange\n          })\n        )\n      ),\n      React.createElement(GoogleFields, {\n        rgb: rgb,\n        hsl: hsl,\n        hex: hex,\n        hsv: hsv,\n        onChange: onChange\n      })\n    )\n  );\n};\n\nGoogle.propTypes = {\n  width: PropTypes.oneOfType([PropTypes.string, PropTypes.number]),\n  styles: PropTypes.object,\n  header: PropTypes.string\n\n};\n\nGoogle.defaultProps = {\n  width: 652,\n  styles: {},\n  header: 'Color picker'\n};\n\nexport default ColorWrap(Google);","import _extends from '@babel/runtime/helpers/esm/extends';\nimport _assertThisInitialized from '@babel/runtime/helpers/esm/assertThisInitialized';\nimport _inheritsLoose from '@babel/runtime/helpers/esm/inheritsLoose';\nimport memoizeOne from 'memoize-one';\nimport { createElement, PureComponent } from 'react';\nimport _objectWithoutPropertiesLoose from '@babel/runtime/helpers/esm/objectWithoutPropertiesLoose';\n\n// Animation frame based implementation of setTimeout.\n// Inspired by Joe Lambert, https://gist.github.com/joelambert/1002116#file-requesttimeout-js\nvar hasNativePerformanceNow = typeof performance === 'object' && typeof performance.now === 'function';\nvar now = hasNativePerformanceNow ? function () {\n  return performance.now();\n} : function () {\n  return Date.now();\n};\nfunction cancelTimeout(timeoutID) {\n  cancelAnimationFrame(timeoutID.id);\n}\nfunction requestTimeout(callback, delay) {\n  var start = now();\n\n  function tick() {\n    if (now() - start >= delay) {\n      callback.call(null);\n    } else {\n      timeoutID.id = requestAnimationFrame(tick);\n    }\n  }\n\n  var timeoutID = {\n    id: requestAnimationFrame(tick)\n  };\n  return timeoutID;\n}\n\nvar size = -1; // This utility copied from \"dom-helpers\" package.\n\nfunction getScrollbarSize(recalculate) {\n  if (recalculate === void 0) {\n    recalculate = false;\n  }\n\n  if (size === -1 || recalculate) {\n    var div = document.createElement('div');\n    var style = div.style;\n    style.width = '50px';\n    style.height = '50px';\n    style.overflow = 'scroll';\n    document.body.appendChild(div);\n    size = div.offsetWidth - div.clientWidth;\n    document.body.removeChild(div);\n  }\n\n  return size;\n}\nvar cachedRTLResult = null; // TRICKY According to the spec, scrollLeft should be negative for RTL aligned elements.\n// Chrome does not seem to adhere; its scrollLeft values are positive (measured relative to the left).\n// Safari's elastic bounce makes detecting this even more complicated wrt potential false positives.\n// The safest way to check this is to intentionally set a negative offset,\n// and then verify that the subsequent \"scroll\" event matches the negative offset.\n// If it does not match, then we can assume a non-standard RTL scroll implementation.\n\nfunction getRTLOffsetType(recalculate) {\n  if (recalculate === void 0) {\n    recalculate = false;\n  }\n\n  if (cachedRTLResult === null || recalculate) {\n    var outerDiv = document.createElement('div');\n    var outerStyle = outerDiv.style;\n    outerStyle.width = '50px';\n    outerStyle.height = '50px';\n    outerStyle.overflow = 'scroll';\n    outerStyle.direction = 'rtl';\n    var innerDiv = document.createElement('div');\n    var innerStyle = innerDiv.style;\n    innerStyle.width = '100px';\n    innerStyle.height = '100px';\n    outerDiv.appendChild(innerDiv);\n    document.body.appendChild(outerDiv);\n\n    if (outerDiv.scrollLeft > 0) {\n      cachedRTLResult = 'positive-descending';\n    } else {\n      outerDiv.scrollLeft = 1;\n\n      if (outerDiv.scrollLeft === 0) {\n        cachedRTLResult = 'negative';\n      } else {\n        cachedRTLResult = 'positive-ascending';\n      }\n    }\n\n    document.body.removeChild(outerDiv);\n    return cachedRTLResult;\n  }\n\n  return cachedRTLResult;\n}\n\nvar IS_SCROLLING_DEBOUNCE_INTERVAL = 150;\n\nvar defaultItemKey = function defaultItemKey(_ref) {\n  var columnIndex = _ref.columnIndex,\n      data = _ref.data,\n      rowIndex = _ref.rowIndex;\n  return rowIndex + \":\" + columnIndex;\n}; // In DEV mode, this Set helps us only log a warning once per component instance.\n// This avoids spamming the console every time a render happens.\n\n\nvar devWarningsOverscanCount = null;\nvar devWarningsOverscanRowsColumnsCount = null;\nvar devWarningsTagName = null;\n\nif (process.env.NODE_ENV !== 'production') {\n  if (typeof window !== 'undefined' && typeof window.WeakSet !== 'undefined') {\n    devWarningsOverscanCount = /*#__PURE__*/new WeakSet();\n    devWarningsOverscanRowsColumnsCount = /*#__PURE__*/new WeakSet();\n    devWarningsTagName = /*#__PURE__*/new WeakSet();\n  }\n}\n\nfunction createGridComponent(_ref2) {\n  var _class;\n\n  var getColumnOffset = _ref2.getColumnOffset,\n      getColumnStartIndexForOffset = _ref2.getColumnStartIndexForOffset,\n      getColumnStopIndexForStartIndex = _ref2.getColumnStopIndexForStartIndex,\n      getColumnWidth = _ref2.getColumnWidth,\n      getEstimatedTotalHeight = _ref2.getEstimatedTotalHeight,\n      getEstimatedTotalWidth = _ref2.getEstimatedTotalWidth,\n      getOffsetForColumnAndAlignment = _ref2.getOffsetForColumnAndAlignment,\n      getOffsetForRowAndAlignment = _ref2.getOffsetForRowAndAlignment,\n      getRowHeight = _ref2.getRowHeight,\n      getRowOffset = _ref2.getRowOffset,\n      getRowStartIndexForOffset = _ref2.getRowStartIndexForOffset,\n      getRowStopIndexForStartIndex = _ref2.getRowStopIndexForStartIndex,\n      initInstanceProps = _ref2.initInstanceProps,\n      shouldResetStyleCacheOnItemSizeChange = _ref2.shouldResetStyleCacheOnItemSizeChange,\n      validateProps = _ref2.validateProps;\n  return _class = /*#__PURE__*/function (_PureComponent) {\n    _inheritsLoose(Grid, _PureComponent);\n\n    // Always use explicit constructor for React components.\n    // It produces less code after transpilation. (#26)\n    // eslint-disable-next-line no-useless-constructor\n    function Grid(props) {\n      var _this;\n\n      _this = _PureComponent.call(this, props) || this;\n      _this._instanceProps = initInstanceProps(_this.props, _assertThisInitialized(_this));\n      _this._resetIsScrollingTimeoutId = null;\n      _this._outerRef = void 0;\n      _this.state = {\n        instance: _assertThisInitialized(_this),\n        isScrolling: false,\n        horizontalScrollDirection: 'forward',\n        scrollLeft: typeof _this.props.initialScrollLeft === 'number' ? _this.props.initialScrollLeft : 0,\n        scrollTop: typeof _this.props.initialScrollTop === 'number' ? _this.props.initialScrollTop : 0,\n        scrollUpdateWasRequested: false,\n        verticalScrollDirection: 'forward'\n      };\n      _this._callOnItemsRendered = void 0;\n      _this._callOnItemsRendered = memoizeOne(function (overscanColumnStartIndex, overscanColumnStopIndex, overscanRowStartIndex, overscanRowStopIndex, visibleColumnStartIndex, visibleColumnStopIndex, visibleRowStartIndex, visibleRowStopIndex) {\n        return _this.props.onItemsRendered({\n          overscanColumnStartIndex: overscanColumnStartIndex,\n          overscanColumnStopIndex: overscanColumnStopIndex,\n          overscanRowStartIndex: overscanRowStartIndex,\n          overscanRowStopIndex: overscanRowStopIndex,\n          visibleColumnStartIndex: visibleColumnStartIndex,\n          visibleColumnStopIndex: visibleColumnStopIndex,\n          visibleRowStartIndex: visibleRowStartIndex,\n          visibleRowStopIndex: visibleRowStopIndex\n        });\n      });\n      _this._callOnScroll = void 0;\n      _this._callOnScroll = memoizeOne(function (scrollLeft, scrollTop, horizontalScrollDirection, verticalScrollDirection, scrollUpdateWasRequested) {\n        return _this.props.onScroll({\n          horizontalScrollDirection: horizontalScrollDirection,\n          scrollLeft: scrollLeft,\n          scrollTop: scrollTop,\n          verticalScrollDirection: verticalScrollDirection,\n          scrollUpdateWasRequested: scrollUpdateWasRequested\n        });\n      });\n      _this._getItemStyle = void 0;\n\n      _this._getItemStyle = function (rowIndex, columnIndex) {\n        var _this$props = _this.props,\n            columnWidth = _this$props.columnWidth,\n            direction = _this$props.direction,\n            rowHeight = _this$props.rowHeight;\n\n        var itemStyleCache = _this._getItemStyleCache(shouldResetStyleCacheOnItemSizeChange && columnWidth, shouldResetStyleCacheOnItemSizeChange && direction, shouldResetStyleCacheOnItemSizeChange && rowHeight);\n\n        var key = rowIndex + \":\" + columnIndex;\n        var style;\n\n        if (itemStyleCache.hasOwnProperty(key)) {\n          style = itemStyleCache[key];\n        } else {\n          var _offset = getColumnOffset(_this.props, columnIndex, _this._instanceProps);\n\n          var isRtl = direction === 'rtl';\n          itemStyleCache[key] = style = {\n            position: 'absolute',\n            left: isRtl ? undefined : _offset,\n            right: isRtl ? _offset : undefined,\n            top: getRowOffset(_this.props, rowIndex, _this._instanceProps),\n            height: getRowHeight(_this.props, rowIndex, _this._instanceProps),\n            width: getColumnWidth(_this.props, columnIndex, _this._instanceProps)\n          };\n        }\n\n        return style;\n      };\n\n      _this._getItemStyleCache = void 0;\n      _this._getItemStyleCache = memoizeOne(function (_, __, ___) {\n        return {};\n      });\n\n      _this._onScroll = function (event) {\n        var _event$currentTarget = event.currentTarget,\n            clientHeight = _event$currentTarget.clientHeight,\n            clientWidth = _event$currentTarget.clientWidth,\n            scrollLeft = _event$currentTarget.scrollLeft,\n            scrollTop = _event$currentTarget.scrollTop,\n            scrollHeight = _event$currentTarget.scrollHeight,\n            scrollWidth = _event$currentTarget.scrollWidth;\n\n        _this.setState(function (prevState) {\n          if (prevState.scrollLeft === scrollLeft && prevState.scrollTop === scrollTop) {\n            // Scroll position may have been updated by cDM/cDU,\n            // In which case we don't need to trigger another render,\n            // And we don't want to update state.isScrolling.\n            return null;\n          }\n\n          var direction = _this.props.direction; // TRICKY According to the spec, scrollLeft should be negative for RTL aligned elements.\n          // This is not the case for all browsers though (e.g. Chrome reports values as positive, measured relative to the left).\n          // It's also easier for this component if we convert offsets to the same format as they would be in for ltr.\n          // So the simplest solution is to determine which browser behavior we're dealing with, and convert based on it.\n\n          var calculatedScrollLeft = scrollLeft;\n\n          if (direction === 'rtl') {\n            switch (getRTLOffsetType()) {\n              case 'negative':\n                calculatedScrollLeft = -scrollLeft;\n                break;\n\n              case 'positive-descending':\n                calculatedScrollLeft = scrollWidth - clientWidth - scrollLeft;\n                break;\n            }\n          } // Prevent Safari's elastic scrolling from causing visual shaking when scrolling past bounds.\n\n\n          calculatedScrollLeft = Math.max(0, Math.min(calculatedScrollLeft, scrollWidth - clientWidth));\n          var calculatedScrollTop = Math.max(0, Math.min(scrollTop, scrollHeight - clientHeight));\n          return {\n            isScrolling: true,\n            horizontalScrollDirection: prevState.scrollLeft < scrollLeft ? 'forward' : 'backward',\n            scrollLeft: calculatedScrollLeft,\n            scrollTop: calculatedScrollTop,\n            verticalScrollDirection: prevState.scrollTop < scrollTop ? 'forward' : 'backward',\n            scrollUpdateWasRequested: false\n          };\n        }, _this._resetIsScrollingDebounced);\n      };\n\n      _this._outerRefSetter = function (ref) {\n        var outerRef = _this.props.outerRef;\n        _this._outerRef = ref;\n\n        if (typeof outerRef === 'function') {\n          outerRef(ref);\n        } else if (outerRef != null && typeof outerRef === 'object' && outerRef.hasOwnProperty('current')) {\n          outerRef.current = ref;\n        }\n      };\n\n      _this._resetIsScrollingDebounced = function () {\n        if (_this._resetIsScrollingTimeoutId !== null) {\n          cancelTimeout(_this._resetIsScrollingTimeoutId);\n        }\n\n        _this._resetIsScrollingTimeoutId = requestTimeout(_this._resetIsScrolling, IS_SCROLLING_DEBOUNCE_INTERVAL);\n      };\n\n      _this._resetIsScrolling = function () {\n        _this._resetIsScrollingTimeoutId = null;\n\n        _this.setState({\n          isScrolling: false\n        }, function () {\n          // Clear style cache after state update has been committed.\n          // This way we don't break pure sCU for items that don't use isScrolling param.\n          _this._getItemStyleCache(-1);\n        });\n      };\n\n      return _this;\n    }\n\n    Grid.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, prevState) {\n      validateSharedProps(nextProps, prevState);\n      validateProps(nextProps);\n      return null;\n    };\n\n    var _proto = Grid.prototype;\n\n    _proto.scrollTo = function scrollTo(_ref3) {\n      var scrollLeft = _ref3.scrollLeft,\n          scrollTop = _ref3.scrollTop;\n\n      if (scrollLeft !== undefined) {\n        scrollLeft = Math.max(0, scrollLeft);\n      }\n\n      if (scrollTop !== undefined) {\n        scrollTop = Math.max(0, scrollTop);\n      }\n\n      this.setState(function (prevState) {\n        if (scrollLeft === undefined) {\n          scrollLeft = prevState.scrollLeft;\n        }\n\n        if (scrollTop === undefined) {\n          scrollTop = prevState.scrollTop;\n        }\n\n        if (prevState.scrollLeft === scrollLeft && prevState.scrollTop === scrollTop) {\n          return null;\n        }\n\n        return {\n          horizontalScrollDirection: prevState.scrollLeft < scrollLeft ? 'forward' : 'backward',\n          scrollLeft: scrollLeft,\n          scrollTop: scrollTop,\n          scrollUpdateWasRequested: true,\n          verticalScrollDirection: prevState.scrollTop < scrollTop ? 'forward' : 'backward'\n        };\n      }, this._resetIsScrollingDebounced);\n    };\n\n    _proto.scrollToItem = function scrollToItem(_ref4) {\n      var _ref4$align = _ref4.align,\n          align = _ref4$align === void 0 ? 'auto' : _ref4$align,\n          columnIndex = _ref4.columnIndex,\n          rowIndex = _ref4.rowIndex;\n      var _this$props2 = this.props,\n          columnCount = _this$props2.columnCount,\n          height = _this$props2.height,\n          rowCount = _this$props2.rowCount,\n          width = _this$props2.width;\n      var _this$state = this.state,\n          scrollLeft = _this$state.scrollLeft,\n          scrollTop = _this$state.scrollTop;\n      var scrollbarSize = getScrollbarSize();\n\n      if (columnIndex !== undefined) {\n        columnIndex = Math.max(0, Math.min(columnIndex, columnCount - 1));\n      }\n\n      if (rowIndex !== undefined) {\n        rowIndex = Math.max(0, Math.min(rowIndex, rowCount - 1));\n      }\n\n      var estimatedTotalHeight = getEstimatedTotalHeight(this.props, this._instanceProps);\n      var estimatedTotalWidth = getEstimatedTotalWidth(this.props, this._instanceProps); // The scrollbar size should be considered when scrolling an item into view,\n      // to ensure it's fully visible.\n      // But we only need to account for its size when it's actually visible.\n\n      var horizontalScrollbarSize = estimatedTotalWidth > width ? scrollbarSize : 0;\n      var verticalScrollbarSize = estimatedTotalHeight > height ? scrollbarSize : 0;\n      this.scrollTo({\n        scrollLeft: columnIndex !== undefined ? getOffsetForColumnAndAlignment(this.props, columnIndex, align, scrollLeft, this._instanceProps, verticalScrollbarSize) : scrollLeft,\n        scrollTop: rowIndex !== undefined ? getOffsetForRowAndAlignment(this.props, rowIndex, align, scrollTop, this._instanceProps, horizontalScrollbarSize) : scrollTop\n      });\n    };\n\n    _proto.componentDidMount = function componentDidMount() {\n      var _this$props3 = this.props,\n          initialScrollLeft = _this$props3.initialScrollLeft,\n          initialScrollTop = _this$props3.initialScrollTop;\n\n      if (this._outerRef != null) {\n        var outerRef = this._outerRef;\n\n        if (typeof initialScrollLeft === 'number') {\n          outerRef.scrollLeft = initialScrollLeft;\n        }\n\n        if (typeof initialScrollTop === 'number') {\n          outerRef.scrollTop = initialScrollTop;\n        }\n      }\n\n      this._callPropsCallbacks();\n    };\n\n    _proto.componentDidUpdate = function componentDidUpdate() {\n      var direction = this.props.direction;\n      var _this$state2 = this.state,\n          scrollLeft = _this$state2.scrollLeft,\n          scrollTop = _this$state2.scrollTop,\n          scrollUpdateWasRequested = _this$state2.scrollUpdateWasRequested;\n\n      if (scrollUpdateWasRequested && this._outerRef != null) {\n        // TRICKY According to the spec, scrollLeft should be negative for RTL aligned elements.\n        // This is not the case for all browsers though (e.g. Chrome reports values as positive, measured relative to the left).\n        // So we need to determine which browser behavior we're dealing with, and mimic it.\n        var outerRef = this._outerRef;\n\n        if (direction === 'rtl') {\n          switch (getRTLOffsetType()) {\n            case 'negative':\n              outerRef.scrollLeft = -scrollLeft;\n              break;\n\n            case 'positive-ascending':\n              outerRef.scrollLeft = scrollLeft;\n              break;\n\n            default:\n              var clientWidth = outerRef.clientWidth,\n                  scrollWidth = outerRef.scrollWidth;\n              outerRef.scrollLeft = scrollWidth - clientWidth - scrollLeft;\n              break;\n          }\n        } else {\n          outerRef.scrollLeft = Math.max(0, scrollLeft);\n        }\n\n        outerRef.scrollTop = Math.max(0, scrollTop);\n      }\n\n      this._callPropsCallbacks();\n    };\n\n    _proto.componentWillUnmount = function componentWillUnmount() {\n      if (this._resetIsScrollingTimeoutId !== null) {\n        cancelTimeout(this._resetIsScrollingTimeoutId);\n      }\n    };\n\n    _proto.render = function render() {\n      var _this$props4 = this.props,\n          children = _this$props4.children,\n          className = _this$props4.className,\n          columnCount = _this$props4.columnCount,\n          direction = _this$props4.direction,\n          height = _this$props4.height,\n          innerRef = _this$props4.innerRef,\n          innerElementType = _this$props4.innerElementType,\n          innerTagName = _this$props4.innerTagName,\n          itemData = _this$props4.itemData,\n          _this$props4$itemKey = _this$props4.itemKey,\n          itemKey = _this$props4$itemKey === void 0 ? defaultItemKey : _this$props4$itemKey,\n          outerElementType = _this$props4.outerElementType,\n          outerTagName = _this$props4.outerTagName,\n          rowCount = _this$props4.rowCount,\n          style = _this$props4.style,\n          useIsScrolling = _this$props4.useIsScrolling,\n          width = _this$props4.width;\n      var isScrolling = this.state.isScrolling;\n\n      var _this$_getHorizontalR = this._getHorizontalRangeToRender(),\n          columnStartIndex = _this$_getHorizontalR[0],\n          columnStopIndex = _this$_getHorizontalR[1];\n\n      var _this$_getVerticalRan = this._getVerticalRangeToRender(),\n          rowStartIndex = _this$_getVerticalRan[0],\n          rowStopIndex = _this$_getVerticalRan[1];\n\n      var items = [];\n\n      if (columnCount > 0 && rowCount) {\n        for (var _rowIndex = rowStartIndex; _rowIndex <= rowStopIndex; _rowIndex++) {\n          for (var _columnIndex = columnStartIndex; _columnIndex <= columnStopIndex; _columnIndex++) {\n            items.push(createElement(children, {\n              columnIndex: _columnIndex,\n              data: itemData,\n              isScrolling: useIsScrolling ? isScrolling : undefined,\n              key: itemKey({\n                columnIndex: _columnIndex,\n                data: itemData,\n                rowIndex: _rowIndex\n              }),\n              rowIndex: _rowIndex,\n              style: this._getItemStyle(_rowIndex, _columnIndex)\n            }));\n          }\n        }\n      } // Read this value AFTER items have been created,\n      // So their actual sizes (if variable) are taken into consideration.\n\n\n      var estimatedTotalHeight = getEstimatedTotalHeight(this.props, this._instanceProps);\n      var estimatedTotalWidth = getEstimatedTotalWidth(this.props, this._instanceProps);\n      return createElement(outerElementType || outerTagName || 'div', {\n        className: className,\n        onScroll: this._onScroll,\n        ref: this._outerRefSetter,\n        style: _extends({\n          position: 'relative',\n          height: height,\n          width: width,\n          overflow: 'auto',\n          WebkitOverflowScrolling: 'touch',\n          willChange: 'transform',\n          direction: direction\n        }, style)\n      }, createElement(innerElementType || innerTagName || 'div', {\n        children: items,\n        ref: innerRef,\n        style: {\n          height: estimatedTotalHeight,\n          pointerEvents: isScrolling ? 'none' : undefined,\n          width: estimatedTotalWidth\n        }\n      }));\n    };\n\n    _proto._callPropsCallbacks = function _callPropsCallbacks() {\n      var _this$props5 = this.props,\n          columnCount = _this$props5.columnCount,\n          onItemsRendered = _this$props5.onItemsRendered,\n          onScroll = _this$props5.onScroll,\n          rowCount = _this$props5.rowCount;\n\n      if (typeof onItemsRendered === 'function') {\n        if (columnCount > 0 && rowCount > 0) {\n          var _this$_getHorizontalR2 = this._getHorizontalRangeToRender(),\n              _overscanColumnStartIndex = _this$_getHorizontalR2[0],\n              _overscanColumnStopIndex = _this$_getHorizontalR2[1],\n              _visibleColumnStartIndex = _this$_getHorizontalR2[2],\n              _visibleColumnStopIndex = _this$_getHorizontalR2[3];\n\n          var _this$_getVerticalRan2 = this._getVerticalRangeToRender(),\n              _overscanRowStartIndex = _this$_getVerticalRan2[0],\n              _overscanRowStopIndex = _this$_getVerticalRan2[1],\n              _visibleRowStartIndex = _this$_getVerticalRan2[2],\n              _visibleRowStopIndex = _this$_getVerticalRan2[3];\n\n          this._callOnItemsRendered(_overscanColumnStartIndex, _overscanColumnStopIndex, _overscanRowStartIndex, _overscanRowStopIndex, _visibleColumnStartIndex, _visibleColumnStopIndex, _visibleRowStartIndex, _visibleRowStopIndex);\n        }\n      }\n\n      if (typeof onScroll === 'function') {\n        var _this$state3 = this.state,\n            _horizontalScrollDirection = _this$state3.horizontalScrollDirection,\n            _scrollLeft = _this$state3.scrollLeft,\n            _scrollTop = _this$state3.scrollTop,\n            _scrollUpdateWasRequested = _this$state3.scrollUpdateWasRequested,\n            _verticalScrollDirection = _this$state3.verticalScrollDirection;\n\n        this._callOnScroll(_scrollLeft, _scrollTop, _horizontalScrollDirection, _verticalScrollDirection, _scrollUpdateWasRequested);\n      }\n    } // Lazily create and cache item styles while scrolling,\n    // So that pure component sCU will prevent re-renders.\n    // We maintain this cache, and pass a style prop rather than index,\n    // So that List can clear cached styles and force item re-render if necessary.\n    ;\n\n    _proto._getHorizontalRangeToRender = function _getHorizontalRangeToRender() {\n      var _this$props6 = this.props,\n          columnCount = _this$props6.columnCount,\n          overscanColumnCount = _this$props6.overscanColumnCount,\n          overscanColumnsCount = _this$props6.overscanColumnsCount,\n          overscanCount = _this$props6.overscanCount,\n          rowCount = _this$props6.rowCount;\n      var _this$state4 = this.state,\n          horizontalScrollDirection = _this$state4.horizontalScrollDirection,\n          isScrolling = _this$state4.isScrolling,\n          scrollLeft = _this$state4.scrollLeft;\n      var overscanCountResolved = overscanColumnCount || overscanColumnsCount || overscanCount || 1;\n\n      if (columnCount === 0 || rowCount === 0) {\n        return [0, 0, 0, 0];\n      }\n\n      var startIndex = getColumnStartIndexForOffset(this.props, scrollLeft, this._instanceProps);\n      var stopIndex = getColumnStopIndexForStartIndex(this.props, startIndex, scrollLeft, this._instanceProps); // Overscan by one item in each direction so that tab/focus works.\n      // If there isn't at least one extra item, tab loops back around.\n\n      var overscanBackward = !isScrolling || horizontalScrollDirection === 'backward' ? Math.max(1, overscanCountResolved) : 1;\n      var overscanForward = !isScrolling || horizontalScrollDirection === 'forward' ? Math.max(1, overscanCountResolved) : 1;\n      return [Math.max(0, startIndex - overscanBackward), Math.max(0, Math.min(columnCount - 1, stopIndex + overscanForward)), startIndex, stopIndex];\n    };\n\n    _proto._getVerticalRangeToRender = function _getVerticalRangeToRender() {\n      var _this$props7 = this.props,\n          columnCount = _this$props7.columnCount,\n          overscanCount = _this$props7.overscanCount,\n          overscanRowCount = _this$props7.overscanRowCount,\n          overscanRowsCount = _this$props7.overscanRowsCount,\n          rowCount = _this$props7.rowCount;\n      var _this$state5 = this.state,\n          isScrolling = _this$state5.isScrolling,\n          verticalScrollDirection = _this$state5.verticalScrollDirection,\n          scrollTop = _this$state5.scrollTop;\n      var overscanCountResolved = overscanRowCount || overscanRowsCount || overscanCount || 1;\n\n      if (columnCount === 0 || rowCount === 0) {\n        return [0, 0, 0, 0];\n      }\n\n      var startIndex = getRowStartIndexForOffset(this.props, scrollTop, this._instanceProps);\n      var stopIndex = getRowStopIndexForStartIndex(this.props, startIndex, scrollTop, this._instanceProps); // Overscan by one item in each direction so that tab/focus works.\n      // If there isn't at least one extra item, tab loops back around.\n\n      var overscanBackward = !isScrolling || verticalScrollDirection === 'backward' ? Math.max(1, overscanCountResolved) : 1;\n      var overscanForward = !isScrolling || verticalScrollDirection === 'forward' ? Math.max(1, overscanCountResolved) : 1;\n      return [Math.max(0, startIndex - overscanBackward), Math.max(0, Math.min(rowCount - 1, stopIndex + overscanForward)), startIndex, stopIndex];\n    };\n\n    return Grid;\n  }(PureComponent), _class.defaultProps = {\n    direction: 'ltr',\n    itemData: undefined,\n    useIsScrolling: false\n  }, _class;\n}\n\nvar validateSharedProps = function validateSharedProps(_ref5, _ref6) {\n  var children = _ref5.children,\n      direction = _ref5.direction,\n      height = _ref5.height,\n      innerTagName = _ref5.innerTagName,\n      outerTagName = _ref5.outerTagName,\n      overscanColumnsCount = _ref5.overscanColumnsCount,\n      overscanCount = _ref5.overscanCount,\n      overscanRowsCount = _ref5.overscanRowsCount,\n      width = _ref5.width;\n  var instance = _ref6.instance;\n\n  if (process.env.NODE_ENV !== 'production') {\n    if (typeof overscanCount === 'number') {\n      if (devWarningsOverscanCount && !devWarningsOverscanCount.has(instance)) {\n        devWarningsOverscanCount.add(instance);\n        console.warn('The overscanCount prop has been deprecated. ' + 'Please use the overscanColumnCount and overscanRowCount props instead.');\n      }\n    }\n\n    if (typeof overscanColumnsCount === 'number' || typeof overscanRowsCount === 'number') {\n      if (devWarningsOverscanRowsColumnsCount && !devWarningsOverscanRowsColumnsCount.has(instance)) {\n        devWarningsOverscanRowsColumnsCount.add(instance);\n        console.warn('The overscanColumnsCount and overscanRowsCount props have been deprecated. ' + 'Please use the overscanColumnCount and overscanRowCount props instead.');\n      }\n    }\n\n    if (innerTagName != null || outerTagName != null) {\n      if (devWarningsTagName && !devWarningsTagName.has(instance)) {\n        devWarningsTagName.add(instance);\n        console.warn('The innerTagName and outerTagName props have been deprecated. ' + 'Please use the innerElementType and outerElementType props instead.');\n      }\n    }\n\n    if (children == null) {\n      throw Error('An invalid \"children\" prop has been specified. ' + 'Value should be a React component. ' + (\"\\\"\" + (children === null ? 'null' : typeof children) + \"\\\" was specified.\"));\n    }\n\n    switch (direction) {\n      case 'ltr':\n      case 'rtl':\n        // Valid values\n        break;\n\n      default:\n        throw Error('An invalid \"direction\" prop has been specified. ' + 'Value should be either \"ltr\" or \"rtl\". ' + (\"\\\"\" + direction + \"\\\" was specified.\"));\n    }\n\n    if (typeof width !== 'number') {\n      throw Error('An invalid \"width\" prop has been specified. ' + 'Grids must specify a number for width. ' + (\"\\\"\" + (width === null ? 'null' : typeof width) + \"\\\" was specified.\"));\n    }\n\n    if (typeof height !== 'number') {\n      throw Error('An invalid \"height\" prop has been specified. ' + 'Grids must specify a number for height. ' + (\"\\\"\" + (height === null ? 'null' : typeof height) + \"\\\" was specified.\"));\n    }\n  }\n};\n\nvar DEFAULT_ESTIMATED_ITEM_SIZE = 50;\n\nvar getEstimatedTotalHeight = function getEstimatedTotalHeight(_ref, _ref2) {\n  var rowCount = _ref.rowCount;\n  var rowMetadataMap = _ref2.rowMetadataMap,\n      estimatedRowHeight = _ref2.estimatedRowHeight,\n      lastMeasuredRowIndex = _ref2.lastMeasuredRowIndex;\n  var totalSizeOfMeasuredRows = 0; // Edge case check for when the number of items decreases while a scroll is in progress.\n  // https://github.com/bvaughn/react-window/pull/138\n\n  if (lastMeasuredRowIndex >= rowCount) {\n    lastMeasuredRowIndex = rowCount - 1;\n  }\n\n  if (lastMeasuredRowIndex >= 0) {\n    var itemMetadata = rowMetadataMap[lastMeasuredRowIndex];\n    totalSizeOfMeasuredRows = itemMetadata.offset + itemMetadata.size;\n  }\n\n  var numUnmeasuredItems = rowCount - lastMeasuredRowIndex - 1;\n  var totalSizeOfUnmeasuredItems = numUnmeasuredItems * estimatedRowHeight;\n  return totalSizeOfMeasuredRows + totalSizeOfUnmeasuredItems;\n};\n\nvar getEstimatedTotalWidth = function getEstimatedTotalWidth(_ref3, _ref4) {\n  var columnCount = _ref3.columnCount;\n  var columnMetadataMap = _ref4.columnMetadataMap,\n      estimatedColumnWidth = _ref4.estimatedColumnWidth,\n      lastMeasuredColumnIndex = _ref4.lastMeasuredColumnIndex;\n  var totalSizeOfMeasuredRows = 0; // Edge case check for when the number of items decreases while a scroll is in progress.\n  // https://github.com/bvaughn/react-window/pull/138\n\n  if (lastMeasuredColumnIndex >= columnCount) {\n    lastMeasuredColumnIndex = columnCount - 1;\n  }\n\n  if (lastMeasuredColumnIndex >= 0) {\n    var itemMetadata = columnMetadataMap[lastMeasuredColumnIndex];\n    totalSizeOfMeasuredRows = itemMetadata.offset + itemMetadata.size;\n  }\n\n  var numUnmeasuredItems = columnCount - lastMeasuredColumnIndex - 1;\n  var totalSizeOfUnmeasuredItems = numUnmeasuredItems * estimatedColumnWidth;\n  return totalSizeOfMeasuredRows + totalSizeOfUnmeasuredItems;\n};\n\nvar getItemMetadata = function getItemMetadata(itemType, props, index, instanceProps) {\n  var itemMetadataMap, itemSize, lastMeasuredIndex;\n\n  if (itemType === 'column') {\n    itemMetadataMap = instanceProps.columnMetadataMap;\n    itemSize = props.columnWidth;\n    lastMeasuredIndex = instanceProps.lastMeasuredColumnIndex;\n  } else {\n    itemMetadataMap = instanceProps.rowMetadataMap;\n    itemSize = props.rowHeight;\n    lastMeasuredIndex = instanceProps.lastMeasuredRowIndex;\n  }\n\n  if (index > lastMeasuredIndex) {\n    var offset = 0;\n\n    if (lastMeasuredIndex >= 0) {\n      var itemMetadata = itemMetadataMap[lastMeasuredIndex];\n      offset = itemMetadata.offset + itemMetadata.size;\n    }\n\n    for (var i = lastMeasuredIndex + 1; i <= index; i++) {\n      var size = itemSize(i);\n      itemMetadataMap[i] = {\n        offset: offset,\n        size: size\n      };\n      offset += size;\n    }\n\n    if (itemType === 'column') {\n      instanceProps.lastMeasuredColumnIndex = index;\n    } else {\n      instanceProps.lastMeasuredRowIndex = index;\n    }\n  }\n\n  return itemMetadataMap[index];\n};\n\nvar findNearestItem = function findNearestItem(itemType, props, instanceProps, offset) {\n  var itemMetadataMap, lastMeasuredIndex;\n\n  if (itemType === 'column') {\n    itemMetadataMap = instanceProps.columnMetadataMap;\n    lastMeasuredIndex = instanceProps.lastMeasuredColumnIndex;\n  } else {\n    itemMetadataMap = instanceProps.rowMetadataMap;\n    lastMeasuredIndex = instanceProps.lastMeasuredRowIndex;\n  }\n\n  var lastMeasuredItemOffset = lastMeasuredIndex > 0 ? itemMetadataMap[lastMeasuredIndex].offset : 0;\n\n  if (lastMeasuredItemOffset >= offset) {\n    // If we've already measured items within this range just use a binary search as it's faster.\n    return findNearestItemBinarySearch(itemType, props, instanceProps, lastMeasuredIndex, 0, offset);\n  } else {\n    // If we haven't yet measured this high, fallback to an exponential search with an inner binary search.\n    // The exponential search avoids pre-computing sizes for the full set of items as a binary search would.\n    // The overall complexity for this approach is O(log n).\n    return findNearestItemExponentialSearch(itemType, props, instanceProps, Math.max(0, lastMeasuredIndex), offset);\n  }\n};\n\nvar findNearestItemBinarySearch = function findNearestItemBinarySearch(itemType, props, instanceProps, high, low, offset) {\n  while (low <= high) {\n    var middle = low + Math.floor((high - low) / 2);\n    var currentOffset = getItemMetadata(itemType, props, middle, instanceProps).offset;\n\n    if (currentOffset === offset) {\n      return middle;\n    } else if (currentOffset < offset) {\n      low = middle + 1;\n    } else if (currentOffset > offset) {\n      high = middle - 1;\n    }\n  }\n\n  if (low > 0) {\n    return low - 1;\n  } else {\n    return 0;\n  }\n};\n\nvar findNearestItemExponentialSearch = function findNearestItemExponentialSearch(itemType, props, instanceProps, index, offset) {\n  var itemCount = itemType === 'column' ? props.columnCount : props.rowCount;\n  var interval = 1;\n\n  while (index < itemCount && getItemMetadata(itemType, props, index, instanceProps).offset < offset) {\n    index += interval;\n    interval *= 2;\n  }\n\n  return findNearestItemBinarySearch(itemType, props, instanceProps, Math.min(index, itemCount - 1), Math.floor(index / 2), offset);\n};\n\nvar getOffsetForIndexAndAlignment = function getOffsetForIndexAndAlignment(itemType, props, index, align, scrollOffset, instanceProps, scrollbarSize) {\n  var size = itemType === 'column' ? props.width : props.height;\n  var itemMetadata = getItemMetadata(itemType, props, index, instanceProps); // Get estimated total size after ItemMetadata is computed,\n  // To ensure it reflects actual measurements instead of just estimates.\n\n  var estimatedTotalSize = itemType === 'column' ? getEstimatedTotalWidth(props, instanceProps) : getEstimatedTotalHeight(props, instanceProps);\n  var maxOffset = Math.max(0, Math.min(estimatedTotalSize - size, itemMetadata.offset));\n  var minOffset = Math.max(0, itemMetadata.offset - size + scrollbarSize + itemMetadata.size);\n\n  if (align === 'smart') {\n    if (scrollOffset >= minOffset - size && scrollOffset <= maxOffset + size) {\n      align = 'auto';\n    } else {\n      align = 'center';\n    }\n  }\n\n  switch (align) {\n    case 'start':\n      return maxOffset;\n\n    case 'end':\n      return minOffset;\n\n    case 'center':\n      return Math.round(minOffset + (maxOffset - minOffset) / 2);\n\n    case 'auto':\n    default:\n      if (scrollOffset >= minOffset && scrollOffset <= maxOffset) {\n        return scrollOffset;\n      } else if (minOffset > maxOffset) {\n        // Because we only take into account the scrollbar size when calculating minOffset\n        // this value can be larger than maxOffset when at the end of the list\n        return minOffset;\n      } else if (scrollOffset < minOffset) {\n        return minOffset;\n      } else {\n        return maxOffset;\n      }\n\n  }\n};\n\nvar VariableSizeGrid = /*#__PURE__*/createGridComponent({\n  getColumnOffset: function getColumnOffset(props, index, instanceProps) {\n    return getItemMetadata('column', props, index, instanceProps).offset;\n  },\n  getColumnStartIndexForOffset: function getColumnStartIndexForOffset(props, scrollLeft, instanceProps) {\n    return findNearestItem('column', props, instanceProps, scrollLeft);\n  },\n  getColumnStopIndexForStartIndex: function getColumnStopIndexForStartIndex(props, startIndex, scrollLeft, instanceProps) {\n    var columnCount = props.columnCount,\n        width = props.width;\n    var itemMetadata = getItemMetadata('column', props, startIndex, instanceProps);\n    var maxOffset = scrollLeft + width;\n    var offset = itemMetadata.offset + itemMetadata.size;\n    var stopIndex = startIndex;\n\n    while (stopIndex < columnCount - 1 && offset < maxOffset) {\n      stopIndex++;\n      offset += getItemMetadata('column', props, stopIndex, instanceProps).size;\n    }\n\n    return stopIndex;\n  },\n  getColumnWidth: function getColumnWidth(props, index, instanceProps) {\n    return instanceProps.columnMetadataMap[index].size;\n  },\n  getEstimatedTotalHeight: getEstimatedTotalHeight,\n  getEstimatedTotalWidth: getEstimatedTotalWidth,\n  getOffsetForColumnAndAlignment: function getOffsetForColumnAndAlignment(props, index, align, scrollOffset, instanceProps, scrollbarSize) {\n    return getOffsetForIndexAndAlignment('column', props, index, align, scrollOffset, instanceProps, scrollbarSize);\n  },\n  getOffsetForRowAndAlignment: function getOffsetForRowAndAlignment(props, index, align, scrollOffset, instanceProps, scrollbarSize) {\n    return getOffsetForIndexAndAlignment('row', props, index, align, scrollOffset, instanceProps, scrollbarSize);\n  },\n  getRowOffset: function getRowOffset(props, index, instanceProps) {\n    return getItemMetadata('row', props, index, instanceProps).offset;\n  },\n  getRowHeight: function getRowHeight(props, index, instanceProps) {\n    return instanceProps.rowMetadataMap[index].size;\n  },\n  getRowStartIndexForOffset: function getRowStartIndexForOffset(props, scrollTop, instanceProps) {\n    return findNearestItem('row', props, instanceProps, scrollTop);\n  },\n  getRowStopIndexForStartIndex: function getRowStopIndexForStartIndex(props, startIndex, scrollTop, instanceProps) {\n    var rowCount = props.rowCount,\n        height = props.height;\n    var itemMetadata = getItemMetadata('row', props, startIndex, instanceProps);\n    var maxOffset = scrollTop + height;\n    var offset = itemMetadata.offset + itemMetadata.size;\n    var stopIndex = startIndex;\n\n    while (stopIndex < rowCount - 1 && offset < maxOffset) {\n      stopIndex++;\n      offset += getItemMetadata('row', props, stopIndex, instanceProps).size;\n    }\n\n    return stopIndex;\n  },\n  initInstanceProps: function initInstanceProps(props, instance) {\n    var _ref5 = props,\n        estimatedColumnWidth = _ref5.estimatedColumnWidth,\n        estimatedRowHeight = _ref5.estimatedRowHeight;\n    var instanceProps = {\n      columnMetadataMap: {},\n      estimatedColumnWidth: estimatedColumnWidth || DEFAULT_ESTIMATED_ITEM_SIZE,\n      estimatedRowHeight: estimatedRowHeight || DEFAULT_ESTIMATED_ITEM_SIZE,\n      lastMeasuredColumnIndex: -1,\n      lastMeasuredRowIndex: -1,\n      rowMetadataMap: {}\n    };\n\n    instance.resetAfterColumnIndex = function (columnIndex, shouldForceUpdate) {\n      if (shouldForceUpdate === void 0) {\n        shouldForceUpdate = true;\n      }\n\n      instance.resetAfterIndices({\n        columnIndex: columnIndex,\n        shouldForceUpdate: shouldForceUpdate\n      });\n    };\n\n    instance.resetAfterRowIndex = function (rowIndex, shouldForceUpdate) {\n      if (shouldForceUpdate === void 0) {\n        shouldForceUpdate = true;\n      }\n\n      instance.resetAfterIndices({\n        rowIndex: rowIndex,\n        shouldForceUpdate: shouldForceUpdate\n      });\n    };\n\n    instance.resetAfterIndices = function (_ref6) {\n      var columnIndex = _ref6.columnIndex,\n          rowIndex = _ref6.rowIndex,\n          _ref6$shouldForceUpda = _ref6.shouldForceUpdate,\n          shouldForceUpdate = _ref6$shouldForceUpda === void 0 ? true : _ref6$shouldForceUpda;\n\n      if (typeof columnIndex === 'number') {\n        instanceProps.lastMeasuredColumnIndex = Math.min(instanceProps.lastMeasuredColumnIndex, columnIndex - 1);\n      }\n\n      if (typeof rowIndex === 'number') {\n        instanceProps.lastMeasuredRowIndex = Math.min(instanceProps.lastMeasuredRowIndex, rowIndex - 1);\n      } // We could potentially optimize further by only evicting styles after this index,\n      // But since styles are only cached while scrolling is in progress-\n      // It seems an unnecessary optimization.\n      // It's unlikely that resetAfterIndex() will be called while a user is scrolling.\n\n\n      instance._getItemStyleCache(-1);\n\n      if (shouldForceUpdate) {\n        instance.forceUpdate();\n      }\n    };\n\n    return instanceProps;\n  },\n  shouldResetStyleCacheOnItemSizeChange: false,\n  validateProps: function validateProps(_ref7) {\n    var columnWidth = _ref7.columnWidth,\n        rowHeight = _ref7.rowHeight;\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (typeof columnWidth !== 'function') {\n        throw Error('An invalid \"columnWidth\" prop has been specified. ' + 'Value should be a function. ' + (\"\\\"\" + (columnWidth === null ? 'null' : typeof columnWidth) + \"\\\" was specified.\"));\n      } else if (typeof rowHeight !== 'function') {\n        throw Error('An invalid \"rowHeight\" prop has been specified. ' + 'Value should be a function. ' + (\"\\\"\" + (rowHeight === null ? 'null' : typeof rowHeight) + \"\\\" was specified.\"));\n      }\n    }\n  }\n});\n\nvar IS_SCROLLING_DEBOUNCE_INTERVAL$1 = 150;\n\nvar defaultItemKey$1 = function defaultItemKey(index, data) {\n  return index;\n}; // In DEV mode, this Set helps us only log a warning once per component instance.\n// This avoids spamming the console every time a render happens.\n\n\nvar devWarningsDirection = null;\nvar devWarningsTagName$1 = null;\n\nif (process.env.NODE_ENV !== 'production') {\n  if (typeof window !== 'undefined' && typeof window.WeakSet !== 'undefined') {\n    devWarningsDirection = /*#__PURE__*/new WeakSet();\n    devWarningsTagName$1 = /*#__PURE__*/new WeakSet();\n  }\n}\n\nfunction createListComponent(_ref) {\n  var _class;\n\n  var getItemOffset = _ref.getItemOffset,\n      getEstimatedTotalSize = _ref.getEstimatedTotalSize,\n      getItemSize = _ref.getItemSize,\n      getOffsetForIndexAndAlignment = _ref.getOffsetForIndexAndAlignment,\n      getStartIndexForOffset = _ref.getStartIndexForOffset,\n      getStopIndexForStartIndex = _ref.getStopIndexForStartIndex,\n      initInstanceProps = _ref.initInstanceProps,\n      shouldResetStyleCacheOnItemSizeChange = _ref.shouldResetStyleCacheOnItemSizeChange,\n      validateProps = _ref.validateProps;\n  return _class = /*#__PURE__*/function (_PureComponent) {\n    _inheritsLoose(List, _PureComponent);\n\n    // Always use explicit constructor for React components.\n    // It produces less code after transpilation. (#26)\n    // eslint-disable-next-line no-useless-constructor\n    function List(props) {\n      var _this;\n\n      _this = _PureComponent.call(this, props) || this;\n      _this._instanceProps = initInstanceProps(_this.props, _assertThisInitialized(_this));\n      _this._outerRef = void 0;\n      _this._resetIsScrollingTimeoutId = null;\n      _this.state = {\n        instance: _assertThisInitialized(_this),\n        isScrolling: false,\n        scrollDirection: 'forward',\n        scrollOffset: typeof _this.props.initialScrollOffset === 'number' ? _this.props.initialScrollOffset : 0,\n        scrollUpdateWasRequested: false\n      };\n      _this._callOnItemsRendered = void 0;\n      _this._callOnItemsRendered = memoizeOne(function (overscanStartIndex, overscanStopIndex, visibleStartIndex, visibleStopIndex) {\n        return _this.props.onItemsRendered({\n          overscanStartIndex: overscanStartIndex,\n          overscanStopIndex: overscanStopIndex,\n          visibleStartIndex: visibleStartIndex,\n          visibleStopIndex: visibleStopIndex\n        });\n      });\n      _this._callOnScroll = void 0;\n      _this._callOnScroll = memoizeOne(function (scrollDirection, scrollOffset, scrollUpdateWasRequested) {\n        return _this.props.onScroll({\n          scrollDirection: scrollDirection,\n          scrollOffset: scrollOffset,\n          scrollUpdateWasRequested: scrollUpdateWasRequested\n        });\n      });\n      _this._getItemStyle = void 0;\n\n      _this._getItemStyle = function (index) {\n        var _this$props = _this.props,\n            direction = _this$props.direction,\n            itemSize = _this$props.itemSize,\n            layout = _this$props.layout;\n\n        var itemStyleCache = _this._getItemStyleCache(shouldResetStyleCacheOnItemSizeChange && itemSize, shouldResetStyleCacheOnItemSizeChange && layout, shouldResetStyleCacheOnItemSizeChange && direction);\n\n        var style;\n\n        if (itemStyleCache.hasOwnProperty(index)) {\n          style = itemStyleCache[index];\n        } else {\n          var _offset = getItemOffset(_this.props, index, _this._instanceProps);\n\n          var size = getItemSize(_this.props, index, _this._instanceProps); // TODO Deprecate direction \"horizontal\"\n\n          var isHorizontal = direction === 'horizontal' || layout === 'horizontal';\n          var isRtl = direction === 'rtl';\n          var offsetHorizontal = isHorizontal ? _offset : 0;\n          itemStyleCache[index] = style = {\n            position: 'absolute',\n            left: isRtl ? undefined : offsetHorizontal,\n            right: isRtl ? offsetHorizontal : undefined,\n            top: !isHorizontal ? _offset : 0,\n            height: !isHorizontal ? size : '100%',\n            width: isHorizontal ? size : '100%'\n          };\n        }\n\n        return style;\n      };\n\n      _this._getItemStyleCache = void 0;\n      _this._getItemStyleCache = memoizeOne(function (_, __, ___) {\n        return {};\n      });\n\n      _this._onScrollHorizontal = function (event) {\n        var _event$currentTarget = event.currentTarget,\n            clientWidth = _event$currentTarget.clientWidth,\n            scrollLeft = _event$currentTarget.scrollLeft,\n            scrollWidth = _event$currentTarget.scrollWidth;\n\n        _this.setState(function (prevState) {\n          if (prevState.scrollOffset === scrollLeft) {\n            // Scroll position may have been updated by cDM/cDU,\n            // In which case we don't need to trigger another render,\n            // And we don't want to update state.isScrolling.\n            return null;\n          }\n\n          var direction = _this.props.direction;\n          var scrollOffset = scrollLeft;\n\n          if (direction === 'rtl') {\n            // TRICKY According to the spec, scrollLeft should be negative for RTL aligned elements.\n            // This is not the case for all browsers though (e.g. Chrome reports values as positive, measured relative to the left).\n            // It's also easier for this component if we convert offsets to the same format as they would be in for ltr.\n            // So the simplest solution is to determine which browser behavior we're dealing with, and convert based on it.\n            switch (getRTLOffsetType()) {\n              case 'negative':\n                scrollOffset = -scrollLeft;\n                break;\n\n              case 'positive-descending':\n                scrollOffset = scrollWidth - clientWidth - scrollLeft;\n                break;\n            }\n          } // Prevent Safari's elastic scrolling from causing visual shaking when scrolling past bounds.\n\n\n          scrollOffset = Math.max(0, Math.min(scrollOffset, scrollWidth - clientWidth));\n          return {\n            isScrolling: true,\n            scrollDirection: prevState.scrollOffset < scrollOffset ? 'forward' : 'backward',\n            scrollOffset: scrollOffset,\n            scrollUpdateWasRequested: false\n          };\n        }, _this._resetIsScrollingDebounced);\n      };\n\n      _this._onScrollVertical = function (event) {\n        var _event$currentTarget2 = event.currentTarget,\n            clientHeight = _event$currentTarget2.clientHeight,\n            scrollHeight = _event$currentTarget2.scrollHeight,\n            scrollTop = _event$currentTarget2.scrollTop;\n\n        _this.setState(function (prevState) {\n          if (prevState.scrollOffset === scrollTop) {\n            // Scroll position may have been updated by cDM/cDU,\n            // In which case we don't need to trigger another render,\n            // And we don't want to update state.isScrolling.\n            return null;\n          } // Prevent Safari's elastic scrolling from causing visual shaking when scrolling past bounds.\n\n\n          var scrollOffset = Math.max(0, Math.min(scrollTop, scrollHeight - clientHeight));\n          return {\n            isScrolling: true,\n            scrollDirection: prevState.scrollOffset < scrollOffset ? 'forward' : 'backward',\n            scrollOffset: scrollOffset,\n            scrollUpdateWasRequested: false\n          };\n        }, _this._resetIsScrollingDebounced);\n      };\n\n      _this._outerRefSetter = function (ref) {\n        var outerRef = _this.props.outerRef;\n        _this._outerRef = ref;\n\n        if (typeof outerRef === 'function') {\n          outerRef(ref);\n        } else if (outerRef != null && typeof outerRef === 'object' && outerRef.hasOwnProperty('current')) {\n          outerRef.current = ref;\n        }\n      };\n\n      _this._resetIsScrollingDebounced = function () {\n        if (_this._resetIsScrollingTimeoutId !== null) {\n          cancelTimeout(_this._resetIsScrollingTimeoutId);\n        }\n\n        _this._resetIsScrollingTimeoutId = requestTimeout(_this._resetIsScrolling, IS_SCROLLING_DEBOUNCE_INTERVAL$1);\n      };\n\n      _this._resetIsScrolling = function () {\n        _this._resetIsScrollingTimeoutId = null;\n\n        _this.setState({\n          isScrolling: false\n        }, function () {\n          // Clear style cache after state update has been committed.\n          // This way we don't break pure sCU for items that don't use isScrolling param.\n          _this._getItemStyleCache(-1, null);\n        });\n      };\n\n      return _this;\n    }\n\n    List.getDerivedStateFromProps = function getDerivedStateFromProps(nextProps, prevState) {\n      validateSharedProps$1(nextProps, prevState);\n      validateProps(nextProps);\n      return null;\n    };\n\n    var _proto = List.prototype;\n\n    _proto.scrollTo = function scrollTo(scrollOffset) {\n      scrollOffset = Math.max(0, scrollOffset);\n      this.setState(function (prevState) {\n        if (prevState.scrollOffset === scrollOffset) {\n          return null;\n        }\n\n        return {\n          scrollDirection: prevState.scrollOffset < scrollOffset ? 'forward' : 'backward',\n          scrollOffset: scrollOffset,\n          scrollUpdateWasRequested: true\n        };\n      }, this._resetIsScrollingDebounced);\n    };\n\n    _proto.scrollToItem = function scrollToItem(index, align) {\n      if (align === void 0) {\n        align = 'auto';\n      }\n\n      var _this$props2 = this.props,\n          itemCount = _this$props2.itemCount,\n          layout = _this$props2.layout;\n      var scrollOffset = this.state.scrollOffset;\n      index = Math.max(0, Math.min(index, itemCount - 1)); // The scrollbar size should be considered when scrolling an item into view, to ensure it's fully visible.\n      // But we only need to account for its size when it's actually visible.\n      // This is an edge case for lists; normally they only scroll in the dominant direction.\n\n      var scrollbarSize = 0;\n\n      if (this._outerRef) {\n        var outerRef = this._outerRef;\n\n        if (layout === 'vertical') {\n          scrollbarSize = outerRef.scrollWidth > outerRef.clientWidth ? getScrollbarSize() : 0;\n        } else {\n          scrollbarSize = outerRef.scrollHeight > outerRef.clientHeight ? getScrollbarSize() : 0;\n        }\n      }\n\n      this.scrollTo(getOffsetForIndexAndAlignment(this.props, index, align, scrollOffset, this._instanceProps, scrollbarSize));\n    };\n\n    _proto.componentDidMount = function componentDidMount() {\n      var _this$props3 = this.props,\n          direction = _this$props3.direction,\n          initialScrollOffset = _this$props3.initialScrollOffset,\n          layout = _this$props3.layout;\n\n      if (typeof initialScrollOffset === 'number' && this._outerRef != null) {\n        var outerRef = this._outerRef; // TODO Deprecate direction \"horizontal\"\n\n        if (direction === 'horizontal' || layout === 'horizontal') {\n          outerRef.scrollLeft = initialScrollOffset;\n        } else {\n          outerRef.scrollTop = initialScrollOffset;\n        }\n      }\n\n      this._callPropsCallbacks();\n    };\n\n    _proto.componentDidUpdate = function componentDidUpdate() {\n      var _this$props4 = this.props,\n          direction = _this$props4.direction,\n          layout = _this$props4.layout;\n      var _this$state = this.state,\n          scrollOffset = _this$state.scrollOffset,\n          scrollUpdateWasRequested = _this$state.scrollUpdateWasRequested;\n\n      if (scrollUpdateWasRequested && this._outerRef != null) {\n        var outerRef = this._outerRef; // TODO Deprecate direction \"horizontal\"\n\n        if (direction === 'horizontal' || layout === 'horizontal') {\n          if (direction === 'rtl') {\n            // TRICKY According to the spec, scrollLeft should be negative for RTL aligned elements.\n            // This is not the case for all browsers though (e.g. Chrome reports values as positive, measured relative to the left).\n            // So we need to determine which browser behavior we're dealing with, and mimic it.\n            switch (getRTLOffsetType()) {\n              case 'negative':\n                outerRef.scrollLeft = -scrollOffset;\n                break;\n\n              case 'positive-ascending':\n                outerRef.scrollLeft = scrollOffset;\n                break;\n\n              default:\n                var clientWidth = outerRef.clientWidth,\n                    scrollWidth = outerRef.scrollWidth;\n                outerRef.scrollLeft = scrollWidth - clientWidth - scrollOffset;\n                break;\n            }\n          } else {\n            outerRef.scrollLeft = scrollOffset;\n          }\n        } else {\n          outerRef.scrollTop = scrollOffset;\n        }\n      }\n\n      this._callPropsCallbacks();\n    };\n\n    _proto.componentWillUnmount = function componentWillUnmount() {\n      if (this._resetIsScrollingTimeoutId !== null) {\n        cancelTimeout(this._resetIsScrollingTimeoutId);\n      }\n    };\n\n    _proto.render = function render() {\n      var _this$props5 = this.props,\n          children = _this$props5.children,\n          className = _this$props5.className,\n          direction = _this$props5.direction,\n          height = _this$props5.height,\n          innerRef = _this$props5.innerRef,\n          innerElementType = _this$props5.innerElementType,\n          innerTagName = _this$props5.innerTagName,\n          itemCount = _this$props5.itemCount,\n          itemData = _this$props5.itemData,\n          _this$props5$itemKey = _this$props5.itemKey,\n          itemKey = _this$props5$itemKey === void 0 ? defaultItemKey$1 : _this$props5$itemKey,\n          layout = _this$props5.layout,\n          outerElementType = _this$props5.outerElementType,\n          outerTagName = _this$props5.outerTagName,\n          style = _this$props5.style,\n          useIsScrolling = _this$props5.useIsScrolling,\n          width = _this$props5.width;\n      var isScrolling = this.state.isScrolling; // TODO Deprecate direction \"horizontal\"\n\n      var isHorizontal = direction === 'horizontal' || layout === 'horizontal';\n      var onScroll = isHorizontal ? this._onScrollHorizontal : this._onScrollVertical;\n\n      var _this$_getRangeToRend = this._getRangeToRender(),\n          startIndex = _this$_getRangeToRend[0],\n          stopIndex = _this$_getRangeToRend[1];\n\n      var items = [];\n\n      if (itemCount > 0) {\n        for (var _index = startIndex; _index <= stopIndex; _index++) {\n          items.push(createElement(children, {\n            data: itemData,\n            key: itemKey(_index, itemData),\n            index: _index,\n            isScrolling: useIsScrolling ? isScrolling : undefined,\n            style: this._getItemStyle(_index)\n          }));\n        }\n      } // Read this value AFTER items have been created,\n      // So their actual sizes (if variable) are taken into consideration.\n\n\n      var estimatedTotalSize = getEstimatedTotalSize(this.props, this._instanceProps);\n      return createElement(outerElementType || outerTagName || 'div', {\n        className: className,\n        onScroll: onScroll,\n        ref: this._outerRefSetter,\n        style: _extends({\n          position: 'relative',\n          height: height,\n          width: width,\n          overflow: 'auto',\n          WebkitOverflowScrolling: 'touch',\n          willChange: 'transform',\n          direction: direction\n        }, style)\n      }, createElement(innerElementType || innerTagName || 'div', {\n        children: items,\n        ref: innerRef,\n        style: {\n          height: isHorizontal ? '100%' : estimatedTotalSize,\n          pointerEvents: isScrolling ? 'none' : undefined,\n          width: isHorizontal ? estimatedTotalSize : '100%'\n        }\n      }));\n    };\n\n    _proto._callPropsCallbacks = function _callPropsCallbacks() {\n      if (typeof this.props.onItemsRendered === 'function') {\n        var itemCount = this.props.itemCount;\n\n        if (itemCount > 0) {\n          var _this$_getRangeToRend2 = this._getRangeToRender(),\n              _overscanStartIndex = _this$_getRangeToRend2[0],\n              _overscanStopIndex = _this$_getRangeToRend2[1],\n              _visibleStartIndex = _this$_getRangeToRend2[2],\n              _visibleStopIndex = _this$_getRangeToRend2[3];\n\n          this._callOnItemsRendered(_overscanStartIndex, _overscanStopIndex, _visibleStartIndex, _visibleStopIndex);\n        }\n      }\n\n      if (typeof this.props.onScroll === 'function') {\n        var _this$state2 = this.state,\n            _scrollDirection = _this$state2.scrollDirection,\n            _scrollOffset = _this$state2.scrollOffset,\n            _scrollUpdateWasRequested = _this$state2.scrollUpdateWasRequested;\n\n        this._callOnScroll(_scrollDirection, _scrollOffset, _scrollUpdateWasRequested);\n      }\n    } // Lazily create and cache item styles while scrolling,\n    // So that pure component sCU will prevent re-renders.\n    // We maintain this cache, and pass a style prop rather than index,\n    // So that List can clear cached styles and force item re-render if necessary.\n    ;\n\n    _proto._getRangeToRender = function _getRangeToRender() {\n      var _this$props6 = this.props,\n          itemCount = _this$props6.itemCount,\n          overscanCount = _this$props6.overscanCount;\n      var _this$state3 = this.state,\n          isScrolling = _this$state3.isScrolling,\n          scrollDirection = _this$state3.scrollDirection,\n          scrollOffset = _this$state3.scrollOffset;\n\n      if (itemCount === 0) {\n        return [0, 0, 0, 0];\n      }\n\n      var startIndex = getStartIndexForOffset(this.props, scrollOffset, this._instanceProps);\n      var stopIndex = getStopIndexForStartIndex(this.props, startIndex, scrollOffset, this._instanceProps); // Overscan by one item in each direction so that tab/focus works.\n      // If there isn't at least one extra item, tab loops back around.\n\n      var overscanBackward = !isScrolling || scrollDirection === 'backward' ? Math.max(1, overscanCount) : 1;\n      var overscanForward = !isScrolling || scrollDirection === 'forward' ? Math.max(1, overscanCount) : 1;\n      return [Math.max(0, startIndex - overscanBackward), Math.max(0, Math.min(itemCount - 1, stopIndex + overscanForward)), startIndex, stopIndex];\n    };\n\n    return List;\n  }(PureComponent), _class.defaultProps = {\n    direction: 'ltr',\n    itemData: undefined,\n    layout: 'vertical',\n    overscanCount: 2,\n    useIsScrolling: false\n  }, _class;\n} // NOTE: I considered further wrapping individual items with a pure ListItem component.\n// This would avoid ever calling the render function for the same index more than once,\n// But it would also add the overhead of a lot of components/fibers.\n// I assume people already do this (render function returning a class component),\n// So my doing it would just unnecessarily double the wrappers.\n\nvar validateSharedProps$1 = function validateSharedProps(_ref2, _ref3) {\n  var children = _ref2.children,\n      direction = _ref2.direction,\n      height = _ref2.height,\n      layout = _ref2.layout,\n      innerTagName = _ref2.innerTagName,\n      outerTagName = _ref2.outerTagName,\n      width = _ref2.width;\n  var instance = _ref3.instance;\n\n  if (process.env.NODE_ENV !== 'production') {\n    if (innerTagName != null || outerTagName != null) {\n      if (devWarningsTagName$1 && !devWarningsTagName$1.has(instance)) {\n        devWarningsTagName$1.add(instance);\n        console.warn('The innerTagName and outerTagName props have been deprecated. ' + 'Please use the innerElementType and outerElementType props instead.');\n      }\n    } // TODO Deprecate direction \"horizontal\"\n\n\n    var isHorizontal = direction === 'horizontal' || layout === 'horizontal';\n\n    switch (direction) {\n      case 'horizontal':\n      case 'vertical':\n        if (devWarningsDirection && !devWarningsDirection.has(instance)) {\n          devWarningsDirection.add(instance);\n          console.warn('The direction prop should be either \"ltr\" (default) or \"rtl\". ' + 'Please use the layout prop to specify \"vertical\" (default) or \"horizontal\" orientation.');\n        }\n\n        break;\n\n      case 'ltr':\n      case 'rtl':\n        // Valid values\n        break;\n\n      default:\n        throw Error('An invalid \"direction\" prop has been specified. ' + 'Value should be either \"ltr\" or \"rtl\". ' + (\"\\\"\" + direction + \"\\\" was specified.\"));\n    }\n\n    switch (layout) {\n      case 'horizontal':\n      case 'vertical':\n        // Valid values\n        break;\n\n      default:\n        throw Error('An invalid \"layout\" prop has been specified. ' + 'Value should be either \"horizontal\" or \"vertical\". ' + (\"\\\"\" + layout + \"\\\" was specified.\"));\n    }\n\n    if (children == null) {\n      throw Error('An invalid \"children\" prop has been specified. ' + 'Value should be a React component. ' + (\"\\\"\" + (children === null ? 'null' : typeof children) + \"\\\" was specified.\"));\n    }\n\n    if (isHorizontal && typeof width !== 'number') {\n      throw Error('An invalid \"width\" prop has been specified. ' + 'Horizontal lists must specify a number for width. ' + (\"\\\"\" + (width === null ? 'null' : typeof width) + \"\\\" was specified.\"));\n    } else if (!isHorizontal && typeof height !== 'number') {\n      throw Error('An invalid \"height\" prop has been specified. ' + 'Vertical lists must specify a number for height. ' + (\"\\\"\" + (height === null ? 'null' : typeof height) + \"\\\" was specified.\"));\n    }\n  }\n};\n\nvar DEFAULT_ESTIMATED_ITEM_SIZE$1 = 50;\n\nvar getItemMetadata$1 = function getItemMetadata(props, index, instanceProps) {\n  var _ref = props,\n      itemSize = _ref.itemSize;\n  var itemMetadataMap = instanceProps.itemMetadataMap,\n      lastMeasuredIndex = instanceProps.lastMeasuredIndex;\n\n  if (index > lastMeasuredIndex) {\n    var offset = 0;\n\n    if (lastMeasuredIndex >= 0) {\n      var itemMetadata = itemMetadataMap[lastMeasuredIndex];\n      offset = itemMetadata.offset + itemMetadata.size;\n    }\n\n    for (var i = lastMeasuredIndex + 1; i <= index; i++) {\n      var size = itemSize(i);\n      itemMetadataMap[i] = {\n        offset: offset,\n        size: size\n      };\n      offset += size;\n    }\n\n    instanceProps.lastMeasuredIndex = index;\n  }\n\n  return itemMetadataMap[index];\n};\n\nvar findNearestItem$1 = function findNearestItem(props, instanceProps, offset) {\n  var itemMetadataMap = instanceProps.itemMetadataMap,\n      lastMeasuredIndex = instanceProps.lastMeasuredIndex;\n  var lastMeasuredItemOffset = lastMeasuredIndex > 0 ? itemMetadataMap[lastMeasuredIndex].offset : 0;\n\n  if (lastMeasuredItemOffset >= offset) {\n    // If we've already measured items within this range just use a binary search as it's faster.\n    return findNearestItemBinarySearch$1(props, instanceProps, lastMeasuredIndex, 0, offset);\n  } else {\n    // If we haven't yet measured this high, fallback to an exponential search with an inner binary search.\n    // The exponential search avoids pre-computing sizes for the full set of items as a binary search would.\n    // The overall complexity for this approach is O(log n).\n    return findNearestItemExponentialSearch$1(props, instanceProps, Math.max(0, lastMeasuredIndex), offset);\n  }\n};\n\nvar findNearestItemBinarySearch$1 = function findNearestItemBinarySearch(props, instanceProps, high, low, offset) {\n  while (low <= high) {\n    var middle = low + Math.floor((high - low) / 2);\n    var currentOffset = getItemMetadata$1(props, middle, instanceProps).offset;\n\n    if (currentOffset === offset) {\n      return middle;\n    } else if (currentOffset < offset) {\n      low = middle + 1;\n    } else if (currentOffset > offset) {\n      high = middle - 1;\n    }\n  }\n\n  if (low > 0) {\n    return low - 1;\n  } else {\n    return 0;\n  }\n};\n\nvar findNearestItemExponentialSearch$1 = function findNearestItemExponentialSearch(props, instanceProps, index, offset) {\n  var itemCount = props.itemCount;\n  var interval = 1;\n\n  while (index < itemCount && getItemMetadata$1(props, index, instanceProps).offset < offset) {\n    index += interval;\n    interval *= 2;\n  }\n\n  return findNearestItemBinarySearch$1(props, instanceProps, Math.min(index, itemCount - 1), Math.floor(index / 2), offset);\n};\n\nvar getEstimatedTotalSize = function getEstimatedTotalSize(_ref2, _ref3) {\n  var itemCount = _ref2.itemCount;\n  var itemMetadataMap = _ref3.itemMetadataMap,\n      estimatedItemSize = _ref3.estimatedItemSize,\n      lastMeasuredIndex = _ref3.lastMeasuredIndex;\n  var totalSizeOfMeasuredItems = 0; // Edge case check for when the number of items decreases while a scroll is in progress.\n  // https://github.com/bvaughn/react-window/pull/138\n\n  if (lastMeasuredIndex >= itemCount) {\n    lastMeasuredIndex = itemCount - 1;\n  }\n\n  if (lastMeasuredIndex >= 0) {\n    var itemMetadata = itemMetadataMap[lastMeasuredIndex];\n    totalSizeOfMeasuredItems = itemMetadata.offset + itemMetadata.size;\n  }\n\n  var numUnmeasuredItems = itemCount - lastMeasuredIndex - 1;\n  var totalSizeOfUnmeasuredItems = numUnmeasuredItems * estimatedItemSize;\n  return totalSizeOfMeasuredItems + totalSizeOfUnmeasuredItems;\n};\n\nvar VariableSizeList = /*#__PURE__*/createListComponent({\n  getItemOffset: function getItemOffset(props, index, instanceProps) {\n    return getItemMetadata$1(props, index, instanceProps).offset;\n  },\n  getItemSize: function getItemSize(props, index, instanceProps) {\n    return instanceProps.itemMetadataMap[index].size;\n  },\n  getEstimatedTotalSize: getEstimatedTotalSize,\n  getOffsetForIndexAndAlignment: function getOffsetForIndexAndAlignment(props, index, align, scrollOffset, instanceProps, scrollbarSize) {\n    var direction = props.direction,\n        height = props.height,\n        layout = props.layout,\n        width = props.width; // TODO Deprecate direction \"horizontal\"\n\n    var isHorizontal = direction === 'horizontal' || layout === 'horizontal';\n    var size = isHorizontal ? width : height;\n    var itemMetadata = getItemMetadata$1(props, index, instanceProps); // Get estimated total size after ItemMetadata is computed,\n    // To ensure it reflects actual measurements instead of just estimates.\n\n    var estimatedTotalSize = getEstimatedTotalSize(props, instanceProps);\n    var maxOffset = Math.max(0, Math.min(estimatedTotalSize - size, itemMetadata.offset));\n    var minOffset = Math.max(0, itemMetadata.offset - size + itemMetadata.size + scrollbarSize);\n\n    if (align === 'smart') {\n      if (scrollOffset >= minOffset - size && scrollOffset <= maxOffset + size) {\n        align = 'auto';\n      } else {\n        align = 'center';\n      }\n    }\n\n    switch (align) {\n      case 'start':\n        return maxOffset;\n\n      case 'end':\n        return minOffset;\n\n      case 'center':\n        return Math.round(minOffset + (maxOffset - minOffset) / 2);\n\n      case 'auto':\n      default:\n        if (scrollOffset >= minOffset && scrollOffset <= maxOffset) {\n          return scrollOffset;\n        } else if (scrollOffset < minOffset) {\n          return minOffset;\n        } else {\n          return maxOffset;\n        }\n\n    }\n  },\n  getStartIndexForOffset: function getStartIndexForOffset(props, offset, instanceProps) {\n    return findNearestItem$1(props, instanceProps, offset);\n  },\n  getStopIndexForStartIndex: function getStopIndexForStartIndex(props, startIndex, scrollOffset, instanceProps) {\n    var direction = props.direction,\n        height = props.height,\n        itemCount = props.itemCount,\n        layout = props.layout,\n        width = props.width; // TODO Deprecate direction \"horizontal\"\n\n    var isHorizontal = direction === 'horizontal' || layout === 'horizontal';\n    var size = isHorizontal ? width : height;\n    var itemMetadata = getItemMetadata$1(props, startIndex, instanceProps);\n    var maxOffset = scrollOffset + size;\n    var offset = itemMetadata.offset + itemMetadata.size;\n    var stopIndex = startIndex;\n\n    while (stopIndex < itemCount - 1 && offset < maxOffset) {\n      stopIndex++;\n      offset += getItemMetadata$1(props, stopIndex, instanceProps).size;\n    }\n\n    return stopIndex;\n  },\n  initInstanceProps: function initInstanceProps(props, instance) {\n    var _ref4 = props,\n        estimatedItemSize = _ref4.estimatedItemSize;\n    var instanceProps = {\n      itemMetadataMap: {},\n      estimatedItemSize: estimatedItemSize || DEFAULT_ESTIMATED_ITEM_SIZE$1,\n      lastMeasuredIndex: -1\n    };\n\n    instance.resetAfterIndex = function (index, shouldForceUpdate) {\n      if (shouldForceUpdate === void 0) {\n        shouldForceUpdate = true;\n      }\n\n      instanceProps.lastMeasuredIndex = Math.min(instanceProps.lastMeasuredIndex, index - 1); // We could potentially optimize further by only evicting styles after this index,\n      // But since styles are only cached while scrolling is in progress-\n      // It seems an unnecessary optimization.\n      // It's unlikely that resetAfterIndex() will be called while a user is scrolling.\n\n      instance._getItemStyleCache(-1);\n\n      if (shouldForceUpdate) {\n        instance.forceUpdate();\n      }\n    };\n\n    return instanceProps;\n  },\n  shouldResetStyleCacheOnItemSizeChange: false,\n  validateProps: function validateProps(_ref5) {\n    var itemSize = _ref5.itemSize;\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (typeof itemSize !== 'function') {\n        throw Error('An invalid \"itemSize\" prop has been specified. ' + 'Value should be a function. ' + (\"\\\"\" + (itemSize === null ? 'null' : typeof itemSize) + \"\\\" was specified.\"));\n      }\n    }\n  }\n});\n\nvar FixedSizeGrid = /*#__PURE__*/createGridComponent({\n  getColumnOffset: function getColumnOffset(_ref, index) {\n    var columnWidth = _ref.columnWidth;\n    return index * columnWidth;\n  },\n  getColumnWidth: function getColumnWidth(_ref2, index) {\n    var columnWidth = _ref2.columnWidth;\n    return columnWidth;\n  },\n  getRowOffset: function getRowOffset(_ref3, index) {\n    var rowHeight = _ref3.rowHeight;\n    return index * rowHeight;\n  },\n  getRowHeight: function getRowHeight(_ref4, index) {\n    var rowHeight = _ref4.rowHeight;\n    return rowHeight;\n  },\n  getEstimatedTotalHeight: function getEstimatedTotalHeight(_ref5) {\n    var rowCount = _ref5.rowCount,\n        rowHeight = _ref5.rowHeight;\n    return rowHeight * rowCount;\n  },\n  getEstimatedTotalWidth: function getEstimatedTotalWidth(_ref6) {\n    var columnCount = _ref6.columnCount,\n        columnWidth = _ref6.columnWidth;\n    return columnWidth * columnCount;\n  },\n  getOffsetForColumnAndAlignment: function getOffsetForColumnAndAlignment(_ref7, columnIndex, align, scrollLeft, instanceProps, scrollbarSize) {\n    var columnCount = _ref7.columnCount,\n        columnWidth = _ref7.columnWidth,\n        width = _ref7.width;\n    var lastColumnOffset = Math.max(0, columnCount * columnWidth - width);\n    var maxOffset = Math.min(lastColumnOffset, columnIndex * columnWidth);\n    var minOffset = Math.max(0, columnIndex * columnWidth - width + scrollbarSize + columnWidth);\n\n    if (align === 'smart') {\n      if (scrollLeft >= minOffset - width && scrollLeft <= maxOffset + width) {\n        align = 'auto';\n      } else {\n        align = 'center';\n      }\n    }\n\n    switch (align) {\n      case 'start':\n        return maxOffset;\n\n      case 'end':\n        return minOffset;\n\n      case 'center':\n        // \"Centered\" offset is usually the average of the min and max.\n        // But near the edges of the list, this doesn't hold true.\n        var middleOffset = Math.round(minOffset + (maxOffset - minOffset) / 2);\n\n        if (middleOffset < Math.ceil(width / 2)) {\n          return 0; // near the beginning\n        } else if (middleOffset > lastColumnOffset + Math.floor(width / 2)) {\n          return lastColumnOffset; // near the end\n        } else {\n          return middleOffset;\n        }\n\n      case 'auto':\n      default:\n        if (scrollLeft >= minOffset && scrollLeft <= maxOffset) {\n          return scrollLeft;\n        } else if (minOffset > maxOffset) {\n          // Because we only take into account the scrollbar size when calculating minOffset\n          // this value can be larger than maxOffset when at the end of the list\n          return minOffset;\n        } else if (scrollLeft < minOffset) {\n          return minOffset;\n        } else {\n          return maxOffset;\n        }\n\n    }\n  },\n  getOffsetForRowAndAlignment: function getOffsetForRowAndAlignment(_ref8, rowIndex, align, scrollTop, instanceProps, scrollbarSize) {\n    var rowHeight = _ref8.rowHeight,\n        height = _ref8.height,\n        rowCount = _ref8.rowCount;\n    var lastRowOffset = Math.max(0, rowCount * rowHeight - height);\n    var maxOffset = Math.min(lastRowOffset, rowIndex * rowHeight);\n    var minOffset = Math.max(0, rowIndex * rowHeight - height + scrollbarSize + rowHeight);\n\n    if (align === 'smart') {\n      if (scrollTop >= minOffset - height && scrollTop <= maxOffset + height) {\n        align = 'auto';\n      } else {\n        align = 'center';\n      }\n    }\n\n    switch (align) {\n      case 'start':\n        return maxOffset;\n\n      case 'end':\n        return minOffset;\n\n      case 'center':\n        // \"Centered\" offset is usually the average of the min and max.\n        // But near the edges of the list, this doesn't hold true.\n        var middleOffset = Math.round(minOffset + (maxOffset - minOffset) / 2);\n\n        if (middleOffset < Math.ceil(height / 2)) {\n          return 0; // near the beginning\n        } else if (middleOffset > lastRowOffset + Math.floor(height / 2)) {\n          return lastRowOffset; // near the end\n        } else {\n          return middleOffset;\n        }\n\n      case 'auto':\n      default:\n        if (scrollTop >= minOffset && scrollTop <= maxOffset) {\n          return scrollTop;\n        } else if (minOffset > maxOffset) {\n          // Because we only take into account the scrollbar size when calculating minOffset\n          // this value can be larger than maxOffset when at the end of the list\n          return minOffset;\n        } else if (scrollTop < minOffset) {\n          return minOffset;\n        } else {\n          return maxOffset;\n        }\n\n    }\n  },\n  getColumnStartIndexForOffset: function getColumnStartIndexForOffset(_ref9, scrollLeft) {\n    var columnWidth = _ref9.columnWidth,\n        columnCount = _ref9.columnCount;\n    return Math.max(0, Math.min(columnCount - 1, Math.floor(scrollLeft / columnWidth)));\n  },\n  getColumnStopIndexForStartIndex: function getColumnStopIndexForStartIndex(_ref10, startIndex, scrollLeft) {\n    var columnWidth = _ref10.columnWidth,\n        columnCount = _ref10.columnCount,\n        width = _ref10.width;\n    var left = startIndex * columnWidth;\n    var numVisibleColumns = Math.ceil((width + scrollLeft - left) / columnWidth);\n    return Math.max(0, Math.min(columnCount - 1, startIndex + numVisibleColumns - 1 // -1 is because stop index is inclusive\n    ));\n  },\n  getRowStartIndexForOffset: function getRowStartIndexForOffset(_ref11, scrollTop) {\n    var rowHeight = _ref11.rowHeight,\n        rowCount = _ref11.rowCount;\n    return Math.max(0, Math.min(rowCount - 1, Math.floor(scrollTop / rowHeight)));\n  },\n  getRowStopIndexForStartIndex: function getRowStopIndexForStartIndex(_ref12, startIndex, scrollTop) {\n    var rowHeight = _ref12.rowHeight,\n        rowCount = _ref12.rowCount,\n        height = _ref12.height;\n    var top = startIndex * rowHeight;\n    var numVisibleRows = Math.ceil((height + scrollTop - top) / rowHeight);\n    return Math.max(0, Math.min(rowCount - 1, startIndex + numVisibleRows - 1 // -1 is because stop index is inclusive\n    ));\n  },\n  initInstanceProps: function initInstanceProps(props) {// Noop\n  },\n  shouldResetStyleCacheOnItemSizeChange: true,\n  validateProps: function validateProps(_ref13) {\n    var columnWidth = _ref13.columnWidth,\n        rowHeight = _ref13.rowHeight;\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (typeof columnWidth !== 'number') {\n        throw Error('An invalid \"columnWidth\" prop has been specified. ' + 'Value should be a number. ' + (\"\\\"\" + (columnWidth === null ? 'null' : typeof columnWidth) + \"\\\" was specified.\"));\n      }\n\n      if (typeof rowHeight !== 'number') {\n        throw Error('An invalid \"rowHeight\" prop has been specified. ' + 'Value should be a number. ' + (\"\\\"\" + (rowHeight === null ? 'null' : typeof rowHeight) + \"\\\" was specified.\"));\n      }\n    }\n  }\n});\n\nvar FixedSizeList = /*#__PURE__*/createListComponent({\n  getItemOffset: function getItemOffset(_ref, index) {\n    var itemSize = _ref.itemSize;\n    return index * itemSize;\n  },\n  getItemSize: function getItemSize(_ref2, index) {\n    var itemSize = _ref2.itemSize;\n    return itemSize;\n  },\n  getEstimatedTotalSize: function getEstimatedTotalSize(_ref3) {\n    var itemCount = _ref3.itemCount,\n        itemSize = _ref3.itemSize;\n    return itemSize * itemCount;\n  },\n  getOffsetForIndexAndAlignment: function getOffsetForIndexAndAlignment(_ref4, index, align, scrollOffset, instanceProps, scrollbarSize) {\n    var direction = _ref4.direction,\n        height = _ref4.height,\n        itemCount = _ref4.itemCount,\n        itemSize = _ref4.itemSize,\n        layout = _ref4.layout,\n        width = _ref4.width;\n    // TODO Deprecate direction \"horizontal\"\n    var isHorizontal = direction === 'horizontal' || layout === 'horizontal';\n    var size = isHorizontal ? width : height;\n    var lastItemOffset = Math.max(0, itemCount * itemSize - size);\n    var maxOffset = Math.min(lastItemOffset, index * itemSize);\n    var minOffset = Math.max(0, index * itemSize - size + itemSize + scrollbarSize);\n\n    if (align === 'smart') {\n      if (scrollOffset >= minOffset - size && scrollOffset <= maxOffset + size) {\n        align = 'auto';\n      } else {\n        align = 'center';\n      }\n    }\n\n    switch (align) {\n      case 'start':\n        return maxOffset;\n\n      case 'end':\n        return minOffset;\n\n      case 'center':\n        {\n          // \"Centered\" offset is usually the average of the min and max.\n          // But near the edges of the list, this doesn't hold true.\n          var middleOffset = Math.round(minOffset + (maxOffset - minOffset) / 2);\n\n          if (middleOffset < Math.ceil(size / 2)) {\n            return 0; // near the beginning\n          } else if (middleOffset > lastItemOffset + Math.floor(size / 2)) {\n            return lastItemOffset; // near the end\n          } else {\n            return middleOffset;\n          }\n        }\n\n      case 'auto':\n      default:\n        if (scrollOffset >= minOffset && scrollOffset <= maxOffset) {\n          return scrollOffset;\n        } else if (scrollOffset < minOffset) {\n          return minOffset;\n        } else {\n          return maxOffset;\n        }\n\n    }\n  },\n  getStartIndexForOffset: function getStartIndexForOffset(_ref5, offset) {\n    var itemCount = _ref5.itemCount,\n        itemSize = _ref5.itemSize;\n    return Math.max(0, Math.min(itemCount - 1, Math.floor(offset / itemSize)));\n  },\n  getStopIndexForStartIndex: function getStopIndexForStartIndex(_ref6, startIndex, scrollOffset) {\n    var direction = _ref6.direction,\n        height = _ref6.height,\n        itemCount = _ref6.itemCount,\n        itemSize = _ref6.itemSize,\n        layout = _ref6.layout,\n        width = _ref6.width;\n    // TODO Deprecate direction \"horizontal\"\n    var isHorizontal = direction === 'horizontal' || layout === 'horizontal';\n    var offset = startIndex * itemSize;\n    var size = isHorizontal ? width : height;\n    var numVisibleItems = Math.ceil((size + scrollOffset - offset) / itemSize);\n    return Math.max(0, Math.min(itemCount - 1, startIndex + numVisibleItems - 1 // -1 is because stop index is inclusive\n    ));\n  },\n  initInstanceProps: function initInstanceProps(props) {// Noop\n  },\n  shouldResetStyleCacheOnItemSizeChange: true,\n  validateProps: function validateProps(_ref7) {\n    var itemSize = _ref7.itemSize;\n\n    if (process.env.NODE_ENV !== 'production') {\n      if (typeof itemSize !== 'number') {\n        throw Error('An invalid \"itemSize\" prop has been specified. ' + 'Value should be a number. ' + (\"\\\"\" + (itemSize === null ? 'null' : typeof itemSize) + \"\\\" was specified.\"));\n      }\n    }\n  }\n});\n\n// Pulled from react-compat\n// https://github.com/developit/preact-compat/blob/7c5de00e7c85e2ffd011bf3af02899b63f699d3a/src/index.js#L349\nfunction shallowDiffers(prev, next) {\n  for (var attribute in prev) {\n    if (!(attribute in next)) {\n      return true;\n    }\n  }\n\n  for (var _attribute in next) {\n    if (prev[_attribute] !== next[_attribute]) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nvar _excluded = [\"style\"],\n    _excluded2 = [\"style\"];\n// It knows to compare individual style props and ignore the wrapper object.\n// See https://reactjs.org/docs/react-api.html#reactmemo\n\nfunction areEqual(prevProps, nextProps) {\n  var prevStyle = prevProps.style,\n      prevRest = _objectWithoutPropertiesLoose(prevProps, _excluded);\n\n  var nextStyle = nextProps.style,\n      nextRest = _objectWithoutPropertiesLoose(nextProps, _excluded2);\n\n  return !shallowDiffers(prevStyle, nextStyle) && !shallowDiffers(prevRest, nextRest);\n}\n\n// It knows to compare individual style props and ignore the wrapper object.\n// See https://reactjs.org/docs/react-component.html#shouldcomponentupdate\n\nfunction shouldComponentUpdate(nextProps, nextState) {\n  return !areEqual(this.props, nextProps) || shallowDiffers(this.state, nextState);\n}\n\nexport { FixedSizeGrid, FixedSizeList, VariableSizeGrid, VariableSizeList, areEqual, shouldComponentUpdate };\n//# sourceMappingURL=index.esm.js.map\n","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.autoprefix = undefined;\n\nvar _forOwn2 = require('lodash/forOwn');\n\nvar _forOwn3 = _interopRequireDefault(_forOwn2);\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar transforms = {\n  borderRadius: function borderRadius(value) {\n    return {\n      msBorderRadius: value,\n      MozBorderRadius: value,\n      OBorderRadius: value,\n      WebkitBorderRadius: value,\n      borderRadius: value\n    };\n  },\n  boxShadow: function boxShadow(value) {\n    return {\n      msBoxShadow: value,\n      MozBoxShadow: value,\n      OBoxShadow: value,\n      WebkitBoxShadow: value,\n      boxShadow: value\n    };\n  },\n  userSelect: function userSelect(value) {\n    return {\n      WebkitTouchCallout: value,\n      KhtmlUserSelect: value,\n      MozUserSelect: value,\n      msUserSelect: value,\n      WebkitUserSelect: value,\n      userSelect: value\n    };\n  },\n\n  flex: function flex(value) {\n    return {\n      WebkitBoxFlex: value,\n      MozBoxFlex: value,\n      WebkitFlex: value,\n      msFlex: value,\n      flex: value\n    };\n  },\n  flexBasis: function flexBasis(value) {\n    return {\n      WebkitFlexBasis: value,\n      flexBasis: value\n    };\n  },\n  justifyContent: function justifyContent(value) {\n    return {\n      WebkitJustifyContent: value,\n      justifyContent: value\n    };\n  },\n\n  transition: function transition(value) {\n    return {\n      msTransition: value,\n      MozTransition: value,\n      OTransition: value,\n      WebkitTransition: value,\n      transition: value\n    };\n  },\n\n  transform: function transform(value) {\n    return {\n      msTransform: value,\n      MozTransform: value,\n      OTransform: value,\n      WebkitTransform: value,\n      transform: value\n    };\n  },\n  absolute: function absolute(value) {\n    var direction = value && value.split(' ');\n    return {\n      position: 'absolute',\n      top: direction && direction[0],\n      right: direction && direction[1],\n      bottom: direction && direction[2],\n      left: direction && direction[3]\n    };\n  },\n  extend: function extend(name, otherElementStyles) {\n    var otherStyle = otherElementStyles[name];\n    if (otherStyle) {\n      return otherStyle;\n    }\n    return {\n      'extend': name\n    };\n  }\n};\n\nvar autoprefix = exports.autoprefix = function autoprefix(elements) {\n  var prefixed = {};\n  (0, _forOwn3.default)(elements, function (styles, element) {\n    var expanded = {};\n    (0, _forOwn3.default)(styles, function (value, key) {\n      var transform = transforms[key];\n      if (transform) {\n        expanded = _extends({}, expanded, transform(value));\n      } else {\n        expanded[key] = value;\n      }\n    });\n    prefixed[element] = expanded;\n  });\n  return prefixed;\n};\n\nexports.default = autoprefix;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.active = undefined;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar active = exports.active = function active(Component) {\n  var Span = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'span';\n\n  return function (_React$Component) {\n    _inherits(Active, _React$Component);\n\n    function Active() {\n      var _ref;\n\n      var _temp, _this, _ret;\n\n      _classCallCheck(this, Active);\n\n      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = Active.__proto__ || Object.getPrototypeOf(Active)).call.apply(_ref, [this].concat(args))), _this), _this.state = { active: false }, _this.handleMouseDown = function () {\n        return _this.setState({ active: true });\n      }, _this.handleMouseUp = function () {\n        return _this.setState({ active: false });\n      }, _this.render = function () {\n        return _react2.default.createElement(\n          Span,\n          { onMouseDown: _this.handleMouseDown, onMouseUp: _this.handleMouseUp },\n          _react2.default.createElement(Component, _extends({}, _this.props, _this.state))\n        );\n      }, _temp), _possibleConstructorReturn(_this, _ret);\n    }\n\n    return Active;\n  }(_react2.default.Component);\n};\n\nexports.default = active;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.hover = undefined;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar hover = exports.hover = function hover(Component) {\n  var Span = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'span';\n\n  return function (_React$Component) {\n    _inherits(Hover, _React$Component);\n\n    function Hover() {\n      var _ref;\n\n      var _temp, _this, _ret;\n\n      _classCallCheck(this, Hover);\n\n      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      return _ret = (_temp = (_this = _possibleConstructorReturn(this, (_ref = Hover.__proto__ || Object.getPrototypeOf(Hover)).call.apply(_ref, [this].concat(args))), _this), _this.state = { hover: false }, _this.handleMouseOver = function () {\n        return _this.setState({ hover: true });\n      }, _this.handleMouseOut = function () {\n        return _this.setState({ hover: false });\n      }, _this.render = function () {\n        return _react2.default.createElement(\n          Span,\n          { onMouseOver: _this.handleMouseOver, onMouseOut: _this.handleMouseOut },\n          _react2.default.createElement(Component, _extends({}, _this.props, _this.state))\n        );\n      }, _temp), _possibleConstructorReturn(_this, _ret);\n    }\n\n    return Hover;\n  }(_react2.default.Component);\n};\n\nexports.default = hover;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.flattenNames = undefined;\n\nvar _isString2 = require('lodash/isString');\n\nvar _isString3 = _interopRequireDefault(_isString2);\n\nvar _forOwn2 = require('lodash/forOwn');\n\nvar _forOwn3 = _interopRequireDefault(_forOwn2);\n\nvar _isPlainObject2 = require('lodash/isPlainObject');\n\nvar _isPlainObject3 = _interopRequireDefault(_isPlainObject2);\n\nvar _map2 = require('lodash/map');\n\nvar _map3 = _interopRequireDefault(_map2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar flattenNames = exports.flattenNames = function flattenNames() {\n  var things = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n\n  var names = [];\n\n  (0, _map3.default)(things, function (thing) {\n    if (Array.isArray(thing)) {\n      flattenNames(thing).map(function (name) {\n        return names.push(name);\n      });\n    } else if ((0, _isPlainObject3.default)(thing)) {\n      (0, _forOwn3.default)(thing, function (value, key) {\n        value === true && names.push(key);\n        names.push(key + '-' + value);\n      });\n    } else if ((0, _isString3.default)(thing)) {\n      names.push(thing);\n    }\n  });\n\n  return names;\n};\n\nexports.default = flattenNames;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ReactCSS = exports.loop = exports.handleActive = exports.handleHover = exports.hover = undefined;\n\nvar _flattenNames = require('./flattenNames');\n\nvar _flattenNames2 = _interopRequireDefault(_flattenNames);\n\nvar _mergeClasses = require('./mergeClasses');\n\nvar _mergeClasses2 = _interopRequireDefault(_mergeClasses);\n\nvar _autoprefix = require('./autoprefix');\n\nvar _autoprefix2 = _interopRequireDefault(_autoprefix);\n\nvar _hover2 = require('./components/hover');\n\nvar _hover3 = _interopRequireDefault(_hover2);\n\nvar _active = require('./components/active');\n\nvar _active2 = _interopRequireDefault(_active);\n\nvar _loop2 = require('./loop');\n\nvar _loop3 = _interopRequireDefault(_loop2);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.hover = _hover3.default;\nexports.handleHover = _hover3.default;\nexports.handleActive = _active2.default;\nexports.loop = _loop3.default;\nvar ReactCSS = exports.ReactCSS = function ReactCSS(classes) {\n  for (var _len = arguments.length, activations = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    activations[_key - 1] = arguments[_key];\n  }\n\n  var activeNames = (0, _flattenNames2.default)(activations);\n  var merged = (0, _mergeClasses2.default)(classes, activeNames);\n  return (0, _autoprefix2.default)(merged);\n};\n\nexports.default = ReactCSS;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nvar loopable = function loopable(i, length) {\n  var props = {};\n  var setProp = function setProp(name) {\n    var value = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n\n    props[name] = value;\n  };\n\n  i === 0 && setProp('first-child');\n  i === length - 1 && setProp('last-child');\n  (i === 0 || i % 2 === 0) && setProp('even');\n  Math.abs(i % 2) === 1 && setProp('odd');\n  setProp('nth-child', i);\n\n  return props;\n};\n\nexports.default = loopable;","'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.mergeClasses = undefined;\n\nvar _forOwn2 = require('lodash/forOwn');\n\nvar _forOwn3 = _interopRequireDefault(_forOwn2);\n\nvar _cloneDeep2 = require('lodash/cloneDeep');\n\nvar _cloneDeep3 = _interopRequireDefault(_cloneDeep2);\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar mergeClasses = exports.mergeClasses = function mergeClasses(classes) {\n  var activeNames = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n\n  var styles = classes.default && (0, _cloneDeep3.default)(classes.default) || {};\n  activeNames.map(function (name) {\n    var toMerge = classes[name];\n    if (toMerge) {\n      (0, _forOwn3.default)(toMerge, function (value, key) {\n        if (!styles[key]) {\n          styles[key] = {};\n        }\n\n        styles[key] = _extends({}, styles[key], toMerge[key]);\n      });\n    }\n\n    return name;\n  });\n  return styles;\n};\n\nexports.default = mergeClasses;","/**\n * @license React\n * use-sync-external-store-shim.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var e=require(\"react\");function h(a,b){return a===b&&(0!==a||1/a===1/b)||a!==a&&b!==b}var k=\"function\"===typeof Object.is?Object.is:h,l=e.useState,m=e.useEffect,n=e.useLayoutEffect,p=e.useDebugValue;function q(a,b){var d=b(),f=l({inst:{value:d,getSnapshot:b}}),c=f[0].inst,g=f[1];n(function(){c.value=d;c.getSnapshot=b;r(c)&&g({inst:c})},[a,d,b]);m(function(){r(c)&&g({inst:c});return a(function(){r(c)&&g({inst:c})})},[a]);p(d);return d}\nfunction r(a){var b=a.getSnapshot;a=a.value;try{var d=b();return!k(a,d)}catch(f){return!0}}function t(a,b){return b()}var u=\"undefined\"===typeof window||\"undefined\"===typeof window.document||\"undefined\"===typeof window.document.createElement?t:q;exports.useSyncExternalStore=void 0!==e.useSyncExternalStore?e.useSyncExternalStore:u;\n","/**\n * @license React\n * use-sync-external-store-shim/with-selector.production.min.js\n *\n * Copyright (c) Facebook, Inc. and its affiliates.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n'use strict';var h=require(\"react\"),n=require(\"use-sync-external-store/shim\");function p(a,b){return a===b&&(0!==a||1/a===1/b)||a!==a&&b!==b}var q=\"function\"===typeof Object.is?Object.is:p,r=n.useSyncExternalStore,t=h.useRef,u=h.useEffect,v=h.useMemo,w=h.useDebugValue;\nexports.useSyncExternalStoreWithSelector=function(a,b,e,l,g){var c=t(null);if(null===c.current){var f={hasValue:!1,value:null};c.current=f}else f=c.current;c=v(function(){function a(a){if(!c){c=!0;d=a;a=l(a);if(void 0!==g&&f.hasValue){var b=f.value;if(g(b,a))return k=b}return k=a}b=k;if(q(d,a))return b;var e=l(a);if(void 0!==g&&g(b,e))return b;d=a;return k=e}var c=!1,d,k,m=void 0===e?null:e;return[function(){return a(b())},null===m?void 0:function(){return a(m())}]},[b,e,l,g]);var d=r(a,c[0],c[1]);\nu(function(){f.hasValue=!0;f.value=d},[d]);w(d);return d};\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('../cjs/use-sync-external-store-shim.production.min.js');\n} else {\n  module.exports = require('../cjs/use-sync-external-store-shim.development.js');\n}\n","'use strict';\n\nif (process.env.NODE_ENV === 'production') {\n  module.exports = require('../cjs/use-sync-external-store-shim/with-selector.production.min.js');\n} else {\n  module.exports = require('../cjs/use-sync-external-store-shim/with-selector.development.js');\n}\n","const createStoreImpl = (createState) => {\n  let state;\n  const listeners = /* @__PURE__ */ new Set();\n  const setState = (partial, replace) => {\n    const nextState = typeof partial === \"function\" ? partial(state) : partial;\n    if (!Object.is(nextState, state)) {\n      const previousState = state;\n      state = (replace != null ? replace : typeof nextState !== \"object\" || nextState === null) ? nextState : Object.assign({}, state, nextState);\n      listeners.forEach((listener) => listener(state, previousState));\n    }\n  };\n  const getState = () => state;\n  const getInitialState = () => initialState;\n  const subscribe = (listener) => {\n    listeners.add(listener);\n    return () => listeners.delete(listener);\n  };\n  const destroy = () => {\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n      console.warn(\n        \"[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected.\"\n      );\n    }\n    listeners.clear();\n  };\n  const api = { setState, getState, getInitialState, subscribe, destroy };\n  const initialState = state = createState(setState, getState, api);\n  return api;\n};\nconst createStore = (createState) => createState ? createStoreImpl(createState) : createStoreImpl;\nvar vanilla = (createState) => {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n    console.warn(\n      \"[DEPRECATED] Default export is deprecated. Instead use import { createStore } from 'zustand/vanilla'.\"\n    );\n  }\n  return createStore(createState);\n};\n\nexport { createStore, vanilla as default };\n","import { createStore } from 'zustand/vanilla';\nexport * from 'zustand/vanilla';\nimport ReactExports from 'react';\nimport useSyncExternalStoreExports from 'use-sync-external-store/shim/with-selector.js';\n\nconst { useDebugValue } = ReactExports;\nconst { useSyncExternalStoreWithSelector } = useSyncExternalStoreExports;\nlet didWarnAboutEqualityFn = false;\nconst identity = (arg) => arg;\nfunction useStore(api, selector = identity, equalityFn) {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && equalityFn && !didWarnAboutEqualityFn) {\n    console.warn(\n      \"[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937\"\n    );\n    didWarnAboutEqualityFn = true;\n  }\n  const slice = useSyncExternalStoreWithSelector(\n    api.subscribe,\n    api.getState,\n    api.getServerState || api.getInitialState,\n    selector,\n    equalityFn\n  );\n  useDebugValue(slice);\n  return slice;\n}\nconst createImpl = (createState) => {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && typeof createState !== \"function\") {\n    console.warn(\n      \"[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.\"\n    );\n  }\n  const api = typeof createState === \"function\" ? createStore(createState) : createState;\n  const useBoundStore = (selector, equalityFn) => useStore(api, selector, equalityFn);\n  Object.assign(useBoundStore, api);\n  return useBoundStore;\n};\nconst create = (createState) => createState ? createImpl(createState) : createImpl;\nvar react = (createState) => {\n  if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n    console.warn(\n      \"[DEPRECATED] Default export is deprecated. Instead use `import { create } from 'zustand'`.\"\n    );\n  }\n  return create(createState);\n};\n\nexport { create, react as default, useStore };\n","const reduxImpl = (reducer, initial) => (set, _get, api) => {\n  api.dispatch = (action) => {\n    set((state) => reducer(state, action), false, action);\n    return action;\n  };\n  api.dispatchFromDevtools = true;\n  return { dispatch: (...a) => api.dispatch(...a), ...initial };\n};\nconst redux = reduxImpl;\n\nconst trackedConnections = /* @__PURE__ */ new Map();\nconst getTrackedConnectionState = (name) => {\n  const api = trackedConnections.get(name);\n  if (!api) return {};\n  return Object.fromEntries(\n    Object.entries(api.stores).map(([key, api2]) => [key, api2.getState()])\n  );\n};\nconst extractConnectionInformation = (store, extensionConnector, options) => {\n  if (store === void 0) {\n    return {\n      type: \"untracked\",\n      connection: extensionConnector.connect(options)\n    };\n  }\n  const existingConnection = trackedConnections.get(options.name);\n  if (existingConnection) {\n    return { type: \"tracked\", store, ...existingConnection };\n  }\n  const newConnection = {\n    connection: extensionConnector.connect(options),\n    stores: {}\n  };\n  trackedConnections.set(options.name, newConnection);\n  return { type: \"tracked\", store, ...newConnection };\n};\nconst devtoolsImpl = (fn, devtoolsOptions = {}) => (set, get, api) => {\n  const { enabled, anonymousActionType, store, ...options } = devtoolsOptions;\n  let extensionConnector;\n  try {\n    extensionConnector = (enabled != null ? enabled : (import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") && window.__REDUX_DEVTOOLS_EXTENSION__;\n  } catch (_e) {\n  }\n  if (!extensionConnector) {\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && enabled) {\n      console.warn(\n        \"[zustand devtools middleware] Please install/enable Redux devtools extension\"\n      );\n    }\n    return fn(set, get, api);\n  }\n  const { connection, ...connectionInformation } = extractConnectionInformation(store, extensionConnector, options);\n  let isRecording = true;\n  api.setState = (state, replace, nameOrAction) => {\n    const r = set(state, replace);\n    if (!isRecording) return r;\n    const action = nameOrAction === void 0 ? { type: anonymousActionType || \"anonymous\" } : typeof nameOrAction === \"string\" ? { type: nameOrAction } : nameOrAction;\n    if (store === void 0) {\n      connection == null ? void 0 : connection.send(action, get());\n      return r;\n    }\n    connection == null ? void 0 : connection.send(\n      {\n        ...action,\n        type: `${store}/${action.type}`\n      },\n      {\n        ...getTrackedConnectionState(options.name),\n        [store]: api.getState()\n      }\n    );\n    return r;\n  };\n  const setStateFromDevtools = (...a) => {\n    const originalIsRecording = isRecording;\n    isRecording = false;\n    set(...a);\n    isRecording = originalIsRecording;\n  };\n  const initialState = fn(api.setState, get, api);\n  if (connectionInformation.type === \"untracked\") {\n    connection == null ? void 0 : connection.init(initialState);\n  } else {\n    connectionInformation.stores[connectionInformation.store] = api;\n    connection == null ? void 0 : connection.init(\n      Object.fromEntries(\n        Object.entries(connectionInformation.stores).map(([key, store2]) => [\n          key,\n          key === connectionInformation.store ? initialState : store2.getState()\n        ])\n      )\n    );\n  }\n  if (api.dispatchFromDevtools && typeof api.dispatch === \"function\") {\n    let didWarnAboutReservedActionType = false;\n    const originalDispatch = api.dispatch;\n    api.dispatch = (...a) => {\n      if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\" && a[0].type === \"__setState\" && !didWarnAboutReservedActionType) {\n        console.warn(\n          '[zustand devtools middleware] \"__setState\" action type is reserved to set state from the devtools. Avoid using it.'\n        );\n        didWarnAboutReservedActionType = true;\n      }\n      originalDispatch(...a);\n    };\n  }\n  connection.subscribe((message) => {\n    var _a;\n    switch (message.type) {\n      case \"ACTION\":\n        if (typeof message.payload !== \"string\") {\n          console.error(\n            \"[zustand devtools middleware] Unsupported action format\"\n          );\n          return;\n        }\n        return parseJsonThen(\n          message.payload,\n          (action) => {\n            if (action.type === \"__setState\") {\n              if (store === void 0) {\n                setStateFromDevtools(action.state);\n                return;\n              }\n              if (Object.keys(action.state).length !== 1) {\n                console.error(\n                  `\n                    [zustand devtools middleware] Unsupported __setState action format. \n                    When using 'store' option in devtools(), the 'state' should have only one key, which is a value of 'store' that was passed in devtools(),\n                    and value of this only key should be a state object. Example: { \"type\": \"__setState\", \"state\": { \"abc123Store\": { \"foo\": \"bar\" } } }\n                    `\n                );\n              }\n              const stateFromDevtools = action.state[store];\n              if (stateFromDevtools === void 0 || stateFromDevtools === null) {\n                return;\n              }\n              if (JSON.stringify(api.getState()) !== JSON.stringify(stateFromDevtools)) {\n                setStateFromDevtools(stateFromDevtools);\n              }\n              return;\n            }\n            if (!api.dispatchFromDevtools) return;\n            if (typeof api.dispatch !== \"function\") return;\n            api.dispatch(action);\n          }\n        );\n      case \"DISPATCH\":\n        switch (message.payload.type) {\n          case \"RESET\":\n            setStateFromDevtools(initialState);\n            if (store === void 0) {\n              return connection == null ? void 0 : connection.init(api.getState());\n            }\n            return connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n          case \"COMMIT\":\n            if (store === void 0) {\n              connection == null ? void 0 : connection.init(api.getState());\n              return;\n            }\n            return connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n          case \"ROLLBACK\":\n            return parseJsonThen(message.state, (state) => {\n              if (store === void 0) {\n                setStateFromDevtools(state);\n                connection == null ? void 0 : connection.init(api.getState());\n                return;\n              }\n              setStateFromDevtools(state[store]);\n              connection == null ? void 0 : connection.init(getTrackedConnectionState(options.name));\n            });\n          case \"JUMP_TO_STATE\":\n          case \"JUMP_TO_ACTION\":\n            return parseJsonThen(message.state, (state) => {\n              if (store === void 0) {\n                setStateFromDevtools(state);\n                return;\n              }\n              if (JSON.stringify(api.getState()) !== JSON.stringify(state[store])) {\n                setStateFromDevtools(state[store]);\n              }\n            });\n          case \"IMPORT_STATE\": {\n            const { nextLiftedState } = message.payload;\n            const lastComputedState = (_a = nextLiftedState.computedStates.slice(-1)[0]) == null ? void 0 : _a.state;\n            if (!lastComputedState) return;\n            if (store === void 0) {\n              setStateFromDevtools(lastComputedState);\n            } else {\n              setStateFromDevtools(lastComputedState[store]);\n            }\n            connection == null ? void 0 : connection.send(\n              null,\n              // FIXME no-any\n              nextLiftedState\n            );\n            return;\n          }\n          case \"PAUSE_RECORDING\":\n            return isRecording = !isRecording;\n        }\n        return;\n    }\n  });\n  return initialState;\n};\nconst devtools = devtoolsImpl;\nconst parseJsonThen = (stringified, f) => {\n  let parsed;\n  try {\n    parsed = JSON.parse(stringified);\n  } catch (e) {\n    console.error(\n      \"[zustand devtools middleware] Could not parse the received json\",\n      e\n    );\n  }\n  if (parsed !== void 0) f(parsed);\n};\n\nconst subscribeWithSelectorImpl = (fn) => (set, get, api) => {\n  const origSubscribe = api.subscribe;\n  api.subscribe = (selector, optListener, options) => {\n    let listener = selector;\n    if (optListener) {\n      const equalityFn = (options == null ? void 0 : options.equalityFn) || Object.is;\n      let currentSlice = selector(api.getState());\n      listener = (state) => {\n        const nextSlice = selector(state);\n        if (!equalityFn(currentSlice, nextSlice)) {\n          const previousSlice = currentSlice;\n          optListener(currentSlice = nextSlice, previousSlice);\n        }\n      };\n      if (options == null ? void 0 : options.fireImmediately) {\n        optListener(currentSlice, currentSlice);\n      }\n    }\n    return origSubscribe(listener);\n  };\n  const initialState = fn(set, get, api);\n  return initialState;\n};\nconst subscribeWithSelector = subscribeWithSelectorImpl;\n\nconst combine = (initialState, create) => (...a) => Object.assign({}, initialState, create(...a));\n\nfunction createJSONStorage(getStorage, options) {\n  let storage;\n  try {\n    storage = getStorage();\n  } catch (_e) {\n    return;\n  }\n  const persistStorage = {\n    getItem: (name) => {\n      var _a;\n      const parse = (str2) => {\n        if (str2 === null) {\n          return null;\n        }\n        return JSON.parse(str2, options == null ? void 0 : options.reviver);\n      };\n      const str = (_a = storage.getItem(name)) != null ? _a : null;\n      if (str instanceof Promise) {\n        return str.then(parse);\n      }\n      return parse(str);\n    },\n    setItem: (name, newValue) => storage.setItem(\n      name,\n      JSON.stringify(newValue, options == null ? void 0 : options.replacer)\n    ),\n    removeItem: (name) => storage.removeItem(name)\n  };\n  return persistStorage;\n}\nconst toThenable = (fn) => (input) => {\n  try {\n    const result = fn(input);\n    if (result instanceof Promise) {\n      return result;\n    }\n    return {\n      then(onFulfilled) {\n        return toThenable(onFulfilled)(result);\n      },\n      catch(_onRejected) {\n        return this;\n      }\n    };\n  } catch (e) {\n    return {\n      then(_onFulfilled) {\n        return this;\n      },\n      catch(onRejected) {\n        return toThenable(onRejected)(e);\n      }\n    };\n  }\n};\nconst oldImpl = (config, baseOptions) => (set, get, api) => {\n  let options = {\n    getStorage: () => localStorage,\n    serialize: JSON.stringify,\n    deserialize: JSON.parse,\n    partialize: (state) => state,\n    version: 0,\n    merge: (persistedState, currentState) => ({\n      ...currentState,\n      ...persistedState\n    }),\n    ...baseOptions\n  };\n  let hasHydrated = false;\n  const hydrationListeners = /* @__PURE__ */ new Set();\n  const finishHydrationListeners = /* @__PURE__ */ new Set();\n  let storage;\n  try {\n    storage = options.getStorage();\n  } catch (_e) {\n  }\n  if (!storage) {\n    return config(\n      (...args) => {\n        console.warn(\n          `[zustand persist middleware] Unable to update item '${options.name}', the given storage is currently unavailable.`\n        );\n        set(...args);\n      },\n      get,\n      api\n    );\n  }\n  const thenableSerialize = toThenable(options.serialize);\n  const setItem = () => {\n    const state = options.partialize({ ...get() });\n    let errorInSync;\n    const thenable = thenableSerialize({ state, version: options.version }).then(\n      (serializedValue) => storage.setItem(options.name, serializedValue)\n    ).catch((e) => {\n      errorInSync = e;\n    });\n    if (errorInSync) {\n      throw errorInSync;\n    }\n    return thenable;\n  };\n  const savedSetState = api.setState;\n  api.setState = (state, replace) => {\n    savedSetState(state, replace);\n    void setItem();\n  };\n  const configResult = config(\n    (...args) => {\n      set(...args);\n      void setItem();\n    },\n    get,\n    api\n  );\n  let stateFromStorage;\n  const hydrate = () => {\n    var _a;\n    if (!storage) return;\n    hasHydrated = false;\n    hydrationListeners.forEach((cb) => cb(get()));\n    const postRehydrationCallback = ((_a = options.onRehydrateStorage) == null ? void 0 : _a.call(options, get())) || void 0;\n    return toThenable(storage.getItem.bind(storage))(options.name).then((storageValue) => {\n      if (storageValue) {\n        return options.deserialize(storageValue);\n      }\n    }).then((deserializedStorageValue) => {\n      if (deserializedStorageValue) {\n        if (typeof deserializedStorageValue.version === \"number\" && deserializedStorageValue.version !== options.version) {\n          if (options.migrate) {\n            return options.migrate(\n              deserializedStorageValue.state,\n              deserializedStorageValue.version\n            );\n          }\n          console.error(\n            `State loaded from storage couldn't be migrated since no migrate function was provided`\n          );\n        } else {\n          return deserializedStorageValue.state;\n        }\n      }\n    }).then((migratedState) => {\n      var _a2;\n      stateFromStorage = options.merge(\n        migratedState,\n        (_a2 = get()) != null ? _a2 : configResult\n      );\n      set(stateFromStorage, true);\n      return setItem();\n    }).then(() => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(stateFromStorage, void 0);\n      hasHydrated = true;\n      finishHydrationListeners.forEach((cb) => cb(stateFromStorage));\n    }).catch((e) => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(void 0, e);\n    });\n  };\n  api.persist = {\n    setOptions: (newOptions) => {\n      options = {\n        ...options,\n        ...newOptions\n      };\n      if (newOptions.getStorage) {\n        storage = newOptions.getStorage();\n      }\n    },\n    clearStorage: () => {\n      storage == null ? void 0 : storage.removeItem(options.name);\n    },\n    getOptions: () => options,\n    rehydrate: () => hydrate(),\n    hasHydrated: () => hasHydrated,\n    onHydrate: (cb) => {\n      hydrationListeners.add(cb);\n      return () => {\n        hydrationListeners.delete(cb);\n      };\n    },\n    onFinishHydration: (cb) => {\n      finishHydrationListeners.add(cb);\n      return () => {\n        finishHydrationListeners.delete(cb);\n      };\n    }\n  };\n  hydrate();\n  return stateFromStorage || configResult;\n};\nconst newImpl = (config, baseOptions) => (set, get, api) => {\n  let options = {\n    storage: createJSONStorage(() => localStorage),\n    partialize: (state) => state,\n    version: 0,\n    merge: (persistedState, currentState) => ({\n      ...currentState,\n      ...persistedState\n    }),\n    ...baseOptions\n  };\n  let hasHydrated = false;\n  const hydrationListeners = /* @__PURE__ */ new Set();\n  const finishHydrationListeners = /* @__PURE__ */ new Set();\n  let storage = options.storage;\n  if (!storage) {\n    return config(\n      (...args) => {\n        console.warn(\n          `[zustand persist middleware] Unable to update item '${options.name}', the given storage is currently unavailable.`\n        );\n        set(...args);\n      },\n      get,\n      api\n    );\n  }\n  const setItem = () => {\n    const state = options.partialize({ ...get() });\n    return storage.setItem(options.name, {\n      state,\n      version: options.version\n    });\n  };\n  const savedSetState = api.setState;\n  api.setState = (state, replace) => {\n    savedSetState(state, replace);\n    void setItem();\n  };\n  const configResult = config(\n    (...args) => {\n      set(...args);\n      void setItem();\n    },\n    get,\n    api\n  );\n  api.getInitialState = () => configResult;\n  let stateFromStorage;\n  const hydrate = () => {\n    var _a, _b;\n    if (!storage) return;\n    hasHydrated = false;\n    hydrationListeners.forEach((cb) => {\n      var _a2;\n      return cb((_a2 = get()) != null ? _a2 : configResult);\n    });\n    const postRehydrationCallback = ((_b = options.onRehydrateStorage) == null ? void 0 : _b.call(options, (_a = get()) != null ? _a : configResult)) || void 0;\n    return toThenable(storage.getItem.bind(storage))(options.name).then((deserializedStorageValue) => {\n      if (deserializedStorageValue) {\n        if (typeof deserializedStorageValue.version === \"number\" && deserializedStorageValue.version !== options.version) {\n          if (options.migrate) {\n            return [\n              true,\n              options.migrate(\n                deserializedStorageValue.state,\n                deserializedStorageValue.version\n              )\n            ];\n          }\n          console.error(\n            `State loaded from storage couldn't be migrated since no migrate function was provided`\n          );\n        } else {\n          return [false, deserializedStorageValue.state];\n        }\n      }\n      return [false, void 0];\n    }).then((migrationResult) => {\n      var _a2;\n      const [migrated, migratedState] = migrationResult;\n      stateFromStorage = options.merge(\n        migratedState,\n        (_a2 = get()) != null ? _a2 : configResult\n      );\n      set(stateFromStorage, true);\n      if (migrated) {\n        return setItem();\n      }\n    }).then(() => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(stateFromStorage, void 0);\n      stateFromStorage = get();\n      hasHydrated = true;\n      finishHydrationListeners.forEach((cb) => cb(stateFromStorage));\n    }).catch((e) => {\n      postRehydrationCallback == null ? void 0 : postRehydrationCallback(void 0, e);\n    });\n  };\n  api.persist = {\n    setOptions: (newOptions) => {\n      options = {\n        ...options,\n        ...newOptions\n      };\n      if (newOptions.storage) {\n        storage = newOptions.storage;\n      }\n    },\n    clearStorage: () => {\n      storage == null ? void 0 : storage.removeItem(options.name);\n    },\n    getOptions: () => options,\n    rehydrate: () => hydrate(),\n    hasHydrated: () => hasHydrated,\n    onHydrate: (cb) => {\n      hydrationListeners.add(cb);\n      return () => {\n        hydrationListeners.delete(cb);\n      };\n    },\n    onFinishHydration: (cb) => {\n      finishHydrationListeners.add(cb);\n      return () => {\n        finishHydrationListeners.delete(cb);\n      };\n    }\n  };\n  if (!options.skipHydration) {\n    hydrate();\n  }\n  return stateFromStorage || configResult;\n};\nconst persistImpl = (config, baseOptions) => {\n  if (\"getStorage\" in baseOptions || \"serialize\" in baseOptions || \"deserialize\" in baseOptions) {\n    if ((import.meta.env ? import.meta.env.MODE : void 0) !== \"production\") {\n      console.warn(\n        \"[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead.\"\n      );\n    }\n    return oldImpl(config, baseOptions);\n  }\n  return newImpl(config, baseOptions);\n};\nconst persist = persistImpl;\n\nexport { combine, createJSONStorage, devtools, persist, redux, subscribeWithSelector };\n"],"names":["FullDateInterface","constructor","date","this","fullDate","getTimeInSec","dateString","substring","timeString","yyyy","parseInt","mm","length","undefined","dd","isNaN","Error","dateJS","Date","HH","MM","SS","fractionalStr","FFFFFF","Math","pow","timeInSec","getTime","getTimeInMicroSec","combineDateTime","time","hours","padStart","minutes","seconds","month","day","fractionalSeconds","padEnd","year","parseDA","d","m","y","daysInMonth","parseTM","hh","ss","ffffff","dateTimeToFullDateInterface","dateTime","calculateDecayCorrection","instances","RadionuclideTotalDose","RadionuclideHalfLife","RadiopharmaceuticalStartDateTime","RadiopharmaceuticalStartTime","SeriesDate","scanTimes","SeriesTime","GEPrivatePostInjectionDateTime","results","Array","seriesDateTime","earliestAcquisitionDateTime","timeError","forEach","instance","AcquisitionDate","AcquisitionTime","acquisitionDateTime","fill","calculateScanTimes","startTime","input","calculateStartTime","map","_","index","decayTimeInSec","deepEquals","a","b","isArray","every","val","calculateSUVScalingFactors","CorrectedImage","Units","PhilipsPETPrivateGroup","PatientWeight","PatientSex","PatientSize","includes","DecayCorrection","decayCorrectionArray","weightInGrams","value","hasValidSUVScaleFactor","_instance$PhilipsPETP","_instance$PhilipsPETP2","_instance$PhilipsPETP3","SUVScaleFactor","hasValidActivityConcentrationScaleFactor","_instance$PhilipsPETP4","_instance$PhilipsPETP5","_instance$PhilipsPETP6","ActivityConcentrationScaleFactor","JSON","stringify","suvbsaFactor","suvlbmFactor","suvlbmJenmaFactor","console","warn","inputs","calculateSUVbsaScalingFactor","suvlbmInputs","LBM","weightSizeFactor","calculateSUVlbmScalingFactor","bodyMassIndex","calculateSUVlbmJanmahasatianScalingFactor","result","factors","suvbw","suvbsa","suvlbm","suvlbmJanma","DEFINED_CURSORS","Symbol","STANDARD_CURSORS","Set","MouseCursor","name","fallback","getName","addFallbackStyleProperty","style","getStyleProperty","getDefinedCursor","definedCursors","getDefinedCursors","mouseCursor","get","has","set","setDefinedCursor","cursor","context","symbol","Map","Object","defineProperty","standardCursorNames","values","ELEMENT_CURSORS_MAP","initElementCursor","element","_getElementCursors","_setElementCursor","cursors","resetElementCursor","hideElementCursor","WeakMap","ImageMouseCursor","url","x","super","getUniqueInstanceName","Number","prefix","utilities","BASE","iconContent","iconSize","viewBox","mousePoint","mousePointerGroupString","SEGMENTATION_CURSOR_BOUNDARIES","MINUS_RECT","PLUS_RECT","SCISSOR_ICON","RECTANGLE_ICON","CIRCLE_ICON","CursorSVG","Angle","extend","ArrowAnnotate","Bidirectional","CobbAngle","CircleROI","EllipticalROI","FreehandROI","FreehandROISculptor","Length","Height","Probe","RectangleROI","TextMarker","Crosshairs","Eraser","Magnify","Pan","Rotate","StackScroll","WindowLevelRegion","WindowLevel","Zoom","SegmentationFreeHandEraseInside","SegmentationFreeHandFillInside","SegmentationFreeHandEraseOutside","SegmentationFreeHandFillOutside","SegmentationRectangleEraseInside","RectangleScissor","CircleScissor","base","assign","create","registerCursor","toolName","svgCursorNames","keys","STATE","AnnotationStyleStates","Highlighted","MODE","ToolModes","Active","SVGMouseCursor","pointer","color","urn","type","getCursorURN","descriptor","getDefinedSVGCursorDescriptor","options","blob","svgString","createSVGIconWithPointer","createSVGIcon","Blob","createSVGIconBlob","URL","createObjectURL","createSVGIconUrl","createSVGMouseCursor","format","template","dictionary","dict","defined","prototype","hasOwnProperty","bind","replace","match","key","svgSize","max","cursorName","log","setElementCursor","CursorNames","VIEWPORT_ELEMENT","getSvgNode","canvasHash","cacheKey","state","svgNodeCache","domRef","appendNode","svgLayerElement","svgNode","touched","appendChild","setNodeTouched","clearUntouched","cacheEntry","removeChild","enabledElement","getEnabledElement","viewportId","renderingEngineId","viewportElement","internalDivElement","querySelector","svgLayer","_getSvgLayer","svgNodeCacheForCanvas","fn","svgDrawingHelper","attributes","currentValue","getAttribute","newValue","removeAttribute","setAttribute","annotationUID","circleUID","center","radius","dataId","width","lineWidth","lineDash","fillOpacity","strokeOpacity","strokeWidth","svgNodeHash","_getHash","existingCircleElement","cx","cy","r","stroke","newCircleElement","document","createElementNS","ellipseUID","canvasCoordinates","existingEllipse","bottom","top","left","right","w","hypot","h","angle","atan2","PI","rx","ry","transform","svgEllipseElement","corner1","corner2","handleGroupUID","handle","uniqueIndex","handleRadius","opacity","side","parseFloat","height","existingHandleElement","newHandleElement","handlePoints","i","drawLine","lineUID","start","end","shadow","existingLine","dropShadowStyle","id","x1","y1","x2","y2","newLine","drawHeight","heightUID","midX","endfirstLine","endsecondLine","firstLine","secondLine","threeLine","drawPolyline","polylineUID","points","fillColor","closePath","existingPolyLine","pointsAttribute","point","toFixed","firstPoint","newPolyLine","drawPath","pathUID","pointsArrays","existingNode","numArrays","numPoints","j","newNode","_createTextSpan","text","textSpanElement","textContent","_drawTextBackground","group","getBBox","insertBefore","firstChild","bBox","textUID","textLines","position","padding","fontFamily","fontSize","background","textGroupBoundingBox","svgns","existingTextGroup","textElement","textSpans","from","children","textSpan","textGroupAttributes","textGroup","noSelectStyle","combinedStyle","_createTextElement","_drawTextGroup","centerX","centerY","linkUID","annotationAnchorPoints","refPoint","boundingBox","findClosestPoint","boundingBoxPoints","halfWidth","halfHeight","_boundingBoxPoints","textBoxUID","textBoxPosition","textBox","mergedOptions","centering","canvasBoundingBox","drawRectByCoordinates","rectangleUID","_width","existingRect","topLeft","topRight","bottomLeft","bottomRight","leftEdgeCenter","svgRectElement","drawRect","drawArrow","arrowUID","cos","sin","drawRedactionRect","tlhc","min","abs","ChangeTypes","Events","StrategyCallbacks","Swipe","DEFAULT_CONTOUR_SEG_TOOL_NAME","async","contourSegmentationCompletedListener","evt","sourceAnnotation","detail","annotation","isContourSegmentationAnnotation","viewport","viewports","viewportWithToolRegistered","find","isFreehandContourSegToolRegisteredForViewport","getViewport","contourSegmentationAnnotations","sourceAnnotationUID","getAllAnnotations","filter","targetAnnotation","areSameSegment","isReferenceViewable","metadata","getValidContourSegmentationAnnotations","sourcePolyline","convertContourPolylineToCanvasSpace","data","contour","polyline","targetAnnotationInfo","sourceAABB","targetPolyline","targetAABB","aabbIntersect","lineSegmentsIntersect","isContourHole","findIntersectingContour","contourHoleProcessingEnabled","createPolylineHole","sourceStartPoint","mergePolylines","contourHolesData","getChildAnnotations","holeAnnotation","getContourHolesData","unassignedContourHolesSet","reassignedContourHolesMap","assignHoleToPolyline","parentPolyline","holeData","holes","push","delete","newPolylines","mergedPolyline","newPolyline","contourHolesDataArray","contourHoleData","clearParentAnnotation","handles","segmentation","removeAnnotation","startPoint","canvasToWorld","endPoint","newAnnotation","originalToolName","cachedStats","closed","spline","highlighted","invalidated","isLocked","isVisible","interpolationUID","interpolationCompleted","targetWindingDirection","Clockwise","addAnnotation","addContourSegmentationAnnotation","addChildAnnotation","updatedTtoolNames","viewportIdsToRender","getViewportIdsWithToolToRender","Promise","resolve","window","requestAnimationFrame","updateViewports","combinePolylines","silent","toolGroup","getToolGroupForViewport","errorMessage","hasTool","getToolOptions","projectedPolyline","worldToCanvas","windingDirection","holeWindingDirection","removeContourSegmentationAnnotation","holeContour","holePolyline","updatedToolNames","disable","removeEventListener","mouseDoubleClickListener","mouseDownListener","mouseMoveListener","capture","enable","addEventListener","preventGhostClick","touchStartListener","passive","wheelListener","segmentationId","modifiedSlicesToUse","representationData","viewportIds","hasVolumeViewport","some","getEnabledElementByViewportId","VolumeViewport","hasStackViewport","StackViewport","hasBothStackAndVolume","segmentationVolume","cache","getVolume","volumeId","imageData","vtkOpenGLTexture","slicesToUpdate","numSlices","getDimensions","setUpdatedFrame","modified","performVolumeLabelmapUpdate","SegmentationRepresentations","Labelmap","representations","representation","actorEntry","segImageData","actor","getMapper","getInputData","currentSegmentationImageId","segmentationImage","getImage","performStackLabelmapUpdate","getSegmentation","_imageChangeEventListener","eventData","getEnabledElementByIds","getSegmentationRepresentation","labelmapRepresentations","actors","getActors","updateLabelmapSegmentationImageReferences","labelmapActors","getCurrentLabelmapImageIdForViewport","referencedId","removeActors","uid","currentImageId","getCurrentImageId","derivedImageId","derivedImage","segmentationActorInput","dimensions","spacing","direction","getImageDataMetadata","currentImage","imageId","origin","currentOrigin","originToUse","voxelManager","getConstructor","newPixelData","getScalarData","scalarArray","numberOfComponents","setDimensions","setSpacing","setDirection","setOrigin","getPointData","setScalars","addImages","representationUID","callback","imageActor","setInputData","segmentationImageData","setDerivedImage","render","Enums","IMAGE_RENDERED","BaseVolumeViewport","STACK_NEW_IMAGE","annotationCompletedListener","contourSegmentationCompleted","removed","getRenderingEngines","renderingEngine","getViewports","vp","triggerAnnotationRenderForViewportIds","t","annotationRemovedListener","onImageRendered","triggerAnnotationRender","MOUSE_CLICK","MOUSE_DOWN","MOUSE_DOWN_ACTIVATE","MOUSE_DOUBLE_CLICK","MOUSE_DRAG","MOUSE_MOVE","MOUSE_UP","MOUSE_WHEEL","KEY_DOWN","KEY_UP","Passive","Enabled","onCameraModified","getToolsWithModesForMouseEvent","tool","CAMERA_MODIFIED","onImageSpacingCalibrated","IMAGE_SPACING_CALIBRATED","TOUCH_START","TOUCH_START_ACTIVATE","TOUCH_DRAG","TOUCH_END","TOUCH_TAP","TOUCH_PRESS","eventTarget","ANNOTATION_COMPLETED","InterpolationManager","handleAnnotationCompleted","ANNOTATION_MODIFIED","handleAnnotationUpdate","ANNOTATION_REMOVED","handleAnnotationDelete","onCameraReset","onResetCamera","CAMERA_RESET","addEnabledElement","svgLayerId","classList","add","pointerEvents","defs","feOffset","feColorMatrix","feBlend","_createSvgAnnotationLayer","viewportUid","renderingEngineUid","dataset","elementHash","_setSvgNodeCache","addViewportElement","imageRenderedEventDispatcher","cameraModifiedEventDispatcher","imageSpacingCalibratedEventDispatcher","cameraResetEventDispatcher","enabledElements","synchronizersFilteredByIds","synchronizers","synchronizer","notDisabled","isDisabled","hasSourceViewport","hasTargetViewport","_removeViewportFromSynchronizers","sync","remove","_removeViewportFromToolGroup","removeViewports","_removeEnabledElement","foundElementIndex","findIndex","el","splice","elementDisabledEvt","_resetSvgNodeCache","internalViewportNode","_removeSvgNode","removeViewportElement","cancelActiveManipulations","tools","toolsWithData","cancel","_getViewportIndex","arr","ar","_containsViewport","synchronizerId","eventName","eventHandler","_viewportOptions","_onEvent","_ignoreFiredEvents","_targetViewports","_eventSource","currentTarget","_sourceViewports","s","fireEvent","_enabled","_eventName","_eventHandler","_options","eventSource","_auxiliaryEvents","auxiliaryEvents","_hasSourceElements","setOptions","setEnabled","enabled","getOptions","viewportInfo","addTarget","addSource","getRenderingEngine","source","_updateDisableHandlers","getSourceViewports","getTargetViewports","destroy","removeSource","removeTarget","getViewportElement","sourceViewport","sourceEvent","promises","targetViewport","ex","allSettled","then","vp1","vp2","unique","vps","concat","u","_getUniqueViewports","_remove","disableHandler","elementDisabledEvent","getEventSource","ELEMENT_DISABLED","pop","synchronizerIndex","csToolsInitialized","init","defaultConfiguration","_removeCornerstoneEventListeners","elementEnabledEvent","ELEMENT_ENABLED","annotationInterpolationEventDispatcher","_addCornerstoneEventListeners","_removeCornerstoneToolsEventListeners","ANNOTATION_SELECTION_CHANGE","SEGMENTATION_MODIFIED","SEGMENTATION_DATA_MODIFIED","SEGMENTATION_REPRESENTATION_MODIFIED","SEGMENTATION_REPRESENTATION_ADDED","ToolGroupManager","annotationManager","getAnnotationManager","segmentationStateManager","restoreAnnotations","resetState","cameraSyncCallback","synchronizerInstance","cameraModifiedEvent","camera","tViewport","setCamera","createCameraPositionSynchronizer","synchronizerName","presentationViewSyncCallback","_synchronizerInstance","_sourceEvent","presentationView","getViewPresentation","setViewPresentation","createPresentationViewSynchronizer","viewPresentation","voiSyncCallback","modifiedEvent","eventDetail","range","invertStateChanged","invert","colormap","tProperties","voiRange","syncInvertState","syncColormap","_actors","size","setProperties","createVOISynchronizer","VOI_MODIFIED","COLORMAP_MODIFIED","zoomPanSyncCallback","sViewport","syncZoom","srcZoom","getZoom","setZoom","syncPan","srcPan","getPan","setPan","createZoomPanSynchronizer","getSpatialRegistration","targetId","sourceId","imageSliceSyncCallback","disabled","imageId1","sourceImagePositionPatient","metaData","imagePositionPatient","targetImageIds","getImageIds","viewport1","viewport2","viewPlaneNormal","viewPlaneNormal1","getCamera","viewPlaneNormal2","dotProducts","areViewportsCoplanar","registrationMatrixMat4","getFrameOfReferenceUID","useInitialPosition","targetImagePositionPatientWithRegistrationMatrix","closestImageIdIndex2","targetPoint","reduce","closestImageIdIndex","distance","Infinity","imageIndexToSet","getCurrentImageIdIndex","imageIndex","VOLUME_NEW_IMAGE","createImageSliceSynchronizer","slabThicknessSyncCallback","slabThickness","getSlabThickness","setSlabThickness","createStackImageSynchronizer","PanTool","toolProps","defaultToolProps","supportedInteractionTypes","touchDragCallback","_dragCallback","mouseDragCallback","deltaPoints","deltaPointsWorld","world","focalPoint","updatedPosition","updatedFocalPoint","TrackballRotateTool","configuration","rotateIncrementDegrees","_resizeObservers","_hasResolutionChanged","preMouseDownCallback","mapper","getDefaultActor","originalSampleDistance","getSampleDistance","setSampleDistance","cleanUp","once","_getViewportsInfo","getToolGroup","toolGroupId","viewportsInfo","onSetToolActive","subscribeToElementResize","resizeObserver","ResizeObserver","resetCamera","observe","_viewportAddedListener","TOOLGROUP_VIEWPORT_ADDED","onSetToolDisabled","disconnect","rotateCamera","centerWorld","axis","vtkCamera","getVtkActiveCamera","viewUp","getViewUp","getFocalPoint","getPosition","newPosition","newFocalPoint","newViewUp","Float32Array","currentPoints","lastPoints","currentPointsCanvas","canvas","lastPointsCanvas","clientWidth","clientHeight","normalizedPosition","normalizedPreviousPosition","radsq","op","oe","opsq","oesq","lop","sqrt","loe","nop","noe","dot","angleX","acos","sign","upVec","atV","rightV","forwardV","angleY","WindowLevelTool","_getImageDynamicRangeFromMiddleSlice","scalarData","middleSliceIndex","floor","frameLength","bytesPerVoxel","TypedArrayConstructor","Uint8Array","Uint16Array","Int16Array","frame","buffer","_getMinMax","lower","upper","modality","newRange","viewportsContainingVolumeUID","isPreScaled","properties","getProperties","getVolumeId","volume","Modality","scaling","preScale","scaled","getImageData","scalingParameters","getPTScaledNewRange","deltaPointsCanvas","getNewRange","multiplier","_getMultiplierFromDynamicRange","wwDelta","wcDelta","windowWidth","windowCenter","imageDynamicRange","imageVolume","calculatedDynamicRange","getMiddleSliceData","acc","pixel","BitsStored","metadataDynamicRange","_getImageDynamicRangeFromViewport","ratio","round","getRange","imageDataRange","getScalars","getData","voxel","WindowLevelRegionTool","minWindowWidth","addNewAnnotation","worldPos","isDrawing","referencedImageId","getReferencedImageId","FrameOfReferenceUID","getToolName","editData","_activateDraw","preventDefault","_endCallback","_deactivateDraw","applyWindowLevelRegion","bottomLeftCanvas","topRightCanvas","bottomRightCanvas","topLeftCanvas","bottomRightWorld","topLeftWorld","isInteractingWithTool","renderAnnotation","renderStatus","annotations","filterInteractableAnnotationsForElement","styleSpecifier","p","getAnnotationStyle","windowLevel","startCanvas","endCanvas","pixelLuminanceData","minMaxMean","minPixelValue","maxPixelValue","mean","isPointNearTool","toolSelectedCallback","handleSelectedCallback","_activateModify","_deactivateModify","StackScrollTool","debounceIfNotLoaded","loop","deltaY","mouseWheelCallback","_scroll","_scrollDrag","deltaPointY","pixelsPerImage","_getPixelPerImage","imageIdIndexOffset","delta","debounceLoading","wheel","scrollSlabs","numberOfSlices","getNumberOfSlices","offsetHeight","PlanarRotateTool","setAngle","startPoints","currentPointWorld","startPointWorld","centerCanvas","angleBetweenLines","v1","v2","cross","rotAngle","rotMat","rotatedViewUp","rotation","ZoomTool","zoomToCenter","minZoomScale","maxZoomScale","pinchToZoom","pan","initialMousePosWorld","dirVec","preTouchStartCallback","_dragParallelProjection","pinch","deltaDistance","parallelScale","k","parallelScaleToSet","focalPointToSet","positionToSet","distanceToCanvasCenter","scale","cappedParallelScale","thresholdExceeded","_dragPerspectiveProjection","zoomScale","directionOfProjection","tmp","_pinchCallback","currentPointsList","parallelProjection","_panCallback","MIPJumpToClickTool","targetViewportIds","mouseClickCallback","maxIntensity","brightestPoint","getPointInLineOfSightWithCriteria","intensity","indexOf","foundToolGroup","jumpToWorld","RENDERING_DEFAULTS","CONSTANTS","defaultReferenceLineColor","defaultReferenceLineControllable","defaultReferenceLineDraggableRotatable","defaultReferenceLineSlabThicknessControlsOn","OPERATION","CrosshairsTool","viewportIndicators","viewportIndicatorsConfig","autoPan","panSize","referenceLinesCenterGapRadius","filterActorUIDsToSetSlabThickness","slabThicknessBlendMode","MAXIMUM_INTENSITY_BLEND","mobile","toolCenter","initializeViewport","_getAnnotations","cameraPosition","cameraFocalPoint","rotationPoints","slabThicknessPoints","activeOperation","activeViewportIds","normal","resetCrosshairs","resetPan","resetZoom","resetToCenter","resetRotation","suppressEvents","resetSlabThickness","_computeToolCenter","computeToolCenter","firstViewport","secondViewport","thirdViewport","normal1","point1","normal2","point2","normal3","point3","firstPlane","secondPlane","thirdPlane","jumpWorld","_jump","filteredAnnotations","viewportIdArray","otherViewport","viewportControllable","_getReferenceLineControllable","viewportDraggableRotatable","_getReferenceLineDraggableRotatable","canvasCoords","proximity","_pointNearTool","interactionType","viewportAnnotation","currentCamera","oldCameraPosition","deltaCameraPosition","oldCameraFocalPoint","deltaCameraFocalPoint","isRotation","cameraModifiedInPlane","getViewportIds","_autoPanViewportIfNecessary","mouseMoveCallback","filteredToolAnnotations","imageNeedsUpdate","isAnnotationLocked","previousActiveOperation","previousActiveViewportIds","near","getHandleNearImagePoint","_areViewportIdArraysEqual","viewportUIDSpecificCrosshairs","canvasDiagonalLength","canvasMinDimensionLength","crosshairCenterCanvas","otherViewportAnnotations","_filterAnnotationsByUniqueViewportOrientations","referenceLines","canvasBox","otherCamera","otherViewportControllable","otherViewportDraggableRotatable","otherViewportSlabThicknessControlsOn","_getReferenceLineSlabThicknessControlsOn","otherCanvasDiagonalLength","otherCanvasCenter","otherViewportCenterWorld","pointWorld0","pointWorld1","pointCanvas0","otherViewportCenterCanvas","canvasUnitVectorFromCenter","canvasVectorFromCenterLong","canvasVectorFromCenterMid","canvasVectorFromCenterShort","canvasVectorFromCenterStart","centerGap","refLinePointOne","refLinePointTwo","refLinePointThree","refLinePointFour","refLinesCenter","liangBarksyClip","rotHandleOne","rotHandleTwo","stHandlesCenterCanvas","stHandlesCenterWorld","worldUnitVectorFromCenter","matrix","buildFromDegree","rotate","worldUnitOrthoVectorFromCenter","slabThicknessValue","worldOrthoVectorFromCenter","worldVerticalRefPoint","canvasVerticalRefPoint","canvasOrthoVectorFromCenter","stLinePointOne","stLinePointTwo","stLinePointThree","stLinePointFour","stHandleOne","stHandleTwo","stHandleThree","stHandleFour","newRtpoints","newStpoints","viewportColor","_getReferenceLineColor","line","lineIndex","viewportSlabThicknessControlsOn","selectedViewportId","lineActive","rotHandlesActive","rotationHandles","rotHandleWorldOne","rotHandleWorldTwo","slabThicknessHandlesActive","slabThicknessHandles","slabThicknessHandleWorldOne","slabThicknessHandleWorldTwo","slabThicknessHandleWorldThree","slabThicknessHandleWorldFour","handleUID","drawHandles","referenceColorCoordinates","xOffset","yOffset","circleRadius","drawCircle","getAnnotations","toolGroupAnnotations","_onNewVolume","viewportIdArrayOne","viewportIdArrayTwo","itemFound","_getAnnotationsForViewportsWithDifferentCameras","viewportsWithDifferentCameras","cameraOfTarget","_filterViewportWithSameOrientation","referenceAnnotation","linkedViewportAnnotations","otherViewportsAnnotationsWithSameCameraDirection","otherViewPlaneNormal","otherLinkedViewportAnnotationsFromSameScene","otherViewportsAnnotationsWithUniqueCameras","cameraFound","jj","cameraOfStocked","otherNonLinkedViewportAnnotationsFromSameScene","_checkIfViewportsRenderingSameScene","volumeIds","getAllVolumeIds","otherVolumeIds","viewportsAnnotationsToUpdate","sameScene","_applyDeltaShiftToSelectedViewportCameras","dir1","dir2","finalPointCanvas","originalPointCanvas","_isClockWise","rotationAxis","buildFromRadian","translate","otherViewportsIds","renderViewports","referenceAnnotations","viewportsIds","dotProd","projectedDelta","mod","currentPoint","currentCenter","otherViewportRotationPoints","dotProdDirection","projectedDirection","normalizedProjectedDirection","normalizedProjectedDelta","MINIMUM_SLAB_THICKNESS","_pointNearReferenceLine","getToolInstance","lineViewport","lineSegment1","distanceToPoint1","lineSegment2","distanceToPoint2","getReferenceLineColor","getReferenceLineControllable","getReferenceLineDraggableRotatable","getReferenceLineSlabThicknessControlsOn","_unsubscribeToViewportNewVolumeSet","_subscribeToViewportNewVolumeSet","onSetToolPassive","onSetToolEnabled","_getRotationHandleNearImagePoint","_getSlabThicknessHandleNearImagePoint","VOLUME_VIEWPORT_NEW_VOLUME","toolCenterCanvas","visiblePointCanvas","visiblePointWorld","actorUIDs","blendModeToUse","COMPOSITE","setBlendMode","c","_applyDeltaShiftToViewportCamera","annotationCanvasCoordinate","stPointLineCanvas1","stPointLineCanvas2","stPointLineCanvas1Start","stPointLineCanvas2Start","MAGNIFY_VIEWPORT_ID","MagnifyTool","magnifySize","magnifyWidth","magnifyHeight","_hasBeenRemoved","_getReferencedImageId","_createMagnificationViewport","viewportProperties","canvasPos","magnifyToolElement","magnifyElement","createElement","display","viewportInput","STACK","enableElement","magnifyViewport","setStack","_dragEndCallback","disableElement","getTargetId","split","csEvents","isSegmentation","AdvancedMagnifyToolActions","PARALLEL_THRESHOLD","AdvancedMagnifyTool","Actions","magnifyingGlass","zoomFactor","zoomFactorList","actions","showZoomFactorsList","method","bindings","mouseButton","MouseBindings","Secondary","modifierKey","KeyboardBindings","Shift","config","canvasHandlePoints","_getCanvasHandlePoints","magnifyViewportId","sourceViewportId","isCanvasAnnotation","activeHandleIndex","magnifyViewportManager","createViewport","sourceEnabledElement","annotationPoints","canvasDelta","len","dispose","canvasTop","canvasBottom","canvasLeft","radiusPoint","handleIndex","_dragDrawCallback","hasMoved","_dragModifyCallback","_dragHandle","canvasCenter","currentCanvasPoints","newRadius","newCanvasHandlePoints","getStyle","activeHandleCanvasCoords","isAnnotationVisible","update","canvasCenterPos","canvasRadius","AdvancedMagnifyViewportManager","getInstance","canvasPoint","currentZoomFactor","dropdown","_getZoomFactorsListDropdown","newZoomFactor","parentElement","focus","onChangeCallback","stopPropagation","keyCode","which","toLowerCase","option","label","title","defaultSelected","sourceElement","AdvancedMagnifyViewport","_addSourceElementEventListener","_magnifyViewportsMap","magnifyViewportInfo","_annotationRemovedCallback","destroyViewport","_newStackImageCallback","magnifyViewportsMapEntries","_getMagnifyViewportsMapEntriesBySourceViewportId","stackActorReInitialized","_reset","_newVolumeImageCallback","currentViewPlaneNormal","worldImagePlanePoint","vecHandleToImagePlane","worldDist","worldDelta","_initialize","_singleton","_removeEventListeners","_destroyViewports","magnifyViewportMapEntry","_removeSourceElementEventListener","newEnabledElement","_addEventListeners","newStackHandler","VIEWPORT_NEW_IMAGE_SET","newVolumeHandler","_enabledElement","_sourceToolGroup","_magnifyToolGroup","_isViewportReady","_radius","_resized","_canAutoPan","_viewportId","_sourceEnabledElement","_autoPan","visible","_browserMouseDownCallback","_browserMouseUpCallback","_handleToolModeChanged","_mouseDragCallback","_resizeViewportAsync","debounce","_resizeViewport","_syncViewports","parentNode","magnifyToolGroup","mode","toolBindingsOptions","setToolActive","setToolPassive","setToolEnabled","Disabled","setToolDisabled","_inheritBorderRadius","borderRadius","_createViewportNode","overflow","boxSizing","_convertZoomFactorToParallelScale","offsetWidth","_isStackViewport","_isVolumeViewport","_cloneToolGroups","sourceActors","magnifyToolGroupId","sourceToolGroup","clone","toolInstance","addViewport","addSegmentationRepresentations","_cloneStack","imageIds","_cloneVolumes","volumeInputArray","setVolumes","_cloneViewport","sourceViewportOptions","defaultOptions","toolGroups","_cancelMouseEventCallback","target","closest","canvasCurrent","magnifyRadius","dist","distanceToPoint","maxDist","panDist","canvasDeltaPos","newCanvasPosition","currentWorldPos","newWorldPos","worldDeltaPos","autoPanCallbackData","currentPosition","_addBrowserEventListeners","_removeBrowserEventListeners","TOOL_MODE_CHANGED","sourceCanvas","_syncViewportsCameras","_syncStackViewports","setImageIdIndex","sourceProperties","resize","EPSILON","ReferenceLines","AnnotationDisplayTool","A","enforceSameFrameOfReference","showFullDimension","_init","filterViewportsWithToolEnabled","sourceViewportCanvasCornersInWorld","onSetToolConfiguration","sourceViewPlaneNormal","isParallel","targetViewportPlane","pointSet1","pointSet2","pointSetToUse","topBottomVec","topRightVec","newNormal","isPerpendicular","lineStartWorld","lineEndWorld","handleFullDimension","vec1","vec2","targetImage","getTargetImageData","topLeftImageCoord","topRightImageCoord","bottomRightImageCoord","bottomLeftImageCoord","indexToWorld","lineStartImageCoord","lineEndImageCoord","intersectInfiniteLines","isInBound","err","line1Start","line1End","line2Start","line2End","x3","y3","x4","y4","a1","b1","c1","a2","b2","c2","OverlayGridTool","sourceImageIds","imagePlaneModule","frameOfReferenceUID","pointSets","calculateImageIdPointSets","viewportData","rows","columns","rowCosines","columnCosines","rowPixelSpacing","columnPixelSpacing","imageIdNormal","getImageIdNormal","targetData","initializeViewportData","pointSetsToUse","lineStartsWorld","lineEndsWorld","imageOrientationPatient","rowCosineVec","colCosineVec","SegmentationIntersectionTool","actorsWorldPointsMap","calculateSurfaceSegmentationIntersectionsForViewport","calculateSurfaceSegmentationIntersections","actorEntries","cacheId","getCacheId","clippingFilter","actorWorldPointMap","polyLineIdx","worldPointsSet","canvasPoints","polyLineUID","actorWorldPointsMap","polyData","getOutputData","polyDataUtils","colorArray","colorComponentToString","component","componentString","toString","colorToString","getProperty","getColor","pointToString","ReferenceCursors","preventHandleOutsideImage","displayThreshold","positionSync","disableCursor","isHandleOutsideImage","_elementWithCursor","_currentCursorWorldPosition","_currentCanvasPosition","_disableCursorEnabled","getActiveAnnotation","createInitialAnnotation","updateAnnotationPosition","worldPosition","worldBoundingBox","previousCamera","oldFocalPoint","cameraNormal","dotProduct","isElementWithCursor","updateViewportImage","lineWidthBase","e","crosshairUIDs","centerSpace","lineLength","plane","currentMousePosition","closestIndex","currentDistance","normalizedViewPlane","scaledPlaneNormal","renderViewport","viewportsWithAnnotations","ScaleOverlayTool","scaleLocation","viewportCanvasCornersInWorld","thisAnnotation","computeScaleSize","worldWidthViewport","worldHeightViewport","location","scaleSizes","currentScaleSize","scaleSize","computeEndScaleTicks","locationTickOffset","endTick1","endTick2","computeInnerScaleTicks","leftTick","rightTick","canvasScaleSize","tickIds","tickUIDs","tickCoordinates","numberSmallTicks","tickSpacing","locationOffset","computeWorldScaleCoordinates","pointSet","worldCoordinates","midpointLocation","midpoint","offset","computeCanvasScaleCoordinates","canvasSize","vscaleBounds","hscaleBounds","scaleCanvasCoordinates","worldDistanceOnCanvas","computeScaleBounds","horizontalReduction","verticalReduction","hReduction","vReduction","locationBounds","canvasBounds","devicePixelRatio","scaleTicks","scaleId","leftTickId","rightTickId","locationTextOffest","textCanvasCoordinates","textBoxLines","_getTextLines","drawTextBox","scaleSizeDisplayValue","scaleSizeUnits","SculptorTool","minSpacing","referencedToolNames","toolShape","referencedToolName","registeredShapes","isActive","commonData","activeAnnotationUID","isEditingOpenContour","canvasLocation","configureToolSize","selectFreehandTool","activateModify","updateCursor","endCallback","deactivateModify","activeAnnotation","filterSculptableAnnotationsForElement","calculateStats","dragCallback","sculpt","registerShapes","CircleSculptCursor","shapeName","setToolShape","shapeClass","shape","cursorShape","selectedShape","sculptData","mouseCanvasPoint","maxSpacing","getMaxSpacing","pushedHandles","pushHandles","first","insertNewHandles","interpolatePointsWithinMaxSpacing","indicesToInsertAfter","nextHandleIndex","contourIndex","currentCanvasPoint","nextCanvasPoint","updateToolSize","sculptableAnnotations","findNewHandleIndices","newIndexModifier","insertIndex","insertHandleRadially","last","previousIndex","nextIndex","handleData","getInsertPosition","closestAnnotationUID","getClosestFreehandToolOnElement","toolIndex","distanceFromTool","distancePointToContour","Default","renderShape","DIRECTIONS","VolumeRotateTool","cz","ax","ay","az","transformWorldToIndex","LengthTool","getTextLines","defaultGetTextLines","getViewReference","movingTextBox","canvasPoint1","canvasPoint2","worldPosDelta","unit","_throttledCalculateCachedStats","_calculateCachedStats","getLinkedTextBoxStyle","visibility","canvasTextBoxCoords","getTextBoxCoordsCanvas","drawLinkedTextBox","throttle","trailing","_calculateLength","pos1","pos2","dx","dy","dz","worldPos1","worldPos2","targetIds","image","index1","index2","_isInsideVolume","cachedVolumeStats","HeightTool","_calculateHeight","outside","ProbeTool","eventDispatchDetail","startsWith","getStackViewports","referencedImageURI","hasImageURI","currentImageURI","pixelUnitsOptions","isViewportPreScaled","isSuvScaled","ijk","modalityUnit","getAtIJKPoint","imageURI","calibratedResults","hasEnhancedRegionValues","units","getPixelValueUnits","DragProbeTool","postMouseDownCallback","postTouchStartCallback","EllipticalROITool","storePointData","centerPointRadius","statsCalculator","BasicStatsCalculator","initialRotation","getRotation","canvasCorners","getCanvasEllipseCorners","minorEllipse","majorEllipse","pointInMinorEllipse","_pointInEllipseCanvas","canvasWidth","canvasHeight","originalHandleCanvas","pointsCanvas","dX","dY","bottomCanvas","topCanvas","leftCanvas","rightCanvas","dYCanvas","newHalfCanvasWidth","canvasRight","dXCanvas","newHalfCanvasHeight","areaUnit","area","stdDev","centerPoint","_getCanvasEllipseCenter","pos1Index","post2Index","boundsIJK","ellipseObj","xRadius","yRadius","zRadius","worldWidth","worldHeight","getWorldWidthAndHeightFromTwoPoints","isEmptyArea","pointsInShape","statsCallback","isInObject","pointLPS","pointInEllipse","fast","returnPoints","stats","getStatistics","statsArray","array","ellipse","normalized","ellipseCanvasPoints","areaLine","CircleROITool","canvasEnd","radiusUnit","perimeter","pos2Index","aspect","radiusLine","ETDRSGridTool","degrees","diameters","diametersCanvas","diameter","worldMeasureToCanvas","degreesRad","angleRadians","degree","measurement","p1","p2","p1Canvas","p2Canvas","DEFAULT_SPLINE_CONFIG","resolution","controlPointAdditionDistance","controlPointDeletionDistance","showControlPointsConnectors","controlPointAdditionEnabled","controlPointDeletionEnabled","SplineTypesEnum","SplineToolActions","SplineROITool","ContourSegmentationBaseTool","SplineTypes","contourHoleAdditionModifierKey","decimate","epsilon","Cardinal","Class","CardinalSpline","CatmullRom","CatmullRomSpline","Linear","LinearSpline","BSpline","drawPreviewEnabled","lastControlPointDeletionKeys","AddControlPoint","Primary","DeleteControlPoint","Ctrl","fireChangeOnUpdate","isPointNearCurve","autoGenerated","changeType","Completed","HandlesUpdated","_keyDownCallback","controlPointIndex","_deleteControlPointByIndex","_mouseMoveCallback","lastCanvasPoint","_mouseDownCallback","doubleClick","worldPoint","closeContour","addNewPoint","closestControlPoint","getClosestControlPointWithinDistance","moveAnnotation","triggerAnnotationCompleted","eventType","triggerEvent","triggerAnnotationModified","StatsUpdated","triggerChangeEvent","_renderStats","textboxStyle","addControlPointCallback","splineType","splineConfig","_getSplineConfig","closestPointInfo","getClosestPoint","addControlPointAtU","uValue","deleteControlPointCallback","originalWorldPoint","deltaXPoint","deltaYPoint","deltaInX","deltaInY","maxX","canvasMaxX","maxY","canvasMaxY","minX","canvasMinX","minY","canvasMinY","math","getAABB","topLeftBBWorld","topLeftBBIndex","bottomRightBBWorld","getArea","getMouseModifier","event","createAnnotation","cancelAnnotation","isContourSegmentationTool","renderAnnotationInstance","renderContext","annotationStyle","controlPoints","locked","annotationLocked","childAnnotations","it","childAnnotationUIDs","join","_isSplineROIAnnotation","splinePolylineCanvas","_updateSplineInstance","getPolylinePoints","updateContourPolyline","updateWindingDirection","numControlPoints","previewPolylinePoints","getPreviewPolylinePoints","controlPointsConnectors","textbox","createInterpolatedSplineControl","increment","contourAnnotation","createSpline","onInterpolationComplete","interpolation","splineConfigs","setControlPoints","fixedResolution","fixedScale","SplineContourSegmentationTool","LivewireContourTool","snapHandleNearby","nearestEdge","showInterpolationPolyline","undo","proximitySquared","lineSegment","distanceToPointSquared","clearAnnotation","clearEditData","worldToSlice","sliceToWorld","worldPosOriginal","currentPath","getControlPoints","closestHandlePoint","distSquared","worldControlPoint","canvasControlPoint","snapPoint","scissors","findMinNearby","pathPoints","findPathToPoint","addPoints","prependPath","confirmedPath","lastPoint","getLastPoint","addControlPoint","startSearch","updateAnnotation","imgWidth","imgHeight","slicePoint","editHandle","getCalibratedLengthUnitsAndScale","setupBaseEditData","nextPos","viewportImageData","vtkImageData","sliceImageData","sliceToIndexMatrix","indexToSliceMatrix","ijkPoint","startPos","LivewireScissors","createInstanceFromRawPixelData","scissorsNext","currentPathNext","addPoint","confirmedPathNext","numHandles","previousHandle","nextHandle","findHandlePolylineIndex","slice","slicePos","pathPointsLeft","pathPointsRight","reverse","appendPath","contourSegmentationAnnotation","canvasHandles","livewirePath","pointArray","imagePoints","LivewireContourSegmentationTool","updateInterpolatedAnnotation","interpolationSources","originalPolyline","queueMicrotask","count","repeatInterpolation","originalPoints","handleSmoothing","hIndex","testPoint","minPoint","acceptedPath","path","InterpolationUpdated","rendered","polylineCanvasPoints","ArrowAnnotateTool","getTextCallback","changeTextCallback","arrowFirst","touchTapCallback","taps","doubleClickCallback","clickedAnnotation","_doneChangingTextCallback","stopImmediatePropagation","updatedText","doneChangingTextCallback","prompt","AngleTool","angleStartedNotYetCompleted","line1","canvasPoint3","line2","worldPos3","String","fromCharCode","CobbAngleTool","showArcLines","distanceToLines","isNearFirstLine","isNearSecondLine","_mouseUpCallback","arc1Angle","arc2Angle","arc1Start","arc1End","arc2Start","arc2End","mid1","midPoint","mid2","arc1TextBoxUID","arc1TextLine","arch1TextPosCanvas","arc2TextBoxUID","arc2TextLine","arch2TextPosCanvas","point4","canvasPoint4","getArcsStartEndPoints","linkLine","arc1Side","arc2Side","midLinkLine","linkLineLength","midFirstLine","midSecondLine","directionVectorStartArc1","magnitudeStartArc1","normalizedDirectionStartArc1","directionVectorEndArc1","magnitudeEndArc1","normalizedDirectionEndArc1","directionVectorStartArc2","magnitudeStartArc2","normalizedDirectionStartArc2","directionVectorEndArc2","magnitudeEndArc2","normalizedDirectionEndArc2","seg1","seg2","minDist","MAX_VALUE","UltrasoundDirectionalTool","displayBothAxesDistances","startedDrawing","xValues","yValues","isHorizontal","isUnitless","drawHandle","canvasDeltaY","canvasDeltaX","projectedPointCanvas","imageIndex1","imageIndex2","values1","units1","values2","units2","dist1","dist2","KeyImageTool","canvasPosition","AnnotationEraserTool","_deleteNearbyAnnotations","_toolInstances","annotationsToRemove","interactableAnnotations","setAnnotationSelected","RectangleScissorsTool","strategies","FILL_INSIDE","ERASE_INSIDE","defaultStrategy","activeStrategy","activeLabelmapSegmentation","activeSegmentation","segmentIndex","segmentsLocked","segmentLocking","segmentColor","labelmapData","referencedVolumeId","segmentationImageId","bottomLeftWorld","topRightWorld","operationData","applyActiveStrategy","toolMetadata","CircleScissorsTool","strategySpecificConfiguration","SphereScissorsTool","activeSegmentationRepresentation","CircleROIStartEndThresholdTool","numSlicesToPropagate","calculatePointsInsideVolume","showTextBox","spacingInNormal","startCoord","_getStartCoordinate","endCoord","_getEndCoordinate","startCoordinate","endCoordinate","pointsInVolume","projectionPoints","statistics","labelmapUID","_computeProjectionPoints","_computePointsInsideVolume","filterAnnotationsWithinSamePlane","viewplaneNormal","tempStartCoordinate","tempEndCoordinate","_getCoordinateForViewplaneNormal","roundedStartCoordinate","roundedEndCoordinate","cameraCoordinate","roundedCameraCoordinate","middleCoordinate","isMiddleSlice","_getIndexOfCoordinatesForViewplaneNormal","lineWidthToUse","lineDashToUse","_calculateCachedStatsTool","startIJK","endIJK","handlesToStart","startWorld","indexToWorldVec3","endWorld","newProjectionPoints","newPoint","pointsInsideVolume","measureInfo","modalityUnitOptions","worldPos1Index","worldProjectionPointIndex","indexOfProjection","worldPos2Index","numSlicesToPropagateFromStart","numSlicesToPropagateToEnd","endPos","viewplaneNormalAbs","pos","PaintFillTool","getDirection","fixedDimension","getFixedDimension","floodFillGetter","getLabelValue","getScalarDataPositionFromPlane","inPlaneSeedPoint","fixedDimensionValue","generateHelpers","clickedLabelValue","floodFillResult","floodFill","flooded","scalarDataIndex","setAtIndex","framesModified","getFramesModified","triggerSegmentationDataModified","boundaries","minJ","maxJ","seedIndex3D","z","getAtIJK","generateFloodFillGetter","generateGetScalarDataPositionFromPlane","toIndex","getScalarDataPosition","xDirection","yDirection","zDirection","absoluteOfViewPlaneNormal","absoluteOfXDirection","isEqual","absoluteOfYDirection","absoluteOfZDirection","OverlayMarkerType","OrientationMarkerTool","CUBE","AXIS","VTPFILE","OVERLAY_MARKER_TYPES","orientationWidget","viewportCorner","Corners","BOTTOM_RIGHT","viewportSize","minPixelSize","maxPixelSize","overlayMarkerType","ANNOTATED_CUBE","overlayConfiguration","faceProperties","xPlus","faceColor","faceRotation","xMinus","yPlus","fontColor","yMinus","zPlus","zMinus","defaultStyle","fontStyle","fontSizeScale","res","edgeThickness","edgeColor","AXES","CUSTOM","polyDataURL","initViewports","_subscribeToViewportEvents","cleanUpData","orientationMarker","orientationMarkers","updateViewport","updatingOrientationMarker","unsubscribe","unobserve","setTimeout","offscreenMultiRenderWindow","getRenderWindow","widget","getWidget","isDeleted","addAxisActorInViewport","getRenderer","removeActor","createAnnotationCube","createCustomActor","renderer","renderWindow","interactor","getInteractor","parentRenderer","setViewportCorner","setViewportSize","setMinPixelSize","setMaxPixelSize","updateMarkerOrientation","addWidget","response","fetch","arrayBuffer","vtpReader","parseAsArrayBuffer","shallowCopy","setActiveScalars","setColorModeToDirectScalars","setMapper","rotateZ","setDefaultStyle","setXPlusFaceProperty","setXMinusFaceProperty","setYPlusFaceProperty","setYMinusFaceProperty","setZPlusFaceProperty","setZMinusFaceProperty","createAnnotatedCubeActor","axes","annotatedCube","methodName","charAt","toUpperCase","SegmentSelectTool","SelectMode","Inside","Border","hoverTimeout","searchRadius","hoverTimer","clearTimeout","_setActiveSegment","getActiveSegmentation","_setActiveSegmentForType","hoveredSegmentIndex","getSegmentIndexAtWorldPoint","getSegmentIndexAtLabelmapBorder","Contour","getHoveredContourSegmentationAnnotation","Surface","setActiveSegmentIndex","v","triggerSegmentationModified","VideoRedactionTool","toolConfiguration","active","viewportUIDsToRender","toolDataCanvasCoordinate","rect","_getRectangleImageCoordinates","rectangle","point0","viewportUID","renderingEngineUID","sceneUID","targetUIDs","targetUID","_getImageVolumeFromTargetUID","worldToIndexVec3","iMin","iMax","jMin","jMax","kMin","kMax","yMultiple","zMultiple","valueMinusMean","_getTargetVolumeUID","scene","volumeUID","volumeActors","getVolumeActors","coloneIndex","_getTargetStackUID","annotationRenderingEngine","_needsRender","_animationFrameSet","_animationFrameHandle","_renderFlaggedViewports","_throwIfDestroyed","elements","_viewportElements","_triggerRender","_render","_setViewportsToBeRenderedNextFrame","hasBeenDestroyed","_setAllViewportsToBeRenderedNextFrame","elementsEnabled","enabledTools","draw","anyRendered","ANNOTATION_RENDERED","cancelAnimationFrame","clear","FrameOfReferenceSpecificAnnotationManager","getGroupKey","annotationGroupSelector","_imageVolumeModifiedHandler","frameOfReferenceSpecificAnnotations","getFramesOfReference","groupKey","getAnnotation","frameOfReferenceAnnotations","toolSpecificAnnotations","getNumberOfAnnotations","total","preprocessingFn","groupAnnotations","toolAnnotations","removeAnnotations","removedAnnotations","annotationsForTool","saveAnnotations","structuredClone","flat","getNumberOfAllAnnotations","removeAllAnnotations","IMAGE_VOLUME_MODIFIED","setPreprocessingFn","defaultFrameOfReferenceSpecificAnnotationManager","globalLockedAnnotationUIDsSet","setAnnotationLocked","makeEventDetail","lockedAnnotationUIDsSet","added","g","lock","unlock","publish","unlockAllAnnotations","clearLockedAnnotationsSet","getAnnotationsLocked","getAnnotationsLockedCount","checkAndSetAnnotationLocked","freeze","item","ANNOTATION_LOCK_CHANGE","selectedAnnotationUIDs","selected","preserveSelected","clearSelectionSet","isSelected","selectAnnotation","deselectAnnotation","getAnnotationsSelected","getAnnotationsSelectedByToolName","isAnnotationSelected","getAnnotationsSelectedCount","selection","selectionSet","defaultManager","setAnnotationManager","resetAnnotationManager","manager","childUID","parentAnnotationUID","parentAnnotation","childUIDIndex","childAnnotation","parentUID","getParentAnnotation","childAnnotationUID","HTMLDivElement","annotationManagerUID","invalidateAnnotation","currAnnotation","checkAndSetAnnotationVisibility","globalHiddenAnnotationUIDsSet","setAnnotationVisibility","show","annotationUIDsSet","lastHidden","hide","showAllAnnotations","lastVisible","hidden","ANNOTATION_VISIBILITY_CHANGE","_initializeConfig","colorHighlighted","colorSelected","colorLocked","textBoxVisibility","textBoxFontFamily","textBoxFontSize","textBoxColor","textBoxColorHighlighted","textBoxColorSelected","textBoxColorLocked","textBoxBackground","textBoxLinkLineWidth","textBoxLinkLineDash","textBoxShadow","getAnnotationToolStyles","getViewportToolStyles","getToolGroupToolStyles","getDefaultToolStyles","default","setAnnotationStyles","styles","annotationSpecificStyles","setViewportToolStyles","viewportSpecificStyles","setToolGroupToolStyles","toolGroupSpecificStyles","setDefaultToolStyles","toolStyle","specifications","_getToolStyle","property","annotationToolStyles","viewportToolStyles","global","toolGroupToolStyles","globalStyles","toolStyles","alternatives","list","getHierarchalPropertyStyles","Selected","Locked","AutoGenerated","triggerAnnotationAddedForElement","ANNOTATION_ADDED","triggerAnnotationAddedForFOR","getToolGroupsWithToolName","viewportsToRender","triggerAnnotationRemoved","_triggerAnnotationCompleted","triggerContourAnnotationCompleted","AnnotationGroup","annotationUIDs","_isVisible","visibleFilter","unboundVisibleFilter","setVisible","baseEvent","findNearby","uids","renderers","planarContourToolName","triggerSegmentationRender","segmentationRenderingEngine","renderSegmentationsForViewport","triggerSegmentationRenderBySegmentationId","renderSegmentation","_getAllViewports","flatMap","_renderFlaggedSegmentations","_getViewportIdsForSegmentation","segmentationRepresentations","viewportRenderList","segmentationRenderList","_addPlanarFreeHandToolIfAbsent","error","segmentationDetails","status","onSegmentationRender","SEGMENTATION_RENDERED","addTool","initialDefaultState","colorLUT","segmentations","viewportSegRepresentations","internalComputeVolumeLabelmapFromStack","segmentationImageIds","volumeLoader","internalConvertStackToVolumeLabelmap","defaultSegmentationStateManager","getDefaultRenderingConfig","cfun","ofun","_stackLabelmapImageIdReferenceMap","getState","updateState","updater","newState","getColorLUT","lutIndex","getNextColorLUTIndex","updateSegmentation","payload","draftState","addSegmentation","newSegmentation","getLabelmapImageIds","removeSegmentation","filteredSegmentations","triggerSegmentationRemoved","addSegmentationRepresentation","renderingConfig","getSegmentationRepresentations","debug","setRenderInactiveSegmentations","addDefaultSegmentationRepresentation","addLabelmapRepresentation","triggerSegmentationRepresentationModified","segmentReps","segments","colorLUTIndex","_setActiveSegmentation","processLabelmapRepresentationAddition","volumeViewport","isBaseVolumeSegmentation","_updateLabelmapSegmentationReferences","labelmapImageIds","updateCallback","viewableLabelmapImageIdFound","labelmapImageId","asOverlay","stackViewport","_updateAllLabelmapSegmentationImageReferences","sliceIndex","withNavigation","getStackSegmentationImageIdsForViewport","associatedReferenceImageAndLabelmapImageIds","removeSegmentationRepresentationsInternal","specifier","removedRepresentations","currentRepresentations","activeRepresentationRemoved","shouldRemove","removeSegmentationRepresentations","triggerSegmentationRepresentationRemoved","remainingRepresentations","removeSegmentationRepresentation","suppressEvent","setActiveSegmentation","activeSegRep","segRep","viewportRepresentations","typeMatch","idMatch","getSegmentationRepresentationVisibility","viewportRepresentation","setSegmentationRepresentationVisibility","entries","segment","addColorLUT","removeColorLUT","_getStackIdForImageIds","getAllViewportSegmentationRepresentations","getSegmentationRepresentationsBySegmentationId","viewportReps","filteredReps","segmentationStyle","viewportsStyle","setStyle","currentStyles","updatedStyles","copyActiveToInactiveIfNotProvided","renderInactiveSegmentations","repConfig","perSegment","allSegments","ALL_SEGMENTATIONS_KEY","segConfig","processedStyles","labelmapStyles","renderOutlineInactive","renderOutline","outlineWidthInactive","outlineWidth","renderFillInactive","renderFill","fillAlphaInactive","fillAlpha","outlineOpacityInactive","outlineOpacity","contourStyles","outlineDashInactive","outlineDash","getDefaultStyle","allSegmentationsKey","getRenderInactiveSegmentations","clearSegmentationStyle","clearAllSegmentationStyles","clearViewportStyle","clearAllViewportStyles","resetToGlobalStyle","hasCustomStyle","indexToUse","colorLUTToUse","missingColorLUTs","getColorLUTIndex","colorLUTOrIndex","segmentationInputArray","segmentationInput","representationInput","internalAddSegmentationRepresentation","addContourRepresentationToViewport","contourInputArray","addContourRepresentationToViewportMap","viewportInputMap","inputArray","addLabelmapRepresentationToViewport","labelmapInputArray","addLabelmapRepresentationToViewportMap","addSurfaceRepresentationToViewport","surfaceInputArray","addSurfaceRepresentationToViewportMap","inputData","contourData","geometryIds","annotationUIDsMap","normalizedSegments","segmentsConfig","surfaceData","geometryId","geometry","getGeometry","normalizeSurfaceSegments","normalizeSegments","addSegmentations","setColorLUT","colorLUTsIndex","segmentationRepresentation","getSegmentIndexColor","colorValue","setSegmentIndexColor","colorReference","getActiveSegmentIndex","activeSegmentIndex","getSegmentations","getViewportIdsWithSegmentation","viewportSegmentations","getViewportSegmentations","computeVolumeLabelmapFromStack","args","updateSegmentations","segmentationUpdateArray","segmentationUpdate","setSegmentIndexVisibility","getSegmentIndexVisibility","getHiddenSegmentIndices","clearSegmentValue","removeSegment","setNextSegmentAsActive","isThisSegmentActive","updatedSegments","segmentIndices","sort","currentIndex","nextSegmentIndex","previousSegmentIndex","helpers","convertStackToVolumeLabelmap","convertVolumeToStackLabelmap","computeAndAddContourRepresentation","computeAndAddLabelmapRepresentation","computeAndAddSurfaceRepresentation","computeAndAddRepresentation","surfacesObj","indices","getUniqueSegmentIndices","surface","polys","surfaceRepresentation","createAndCacheSurfacesFromRaw","all","updateSurfaceData","rawSurfacesData","rawSurfaceData","closedSurface","geometryLoader","SURFACE","geometryData","workerManager","getWebWorkerManager","triggerWorkerProgress","progress","WEB_WORKER_PROGRESS","WorkerTypes","POLYSEG_CONTOUR_TO_SURFACE","POLYSEG_LABELMAP_TO_SURFACE","computeSurfaceData","contourRepresentationData","polylines","numPointsArray","executeTask","callbacks","convertContourToSurface","computeSurfaceFromContourSegmentation","computeSurfaceFromLabelmapSegmentation","labelmapRepresentationData","getCompleteScalarDataArray","convertLabelmapToSurface","surfaces","errors","Boolean","conversionPaths","canComputeRequestedRepresentation","existingRepresentationTypes","supportedTypes","representationType","representationTypeData","validateFn","getExistingRepresentationTypes","existingRepresentationType","fromRepresentationType","toRepresentationType","canConvertFromTo","computedRepresentations","computeFunction","updateFunction","onComputationComplete","debouncedUpdateFunction","_debouncedSegmentationModified","_debouncedUpdateFunction","subscribeToSegmentationChanges","rep","removeAllSegmentations","immediate","_removeSegmentationRepresentations","labelmapDisplay","contourDisplay","removeRepresentation","surfaceDisplay","_removeRepresentationObject","removeAllSegmentationRepresentations","removeLabelmapRepresentation","removeContourRepresentation","removeSurfaceRepresentation","isSegmentIndexLocked","setSegmentIndexLocked","getLockedSegmentIndices","re","toolGroupFilteredByIds","tg","PRIMARY_BINDINGS","ToolGroup","toolOptions","currentActivePrimaryToolName","prevActivePrimaryToolName","restoreToolOptions","getViewportsInfo","toolInstanceName","getToolInstances","toolDefinition","hasToolName","localToolInstance","toolClass","ToolClass","instantiatedTool","addToolInstance","parentClassName","ToolClassToUse","ParentClass","ToolInstance","renderingEngineUIDToUse","_findRenderingEngine","vpId","getActivePrimaryMouseButtonTool","Settings","getRuntimeSettings","setViewportsCursorByToolName","vpInfo","TOOLGROUP_VIEWPORT_REMOVED","setActiveStrategy","strategyName","setToolMode","binding","TouchBinding","numTouchPoints","MouseBinding","obj","hasSameBinding","useCursor","_hasMousePrimaryButtonBinding","_setCursorForViewports","_renderViewports","TOOL_ACTIVATED","_triggerToolModeChangedEvent","prevToolOptions","matchBindings","removeAllBindings","getDefaultPrimaryBindings","matchBinding","toolOptionsForTool","_getCursor","setToolConfiguration","overwrite","_configuration","getDefaultMousePrimary","getToolConfiguration","configurationPath","getPrevActivePrimaryToolName","setActivePrimaryTool","activeToolName","getCurrentActivePrimaryToolName","newToolGroupId","fnToolFilter","sourceToolInstance","sourceToolOptions","sourceToolMode","primaryBindings","primary","renderingEngines","matchingEngines","engine","binding1","binding2","toolGroupIndex","MODES","toolGroupToolNames","hasToolByName","removeTool","defaultState","isMultiPartToolActive","resetCornerstoneToolsState","resetSvgNodeCache","BidirectionalTool","firstLineSegmentLength","longAxis","shortAxisPoint0","shortAxisPoint1","longAxisVector","counterClockWisePerpendicularToLongAxis","currentShortAxisVector","shortAxis","canvasCoordPoints","shortAxisDistFromCenter","vectorX","vectorY","xMid","yMid","startX","startY","endX","endY","_dragModifyHandle","movingHandleIndex","canvasCoordHandlesCurrent","firstLineSegment","secondLineSegment","proposedPoint","proposedCanvasCoord","fixedHandleCanvasCoord","fixedHandleToProposedCoordVec","fixedHandleToOldCoordVec","proposedFirstLineSegment","_movingLongAxisWouldPutItThroughShortAxis","centerOfRotation","_getSignedAngle","firstPointX","firstPointY","secondPointX","secondPointY","rotatedFirstPoint","rotatedFirstPointY","rotatedSecondPoint","rotatedSecondPointY","newFirstPoint","newSecondPoint","translateHandleIndex","canvasCoordsCurrent","longLineSegment","shortLineSegment","longLineSegmentVec","longLineSegmentVecNormalized","proposedToCurrentVec","movementLength","movementAlongLineSegmentLength","newTranslatedPoint","dataId1","dataId2","secondLineUID","vectorInSecondLineDirection","extendedSecondLineSegment","worldPos4","index3","index4","handles1","handles2","scale1","scale2","widthUnit","vector1","vector2","PlanarFreehandContourSegmentationTool","allowOpenContours","renderResult","pointCanProjectOnLine","PlanarFreehandROITool","alwaysRenderOpenContourHandles","closeContourProximity","checkCanvasEditFallbackProximity","makeClockWise","subPixelResolution","smoothing","smoothOnAdd","smoothOnEdit","knotsRatioPercentageOnAdd","knotsRatioPercentageOnEdit","displayOnePointAsCrosshairs","isEditingClosed","isEditingOpen","activateDraw","activateOpenContourEndEdit","activateClosedContourEdit","activateOpenContourEdit","previousPoint","pStart","pEnd","cancelDrawing","cancelOpenContourEdit","cancelClosedContourEdit","calibratedScale","updateClosedCachedStats","updateOpenCachedStats","annotationsToDisplay","spacingInNormalDirection","filterAnnotationsWithinSlice","filterAnnotationsForDisplay","annotationsWithParallelNormals","td","annotationViewPlaneNormal","halfSpacingInNormalDirection","annotationsWithinSlice","dir","renderContourBeingDrawn","renderClosedContourBeingEdited","renderOpenContourBeingEdited","renderPointContourWithMarker","renderContour","_calculateStatsIfActive","worldPosIndex","worldPosIndex2","iDelta","jDelta","kDelta","ceil","worldPosEnd","canvasPosEnd","curRow","intersections","intersectionCounter","_pointIJK","getLineSegmentIntersectionsCoordinates","shift","getPixelValueUnitunit","isFinite","RectangleROITool","arguments","frameOfReference","BaseTool","initialProps","strategyOptions","call","applyActiveStrategyCallback","callbackType","setConfiguration","newConfiguration","getViewReferenceId","polySegConversionInProgress","contourRepresentation","renderImmediate","MAX_NUMBER_COLORS","labelMapConfigCache","_getLabelmapConfig","labelmapConfig","isActiveLabelmap","segmentsLabelmapConfig","configToUse","activeSegmentOutlineWidthDelta","_needsTransferFunctionUpdate","segmentsHidden","cacheUID","oldConfig","cfunMTime","getMTime","ofunMTime","forceOpacityUpdate","forceColorUpdate","oldFillAlpha","oldRenderFill","oldRenderOutline","oldOutlineWidth","oldSegmentColor","oldSegmentsHidden","oldCfunMTime","oldOfunMTime","_addLabelmapToViewport","labelmapActorEntry","labelmapStyle","numColors","segmentSpecificLabelmapConfig","addRGBPoint","segmentOpacity","removePoint","addPointLong","labelmapActor","setRGBTransferFunction","setClamping","setScalarOpacity","setInterpolationTypeToNearest","setUseLabelOutline","setLabelOutlineOpacity","outlineWidths","setLabelOutlineThickness","setVisibility","_setLabelmapColorAndOpacity","ViewportType","SurfaceData","BrushTool","FILL_INSIDE_CIRCLE","ERASE_INSIDE_CIRCLE","FILL_INSIDE_SPHERE","ERASE_INSIDE_SPHERE","THRESHOLD_INSIDE_CIRCLE","THRESHOLD_INSIDE_SPHERE","THRESHOLD","threshold","thresholdVolumeId","brushSize","preview","previewColors","previewTimeMs","previewMoveDistance","dragMoveDistance","dragTimeMs","AcceptPreview","RejectPreview","_previewData","timerStart","timer","NaN","isDrag","_editData","createEditData","now","hoverData","_hoverData","createHoverData","getOperationData","OnInteractionStart","rejectPreview","previewCallback","Preview","OnInteractionEnd","acceptPreview","CustomEvent","ERROR_EVENT","message","cancelable","dispatchEvent","volumes","referencedVolumeIdToThreshold","referencedImageIds","override","getActiveSegmentationData","brushCursor","activeRepresentation","_calculateCursor","viewRight","centerCursorInWorld","bottomCursorInWorld","topCursorInWorld","leftCursorInWorld","rightCursorInWorld","strategy","computeInnerCircleRadius","invalidateBrushCursor","brushCursorUID","dynamicRadiusInCanvas","circleUID1","RectangleROIStartEndThresholdTool","computePointsInsideVolume","projectionPointsImageIds","roundedStartCoord","roundedEndCoord","coord","roundedCoord","firstOrLastSlice","habdles","projectionPoint","RectangleROIThresholdTool","ContourWindingDirection","getViewportsForAnnotation","getEnabledElements","roundNumber","sourcePoints","minDistance","MAX_SAFE_INTEGER","sourcePoint","_distanceBetween","cachedResult","keySet","addImageSegmentIndices","addVolumeSegmentIndices","handleLabelmapSegmentation","handleContourSegmentation","handleSurfaceSegmentation","equalsCheck","getVoxelOverlap","voxelSpacing","voxelCenter","halfSpacingX","halfSpacingY","halfSpacingZ","voxelCornersIJK","offsets","xOff","yOff","zOff","processVolumes","thresholdVolumeInformation","segmentationSpacing","scalarDataLength","getScalarDataLength","volumeInfoList","baseVolumeIdx","volumeSize","segmentIndicesCache","setSegmentationDirty","cached","isDirty","getCachedSegmentIndices","setCachedSegmentIndices","_extends","_react","_react2","__esModule","exports","_ref","_ref$fill","_ref$width","_ref$height","_ref$style","props","_objectWithoutProperties","_typeof","iterator","_defineProperties","enumerable","configurable","writable","arg","hint","prim","toPrimitive","TypeError","_toPrimitive","_toConsumableArray","_arrayLikeToArray","_arrayWithoutHoles","iter","_iterableToArray","o","minLen","n","test","_unsupportedIterableToArray","_nonIterableSpread","arr2","stringToUint8Array","str","charCodeAt","containsToken","token","findToken","maxSearchLength","searchLength","multipartEncode","datasets","boundary","s4","random","guid","contentTypeString","header","footer","headerArray","footerArray","headerLength","footerLength","contentArrays","datasetBuffer","contentArray","contentLength","multipartArray","multipartDecode","ArrayBuffer","isView","separator","headerIndex","itemLimit","uint8ArrayToString","boundaryString","parts","substr","identifyBoundary","boundaryIndex","boundaryLength","components","headerTokenIndex","isObject","isEmptyObject","getFirstResult","MEDIATYPES","DICOM","DICOM_JSON","OCTET_STREAM","PDF","JPEG","PNG","debugLog","api","DICOMwebClient","Constructor","_classCallCheck","baseURL","username","password","qidoURLPrefix","qidoURL","wadoURLPrefix","wadoURL","stowURLPrefix","stowURL","singlepart","requestHooks","headers","errorInterceptor","verbose","setDebug","protoProps","staticProps","debugLevel","debugLogFunction","_this","reject","request","XMLHttpRequest","open","responseType","setRequestHeader","functions","userHeaders","onloadstart","onloadend","onreadystatechange","readyState","contentType","getResponseHeader","progressCallback","onprogress","isValid","requestHook","areValidRequestHooks","combinedHeaders","pipedRequest","withCredentials","send","_httpRequest","params","urlWithQueryParams","_parseQueryParameters","Accept","_httpGet","mediaTypes","_buildAcceptHeaderFieldValue","byteRange","supportedMediaTypes","Range","_buildRangeHeaderFieldValue","_buildMultipartAcceptHeaderFieldValue","defaultMediaType","acceptableMediaTypes","mediaType","_httpPost","queryParams","_httpGetApplicationJson","studyInstanceUID","seriesInstanceUID","transferSyntax","sopInstanceUID","paramString","frameNumbers","_httpGetMultipartApplicationOctetStream","_getSharedMediaTypes","commonMediaType","_getCommonMediaType","_httpGetMultipartImage","_httpGetMultipartVideo","_httpGetImage","_httpGetVideo","_httpGetText","_httpGetApplicationPdf","_options$withCredenti","_options$progressCall","_httpGetMultipartApplicationDicom","_options$withCredenti2","_options$progressCall2","BulkDataURI","_options$withCredenti3","_options$progressCall3","_multipartEncode","_options$withCredenti4","queryString","encodeURIComponent","sepIndex","mediaTypeType","_assertMediaTypeIsValid","_this2","fieldValueParts","transferSyntaxUID","fieldValue","endsWith","expectedMediaTypes","actualType","_parseMediaType","expectedMediaType","expectedType","types","sharedMediaTypes","HASH_UNDEFINED","INFINITY","funcTag","genTag","symbolTag","reIsDeepProp","reIsPlainProp","reLeadingDot","rePropName","reEscapeChar","reIsHostCtor","freeGlobal","freeSelf","self","root","Function","arrayProto","funcProto","objectProto","coreJsData","maskSrcKey","exec","IE_PROTO","funcToString","objectToString","reIsNative","RegExp","getNative","nativeCreate","symbolProto","symbolToString","Hash","entry","ListCache","MapCache","assocIndexOf","other","baseGet","object","isSymbol","isKey","stringToPath","toKey","baseIsNative","func","pattern","tag","isFunction","isHostObject","toSource","getMapData","__data__","getValue","memoize","string","baseToString","number","quote","resolver","memoized","apply","Cache","isObjectLike","module","defaultValue","DataView","hashClear","hashDelete","hashGet","hashHas","hashSet","listCacheClear","listCacheDelete","listCacheGet","listCacheHas","listCacheSet","mapCacheClear","mapCacheDelete","mapCacheGet","mapCacheHas","mapCacheSet","setCacheAdd","setCacheHas","SetCache","stackClear","stackDelete","stackGet","stackHas","stackSet","Stack","iteratee","predicate","resIndex","baseTimes","isArguments","isBuffer","isIndex","isTypedArray","inherited","isArr","isArg","isBuff","isType","skipIndexes","baseAssignValue","eq","objValue","copyObject","keysIn","arrayEach","assignValue","baseAssign","baseAssignIn","cloneBuffer","copyArray","copySymbols","copySymbolsIn","getAllKeys","getAllKeysIn","getTag","initCloneArray","initCloneByTag","initCloneObject","isMap","isSet","argsTag","objectTag","cloneableTags","baseClone","bitmask","customizer","stack","isDeep","isFlat","isFull","isFunc","stacked","subValue","objectCreate","baseCreate","proto","baseForOwn","baseEach","createBaseEach","baseFor","createBaseFor","castPath","arrayPush","keysFunc","symbolsFunc","baseGetTag","baseIsEqualDeep","baseIsEqual","equalArrays","equalByTag","equalObjects","arrayTag","equalFunc","objIsArr","othIsArr","objTag","othTag","objIsObj","othIsObj","isSameTag","objIsWrapped","othIsWrapped","objUnwrapped","othUnwrapped","matchData","noCustomizer","srcValue","COMPARE_PARTIAL_FLAG","isMasked","isLength","typedArrayTags","baseMatches","baseMatchesProperty","identity","isPrototype","nativeKeys","nativeKeysIn","isProto","isArrayLike","collection","baseIsMatch","getMatchData","matchesStrictComparable","hasIn","isStrictComparable","arrayMap","byteLength","freeExports","nodeType","freeModule","Buffer","allocUnsafe","copy","cloneArrayBuffer","dataView","byteOffset","reFlags","regexp","lastIndex","symbolValueOf","valueOf","typedArray","isNew","getSymbols","getSymbolsIn","eachFunc","fromRight","iterable","arraySome","cacheHas","isPartial","arrLength","othLength","arrStacked","othStacked","seen","arrValue","othValue","compared","othIndex","mapToArray","setToArray","convert","objProps","objLength","objStacked","skipCtor","objCtor","othCtor","baseGetAllKeys","isKeyable","getPrototype","overArg","getPrototypeOf","arrayFilter","stubArray","propertyIsEnumerable","nativeGetSymbols","getOwnPropertySymbols","mapTag","promiseTag","setTag","weakMapTag","dataViewTag","dataViewCtorString","mapCtorString","promiseCtorString","setCtorString","weakMapCtorString","Ctor","ctorString","hasFunc","cloneDataView","cloneRegExp","cloneSymbol","cloneTypedArray","reIsUint","freeProcess","process","nodeUtil","require","pairs","LARGE_ARRAY_SIZE","memoizeCapped","subString","CLONE_DEEP_FLAG","castFunction","baseHasIn","hasPath","baseIsArguments","stubFalse","baseIsMap","baseUnary","nodeIsMap","objectCtorString","baseIsSet","nodeIsSet","baseIsTypedArray","nodeIsTypedArray","arrayLikeKeys","baseKeys","baseKeysIn","baseIteratee","baseMap","baseProperty","basePropertyDeep","checkboardCache","serverCanvas","checkboard","ctx","getContext","fillStyle","fillRect","toDataURL","Checkboard","white","grey","boxShadow","grid","absolute","isValidElement","defaultProps","_createClass","defineProperties","_possibleConstructorReturn","ReferenceError","Alpha","_ref2","_temp","_len","_key","__proto__","handleChange","change","hsl","initialA","container","containerWidth","containerHeight","pageX","touches","pageY","getBoundingClientRect","pageXOffset","pageYOffset","l","_a","onChange","handleMouseDown","handleMouseUp","unbindEventListeners","subClass","superClass","setPrototypeOf","_inherits","rgb","alpha","gradient","margin","slider","marginTop","vertical","ref","onMouseDown","onTouchMove","onTouchStart","PureComponent","Component","VALID_KEY_CODES","idCounter","EditableInput","handleBlur","blurValue","setState","setUpdatedValue","handleKeyDown","getNumberValue","getArrowOffset","updatedValue","handleDrag","dragLabel","movementX","dragMax","getValueObjectWithLabel","inputId","prevProps","prevState","activeElement","_defineProperty","arrowOffset","onChangeValue","wrap","onKeyDown","onBlur","placeholder","spellCheck","hideLabel","htmlFor","Hue","_h","_props$direction","hue","className","srcIndex","mergeFunc","isCommon","isTyped","isPlainObject","baseMerge","thisArg","nativeMax","otherArgs","nativeNow","lastCalled","stamp","remaining","assigner","sources","guard","Raised","zDepth","_ref$styles","passedStyles","content","bg","propTypes","reWhitespace","reTrimStart","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","isBinary","nativeMin","wait","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","leading","maxing","invokeFunc","shouldInvoke","timeSinceLastCall","timerExpired","trailingEdge","timeWaiting","remainingWait","debounced","isInvoking","leadingEdge","flush","Saturation","_container$getBoundin","saturation","bright","getContainerRenderWindow","contains","parent","black","circle","hsv","trimLeft","trimRight","tinycolor","opts","ok","named","names","matchers","rgba","hsla","hsva","hex8","parseIntFromHex","convertHexToDecimal","hex6","hex4","hex3","stringInputToObject","isValidCSSUnit","bound01","convertToPercentage","f","q","hsvToRgb","hue2rgb","hslToRgb","boundAlpha","inputToRGB","_originalInput","_r","_g","_b","_roundA","_format","_gradientType","gradientType","_ok","rgbToHsl","rgbToHsv","rgbToHex","allow3Char","hex","pad2","rgbaToArgbHex","convertDecimalToHex","_desaturate","amount","toHsl","clamp01","_saturate","_greyscale","desaturate","_lighten","_brighten","toRgb","_darken","_spin","_complement","polyad","step","_splitcomplement","_analogous","slices","part","ret","_monochromatic","toHsv","modification","isDark","getBrightness","isLight","getOriginalInput","getFormat","getAlpha","getLuminance","RsRGB","GsRGB","BsRGB","setAlpha","toHsvString","toHslString","toHex","toHexString","toHex8","allow4Char","rgbaToHex","toHex8String","toRgbString","toPercentageRgb","toPercentageRgbString","toName","hexNames","toFilter","secondColor","hex8String","secondHex8String","formatSet","formattedString","hasAlpha","_applyModification","lighten","brighten","darken","saturate","greyscale","spin","_applyCombination","analogous","complement","monochromatic","splitcomplement","triad","tetrad","fromRatio","newColor","equals","color1","color2","mix","rgb1","rgb2","readability","isReadable","wcag2","wcag2Parms","out","parms","level","validateWCAG2Parms","mostReadable","baseColor","colorList","includeFallbackColors","bestColor","bestScore","aliceblue","antiquewhite","aqua","aquamarine","azure","beige","bisque","blanchedalmond","blue","blueviolet","brown","burlywood","burntsienna","cadetblue","chartreuse","chocolate","coral","cornflowerblue","cornsilk","crimson","cyan","darkblue","darkcyan","darkgoldenrod","darkgray","darkgreen","darkgrey","darkkhaki","darkmagenta","darkolivegreen","darkorange","darkorchid","darkred","darksalmon","darkseagreen","darkslateblue","darkslategray","darkslategrey","darkturquoise","darkviolet","deeppink","deepskyblue","dimgray","dimgrey","dodgerblue","firebrick","floralwhite","forestgreen","fuchsia","gainsboro","ghostwhite","gold","goldenrod","gray","green","greenyellow","honeydew","hotpink","indianred","indigo","ivory","khaki","lavender","lavenderblush","lawngreen","lemonchiffon","lightblue","lightcoral","lightcyan","lightgoldenrodyellow","lightgray","lightgreen","lightgrey","lightpink","lightsalmon","lightseagreen","lightskyblue","lightslategray","lightslategrey","lightsteelblue","lightyellow","lime","limegreen","linen","magenta","maroon","mediumaquamarine","mediumblue","mediumorchid","mediumpurple","mediumseagreen","mediumslateblue","mediumspringgreen","mediumturquoise","mediumvioletred","midnightblue","mintcream","mistyrose","moccasin","navajowhite","navy","oldlace","olive","olivedrab","orange","orangered","orchid","palegoldenrod","palegreen","paleturquoise","palevioletred","papayawhip","peachpuff","peru","pink","plum","powderblue","purple","rebeccapurple","red","rosybrown","royalblue","saddlebrown","salmon","sandybrown","seagreen","seashell","sienna","silver","skyblue","slateblue","slategray","slategrey","snow","springgreen","steelblue","tan","teal","thistle","tomato","turquoise","violet","wheat","whitesmoke","yellow","yellowgreen","flipped","flip","isOnePointZero","processPercent","isPercentage","CSS_UNIT","PERMISSIVE_MATCH3","PERMISSIVE_MATCH4","simpleCheckForValidColor","checked","passed","letter","toState","oldHue","isValidHex","lh","getContrastingColor","col","isvalidColorString","Picker","ColorPicker","colors","onChangeComplete","handleSwatchHover","onSwatchHover","optionalEvents","nextProps","Span","_React$Component","Focus","handleFocus","onFocus","_ref$onClick","onClick","onHover","_ref$title","_ref$focusStyle","focusStyle","transparent","swatch","outline","onMouseOver","tabIndex","picker","backgroundColor","AlphaPicker","_ref$className","swatches","marginRight","float","marginBottom","Block","triangle","hexCode","card","head","alignItems","justifyContent","body","borderStyle","borderWidth","borderColor","marginLeft","border","deepPurple","lightBlue","lightGreen","amber","deepOrange","blueGrey","CircleSwatch","hover","circleSize","circleSpacing","transition","Swatch","Circle","flexWrap","ChromeFields","toggleViews","view","showHighlight","hideHighlight","paddingTop","fields","flex","field","paddingLeft","toggle","textAlign","icon","iconHighlight","textTransform","lineHeight","svg","UnfoldMoreHorizontalIcon","onMouseEnter","onMouseOut","Chrome","disableAlpha","defaultView","paddingBottom","controls","zIndex","toggles","paddingRight","HEXwrap","HEXinput","HEXlabel","RGBwrap","RGBinput","RGBlabel","Compact","compact","hoverSwatch","Github","borderBottomColor","triangleShadow","HuePicker","HuePointer","material","borderBottom","Hex","third","divider","fieldSymbols","triangleBorder","Extend","leftInside","rightInside","button","backgroundImage","currentColor","new","current","Photoshop","_props","_props$styles","_props$className","previews","PhotoshopPointer","onAccept","onCancel","PhotoshopFields","single","double","SketchPresetColors","borderTop","swatchWrap","handleClick","colorObjOrString","isRequired","Sketch","presetColors","sliders","activeColor","Slider","check","CheckIcon","Swatches","overflowY","Twitter","hash","hexcode","GooglePointerCircle","GooglePointer","_values","_values2","hsvValue","column","input2","label2","flexGrow","rgbValue","hslValue","Google","performance","cancelTimeout","timeoutID","requestTimeout","delay","tick","getScrollbarSize","recalculate","div","cachedRTLResult","getRTLOffsetType","outerDiv","outerStyle","innerDiv","innerStyle","scrollLeft","defaultItemKey$1","createListComponent","_class","getItemOffset","getEstimatedTotalSize","getItemSize","getOffsetForIndexAndAlignment","getStartIndexForOffset","getStopIndexForStartIndex","initInstanceProps","shouldResetStyleCacheOnItemSizeChange","validateProps","_PureComponent","List","_instanceProps","_outerRef","_resetIsScrollingTimeoutId","isScrolling","scrollDirection","scrollOffset","initialScrollOffset","scrollUpdateWasRequested","_callOnItemsRendered","overscanStartIndex","overscanStopIndex","visibleStartIndex","visibleStopIndex","onItemsRendered","_callOnScroll","onScroll","_getItemStyle","_this$props","itemSize","layout","itemStyleCache","_getItemStyleCache","_offset","isRtl","offsetHorizontal","__","___","_onScrollHorizontal","_event$currentTarget","scrollWidth","_resetIsScrollingDebounced","_onScrollVertical","_event$currentTarget2","scrollHeight","scrollTop","_outerRefSetter","outerRef","_resetIsScrolling","getDerivedStateFromProps","validateSharedProps$1","_proto","scrollTo","scrollToItem","align","_this$props2","itemCount","scrollbarSize","componentDidMount","_this$props3","_callPropsCallbacks","componentDidUpdate","_this$props4","_this$state","componentWillUnmount","_this$props5","innerRef","innerElementType","innerTagName","itemData","_this$props5$itemKey","itemKey","outerElementType","outerTagName","useIsScrolling","_this$_getRangeToRend","_getRangeToRender","startIndex","stopIndex","items","_index","estimatedTotalSize","WebkitOverflowScrolling","willChange","_this$_getRangeToRend2","_overscanStartIndex","_overscanStopIndex","_visibleStartIndex","_visibleStopIndex","_this$state2","_scrollDirection","_scrollOffset","_scrollUpdateWasRequested","_this$props6","overscanCount","_this$state3","overscanBackward","overscanForward","_ref3","getItemMetadata$1","instanceProps","itemMetadataMap","lastMeasuredIndex","itemMetadata","findNearestItemBinarySearch$1","high","low","middle","currentOffset","findNearestItemExponentialSearch$1","interval","estimatedItemSize","totalSizeOfMeasuredItems","VariableSizeList","maxOffset","minOffset","findNearestItem$1","resetAfterIndex","shouldForceUpdate","forceUpdate","_ref5","autoprefix","_forOwn2","_forOwn3","transforms","msBorderRadius","MozBorderRadius","OBorderRadius","WebkitBorderRadius","msBoxShadow","MozBoxShadow","OBoxShadow","WebkitBoxShadow","userSelect","WebkitTouchCallout","KhtmlUserSelect","MozUserSelect","msUserSelect","WebkitUserSelect","WebkitBoxFlex","MozBoxFlex","WebkitFlex","msFlex","flexBasis","WebkitFlexBasis","WebkitJustifyContent","msTransition","MozTransition","OTransition","WebkitTransition","msTransform","MozTransform","OTransform","WebkitTransform","otherElementStyles","otherStyle","prefixed","expanded","onMouseUp","Hover","handleMouseOver","handleMouseOut","flattenNames","_isString3","_interopRequireDefault","_isPlainObject3","_map3","things","thing","_flattenNames2","_mergeClasses2","_autoprefix2","_hover3","_active2","_loop3","ReactCSS","classes","activations","activeNames","merged","setProp","mergeClasses","_cloneDeep3","toMerge","is","useState","useEffect","useLayoutEffect","useDebugValue","getSnapshot","inst","useSyncExternalStore","useRef","useMemo","useSyncExternalStoreWithSelector","hasValue","createStoreImpl","createState","listeners","partial","nextState","previousState","listener","getInitialState","initialState","subscribe","createStore","didWarnAboutEqualityFn","createImpl","useBoundStore","selector","equalityFn","getServerState","useStore","trackedConnections","getTrackedConnectionState","fromEntries","stores","api2","devtools","devtoolsOptions","anonymousActionType","store","extensionConnector","__REDUX_DEVTOOLS_EXTENSION__","_e","connection","connectionInformation","connect","existingConnection","newConnection","extractConnectionInformation","isRecording","nameOrAction","action","setStateFromDevtools","originalIsRecording","store2","dispatchFromDevtools","dispatch","didWarnAboutReservedActionType","originalDispatch","parseJsonThen","stateFromDevtools","nextLiftedState","lastComputedState","computedStates","stringified","parsed","parse"],"sourceRoot":""}